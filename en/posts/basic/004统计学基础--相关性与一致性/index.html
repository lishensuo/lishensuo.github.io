<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">

<link rel="icon" href="/favicon.ico" type="image/x-icon"> 
<title>统计学基础--相关性与一致性 | Li&#39;s Bioinfo-Blog</title>
<meta name="keywords" content="统计基础">
<meta name="description" content="一、相关性
1、线性相关系数
（1）线性相关系数用于描述多个样本数据中两个变量之间的线性相关的程度。

变量通常为连续型变量；
两个变量一般为描述样本的不同指标，例如人群的体重值与血糖值

（2）协方差(Corvariance)：用于衡量两个随机变量的联合变化程度。">
<meta name="author" content="Lishensuo">
<link rel="canonical" href="https://lishensuo.github.io/en/posts/basic/004%E7%BB%9F%E8%AE%A1%E5%AD%A6%E5%9F%BA%E7%A1%80--%E7%9B%B8%E5%85%B3%E6%80%A7%E4%B8%8E%E4%B8%80%E8%87%B4%E6%80%A7/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.9e4de5e3ba61ea358168341aa7cdf70abfaafb7c697dfe8624af3ddff9a35c2f.css" integrity="sha256-nk3l47ph6jWBaDQap833Cr&#43;q&#43;3xpff6GJK893/mjXC8=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.555af97124d54bb1457985dd081b8f5616a48103aafeb30ac89fde835d65aa6c.js" integrity="sha256-VVr5cSTVS7FFeYXdCBuPVhakgQOq/rMKyJ/eg11lqmw="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://lishensuo.github.io/img/Q.gif">
<link rel="icon" type="image/png" sizes="16x16" href="https://lishensuo.github.io/img/Q.gif">
<link rel="icon" type="image/png" sizes="32x32" href="https://lishensuo.github.io/img/Q.gif">
<link rel="apple-touch-icon" href="https://lishensuo.github.io/Q.gif">
<link rel="mask-icon" href="https://lishensuo.github.io/Q.gif">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://lishensuo.github.io/en/posts/basic/004%E7%BB%9F%E8%AE%A1%E5%AD%A6%E5%9F%BA%E7%A1%80--%E7%9B%B8%E5%85%B3%E6%80%A7%E4%B8%8E%E4%B8%80%E8%87%B4%E6%80%A7/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="统计学基础--相关性与一致性" />
<meta property="og:description" content="一、相关性
1、线性相关系数
（1）线性相关系数用于描述多个样本数据中两个变量之间的线性相关的程度。

变量通常为连续型变量；
两个变量一般为描述样本的不同指标，例如人群的体重值与血糖值

（2）协方差(Corvariance)：用于衡量两个随机变量的联合变化程度。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lishensuo.github.io/en/posts/basic/004%E7%BB%9F%E8%AE%A1%E5%AD%A6%E5%9F%BA%E7%A1%80--%E7%9B%B8%E5%85%B3%E6%80%A7%E4%B8%8E%E4%B8%80%E8%87%B4%E6%80%A7/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-06-02T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2022-06-13T00:00:00&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="统计学基础--相关性与一致性"/>
<meta name="twitter:description" content="一、相关性
1、线性相关系数
（1）线性相关系数用于描述多个样本数据中两个变量之间的线性相关的程度。

变量通常为连续型变量；
两个变量一般为描述样本的不同指标，例如人群的体重值与血糖值

（2）协方差(Corvariance)：用于衡量两个随机变量的联合变化程度。"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "分类",
      "item": "https://lishensuo.github.io/en/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "📖 科研基础 -- 读文献、看教材",
      "item": "https://lishensuo.github.io/en/posts/basic/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "统计学基础--相关性与一致性",
      "item": "https://lishensuo.github.io/en/posts/basic/004%E7%BB%9F%E8%AE%A1%E5%AD%A6%E5%9F%BA%E7%A1%80--%E7%9B%B8%E5%85%B3%E6%80%A7%E4%B8%8E%E4%B8%80%E8%87%B4%E6%80%A7/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "统计学基础--相关性与一致性",
  "name": "统计学基础--相关性与一致性",
  "description": "一、相关性 1、线性相关系数 （1）线性相关系数用于描述多个样本数据中两个变量之间的线性相关的程度。\n变量通常为连续型变量； 两个变量一般为描述样本的不同指标，例如人群的体重值与血糖值 （2）协方差(Corvariance)：用于衡量两个随机变量的联合变化程度。\n",
  "keywords": [
    "统计基础"
  ],
  "articleBody": "一、相关性 1、线性相关系数 （1）线性相关系数用于描述多个样本数据中两个变量之间的线性相关的程度。\n变量通常为连续型变量； 两个变量一般为描述样本的不同指标，例如人群的体重值与血糖值 （2）协方差(Corvariance)：用于衡量两个随机变量的联合变化程度。\n如果协方差大于0，表示正相关；小于0表示负相关。 $$ Cov(y, x) = \\frac{\\sum_{i=1}^n(y_i-\\overline{y})(x_i-\\overline{x})}{n-1} $$\n如上公式，可以看出方差其实是协方差的特例。自己对自己的关系就是方差。\n（3）为了克服不同变量的尺度不相同所带来的的干扰，在计算需要对原始变量进行标准正态分布转换。此时得到的协方差就是两个连续变量的线性相关系数，常称为Person相关系数。 $$ r = \\frac{\\sum_{i=1}^n(y_i-\\overline{y})(x_i-\\overline{x})}{\\sqrt{\\sum_{i=1}^n(y_i-\\overline{y})^2}\\sqrt{\\sum_{i=1}^n(x_i-\\overline{x})^2}} $$\nr(r\u003e0)值越大表示两个变量呈正相关；r(r\u003c0)值越小表示两个变量呈负相关；r=0表示两个变量不相关。 （4）P值与假设检验\n在相关性分析的假设检验中，零假设通常为r=0。在p值显著的情况下，可认为两个变量存在相关性，仅此而已。 不能说P值越小，两个变量的相关性越强(包括正负)。 当P值不显著时，所能得到的结论是两个变量不存在线性相关；而不是不相关。 2、基于秩次的相关系数 当连续变量值的分布特征不符合正态分布时，一般不可使用Person相关系数，可选择如下基于秩次的计算方式。\n2.1 Spearman相关系数 计算思路比较简单：首先求出每个变量各自排序后的秩次，然后以秩次作为变量计算其Person相关系数。\n在计算秩次时，如果对于某一变量，多个样本的值相同的情况，则称为Tie或者说是打结。此时一般取秩次的平均值。如下例图所示。\nSample Var1 Var1-Rank Sp1 1.1 1 Sp2 2.5 2.5 Sp3 2.5 2.5 Sp4 4.9 4 2.2 Kendall的tau系数 （1）首先对于每个变量(Var1, Var2)，计算每个样本的样本秩次。\n（2）然后随机抽取一对样本Sp1，Sp2：\n如果Sp1的Var1秩次大于(小于)Sp2的Var1秩次，同时Sp1的Var2秩次也大于(小于)Sp2的Var2秩次，则记为Concordant，简记为C； 如不符合上述情况，则记为Discordant，简记为D。 （3）最后统计对于所有两两组合的情况下，C与D的差值所占的比例，即为tau系数。\ntau值越高表明两个变量越相关。 $$ \\tau = \\frac{C-D}{n(n-1)/2} $$\n在涉及有序分类(等级)变量的相关性时，可以转换为基于秩次的相关性计算。\n此时会存在很多打结的秩次数据，此时使用Tau/b系数相对Spearman可以更好地处理打结数据。\n3、R实操 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 a1 = c(1,2,4,5,8,11) a2 = c(2,3,5,7,6,15) cor(a1, a2) # [1] 0.9136724 cor(a1, a2, method = \"pearson\") # default cor(a1, a2, method = \"kendall\") cor(a1, a2, method = \"spearman\") cor.test(a1, a2) # data: a1 and a2 # t = 4.4959, df = 4, p-value = 0.01086 # alternative hypothesis: true correlation is not equal to 0 # 95 percent confidence interval: # 0.3950157 0.9906589 # sample estimates: # cor # 0.9136724 cor.test(a1, a2)$p.value cor.test(a1, a2, method = \"pearson\") # default cor.test(a1, a2, method = \"kendall\") cor.test(a1, a2, method = \"spearman\") 二、一致性 一致性与相关性的区别体现在如下两个方面\n一致性强调是描述同一指标的不同测量方式的关系。例如仪器A测量体重值与仪器B测量体重值的一致性。\n一致性更注重两个指标的尺度上的一致性，即[1,2,3]与[1.1,1.9,2.8]的一致性更高；而与[2,4,6]的一致性则较低。\n2.1 CCC CCC(Concordance Correlation Coefficient)用偏离45度线的程度，对Pearson相关系数进行校正。\n计算公式如下：其中r–相关系数；Sx–变量x的标准差；x(hat)–变量x的均值 $$ r_c = \\frac{2r\\cdot S_xS_y}{S_x^2+S_y^2+(\\overline{x}-\\overline{y})^2} $$\n如下图所示，展现了CCC与线性相关系数的不同之处。 2.2 Kappa系数 Cohen’s Kappa\n（1）Kappa系数用于分类变量的一致性评价。值范围在 -1 ~ 1之间，越接近1表示一致性越好。\n可用于机器学习中评价模型分类预测能力。 例如真实的有效、无效所预测的有效、无效的一致性程度。 计算公式如下：其中Po表示观察的一致性，即同一样本的两个变量分类结果相同；Pe表示期望的一致性，即同一样本一致性的期望频率 $$ \\kappa = \\frac{p_o - p_e}{1 - p_e} $$\n（2）举例来说，需要对一批产品(N=20)进行质量评价，分为A、B、C 这3个等级。两个质检员分别独自评价分类，使用kappa系数计算两次结果的一致性。\nA B C sum A 8 2 1 11 B 2 3 0 5 C 0 1 3 4 sum 10 6 4 20 $$ p_o = \\frac{8}{20} + \\frac{3}{20}+ \\frac{3}{20} = 0.70 $$\n$$ p_e = \\frac{10}{20}\\cdot\\frac{11}{20}+\\frac{6}{20}\\cdot\\frac{5}{20}+\\frac{4}{20}\\cdot\\frac{4}{20} = 0.39 $$\n$$ \\kappa = \\frac{0.7 - 0.39}{1-0.39} = 0.51 $$\n（3）加权kappa系数：适用于有序分类变量的一致性评价。\n还是上面的例子，如果A、B、C分别表示好、中、差3个有序等级。\n把同一个产品标记为A、B的情况与把同一个产品标记为A、C的一致性差异是不一致的，前者会比后者更好一些。\n如下为一个示例的权重矩阵\nA B C A 1 0.5 0 B 0.5 1 0.5 C 0 0.5 1 把同一产品分为同一等级的一致性最高，故赋予最高的权重\n把同一产品分为相差一级的一致性中等，故赋予较低的权重\n把同一产品分为相差两级的一致性最低，故赋予最低的权重\n所以加权的观察一致性计算如下\nA B C sum A 8×1=8 2×0.5=1 1×0=0 9 B 2×0.5=1 3×1=3 0×0.5=0 4 C 0×0=0 1×0.5=0.5 3×1=3 3.5 sum 9 4.5 3 16.5 $$ p_o = \\frac{16.5}{20} = 0.825 $$\n加权的预期一致性计算如下\nA B C sum A 10×11×1=110 6×11×0.5=33 4×11×0=0 143 B 10×5×0.5=25 6×5×1=30 4×5×0.5=10 65 C 10×4×0=0 6×4×0.5=12 4×4×1=16 28 sum 135 75 26 236 $$ p_e = \\frac{236 }{20×20} = 0.59 $$\n$$ \\kappa = \\frac{0.825 - 0.59}{1-0.59} = 0.57 $$\n未加权矩阵相当于多角线元素值为1，其余元素值为0的权重值矩阵。\n2.3 AC系数 Gwet’s AC1 $$ AC1 = \\frac{p-e(\\gamma)}{1-e(\\gamma)} $$\nP：the overall percent agreement $$ P = \\frac{A+D}{N} $$ e(γ): the chance agreement probability\n相比Kappa系数，AC系数对边际分类问题准确性有更高的容忍度。\nhttps://bmcmedresmethodol.biomedcentral.com/track/pdf/10.1186/1471-2288-13-61.pdf 2.4 R实操 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 ##(1) CCC系数 a1 = c(1,2,4,5,8,11) a2 = c(2,3,5,7,6,15) library(DescTools) CCC(a1, a2) # $rho.c # est lwr.ci upr.ci # 1 0.8550984 0.3990051 0.971993 # # $s.shift # [1] 1.230973 # # $l.shift # [1] 0.3060408 # # $C.b # [1] 0.9358917 # # $blalt # mean delta # 1 1.5 -1 # 2 2.5 -1 # 3 4.5 -1 # 4 6.0 -2 # 5 7.0 2 # 6 13.0 -4 ##(2) Kappa系数 library(vcd) library(vcd) mat = matrix(c(10, 2, 1, 2, 3 ,0, 0, 1 ,3), byrow = T, nrow = 3) colnames(mat) = c(\"A\",\"B\",\"C\") rownames(mat) = c(\"A\",\"B\",\"C\") mat # A B C # A 10 2 1 # B 2 3 0 # C 0 1 3 Kappa(mat) # value ASE z Pr(\u003e|z|) # Unweighted 0.5319 0.1611 3.301 0.0009629 # Weighted 0.5969 0.1554 3.841 0.0001224 Kappa(mat)$Weights # [,1] [,2] [,3] # [1,] 1.0 0.5 0.0 # [2,] 0.5 1.0 0.5 # [3,] 0.0 0.5 1.0 ##(3) $$ AC1 = \\frac{p-e(\\gamma)}{1-e(\\gamma)} $$\n$$ p = \\frac{a_1 + a_5 + a_9}{\\sum_{i=1}^{9}a_i} $$\n$$ e(\\gamma) = 2q(1-q), \\quad q=\\frac{(a_1 + a_2 + a_3)+(a_1+a_4+a_9)}{2\\sum_{i=1}^{9}a_i} $$\n",
  "wordCount" : "2460",
  "inLanguage": "en",
  "datePublished": "2022-06-02T00:00:00Z",
  "dateModified": "2022-06-13T00:00:00Z",
  "author":[{
    "@type": "Person",
    "name": "Lishensuo"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://lishensuo.github.io/en/posts/basic/004%E7%BB%9F%E8%AE%A1%E5%AD%A6%E5%9F%BA%E7%A1%80--%E7%9B%B8%E5%85%B3%E6%80%A7%E4%B8%8E%E4%B8%80%E8%87%B4%E6%80%A7/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Li's Bioinfo-Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://lishensuo.github.io/img/Q.gif"
    }
  }
}
</script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://lishensuo.github.io/en/" accesskey="h" title="Li&#39;s Bioinfo-Blog (Alt + H)">Li&#39;s Bioinfo-Blog</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                </ul>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://lishensuo.github.io/en/" title="主页">
                    <span>主页</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/posts" title="分类">
                    <span>分类</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/tags" title="标签">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/archives/" title="归档">
                    <span>归档</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/about" title="关于">
                    <span>关于</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/search" title="搜索 (Alt &#43; /)" accesskey=/>
                    <span>搜索</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://lishensuo.github.io/en/">Home</a>&nbsp;»&nbsp;<a href="https://lishensuo.github.io/en/posts/">分类</a>&nbsp;»&nbsp;<a href="https://lishensuo.github.io/en/posts/basic/">📖 科研基础 -- 读文献、看教材</a></div>
    <h1 class="post-title">
      统计学基础--相关性与一致性
    </h1>
    <div class="post-meta">













Create:&amp;nbsp;&lt;span title=&#39;2022-06-02 00:00:00 &#43;0000 UTC&#39;&gt;2022-06-02&lt;/span&gt;&amp;nbsp;|&amp;nbsp;Update:&amp;nbsp;2022-06-13&amp;nbsp;|&amp;nbsp;Words:&amp;nbsp;2460&amp;nbsp;|&amp;nbsp;5 min&amp;nbsp;|&amp;nbsp;Lishensuo

|  Viewers: <span id="busuanzi_value_page_pv"></span> 
	  
    </div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">Table of Contents</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#%e4%b8%80%e7%9b%b8%e5%85%b3%e6%80%a7" aria-label="一、相关性">一、相关性</a><ul>
                            
                    <li>
                        <a href="#1%e7%ba%bf%e6%80%a7%e7%9b%b8%e5%85%b3%e7%b3%bb%e6%95%b0" aria-label="1、线性相关系数">1、线性相关系数</a></li>
                    <li>
                        <a href="#2%e5%9f%ba%e4%ba%8e%e7%a7%a9%e6%ac%a1%e7%9a%84%e7%9b%b8%e5%85%b3%e7%b3%bb%e6%95%b0" aria-label="2、基于秩次的相关系数">2、基于秩次的相关系数</a><ul>
                            
                    <li>
                        <a href="#21-spearman%e7%9b%b8%e5%85%b3%e7%b3%bb%e6%95%b0" aria-label="2.1 Spearman相关系数">2.1 Spearman相关系数</a></li>
                    <li>
                        <a href="#22-kendall%e7%9a%84tau%e7%b3%bb%e6%95%b0" aria-label="2.2 Kendall的tau系数">2.2 Kendall的tau系数</a></li></ul>
                    </li>
                    <li>
                        <a href="#3r%e5%ae%9e%e6%93%8d" aria-label="3、R实操">3、R实操</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e4%ba%8c%e4%b8%80%e8%87%b4%e6%80%a7" aria-label="二、一致性">二、一致性</a><ul>
                            
                    <li>
                        <a href="#21-ccc" aria-label="2.1 CCC">2.1 CCC</a></li>
                    <li>
                        <a href="#22-kappa%e7%b3%bb%e6%95%b0" aria-label="2.2 Kappa系数">2.2 Kappa系数</a></li>
                    <li>
                        <a href="#23-ac%e7%b3%bb%e6%95%b0" aria-label="2.3 AC系数">2.3 AC系数</a></li>
                    <li>
                        <a href="#24-r%e5%ae%9e%e6%93%8d" aria-label="2.4 R实操">2.4 R实操</a>
                    </li>
                </ul>
                </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>


  <div class="post-content"><h1 id="一相关性">一、相关性<a hidden class="anchor" aria-hidden="true" href="#一相关性">#</a></h1>
<h2 id="1线性相关系数">1、线性相关系数<a hidden class="anchor" aria-hidden="true" href="#1线性相关系数">#</a></h2>
<p>（1）线性相关系数用于描述多个样本数据中两个变量之间的线性相关的程度。</p>
<ul>
<li>变量通常为连续型变量；</li>
<li>两个变量一般为描述样本的不同指标，例如人群的体重值与血糖值</li>
</ul>
<p>（2）协方差(Corvariance)：用于衡量两个随机变量的联合变化程度。</p>
<ul>
<li>如果协方差大于0，表示正相关；小于0表示负相关。</li>
</ul>
<p>$$
Cov(y, x) = \frac{\sum_{i=1}^n(y_i-\overline{y})(x_i-\overline{x})}{n-1}
$$</p>
<blockquote>
<p>如上公式，可以看出方差其实是协方差的特例。自己对自己的关系就是方差。</p></blockquote>
<p>（3）为了克服不同变量的尺度不相同所带来的的干扰，在计算需要对原始变量进行<u>标准正态分布转换</u>。此时得到的协方差就是两个连续变量的<strong>线性相关系数</strong>，常称为Person相关系数。
$$
r = \frac{\sum_{i=1}^n(y_i-\overline{y})(x_i-\overline{x})}{\sqrt{\sum_{i=1}^n(y_i-\overline{y})^2}\sqrt{\sum_{i=1}^n(x_i-\overline{x})^2}}
$$</p>
<ul>
<li>r(r&gt;0)值越大表示两个变量呈正相关；r(r&lt;0)值越小表示两个变量呈负相关；r=0表示两个变量不相关。</li>
</ul>
<p>（4）P值与假设检验</p>
<ul>
<li>在相关性分析的假设检验中，零假设通常为r=0。在p值显著的情况下，可认为两个变量存在相关性，仅此而已。</li>
<li>不能说P值越小，两个变量的相关性越强(包括正负)。</li>
<li>当P值不显著时，所能得到的结论是两个变量不存在线性相关；而不是不相关。</li>
</ul>
<h2 id="2基于秩次的相关系数">2、基于秩次的相关系数<a hidden class="anchor" aria-hidden="true" href="#2基于秩次的相关系数">#</a></h2>
<p>当连续变量值的分布特征不符合正态分布时，一般不可使用Person相关系数，可选择如下基于秩次的计算方式。</p>
<h3 id="21-spearman相关系数">2.1 Spearman相关系数<a hidden class="anchor" aria-hidden="true" href="#21-spearman相关系数">#</a></h3>
<p>计算思路比较简单：首先求出每个变量各自排序后的秩次，然后以秩次作为变量计算其Person相关系数。</p>
<p><img loading="lazy" src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4e/Spearman_fig1.svg/300px-Spearman_fig1.svg.png" alt="Spearman&rsquo;s rank correlation coefficient - Wikipedia"  />
</p>
<p>在计算秩次时，如果对于某一变量，多个样本的值相同的情况，则称为Tie或者说是打结。此时一般取秩次的平均值。如下例图所示。</p>
<table>
  <thead>
      <tr>
          <th style="text-align: center">Sample</th>
          <th style="text-align: center">Var1</th>
          <th style="text-align: center">Var1-Rank</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center">Sp1</td>
          <td style="text-align: center">1.1</td>
          <td style="text-align: center">1</td>
      </tr>
      <tr>
          <td style="text-align: center">Sp2</td>
          <td style="text-align: center">2.5</td>
          <td style="text-align: center">2.5</td>
      </tr>
      <tr>
          <td style="text-align: center">Sp3</td>
          <td style="text-align: center">2.5</td>
          <td style="text-align: center">2.5</td>
      </tr>
      <tr>
          <td style="text-align: center">Sp4</td>
          <td style="text-align: center">4.9</td>
          <td style="text-align: center">4</td>
      </tr>
  </tbody>
</table>
<h3 id="22-kendall的tau系数">2.2 Kendall的tau系数<a hidden class="anchor" aria-hidden="true" href="#22-kendall的tau系数">#</a></h3>
<p>（1）首先对于每个变量(Var1, Var2)，计算每个样本的样本秩次。</p>
<p>（2）然后随机抽取一对样本Sp1，Sp2：</p>
<ul>
<li>如果Sp1的Var1秩次大于(小于)Sp2的Var1秩次，同时Sp1的Var2秩次也大于(小于)Sp2的Var2秩次，则记为<strong>Concordant</strong>，简记为C；</li>
<li>如不符合上述情况，则记为<strong>Discordant</strong>，简记为D。</li>
</ul>
<img src="https://www.statology.org/wp-content/uploads/2020/02/kendall8.png" alt="Kendall's tau calculation" style="zoom:50%;" />
<p>（3）最后统计对于所有两两组合的情况下，C与D的差值所占的比例，即为tau系数。</p>
<ul>
<li>tau值越高表明两个变量越相关。</li>
</ul>
<p>$$
\tau = \frac{C-D}{n(n-1)/2}
$$</p>
<blockquote>
<p>在涉及有序分类(等级)变量的相关性时，可以转换为基于秩次的相关性计算。</p>
<p>此时会存在很多打结的秩次数据，此时使用Tau/b系数相对Spearman可以更好地处理打结数据。</p></blockquote>
<h2 id="3r实操">3、R实操<a hidden class="anchor" aria-hidden="true" href="#3r实操">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>a1 = c(<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#ff0;font-weight:bold">5</span>,<span style="color:#ff0;font-weight:bold">8</span>,<span style="color:#ff0;font-weight:bold">11</span>)
</span></span><span style="display:flex;"><span>a2 = c(<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#ff0;font-weight:bold">5</span>,<span style="color:#ff0;font-weight:bold">7</span>,<span style="color:#ff0;font-weight:bold">6</span>,<span style="color:#ff0;font-weight:bold">15</span>)
</span></span><span style="display:flex;"><span>cor(a1, a2)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># [1] 0.9136724</span>
</span></span><span style="display:flex;"><span>cor(a1, a2, method = <span style="color:#0ff;font-weight:bold">&#34;pearson&#34;</span>)  <span style="color:#007f7f"># default</span>
</span></span><span style="display:flex;"><span>cor(a1, a2, method = <span style="color:#0ff;font-weight:bold">&#34;kendall&#34;</span>)  
</span></span><span style="display:flex;"><span>cor(a1, a2, method = <span style="color:#0ff;font-weight:bold">&#34;spearman&#34;</span>)  
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cor.test(a1, a2)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># data:  a1 and a2</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># t = 4.4959, df = 4, p-value = 0.01086</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># alternative hypothesis: true correlation is not equal to 0</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 95 percent confidence interval:</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#  0.3950157 0.9906589</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sample estimates:</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#       cor </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 0.9136724 </span>
</span></span><span style="display:flex;"><span>cor.test(a1, a2)$p.value
</span></span><span style="display:flex;"><span>cor.test(a1, a2, method = <span style="color:#0ff;font-weight:bold">&#34;pearson&#34;</span>)  <span style="color:#007f7f"># default</span>
</span></span><span style="display:flex;"><span>cor.test(a1, a2, method = <span style="color:#0ff;font-weight:bold">&#34;kendall&#34;</span>)  
</span></span><span style="display:flex;"><span>cor.test(a1, a2, method = <span style="color:#0ff;font-weight:bold">&#34;spearman&#34;</span>) 
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="二一致性">二、一致性<a hidden class="anchor" aria-hidden="true" href="#二一致性">#</a></h1>
<p>一致性与相关性的区别体现在如下两个方面</p>
<ul>
<li>
<p>一致性强调是描述<u>同一指标</u>的不同测量方式的关系。例如仪器A测量体重值与仪器B测量体重值的一致性。</p>
</li>
<li>
<p>一致性更注重两个指标的<u>尺度上的一致性</u>，即[1,2,3]与[1.1,1.9,2.8]的一致性更高；而与[2,4,6]的一致性则较低。</p>
</li>
</ul>
<h2 id="21-ccc">2.1 CCC<a hidden class="anchor" aria-hidden="true" href="#21-ccc">#</a></h2>
<p>CCC(Concordance Correlation Coefficient)用偏离45度线的程度，对Pearson相关系数进行校正。</p>
<ul>
<li>计算公式如下：其中r&ndash;相关系数；Sx&ndash;变量x的标准差；x(hat)&ndash;变量x的均值</li>
</ul>
<p>$$
r_c = \frac{2r\cdot S_xS_y}{S_x^2+S_y^2+(\overline{x}-\overline{y})^2}
$$</p>
<ul>
<li>如下图所示，展现了CCC与线性相关系数的不同之处。</li>
</ul>
<p><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images/main/animals-10-02054-g001-550.jpg" alt="Animals | Free Full-Text | Validation of an Alternative Feather Sampling  Method to Measure Corticosterone | HTML"  />
</p>
<h2 id="22-kappa系数">2.2 Kappa系数<a hidden class="anchor" aria-hidden="true" href="#22-kappa系数">#</a></h2>
<p>Cohen’s Kappa</p>
<p>（1）Kappa系数用于分类变量的一致性评价。值范围在 -1 ~ 1之间，越接近1表示一致性越好。</p>
<ul>
<li>可用于机器学习中评价模型分类预测能力。</li>
<li>例如真实的有效、无效所预测的有效、无效的一致性程度。</li>
</ul>
<p>计算公式如下：其中Po表示观察的一致性，即同一样本的两个变量分类结果相同；Pe表示期望的一致性，即同一样本一致性的期望频率
$$
\kappa = \frac{p_o - p_e}{1 - p_e}
$$</p>
<p>（2）举例来说，需要对一批产品(N=20)进行质量评价，分为A、B、C 这3个等级。两个质检员分别独自评价分类，使用kappa系数计算两次结果的一致性。</p>
<table>
  <thead>
      <tr>
          <th style="text-align: center"></th>
          <th style="text-align: center">A</th>
          <th style="text-align: center">B</th>
          <th style="text-align: center">C</th>
          <th style="text-align: center">sum</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center"><strong>A</strong></td>
          <td style="text-align: center">8</td>
          <td style="text-align: center">2</td>
          <td style="text-align: center">1</td>
          <td style="text-align: center">11</td>
      </tr>
      <tr>
          <td style="text-align: center"><strong>B</strong></td>
          <td style="text-align: center">2</td>
          <td style="text-align: center">3</td>
          <td style="text-align: center">0</td>
          <td style="text-align: center">5</td>
      </tr>
      <tr>
          <td style="text-align: center"><strong>C</strong></td>
          <td style="text-align: center">0</td>
          <td style="text-align: center">1</td>
          <td style="text-align: center">3</td>
          <td style="text-align: center">4</td>
      </tr>
      <tr>
          <td style="text-align: center">sum</td>
          <td style="text-align: center">10</td>
          <td style="text-align: center">6</td>
          <td style="text-align: center">4</td>
          <td style="text-align: center">20</td>
      </tr>
  </tbody>
</table>
<p>$$
p_o = \frac{8}{20} + \frac{3}{20}+ \frac{3}{20} = 0.70
$$</p>
<p>$$
p_e = \frac{10}{20}\cdot\frac{11}{20}+\frac{6}{20}\cdot\frac{5}{20}+\frac{4}{20}\cdot\frac{4}{20} = 0.39
$$</p>
<p>$$
\kappa = \frac{0.7 - 0.39}{1-0.39} = 0.51
$$</p>
<p>（3）加权kappa系数：适用于有序分类变量的一致性评价。</p>
<ul>
<li>
<p>还是上面的例子，如果A、B、C分别表示好、中、差3个有序等级。</p>
</li>
<li>
<p>把同一个产品标记为A、B的情况与把同一个产品标记为A、C的一致性差异是不一致的，前者会比后者更好一些。</p>
</li>
</ul>
<p>如下为一个示例的权重矩阵</p>
<table>
  <thead>
      <tr>
          <th></th>
          <th>A</th>
          <th>B</th>
          <th>C</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>A</td>
          <td>1</td>
          <td>0.5</td>
          <td>0</td>
      </tr>
      <tr>
          <td>B</td>
          <td>0.5</td>
          <td>1</td>
          <td>0.5</td>
      </tr>
      <tr>
          <td>C</td>
          <td>0</td>
          <td>0.5</td>
          <td>1</td>
      </tr>
  </tbody>
</table>
<p>把同一产品分为同一等级的一致性最高，故赋予最高的权重</p>
<p>把同一产品分为相差一级的一致性中等，故赋予较低的权重</p>
<p>把同一产品分为相差两级的一致性最低，故赋予最低的权重</p>
<p>所以加权的<strong>观察一致性</strong>计算如下</p>
<table>
  <thead>
      <tr>
          <th style="text-align: center"></th>
          <th style="text-align: center">A</th>
          <th style="text-align: center">B</th>
          <th style="text-align: center">C</th>
          <th style="text-align: center">sum</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center"><strong>A</strong></td>
          <td style="text-align: center">8×1=8</td>
          <td style="text-align: center">2×0.5=1</td>
          <td style="text-align: center">1×0=0</td>
          <td style="text-align: center">9</td>
      </tr>
      <tr>
          <td style="text-align: center"><strong>B</strong></td>
          <td style="text-align: center">2×0.5=1</td>
          <td style="text-align: center">3×1=3</td>
          <td style="text-align: center">0×0.5=0</td>
          <td style="text-align: center">4</td>
      </tr>
      <tr>
          <td style="text-align: center"><strong>C</strong></td>
          <td style="text-align: center">0×0=0</td>
          <td style="text-align: center">1×0.5=0.5</td>
          <td style="text-align: center">3×1=3</td>
          <td style="text-align: center">3.5</td>
      </tr>
      <tr>
          <td style="text-align: center">sum</td>
          <td style="text-align: center">9</td>
          <td style="text-align: center">4.5</td>
          <td style="text-align: center">3</td>
          <td style="text-align: center">16.5</td>
      </tr>
  </tbody>
</table>
<p>$$
p_o = \frac{16.5}{20} = 0.825
$$</p>
<p>加权的<strong>预期一致性</strong>计算如下</p>
<table>
  <thead>
      <tr>
          <th style="text-align: center"></th>
          <th style="text-align: center">A</th>
          <th style="text-align: center">B</th>
          <th style="text-align: center">C</th>
          <th style="text-align: center">sum</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center"><strong>A</strong></td>
          <td style="text-align: center">10×11×1=110</td>
          <td style="text-align: center">6×11×0.5=33</td>
          <td style="text-align: center">4×11×0=0</td>
          <td style="text-align: center">143</td>
      </tr>
      <tr>
          <td style="text-align: center"><strong>B</strong></td>
          <td style="text-align: center">10×5×0.5=25</td>
          <td style="text-align: center">6×5×1=30</td>
          <td style="text-align: center">4×5×0.5=10</td>
          <td style="text-align: center">65</td>
      </tr>
      <tr>
          <td style="text-align: center"><strong>C</strong></td>
          <td style="text-align: center">10×4×0=0</td>
          <td style="text-align: center">6×4×0.5=12</td>
          <td style="text-align: center">4×4×1=16</td>
          <td style="text-align: center">28</td>
      </tr>
      <tr>
          <td style="text-align: center">sum</td>
          <td style="text-align: center">135</td>
          <td style="text-align: center">75</td>
          <td style="text-align: center">26</td>
          <td style="text-align: center">236</td>
      </tr>
  </tbody>
</table>
<p>$$
p_e = \frac{236 }{20×20} = 0.59
$$</p>
<p>$$
\kappa = \frac{0.825 - 0.59}{1-0.59} = 0.57
$$</p>
<blockquote>
<p>未加权矩阵相当于多角线元素值为1，其余元素值为0的权重值矩阵。</p></blockquote>
<h2 id="23-ac系数">2.3 AC系数<a hidden class="anchor" aria-hidden="true" href="#23-ac系数">#</a></h2>
<p>Gwet’s AC1
$$
AC1 = \frac{p-e(\gamma)}{1-e(\gamma)}
$$</p>
<p>P：the overall percent agreement
$$
P = \frac{A+D}{N}
$$
e(γ):  the chance agreement probability</p>
<blockquote>
<p>相比Kappa系数，AC系数对边际分类问题准确性有更高的容忍度。</p>
<ul>
<li><a href="https://bmcmedresmethodol.biomedcentral.com/track/pdf/10.1186/1471-2288-13-61.pdf">https://bmcmedresmethodol.biomedcentral.com/track/pdf/10.1186/1471-2288-13-61.pdf</a></li>
</ul>
<img src="https://raw.githubusercontent.com/lishensuo/images/main/image-20220619125237859.png" alt="image-20220619125237859" style="zoom: 67%;" /></blockquote>
<h2 id="24-r实操">2.4 R实操<a hidden class="anchor" aria-hidden="true" href="#24-r实操">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">54
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span><span style="color:#007f7f">##(1) CCC系数</span>
</span></span><span style="display:flex;"><span>a1 = c(<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#ff0;font-weight:bold">5</span>,<span style="color:#ff0;font-weight:bold">8</span>,<span style="color:#ff0;font-weight:bold">11</span>)
</span></span><span style="display:flex;"><span>a2 = c(<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#ff0;font-weight:bold">5</span>,<span style="color:#ff0;font-weight:bold">7</span>,<span style="color:#ff0;font-weight:bold">6</span>,<span style="color:#ff0;font-weight:bold">15</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>library(DescTools)
</span></span><span style="display:flex;"><span>CCC(a1, a2)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># $rho.c</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># est    lwr.ci   upr.ci</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1 0.8550984 0.3990051 0.971993</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># $s.shift</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># [1] 1.230973</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># $l.shift</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># [1] 0.3060408</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># $C.b</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># [1] 0.9358917</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># $blalt</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># mean delta</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1  1.5    -1</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 2  2.5    -1</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 3  4.5    -1</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 4  6.0    -2</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 5  7.0     2</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 6 13.0    -4</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2) Kappa系数</span>
</span></span><span style="display:flex;"><span>library(vcd)
</span></span><span style="display:flex;"><span>library(vcd)
</span></span><span style="display:flex;"><span>mat = matrix(c(<span style="color:#ff0;font-weight:bold">10</span>, <span style="color:#ff0;font-weight:bold">2</span>, <span style="color:#ff0;font-weight:bold">1</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#ff0;font-weight:bold">2</span>, <span style="color:#ff0;font-weight:bold">3</span> ,<span style="color:#ff0;font-weight:bold">0</span>,
</span></span><span style="display:flex;"><span>               <span style="color:#ff0;font-weight:bold">0</span>, <span style="color:#ff0;font-weight:bold">1</span> ,<span style="color:#ff0;font-weight:bold">3</span>), 
</span></span><span style="display:flex;"><span>             byrow = <span style="color:#fff;font-weight:bold">T</span>, nrow = <span style="color:#ff0;font-weight:bold">3</span>)
</span></span><span style="display:flex;"><span>colnames(mat) = c(<span style="color:#0ff;font-weight:bold">&#34;A&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;B&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;C&#34;</span>)
</span></span><span style="display:flex;"><span>rownames(mat) = c(<span style="color:#0ff;font-weight:bold">&#34;A&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;B&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;C&#34;</span>)
</span></span><span style="display:flex;"><span>mat
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#    A B C</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># A 10 2 1</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># B  2 3 0</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># C  0 1 3</span>
</span></span><span style="display:flex;"><span>Kappa(mat)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#             value    ASE     z  Pr(&gt;|z|)</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Unweighted 0.5319 0.1611 3.301 0.0009629</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Weighted   0.5969 0.1554 3.841 0.0001224</span>
</span></span><span style="display:flex;"><span>Kappa(mat)$Weights
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#      [,1] [,2] [,3]</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># [1,]  1.0  0.5  0.0</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># [2,]  0.5  1.0  0.5</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># [3,]  0.0  0.5  1.0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(3)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>$$
AC1 = \frac{p-e(\gamma)}{1-e(\gamma)}
$$</p>
<p>$$
p = \frac{a_1 + a_5 + a_9}{\sum_{i=1}^{9}a_i}
$$</p>
<p>$$
e(\gamma) = 2q(1-q), \quad q=\frac{(a_1 + a_2 + a_3)+(a_1+a_4+a_9)}{2\sum_{i=1}^{9}a_i}
$$</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://lishensuo.github.io/en/tags/%E7%BB%9F%E8%AE%A1%E5%9F%BA%E7%A1%80/">统计基础</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://lishensuo.github.io/en/posts/program/003python%E5%9F%BA%E7%A1%80-3%E6%9D%A1%E4%BB%B6%E4%B8%8E%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5/">
    <span class="title">« Prev Page</span>
    <br>
    <span>Python基础-(3)条件与循环语句</span>
  </a>
  <a class="next" href="https://lishensuo.github.io/en/posts/bioinfo/004%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%A4%96%E7%BD%91%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93--%E5%A5%B6%E7%89%9B%E5%BF%AB%E4%BC%A0%E9%98%BF%E9%87%8C%E4%BA%91%E7%9B%98/">
    <span class="title">Next Page »</span>
    <br>
    <span>服务器外网文件传输--奶牛快传、阿里云盘</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2025 <a href="https://lishensuo.github.io/en/">Li&#39;s Bioinfo-Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
		<br/>您是本站第 <span id="busuanzi_value_site_uv"></span> 位访问者，总浏览量为 <span id="busuanzi_value_site_pv"></span> 次
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>

<script type="text/javascript"
async
src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
MathJax.Hub.Config({
tex2jax: {
inlineMath: [['$','$'], ['\\(','\\)']],
displayMath: [['$$','$$'], ['\[\[','\]\]']],
processEscapes: true,
processEnvironments: true,
skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
TeX: { equationNumbers: { autoNumber: "AMS" },
extensions: ["AMSmath.js", "AMSsymbols.js"] }
}
});

MathJax.Hub.Queue(function() {



var all = MathJax.Hub.getAllJax(), i;
for(i = 0; i < all.length; i += 1) {
all[i].SourceElement().parentNode.className += ' has-jax';
}
});
</script>

<style>
code.has-jax {
font: inherit;
font-size: 100%;
background: inherit;
border: inherit;
color: #515151;
}
</style></body>
</html>
