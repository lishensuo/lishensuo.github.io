<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">

<link rel="icon" href="/favicon.ico" type="image/x-icon"> 
<title>重启随机游走算法与RandomWalkRestartMH包 | Li&#39;s Bioinfo-Blog</title>
<meta name="keywords" content="R包-网络分析">
<meta name="description" content="1、关于RWR
1.1 算法简介


Random Walk with Restart，RWR重启随机游走算法


在给定的一个由节点和边组成的网络结构中（下面均已PPI蛋白相互作用网络为例），选择其中一个或者一组基因。我们想知道其余的哪些基因与我们先前所选择的一个或者一组基因最相关。此时可以用到RWR，简单原理如下：">
<meta name="author" content="Lishensuo">
<link rel="canonical" href="https://lishensuo.github.io/en/posts/bioinfo/201%E9%87%8D%E5%90%AF%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0%E7%AE%97%E6%B3%95%E4%B8%8Erandomwalkrestartmh%E5%8C%85/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.9e4de5e3ba61ea358168341aa7cdf70abfaafb7c697dfe8624af3ddff9a35c2f.css" integrity="sha256-nk3l47ph6jWBaDQap833Cr&#43;q&#43;3xpff6GJK893/mjXC8=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.555af97124d54bb1457985dd081b8f5616a48103aafeb30ac89fde835d65aa6c.js" integrity="sha256-VVr5cSTVS7FFeYXdCBuPVhakgQOq/rMKyJ/eg11lqmw="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://lishensuo.github.io/img/Q.gif">
<link rel="icon" type="image/png" sizes="16x16" href="https://lishensuo.github.io/img/Q.gif">
<link rel="icon" type="image/png" sizes="32x32" href="https://lishensuo.github.io/img/Q.gif">
<link rel="apple-touch-icon" href="https://lishensuo.github.io/Q.gif">
<link rel="mask-icon" href="https://lishensuo.github.io/Q.gif">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://lishensuo.github.io/en/posts/bioinfo/201%E9%87%8D%E5%90%AF%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0%E7%AE%97%E6%B3%95%E4%B8%8Erandomwalkrestartmh%E5%8C%85/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="重启随机游走算法与RandomWalkRestartMH包" />
<meta property="og:description" content="1、关于RWR
1.1 算法简介


Random Walk with Restart，RWR重启随机游走算法


在给定的一个由节点和边组成的网络结构中（下面均已PPI蛋白相互作用网络为例），选择其中一个或者一组基因。我们想知道其余的哪些基因与我们先前所选择的一个或者一组基因最相关。此时可以用到RWR，简单原理如下：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lishensuo.github.io/en/posts/bioinfo/201%E9%87%8D%E5%90%AF%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0%E7%AE%97%E6%B3%95%E4%B8%8Erandomwalkrestartmh%E5%8C%85/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-19T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2022-04-19T00:00:00&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="重启随机游走算法与RandomWalkRestartMH包"/>
<meta name="twitter:description" content="1、关于RWR
1.1 算法简介


Random Walk with Restart，RWR重启随机游走算法


在给定的一个由节点和边组成的网络结构中（下面均已PPI蛋白相互作用网络为例），选择其中一个或者一组基因。我们想知道其余的哪些基因与我们先前所选择的一个或者一组基因最相关。此时可以用到RWR，简单原理如下："/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "分类",
      "item": "https://lishensuo.github.io/en/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "📖 生信数据分析--分析流程，工具包等",
      "item": "https://lishensuo.github.io/en/posts/bioinfo/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "重启随机游走算法与RandomWalkRestartMH包",
      "item": "https://lishensuo.github.io/en/posts/bioinfo/201%E9%87%8D%E5%90%AF%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0%E7%AE%97%E6%B3%95%E4%B8%8Erandomwalkrestartmh%E5%8C%85/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "重启随机游走算法与RandomWalkRestartMH包",
  "name": "重启随机游走算法与RandomWalkRestartMH包",
  "description": "1、关于RWR 1.1 算法简介 Random Walk with Restart，RWR重启随机游走算法\n在给定的一个由节点和边组成的网络结构中（下面均已PPI蛋白相互作用网络为例），选择其中一个或者一组基因。我们想知道其余的哪些基因与我们先前所选择的一个或者一组基因最相关。此时可以用到RWR，简单原理如下：\n",
  "keywords": [
    "R包-网络分析"
  ],
  "articleBody": "1、关于RWR 1.1 算法简介 Random Walk with Restart，RWR重启随机游走算法\n在给定的一个由节点和边组成的网络结构中（下面均已PPI蛋白相互作用网络为例），选择其中一个或者一组基因。我们想知道其余的哪些基因与我们先前所选择的一个或者一组基因最相关。此时可以用到RWR，简单原理如下：\nRWR的公式如下。其中1-c表示重启概率，e表示起始节点，W表示网络邻接矩阵 $$ \\vec{r_i} = cW*\\vec{r_i} + (1-c) \\vec{e_i} $$\n如下例图所示，假设对于有12个蛋白互作关系组成PPI网络。我们想知道蛋白4与网络中其它蛋白的相关性排名如何。\n（1）选取蛋白4作为起始节点，随机向邻居节点走一步(蛋白1、3、5)。但是在每一次走向邻居节点时，都有一定概率返回到起始节点(蛋白4)。\n（2）假设走到了节点1，然后继续向邻居节点走一步(蛋白2,3)，也仍然有一定概率返回起始节点。\n（3）如此往复循环，最终从蛋白4走到网络其余每个蛋白的节点概率趋于收敛，作为与蛋白4的相关性度量指标。\n1.2 RandomWalkRestartMH包简介 RandomWalkRestartMH R包2018年最初发表，可用于多种复杂生物网中应用RWR算法，下面的笔记主要参考自官方文档。\n按照文档中的定义，有三种类型的网络–\nMonoplex Network：只有一种类型节点，一个类型边。例如常规的PPI网络：节点为蛋白，边为互作关系。 Heterogeneous Network：本质上是两个网络（例如PPI网路与疾病相似性网络），节点类型不相同（前者为蛋白，后者为疾病）。依靠两类节点的关系（某疾病与某蛋白功能异常密切相关）合并而成。 Multiplex Network：本质上也是两个网络，但节点类型相同。例如PPI网络与通路网络 1 2 3 4 5 6 7 #安装，建议从github安装 #BiocManager::install(\"RandomWalkRestartMH\") devtools::install_github(\"alberto-valdeolivas/RandomWalkRestartMH\") packageVersion(\"RandomWalkRestartMH\") # [1] ‘1.13.1’ #检查包的版本与官文示例文档的版本要一致 #该包要求为igraph定义的网络结构，也需要安装。 2、分析实例 2.1 Monoplex Network 在给定PPI网络中，寻找与指定基因（集）最相关的基因 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 library(RandomWalkRestartMH) library(igraph) ##(1) 加载数据：PPI网络的igraph对象 #使用RandomWalkRestartMH的示例数据，下同 data(PPI_Network) PPI_Network #包含4317个蛋白的18062条互作关系 # IGRAPH 3bec0a4 UN-- 4317 18062 -- # 这个PPI网络不包含互作强度 edge_attr(PPI_Network) # named list() ##(2) 创建Multiplex对象，计算出邻接矩阵 PPI_MultiplexObject \u003c- create.multiplex(list(PPI=PPI_Network)) PPI_MultiplexObject AdjMatrix_PPI \u003c- compute.adjacency.matrix(PPI_MultiplexObject) #稀疏矩阵，1表示对应行和列的蛋白存在互作 colSums(AdjMatrix_PPI[,1:4]) # A2M_1 AAGAB_1 AAMDC_1 AAMP_1 # 45 2 2 4 AdjMatrixNorm_PPI \u003c- normalize.multiplex.adjacency(AdjMatrix_PPI) #标准化，使蛋白到所有邻居蛋白的概率和=1 ##(3) 确定起始节点，应用RWR算法，计算相关节点分数 SeedGene \u003c- c(\"PIK3R1\") RWR_PPI_Results \u003c- Random.Walk.Restart.Multiplex(AdjMatrixNorm_PPI, PPI_MultiplexObject,SeedGene) # Top 10 ranked Nodes: # NodeNames Score # 1 GRB2 0.006845881 # 2 EGFR 0.006169129 # 3 CRK 0.005674261 # 4 ABL1 0.005617041 # 5 FYN 0.005611086 # 6 CDC42 0.005594680 # 7 SHC1 0.005577900 # 8 CRKL 0.005509182 # 9 KHDRBS1 0.005443541 # 10 TYRO3 0.005441887 # # Seed Nodes used: # [1] \"PIK3R1\" 有权重的Monoplex Network 基本步骤相同，只需要给igraph对象添加边的权重weight信息。 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 #STRING蛋白相互作用数据可使用STRINGdb包下载 #这里就参考文档，随机模拟 ##(1) library(RandomWalkRestartMH) library(igraph) data(PPI_Network) #随机模拟PPI互作强度，设置igraph edge的weight属性 PPI_Network \u003c- set_edge_attr(PPI_Network,\"weight\",E(PPI_Network), value = runif(ecount(PPI_Network))) edge_attr(PPI_Network) %\u003e% names() # weight ##(2) 创建Multiplex对象，计算出邻接矩阵 PPI_MultiplexObject \u003c- create.multiplex(list(PPI=PPI_Network)) PPI_MultiplexObject AdjMatrix_PPI \u003c- compute.adjacency.matrix(PPI_MultiplexObject) colSums(AdjMatrix_PPI[,1:4]) # A2M_1 AAGAB_1 AAMDC_1 AAMP_1 #22.4898374 0.4895032 1.4202684 1.2030568 AdjMatrixNorm_PPI \u003c- normalize.multiplex.adjacency(AdjMatrix_PPI) ##(3) 确定起始节点，应用RWR算法，计算相关节点分数 SeedGene \u003c- c(\"PIK3R1\") RWR_PPI_Results \u003c- Random.Walk.Restart.Multiplex(AdjMatrixNorm_PPI, PPI_MultiplexObject,SeedGene) # Top 10 ranked Nodes: # NodeNames Score # 1 EGFR 0.010790996 # 2 CRKL 0.010145105 # 3 GSPT1 0.009818236 # 4 AXL 0.009428844 # 5 NFKBIA 0.009418182 # 6 ITSN1 0.009385254 # 7 ZDHHC17 0.009369438 # 8 GAB2 0.009291153 # 9 CXCL2 0.009027423 # 10 STAT3 0.008956187 # # Seed Nodes used: # [1] \"PIK3R1\" 2.2 Heterogeneous Network 已知疾病SHORT综合征(OMIM的id为269880)的关键基因为PIK3R1。据此发现与之最相关的疾病、基因 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 library(RandomWalkRestartMH) library(igraph) ##(1) 构建两个网络 #构建PPI网络 data(PPI_Network) PPI_MultiplexObject \u003c- create.multiplex(list(PPI=PPI_Network)) #构建疾病相似度网络 data(Disease_Network) Disease_MultiplexObject \u003c- create.multiplex(list(Disease=Disease_Network)) ##(2) 疾病与蛋白的关系数据 data(GeneDiseaseRelations) head(GeneDiseaseRelations) # hgnc_symbol mim_morbid # 3 A2M 614036 # 4 A2M 104300 # 6 A4GALT 111400 # 根据两个网络，进一步筛选 GeneDiseaseRelations_PPI \u003c- GeneDiseaseRelations[which(GeneDiseaseRelations$hgnc_symbol %in% PPI_MultiplexObject$Pool_of_Nodes),] GeneDiseaseRelations_PPI \u003c- GeneDiseaseRelations_PPI[which(GeneDiseaseRelations_PPI$mim_morbid %in% Disease_MultiplexObject$Pool_of_Nodes),] dim(GeneDiseaseRelations_PPI) # [1] 1330 2 ##(3) 创建Multiplex对象，计算出邻接矩阵 PPI_Disease_Net \u003c- create.multiplexHet(PPI_MultiplexObject, Disease_MultiplexObject, GeneDiseaseRelations_PPI) PPI_Disease_Net PPIHetTranMatrix \u003c- compute.transition.matrix(PPI_Disease_Net) dim(PPIHetTranMatrix) # [1] 11264 11264 ##(4) 每一层确定一个起始节点，应用RWR算法，计算相关节点分数 SeedGene \u003c- c(\"PIK3R1\") SeedDisease \u003c- c(\"269880\") RWRH_PPI_Disease_Results \u003c- Random.Walk.Restart.MultiplexHet(PPIHetTranMatrix, PPI_Disease_Net, Multiplex1_Seeds = SeedGene, Multiplex2_Seeds = SeedDisease) # RWRH_PPI_Disease_Results # Top 10 ranked global nodes: # NodeNames Score # 1 PIK3R1 0.414259752 # 2 269880 0.372567325 # 3 615214 0.020817435 # 4 616005 0.020785895 # 5 194050 0.005868407 # 6 309000 0.005687206 # 7 262500 0.005681162 # 8 138920 0.005655559 # 9 223370 0.005655117 # 10 608612 0.005649291 # # Top 10 ranked nodes from the first Multiplex: # NodeNames Score # 1479 GRB2 0.001965500 # 1081 EGFR 0.001754048 # 797 CRK 0.001636329 # 603 CDC42 0.001630575 # 19 ABL1 0.001623304 # 798 CRKL 0.001605543 # 1360 FYN 0.001598567 # 3405 SHC1 0.001597720 # 2583 PDGFRB 0.001596830 # 4027 TYRO3 0.001589911 # # Top 10 ranked nodes from the second Multiplex: # NodeNames Score # 6352 615214 0.020817435 # 6705 616005 0.020785895 # 1699 194050 0.005868407 # 3625 309000 0.005687206 # 2901 262500 0.005681162 # 686 138920 0.005655559 # 2150 223370 0.005655117 # 4770 608612 0.005649291 # 4464 606176 0.005641777 # 1411 180500 0.005639919 # # Seeds used: # [1] \"PIK3R1\" \"269880\" ",
  "wordCount" : "1887",
  "inLanguage": "en",
  "datePublished": "2022-04-19T00:00:00Z",
  "dateModified": "2022-04-19T00:00:00Z",
  "author":[{
    "@type": "Person",
    "name": "Lishensuo"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://lishensuo.github.io/en/posts/bioinfo/201%E9%87%8D%E5%90%AF%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0%E7%AE%97%E6%B3%95%E4%B8%8Erandomwalkrestartmh%E5%8C%85/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Li's Bioinfo-Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://lishensuo.github.io/img/Q.gif"
    }
  }
}
</script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://lishensuo.github.io/en/" accesskey="h" title="Li&#39;s Bioinfo-Blog (Alt + H)">Li&#39;s Bioinfo-Blog</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                </ul>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://lishensuo.github.io/en/" title="主页">
                    <span>主页</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/posts" title="分类">
                    <span>分类</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/tags" title="标签">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/archives/" title="归档">
                    <span>归档</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/about" title="关于">
                    <span>关于</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/search" title="搜索 (Alt &#43; /)" accesskey=/>
                    <span>搜索</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://lishensuo.github.io/en/">Home</a>&nbsp;»&nbsp;<a href="https://lishensuo.github.io/en/posts/">分类</a>&nbsp;»&nbsp;<a href="https://lishensuo.github.io/en/posts/bioinfo/">📖 生信数据分析--分析流程，工具包等</a></div>
    <h1 class="post-title">
      重启随机游走算法与RandomWalkRestartMH包
    </h1>
    <div class="post-meta">













Create:&amp;nbsp;&lt;span title=&#39;2022-04-19 00:00:00 &#43;0000 UTC&#39;&gt;2022-04-19&lt;/span&gt;&amp;nbsp;|&amp;nbsp;Update:&amp;nbsp;2022-04-19&amp;nbsp;|&amp;nbsp;Words:&amp;nbsp;1887&amp;nbsp;|&amp;nbsp;4 min&amp;nbsp;|&amp;nbsp;Lishensuo

|  Viewers: <span id="busuanzi_value_page_pv"></span> 
	  
    </div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">Table of Contents</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#1%e5%85%b3%e4%ba%8erwr" aria-label="1、关于RWR">1、关于RWR</a><ul>
                            
                    <li>
                        <a href="#11-%e7%ae%97%e6%b3%95%e7%ae%80%e4%bb%8b" aria-label="1.1 算法简介">1.1 算法简介</a></li>
                    <li>
                        <a href="#12-randomwalkrestartmh%e5%8c%85%e7%ae%80%e4%bb%8b" aria-label="1.2 RandomWalkRestartMH包简介">1.2 RandomWalkRestartMH包简介</a></li></ul>
                    </li>
                    <li>
                        <a href="#2%e5%88%86%e6%9e%90%e5%ae%9e%e4%be%8b" aria-label="2、分析实例">2、分析实例</a><ul>
                            
                    <li>
                        <a href="#21-monoplex-network" aria-label="2.1 Monoplex Network">2.1 Monoplex Network</a><ul>
                            <ul>
                            
                    <li>
                        <a href="#%e6%9c%89%e6%9d%83%e9%87%8d%e7%9a%84monoplex-network" aria-label="有权重的Monoplex Network">有权重的Monoplex Network</a></li></ul>
                        </ul>
                    </li>
                    <li>
                        <a href="#22-heterogeneous-network" aria-label="2.2 Heterogeneous Network">2.2 Heterogeneous Network</a>
                    </li>
                </ul>
                </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>


  <div class="post-content"><h2 id="1关于rwr">1、关于RWR<a hidden class="anchor" aria-hidden="true" href="#1关于rwr">#</a></h2>
<h3 id="11-算法简介">1.1 算法简介<a hidden class="anchor" aria-hidden="true" href="#11-算法简介">#</a></h3>
<ul>
<li>
<p>Random Walk with Restart，RWR重启随机游走算法</p>
</li>
<li>
<p>在给定的一个由节点和边组成的网络结构中（下面均已PPI蛋白相互作用网络为例），选择其中一个或者一组基因。我们想知道其余的哪些基因与我们先前所选择的一个或者一组基因最相关。此时可以用到RWR，简单原理如下：</p>
</li>
<li>
<p>RWR的公式如下。其中<code>1-c</code>表示重启概率，<code>e</code>表示起始节点，<code>W</code>表示网络邻接矩阵
$$
\vec{r_i} = cW*\vec{r_i}  + (1-c) \vec{e_i}
$$</p>
</li>
<li>
<p>如下<a href="https://slideplayer.com/slide/5223771/">例图</a>所示，假设对于有12个蛋白互作关系组成PPI网络。我们想知道蛋白4与网络中其它蛋白的<strong>相关性</strong>排名如何。</p>
<p>（1）选取蛋白4作为起始节点，随机向邻居节点走一步(蛋白1、3、5)。但是在每一次走向邻居节点时，都有一定概率返回到起始节点(蛋白4)。</p>
<p>（2）假设走到了节点1，然后继续向邻居节点走一步(蛋白2,3)，也仍然有一定概率返回起始节点。</p>
<p>（3）如此往复循环，最终从蛋白4走到网络其余每个蛋白的节点概率趋于收敛，作为与蛋白4的相关性度量指标。</p>
</li>
</ul>
<img src="https://raw.githubusercontent.com/lishensuo/images/main/image-20220419150519659.png" alt="image-20220419150519659" style="zoom:67%;" />
<h3 id="12-randomwalkrestartmh包简介">1.2 RandomWalkRestartMH包简介<a hidden class="anchor" aria-hidden="true" href="#12-randomwalkrestartmh包简介">#</a></h3>
<p>RandomWalkRestartMH  R包2018年最初<a href="https://doi.org/10.1093/bioinformatics/bty637">发表</a>，可用于多种复杂生物网中应用RWR算法，下面的笔记主要参考自<a href="https://alberto-valdeolivas.github.io/RandomWalkRestartMH/articles/RandomWalkRestartMH.html">官方文档</a>。</p>
<p>按照文档中的定义，有三种类型的网络&ndash;</p>
<ul>
<li>Monoplex Network：只有一种类型节点，一个类型边。例如常规的PPI网络：节点为蛋白，边为互作关系。</li>
<li>Heterogeneous Network：本质上是两个网络（例如PPI网路与疾病相似性网络），节点类型不相同（前者为蛋白，后者为疾病）。依靠两类节点的关系（某疾病与某蛋白功能异常密切相关）合并而成。</li>
</ul>
<img src="https://www.researchgate.net/profile/Le-Duc-Hau/publication/317829506/figure/fig1/AS:514820518940672@1499754184890/An-illustrative-heterogeneous-network-of-genes-and-diseases-A-phenotypic-disease.png" alt="An illustrative heterogeneous network of genes and diseases. A... |  Download Scientific Diagram" style="zoom:33%;" />
<ul>
<li>Multiplex Network：本质上也是两个网络，但节点类型相同。例如PPI网络与通路网络</li>
</ul>
<img src="https://www.researchgate.net/profile/Alex-Arenas/publication/235403833/figure/fig2/AS:287789280186386@1445625719366/Example-of-a-multiplex-network-with-M2-layers-Nodes-are-the-same-in-both-layers-The.png" alt="Example of a multiplex network with M=2 layers. Nodes are the same in... |  Download Scientific Diagram" style="zoom: 33%;" />
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span><span style="color:#007f7f">#安装，建议从github安装</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#BiocManager::install(&#34;RandomWalkRestartMH&#34;)</span>
</span></span><span style="display:flex;"><span>devtools::install_github(<span style="color:#0ff;font-weight:bold">&#34;alberto-valdeolivas/RandomWalkRestartMH&#34;</span>)
</span></span><span style="display:flex;"><span>packageVersion(<span style="color:#0ff;font-weight:bold">&#34;RandomWalkRestartMH&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># [1] ‘1.13.1’</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#检查包的版本与官文示例文档的版本要一致</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#该包要求为igraph定义的网络结构，也需要安装。</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="2分析实例">2、分析实例<a hidden class="anchor" aria-hidden="true" href="#2分析实例">#</a></h2>
<h3 id="21-monoplex-network">2.1 Monoplex Network<a hidden class="anchor" aria-hidden="true" href="#21-monoplex-network">#</a></h3>
<ul>
<li>在给定PPI网络中，寻找与指定基因（集）最相关的基因</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>library(RandomWalkRestartMH)
</span></span><span style="display:flex;"><span>library(igraph)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(1) 加载数据：PPI网络的igraph对象</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#使用RandomWalkRestartMH的示例数据，下同</span>
</span></span><span style="display:flex;"><span>data(PPI_Network) 
</span></span><span style="display:flex;"><span>PPI_Network <span style="color:#007f7f">#包含4317个蛋白的18062条互作关系</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># IGRAPH 3bec0a4 UN-- 4317 18062 -- </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 这个PPI网络不包含互作强度</span>
</span></span><span style="display:flex;"><span>edge_attr(PPI_Network) 
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># named list()</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2) 创建Multiplex对象，计算出邻接矩阵</span>
</span></span><span style="display:flex;"><span>PPI_MultiplexObject &lt;- create.multiplex(list(PPI=PPI_Network))
</span></span><span style="display:flex;"><span>PPI_MultiplexObject
</span></span><span style="display:flex;"><span>AdjMatrix_PPI &lt;- compute.adjacency.matrix(PPI_MultiplexObject) <span style="color:#007f7f">#稀疏矩阵，1表示对应行和列的蛋白存在互作</span>
</span></span><span style="display:flex;"><span>colSums(AdjMatrix_PPI[,<span style="color:#ff0;font-weight:bold">1</span>:<span style="color:#ff0;font-weight:bold">4</span>]) 
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   A2M_1 AAGAB_1 AAMDC_1  AAMP_1 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#     45       2       2       4</span>
</span></span><span style="display:flex;"><span>AdjMatrixNorm_PPI &lt;- normalize.multiplex.adjacency(AdjMatrix_PPI) <span style="color:#007f7f">#标准化，使蛋白到所有邻居蛋白的概率和=1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(3) 确定起始节点，应用RWR算法，计算相关节点分数</span>
</span></span><span style="display:flex;"><span>SeedGene &lt;- c(<span style="color:#0ff;font-weight:bold">&#34;PIK3R1&#34;</span>)
</span></span><span style="display:flex;"><span>RWR_PPI_Results &lt;- Random.Walk.Restart.Multiplex(AdjMatrixNorm_PPI,
</span></span><span style="display:flex;"><span>                                                 PPI_MultiplexObject,SeedGene)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Top 10 ranked Nodes:</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   NodeNames       Score</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1       GRB2 0.006845881</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 2       EGFR 0.006169129</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 3        CRK 0.005674261</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 4       ABL1 0.005617041</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 5        FYN 0.005611086</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 6      CDC42 0.005594680</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 7       SHC1 0.005577900</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 8       CRKL 0.005509182</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 9    KHDRBS1 0.005443541</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 10     TYRO3 0.005441887</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Seed Nodes used:</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   [1] &#34;PIK3R1&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="有权重的monoplex-network">有权重的Monoplex Network<a hidden class="anchor" aria-hidden="true" href="#有权重的monoplex-network">#</a></h5>
<ul>
<li>基本步骤相同，只需要给igraph对象添加边的权重weight信息。</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span><span style="color:#007f7f">#STRING蛋白相互作用数据可使用STRINGdb包下载</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#这里就参考文档，随机模拟</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(1)</span>
</span></span><span style="display:flex;"><span>library(RandomWalkRestartMH)
</span></span><span style="display:flex;"><span>library(igraph)
</span></span><span style="display:flex;"><span>data(PPI_Network) 
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#随机模拟PPI互作强度，设置igraph edge的weight属性</span>
</span></span><span style="display:flex;"><span>PPI_Network &lt;- set_edge_attr(PPI_Network,<span style="color:#0ff;font-weight:bold">&#34;weight&#34;</span>,E(PPI_Network), 
</span></span><span style="display:flex;"><span>                             value = runif(ecount(PPI_Network)))
</span></span><span style="display:flex;"><span>edge_attr(PPI_Network) %&gt;% names()
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># weight</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2) 创建Multiplex对象，计算出邻接矩阵</span>
</span></span><span style="display:flex;"><span>PPI_MultiplexObject &lt;- create.multiplex(list(PPI=PPI_Network))
</span></span><span style="display:flex;"><span>PPI_MultiplexObject
</span></span><span style="display:flex;"><span>AdjMatrix_PPI &lt;- compute.adjacency.matrix(PPI_MultiplexObject)
</span></span><span style="display:flex;"><span>colSums(AdjMatrix_PPI[,<span style="color:#ff0;font-weight:bold">1</span>:<span style="color:#ff0;font-weight:bold">4</span>]) 
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#     A2M_1    AAGAB_1    AAMDC_1     AAMP_1 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#22.4898374  0.4895032  1.4202684  1.2030568</span>
</span></span><span style="display:flex;"><span>AdjMatrixNorm_PPI &lt;- normalize.multiplex.adjacency(AdjMatrix_PPI)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(3) 确定起始节点，应用RWR算法，计算相关节点分数</span>
</span></span><span style="display:flex;"><span>SeedGene &lt;- c(<span style="color:#0ff;font-weight:bold">&#34;PIK3R1&#34;</span>)
</span></span><span style="display:flex;"><span>RWR_PPI_Results &lt;- Random.Walk.Restart.Multiplex(AdjMatrixNorm_PPI,
</span></span><span style="display:flex;"><span>                                                 PPI_MultiplexObject,SeedGene)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Top 10 ranked Nodes:</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   NodeNames       Score</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1       EGFR 0.010790996</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 2       CRKL 0.010145105</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 3      GSPT1 0.009818236</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 4        AXL 0.009428844</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 5     NFKBIA 0.009418182</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 6      ITSN1 0.009385254</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 7    ZDHHC17 0.009369438</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 8       GAB2 0.009291153</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 9      CXCL2 0.009027423</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 10     STAT3 0.008956187</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Seed Nodes used:</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   [1] &#34;PIK3R1&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="22-heterogeneous-network">2.2 Heterogeneous Network<a hidden class="anchor" aria-hidden="true" href="#22-heterogeneous-network">#</a></h3>
<ul>
<li>已知疾病SHORT综合征(OMIM的id为269880)的关键基因为PIK3R1。据此发现与之最相关的疾病、基因</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">86
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>library(RandomWalkRestartMH)
</span></span><span style="display:flex;"><span>library(igraph)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(1) 构建两个网络</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#构建PPI网络</span>
</span></span><span style="display:flex;"><span>data(PPI_Network) 
</span></span><span style="display:flex;"><span>PPI_MultiplexObject &lt;- create.multiplex(list(PPI=PPI_Network))
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#构建疾病相似度网络</span>
</span></span><span style="display:flex;"><span>data(Disease_Network) 
</span></span><span style="display:flex;"><span>Disease_MultiplexObject &lt;- create.multiplex(list(Disease=Disease_Network))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2) 疾病与蛋白的关系数据</span>
</span></span><span style="display:flex;"><span>data(GeneDiseaseRelations)
</span></span><span style="display:flex;"><span>head(GeneDiseaseRelations)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#    hgnc_symbol mim_morbid</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 3          A2M     614036</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 4          A2M     104300</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 6       A4GALT     111400</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 根据两个网络，进一步筛选</span>
</span></span><span style="display:flex;"><span>GeneDiseaseRelations_PPI &lt;-
</span></span><span style="display:flex;"><span>  GeneDiseaseRelations[which(GeneDiseaseRelations$hgnc_symbol %in%
</span></span><span style="display:flex;"><span>                               PPI_MultiplexObject$Pool_of_Nodes),]
</span></span><span style="display:flex;"><span>GeneDiseaseRelations_PPI &lt;-
</span></span><span style="display:flex;"><span>  GeneDiseaseRelations_PPI[which(GeneDiseaseRelations_PPI$mim_morbid %in%
</span></span><span style="display:flex;"><span>                               Disease_MultiplexObject$Pool_of_Nodes),]
</span></span><span style="display:flex;"><span>dim(GeneDiseaseRelations_PPI)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># [1] 1330    2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(3) 创建Multiplex对象，计算出邻接矩阵</span>
</span></span><span style="display:flex;"><span>PPI_Disease_Net &lt;- create.multiplexHet(PPI_MultiplexObject,
</span></span><span style="display:flex;"><span>                                       Disease_MultiplexObject, 
</span></span><span style="display:flex;"><span>                                       GeneDiseaseRelations_PPI)
</span></span><span style="display:flex;"><span>PPI_Disease_Net
</span></span><span style="display:flex;"><span>PPIHetTranMatrix &lt;- compute.transition.matrix(PPI_Disease_Net)
</span></span><span style="display:flex;"><span>dim(PPIHetTranMatrix)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># [1] 11264 11264</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(4) 每一层确定一个起始节点，应用RWR算法，计算相关节点分数</span>
</span></span><span style="display:flex;"><span>SeedGene &lt;- c(<span style="color:#0ff;font-weight:bold">&#34;PIK3R1&#34;</span>)
</span></span><span style="display:flex;"><span>SeedDisease &lt;- c(<span style="color:#0ff;font-weight:bold">&#34;269880&#34;</span>)
</span></span><span style="display:flex;"><span>RWRH_PPI_Disease_Results &lt;-
</span></span><span style="display:flex;"><span>  Random.Walk.Restart.MultiplexHet(PPIHetTranMatrix,
</span></span><span style="display:flex;"><span>                                   PPI_Disease_Net,
</span></span><span style="display:flex;"><span>                                   Multiplex1_Seeds = SeedGene,
</span></span><span style="display:flex;"><span>                                   Multiplex2_Seeds = SeedDisease)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># RWRH_PPI_Disease_Results</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Top 10 ranked global nodes:</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   NodeNames       Score</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1     PIK3R1 0.414259752</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 2     269880 0.372567325</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 3     615214 0.020817435</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 4     616005 0.020785895</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 5     194050 0.005868407</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 6     309000 0.005687206</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 7     262500 0.005681162</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 8     138920 0.005655559</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 9     223370 0.005655117</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 10    608612 0.005649291</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Top 10 ranked nodes from the first Multiplex:</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   NodeNames       Score</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1479      GRB2 0.001965500</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1081      EGFR 0.001754048</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 797        CRK 0.001636329</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 603      CDC42 0.001630575</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 19        ABL1 0.001623304</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 798       CRKL 0.001605543</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1360       FYN 0.001598567</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 3405      SHC1 0.001597720</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 2583    PDGFRB 0.001596830</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 4027     TYRO3 0.001589911</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Top 10 ranked nodes from the second Multiplex:</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   NodeNames       Score</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 6352    615214 0.020817435</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 6705    616005 0.020785895</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1699    194050 0.005868407</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 3625    309000 0.005687206</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 2901    262500 0.005681162</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 686     138920 0.005655559</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 2150    223370 0.005655117</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 4770    608612 0.005649291</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 4464    606176 0.005641777</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1411    180500 0.005639919</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Seeds used:</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   [1] &#34;PIK3R1&#34; &#34;269880&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://lishensuo.github.io/en/tags/r%E5%8C%85-%E7%BD%91%E7%BB%9C%E5%88%86%E6%9E%90/">R包-网络分析</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://lishensuo.github.io/en/posts/program/201r%E8%AF%AD%E8%A8%80%E7%9A%84%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5/">
    <span class="title">« Prev Page</span>
    <br>
    <span>R语言的多线程循环语句</span>
  </a>
  <a class="next" href="https://lishensuo.github.io/en/posts/bioinfo/202gene2vec%E7%AE%97%E6%B3%95%E6%A0%B9%E6%8D%AE%E5%9F%BA%E5%9B%A0%E5%AF%B9%E8%AE%A1%E7%AE%97%E5%9F%BA%E5%9B%A0%E8%A1%A8%E7%A4%BA/">
    <span class="title">Next Page »</span>
    <br>
    <span>Gene2vec算法根据基因对计算基因表示</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2025 <a href="https://lishensuo.github.io/en/">Li&#39;s Bioinfo-Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
		<br/>您是本站第 <span id="busuanzi_value_site_uv"></span> 位访问者，总浏览量为 <span id="busuanzi_value_site_pv"></span> 次
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>

<script type="text/javascript"
async
src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
MathJax.Hub.Config({
tex2jax: {
inlineMath: [['$','$'], ['\\(','\\)']],
displayMath: [['$$','$$'], ['\[\[','\]\]']],
processEscapes: true,
processEnvironments: true,
skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
TeX: { equationNumbers: { autoNumber: "AMS" },
extensions: ["AMSmath.js", "AMSsymbols.js"] }
}
});

MathJax.Hub.Queue(function() {



var all = MathJax.Hub.getAllJax(), i;
for(i = 0; i < all.length; i += 1) {
all[i].SourceElement().parentNode.className += ' has-jax';
}
});
</script>

<style>
code.has-jax {
font: inherit;
font-size: 100%;
background: inherit;
border: inherit;
color: #515151;
}
</style></body>
</html>
