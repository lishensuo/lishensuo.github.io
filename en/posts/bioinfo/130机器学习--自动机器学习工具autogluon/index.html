<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">

<link rel="icon" href="/favicon.ico" type="image/x-icon"> 
<title>机器学习--自动机器学习工具autogluon | Li&#39;s Bioinfo-Blog</title>
<meta name="keywords" content="机器学习">
<meta name="description" content="
最先在李沐大神在B站的分享中了解到autogluon，它是一个自动机器学习工具，可用于文本图片识别、表格任务等。据说效果非常不错&ndash;号称3行代码打败99%的机器学习模型，甚至说标志着手动调参的时代已经结束。">
<meta name="author" content="Lishensuo">
<link rel="canonical" href="https://lishensuo.github.io/en/posts/bioinfo/130%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0--%E8%87%AA%E5%8A%A8%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%B7%A5%E5%85%B7autogluon/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.9e4de5e3ba61ea358168341aa7cdf70abfaafb7c697dfe8624af3ddff9a35c2f.css" integrity="sha256-nk3l47ph6jWBaDQap833Cr&#43;q&#43;3xpff6GJK893/mjXC8=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.555af97124d54bb1457985dd081b8f5616a48103aafeb30ac89fde835d65aa6c.js" integrity="sha256-VVr5cSTVS7FFeYXdCBuPVhakgQOq/rMKyJ/eg11lqmw="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://lishensuo.github.io/img/Q.gif">
<link rel="icon" type="image/png" sizes="16x16" href="https://lishensuo.github.io/img/Q.gif">
<link rel="icon" type="image/png" sizes="32x32" href="https://lishensuo.github.io/img/Q.gif">
<link rel="apple-touch-icon" href="https://lishensuo.github.io/Q.gif">
<link rel="mask-icon" href="https://lishensuo.github.io/Q.gif">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://lishensuo.github.io/en/posts/bioinfo/130%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0--%E8%87%AA%E5%8A%A8%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%B7%A5%E5%85%B7autogluon/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="机器学习--自动机器学习工具autogluon" />
<meta property="og:description" content="
最先在李沐大神在B站的分享中了解到autogluon，它是一个自动机器学习工具，可用于文本图片识别、表格任务等。据说效果非常不错&ndash;号称3行代码打败99%的机器学习模型，甚至说标志着手动调参的时代已经结束。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lishensuo.github.io/en/posts/bioinfo/130%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0--%E8%87%AA%E5%8A%A8%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%B7%A5%E5%85%B7autogluon/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-17T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2022-09-17T00:00:00&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="机器学习--自动机器学习工具autogluon"/>
<meta name="twitter:description" content="
最先在李沐大神在B站的分享中了解到autogluon，它是一个自动机器学习工具，可用于文本图片识别、表格任务等。据说效果非常不错&ndash;号称3行代码打败99%的机器学习模型，甚至说标志着手动调参的时代已经结束。"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "分类",
      "item": "https://lishensuo.github.io/en/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "📖 生信数据分析--分析流程，工具包等",
      "item": "https://lishensuo.github.io/en/posts/bioinfo/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "机器学习--自动机器学习工具autogluon",
      "item": "https://lishensuo.github.io/en/posts/bioinfo/130%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0--%E8%87%AA%E5%8A%A8%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%B7%A5%E5%85%B7autogluon/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "机器学习--自动机器学习工具autogluon",
  "name": "机器学习--自动机器学习工具autogluon",
  "description": " 最先在李沐大神在B站的分享中了解到autogluon，它是一个自动机器学习工具，可用于文本图片识别、表格任务等。据说效果非常不错\u0026ndash;号称3行代码打败99%的机器学习模型，甚至说标志着手动调参的时代已经结束。\n",
  "keywords": [
    "机器学习"
  ],
  "articleBody": " 最先在李沐大神在B站的分享中了解到autogluon，它是一个自动机器学习工具，可用于文本图片识别、表格任务等。据说效果非常不错–号称3行代码打败99%的机器学习模型，甚至说标志着手动调参的时代已经结束。\n关于它的原理暂且不深入了解了，简单记录下在传统表格任务上的用法，可以作为对数据的初步探索。\n安装方式：https://auto.gluon.ai/stable/index.html 官方教程：https://auto.gluon.ai/stable/tutorials/tabular_prediction/tabular-quickstart.html 1 from autogluon.tabular import TabularDataset, TabularPredictor 1、准备数据 （1）(多列)特征与(1列)target合并在一个表格中，转为autogluon的TabularDataset对象；\n（2）每行代表一个样本，须分为训练集与测试集。\n1 2 3 4 5 6 7 8 9 10 11 12 13 ## (1) 方式1： 从csv文件读取 train_data = TabularDataset('https://autogluon.s3.amazonaws.com/datasets/Inc/train.csv') subsample_size = 500 # 仅为演示、节省时间 train_data = train_data.sample(n=subsample_size, random_state=0) test_data = TabularDataset('https://autogluon.s3.amazonaws.com/datasets/Inc/test.csv') type(train_data) # autogluon.core.dataset.TabularDataset ## (2) 方式2：可由pd.Dataframe对象转换 import pandas as pd train_df = pd.read_csv(\"https://autogluon.s3.amazonaws.com/datasets/Inc/train.csv\") train_data = TabularDataset(train_df) 2、模型训练 （1）autogluon可自动根据target列的内容决定是回归还是分类任务；\n（2）对于特征列数据，autogluon可自动完成缺失值处理、数据标准化等，无需手动清洗数据。\n2.1 基础流程 （1）训练模型 1 2 3 4 5 6 7 8 #指定target列 label = 'class' #指定模型保存位置 save_path = 'tmp' #开始训练 predictor = TabularPredictor(label=label, path=save_path).fit(train_data) # predictor = TabularPredictor.load(save_path) 加载模型 （2）查看训练结果相关信息 1 2 3 4 5 predictor.problem_type #训练任务类型 print(predictor.feature_metadata) #所判断的特征列数据类型 #不同类型模型的训练结果验证集指标排名 predictor.fit_summary() （3）测试集预测 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # 不同模型在测试集的指标排名 predictor.leaderboard(test_data, silent=True) # 最优模型在测试集的多种结果指标 predictor.evaluate(test_data) ##等价于如下步骤 y_test = test_data[label] #真实值 test_data_nolab = test_data.drop(columns=[label]) test_data_nolab.head() y_pred = predictor.predict(test_data_nolab) #预测值 predictor.evaluate_predictions(y_true=y_test, y_pred=y_pred, auxiliary_metrics=True) predictor.predict_proba(test_data_nolab) #预测概率 # 使用指定模型预测 predictor.predict(test_data, model='LightGBM') 2.2 多种指标 autogluon对于分类任务，默认使用accuracy指标；对于回归任务，默认使用RMSE指标\n其它可选指标包括\n（1）分类：\n1 2 3 ['accuracy', 'balanced_accuracy', 'f1', 'f1_macro', 'f1_micro', 'f1_weighted', 'roc_auc', 'roc_auc_ovo_macro', 'average_precision', 'precision', 'precision_macro', 'precision_micro', 'precision_weighted', 'recall', 'recall_macro', 'recall_micro', 'recall_weighted', 'log_loss', 'pac_score'] （2）回归\n1 2 ['root_mean_squared_error', 'mean_squared_error', 'mean_absolute_error', 'median_absolute_error', 'mean_absolute_percentage_error', 'r2'] 如需更多评价指标可参考https://auto.gluon.ai/stable/tutorials/tabular_prediction/tabular-custom-metric.html#sec-tabularcustommetric\n用于训练时的模型优化：选择一个指标，用于模型优化以及比较 1 2 3 metric = 'roc_auc' predictor = TabularPredictor(label=label, path=save_path, eval_metric=metric).fit(train_data) predictor.fit_summary() 用于训练后的模型不同角度的性能比较：可选择多个指标 1 2 metrics = ['roc_auc', \"f1\", \"recall\", \"recall\"] predictor.leaderboard(test_data, extra_metrics = metrics, silent=True) 2.3 不同模式 主要针对 TabularPredictor().fit(train_data, presets=)的presets参数\n默认为\"medium_quality\"，其余依次为\"good_quality\", “high_quality”, “best_quality”\n从左到右，代表了训练时间/成本与训练结果性能之间的取舍。\n官方教程建议先按默认的medium_quality训练，对模型有初步的了解后，在尝试best_quality\n此外fit()函数还包括一个time_limit=参数，单位为秒，直接指定训练的时长。如不指定默认训练完全部可能的模型。\n报错记录 1、在best_quality/high_quality训练模式下会可能会出现如下报错： 1 2 3 4 5 6 7 8 9 10 11 12 13 OpenBLAS : Program is Terminated. Because you tried to allocate too many memory regions. This library was built to support a maximum of 128 threads - either rebuild OpenBLAS with a larger NUM_THREADS value or set the environment variable OPENBLAS_NUM_THREADS to a sufficiently small number. This error typically occurs when the software that relies on OpenBLAS calls BLAS functions from many threads in parallel, or when your computer has more cpu cores than what OpenBLAS was configured to handle. OpenBLAS : Program is Terminated. Because you tried to allocate too many memory regions. This library was built to support a maximum of 128 threadPC: @ 0x7ff3b109952c (unknown) dgemm_incopy_SKYLAKEX @ 0x7ff3b95f0630 (unknown) (unknown) [2023-05-27 15:40:36,365 E 90917 106900] logging.cc:361: *** SIGSEGV received at time=1685173236 on cpu 136 *** [2023-05-27 15:40:36,366 E 90917 106900] logging.cc:361: PC: @ 0x7ff3b109952c (unknown) dgemm_incopy_SKYLAKEX [2023-05-27 15:40:36,366 E 90917 106900] logging.cc:361: @ 0x7ff3b95f0630 (unknown) (unknown) Fatal Python error: Segmentation fault 解决方案参考：https://github.com/autogluon/autogluon/issues/1020 主要原因是KNN模型训练时调用了过多线程，导致超过OpenBLAS所支持的上限。\n因此可限制KNN使用的线程数（默认调用机器的全部线程），或者干脆使用KNN模型\n1 predictor = TabularPredictor(label=\"label\").fit(zuhe_train_Tab,presets=\"high_quality\",excluded_model_types = ['KNN']) ",
  "wordCount" : "1667",
  "inLanguage": "en",
  "datePublished": "2022-09-17T00:00:00Z",
  "dateModified": "2022-09-17T00:00:00Z",
  "author":[{
    "@type": "Person",
    "name": "Lishensuo"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://lishensuo.github.io/en/posts/bioinfo/130%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0--%E8%87%AA%E5%8A%A8%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%B7%A5%E5%85%B7autogluon/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Li's Bioinfo-Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://lishensuo.github.io/img/Q.gif"
    }
  }
}
</script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://lishensuo.github.io/en/" accesskey="h" title="Li&#39;s Bioinfo-Blog (Alt + H)">Li&#39;s Bioinfo-Blog</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                </ul>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://lishensuo.github.io/en/" title="主页">
                    <span>主页</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/posts" title="分类">
                    <span>分类</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/tags" title="标签">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/archives/" title="归档">
                    <span>归档</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/about" title="关于">
                    <span>关于</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/search" title="搜索 (Alt &#43; /)" accesskey=/>
                    <span>搜索</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://lishensuo.github.io/en/">Home</a>&nbsp;»&nbsp;<a href="https://lishensuo.github.io/en/posts/">分类</a>&nbsp;»&nbsp;<a href="https://lishensuo.github.io/en/posts/bioinfo/">📖 生信数据分析--分析流程，工具包等</a></div>
    <h1 class="post-title">
      机器学习--自动机器学习工具autogluon
    </h1>
    <div class="post-meta">













Create:&amp;nbsp;&lt;span title=&#39;2022-09-17 00:00:00 &#43;0000 UTC&#39;&gt;2022-09-17&lt;/span&gt;&amp;nbsp;|&amp;nbsp;Update:&amp;nbsp;2022-09-17&amp;nbsp;|&amp;nbsp;Words:&amp;nbsp;1667&amp;nbsp;|&amp;nbsp;4 min&amp;nbsp;|&amp;nbsp;Lishensuo

|  Viewers: <span id="busuanzi_value_page_pv"></span> 
	  
    </div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">Table of Contents</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#1%e5%87%86%e5%a4%87%e6%95%b0%e6%8d%ae" aria-label="1、准备数据">1、准备数据</a></li>
                    <li>
                        <a href="#2%e6%a8%a1%e5%9e%8b%e8%ae%ad%e7%bb%83" aria-label="2、模型训练">2、模型训练</a><ul>
                            
                    <li>
                        <a href="#21-%e5%9f%ba%e7%a1%80%e6%b5%81%e7%a8%8b" aria-label="2.1 基础流程">2.1 基础流程</a></li>
                    <li>
                        <a href="#22-%e5%a4%9a%e7%a7%8d%e6%8c%87%e6%a0%87" aria-label="2.2 多种指标">2.2 多种指标</a></li>
                    <li>
                        <a href="#23-%e4%b8%8d%e5%90%8c%e6%a8%a1%e5%bc%8f" aria-label="2.3 不同模式">2.3 不同模式</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e6%8a%a5%e9%94%99%e8%ae%b0%e5%bd%95" aria-label="报错记录">报错记录</a>
                    </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>


  <div class="post-content"><blockquote>
<p>最先在李沐大神在B站的分享中了解到autogluon，它是一个自动机器学习工具，可用于文本图片识别、表格任务等。据说效果非常不错&ndash;号称3行代码打败99%的机器学习模型，甚至说标志着手动调参的时代已经结束。</p>
<p>关于它的原理暂且不深入了解了，简单记录下在传统表格任务上的用法，可以作为对数据的初步探索。</p>
<p><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images/main/image-20220916202545442.png" alt="image-20220916202545442"  />
</p>
<ul>
<li>安装方式：https://auto.gluon.ai/stable/index.html</li>
<li>官方教程：https://auto.gluon.ai/stable/tutorials/tabular_prediction/tabular-quickstart.html</li>
</ul></blockquote>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">from</span> autogluon.tabular <span style="color:#fff;font-weight:bold">import</span> TabularDataset, TabularPredictor
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="1准备数据">1、准备数据<a hidden class="anchor" aria-hidden="true" href="#1准备数据">#</a></h2>
<p>（1）(多列)特征与(1列)target合并在一个表格中，转为autogluon的<strong>TabularDataset</strong>对象；</p>
<p>（2）每行代表一个样本，须分为<strong>训练集</strong>与<strong>测试集</strong>。</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#007f7f">## (1) 方式1： 从csv文件读取</span>
</span></span><span style="display:flex;"><span>train_data = TabularDataset(<span style="color:#0ff;font-weight:bold">&#39;https://autogluon.s3.amazonaws.com/datasets/Inc/train.csv&#39;</span>)
</span></span><span style="display:flex;"><span>subsample_size = <span style="color:#ff0;font-weight:bold">500</span>  <span style="color:#007f7f"># 仅为演示、节省时间</span>
</span></span><span style="display:flex;"><span>train_data = train_data.sample(n=subsample_size, random_state=<span style="color:#ff0;font-weight:bold">0</span>)
</span></span><span style="display:flex;"><span>test_data = TabularDataset(<span style="color:#0ff;font-weight:bold">&#39;https://autogluon.s3.amazonaws.com/datasets/Inc/test.csv&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">type</span>(train_data)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># autogluon.core.dataset.TabularDataset</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">## (2) 方式2：可由pd.Dataframe对象转换</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> pandas <span style="color:#fff;font-weight:bold">as</span> pd
</span></span><span style="display:flex;"><span>train_df = pd.read_csv(<span style="color:#0ff;font-weight:bold">&#34;https://autogluon.s3.amazonaws.com/datasets/Inc/train.csv&#34;</span>)
</span></span><span style="display:flex;"><span>train_data = TabularDataset(train_df)
</span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images/main/image-20220916160535419.png" alt="image-20220916160535419"  />
</p>
<h2 id="2模型训练">2、模型训练<a hidden class="anchor" aria-hidden="true" href="#2模型训练">#</a></h2>
<p>（1）autogluon可自动根据target列的内容决定是回归还是分类任务；</p>
<p>（2）对于特征列数据，autogluon可自动完成缺失值处理、数据标准化等，无需手动清洗数据。</p>
<h3 id="21-基础流程">2.1 基础流程<a hidden class="anchor" aria-hidden="true" href="#21-基础流程">#</a></h3>
<ul>
<li>（1）训练模型</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#007f7f">#指定target列</span>
</span></span><span style="display:flex;"><span>label = <span style="color:#0ff;font-weight:bold">&#39;class&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#指定模型保存位置</span>
</span></span><span style="display:flex;"><span>save_path = <span style="color:#0ff;font-weight:bold">&#39;tmp&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#开始训练</span>
</span></span><span style="display:flex;"><span>predictor = TabularPredictor(label=label, path=save_path).fit(train_data)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># predictor = TabularPredictor.load(save_path) 加载模型</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>（2）查看训练结果相关信息</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>predictor.problem_type             <span style="color:#007f7f">#训练任务类型</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">print</span>(predictor.feature_metadata)  <span style="color:#007f7f">#所判断的特征列数据类型</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#不同类型模型的训练结果验证集指标排名</span>
</span></span><span style="display:flex;"><span>predictor.fit_summary()
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>（3）测试集预测</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#007f7f"># 不同模型在测试集的指标排名</span>
</span></span><span style="display:flex;"><span>predictor.leaderboard(test_data, silent=<span style="color:#fff;font-weight:bold">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 最优模型在测试集的多种结果指标</span>
</span></span><span style="display:flex;"><span>predictor.evaluate(test_data)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##等价于如下步骤</span>
</span></span><span style="display:flex;"><span>y_test = test_data[label]                    <span style="color:#007f7f">#真实值</span>
</span></span><span style="display:flex;"><span>test_data_nolab = test_data.drop(columns=[label])  
</span></span><span style="display:flex;"><span>test_data_nolab.head()
</span></span><span style="display:flex;"><span>y_pred = predictor.predict(test_data_nolab)  <span style="color:#007f7f">#预测值</span>
</span></span><span style="display:flex;"><span>predictor.evaluate_predictions(y_true=y_test, y_pred=y_pred, auxiliary_metrics=<span style="color:#fff;font-weight:bold">True</span>)
</span></span><span style="display:flex;"><span>predictor.predict_proba(test_data_nolab)     <span style="color:#007f7f">#预测概率</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 使用指定模型预测</span>
</span></span><span style="display:flex;"><span>predictor.predict(test_data, model=<span style="color:#0ff;font-weight:bold">&#39;LightGBM&#39;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="22-多种指标">2.2 多种指标<a hidden class="anchor" aria-hidden="true" href="#22-多种指标">#</a></h3>
<p>autogluon对于分类任务，默认使用accuracy指标；对于回归任务，默认使用RMSE指标</p>
<p>其它可选指标包括</p>
<p>（1）分类：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>[&#39;accuracy&#39;, &#39;balanced_accuracy&#39;, &#39;f1&#39;, &#39;f1_macro&#39;, &#39;f1_micro&#39;, &#39;f1_weighted&#39;,
</span></span><span style="display:flex;"><span>&#39;roc_auc&#39;, &#39;roc_auc_ovo_macro&#39;, &#39;average_precision&#39;, &#39;precision&#39;, &#39;precision_macro&#39;, &#39;precision_micro&#39;,
</span></span><span style="display:flex;"><span>&#39;precision_weighted&#39;, &#39;recall&#39;, &#39;recall_macro&#39;, &#39;recall_micro&#39;, &#39;recall_weighted&#39;, &#39;log_loss&#39;, &#39;pac_score&#39;]
</span></span></code></pre></td></tr></table>
</div>
</div><p>（2）回归</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>[&#39;root_mean_squared_error&#39;, &#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;, 
</span></span><span style="display:flex;"><span>&#39;median_absolute_error&#39;, &#39;mean_absolute_percentage_error&#39;, &#39;r2&#39;]
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>如需更多评价指标可参考https://auto.gluon.ai/stable/tutorials/tabular_prediction/tabular-custom-metric.html#sec-tabularcustommetric</p></blockquote>
<ul>
<li>用于<strong>训练时</strong>的模型优化：选择<u>一个</u>指标，用于模型优化以及比较</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>metric = <span style="color:#0ff;font-weight:bold">&#39;roc_auc&#39;</span>
</span></span><span style="display:flex;"><span>predictor = TabularPredictor(label=label, path=save_path, eval_metric=metric).fit(train_data)
</span></span><span style="display:flex;"><span>predictor.fit_summary()
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>用于<strong>训练后</strong>的模型不同角度的性能比较：可选择<u>多个</u>指标</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>metrics = [<span style="color:#0ff;font-weight:bold">&#39;roc_auc&#39;</span>, <span style="color:#0ff;font-weight:bold">&#34;f1&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;recall&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;recall&#34;</span>] 
</span></span><span style="display:flex;"><span>predictor.leaderboard(test_data, extra_metrics = metrics, silent=<span style="color:#fff;font-weight:bold">True</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="23-不同模式">2.3 不同模式<a hidden class="anchor" aria-hidden="true" href="#23-不同模式">#</a></h3>
<p>主要针对 <code>TabularPredictor().fit(train_data, presets=)</code>的presets参数</p>
<p>默认为&quot;medium_quality&quot;，其余依次为&quot;good_quality&quot;, &ldquo;high_quality&rdquo;, &ldquo;best_quality&rdquo;</p>
<p>从左到右，代表了训练时间/成本与训练结果性能之间的取舍。</p>
<p>官方教程建议先按默认的medium_quality训练，对模型有初步的了解后，在尝试best_quality</p>
<p><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images/main/image-20220916201804416.png" alt="image-20220916201804416"  />
</p>
<blockquote>
<p>此外fit()函数还包括一个<code>time_limit=</code>参数，单位为秒，直接指定训练的时长。如不指定默认训练完全部可能的模型。</p></blockquote>
<hr>
<h2 id="报错记录">报错记录<a hidden class="anchor" aria-hidden="true" href="#报错记录">#</a></h2>
<ul>
<li>1、在best_quality/high_quality训练模式下会可能会出现如下报错：</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span>OpenBLAS : Program is Terminated. Because you tried to allocate too many memory regions.
</span></span><span style="display:flex;"><span>This library was built to support a maximum of <span style="color:#ff0;font-weight:bold">128</span> threads - either rebuild OpenBLAS
</span></span><span style="display:flex;"><span>with a larger NUM_THREADS value or set the environment variable OPENBLAS_NUM_THREADS to
</span></span><span style="display:flex;"><span>a sufficiently small number. This error typically occurs when the software that relies on
</span></span><span style="display:flex;"><span>OpenBLAS calls BLAS functions from many threads in parallel, or when your computer has more
</span></span><span style="display:flex;"><span>cpu cores than what OpenBLAS was configured to handle.
</span></span><span style="display:flex;"><span>OpenBLAS : Program is Terminated. Because you tried to allocate too many memory regions.
</span></span><span style="display:flex;"><span>This library was built to support a maximum of <span style="color:#ff0;font-weight:bold">128</span> threadPC: <span style="color:#f00">@</span>     <span style="color:#ff0;font-weight:bold">0x7ff3b109952c</span>  (unknown)  dgemm_incopy_SKYLAKEX
</span></span><span style="display:flex;"><span>    <span style="color:#f00">@</span>     <span style="color:#ff0;font-weight:bold">0x7ff3b95f0630</span>  (unknown)  (unknown)
</span></span><span style="display:flex;"><span>[<span style="color:#ff0;font-weight:bold">2023</span>-<span style="color:#ff0;font-weight:bold">05</span>-<span style="color:#ff0;font-weight:bold">27</span> <span style="color:#ff0;font-weight:bold">15</span>:<span style="color:#ff0;font-weight:bold">40</span>:<span style="color:#ff0;font-weight:bold">36</span>,<span style="color:#ff0;font-weight:bold">365</span> E <span style="color:#ff0;font-weight:bold">90917</span> <span style="color:#ff0;font-weight:bold">106900</span>] logging.cc:<span style="color:#ff0;font-weight:bold">361</span>: *** SIGSEGV received at time=<span style="color:#ff0;font-weight:bold">1685173236</span> on cpu <span style="color:#ff0;font-weight:bold">136</span> ***
</span></span><span style="display:flex;"><span>[<span style="color:#ff0;font-weight:bold">2023</span>-<span style="color:#ff0;font-weight:bold">05</span>-<span style="color:#ff0;font-weight:bold">27</span> <span style="color:#ff0;font-weight:bold">15</span>:<span style="color:#ff0;font-weight:bold">40</span>:<span style="color:#ff0;font-weight:bold">36</span>,<span style="color:#ff0;font-weight:bold">366</span> E <span style="color:#ff0;font-weight:bold">90917</span> <span style="color:#ff0;font-weight:bold">106900</span>] logging.cc:<span style="color:#ff0;font-weight:bold">361</span>: PC: <span style="color:#f00">@</span>     <span style="color:#ff0;font-weight:bold">0x7ff3b109952c</span>  (unknown)  dgemm_incopy_SKYLAKEX
</span></span><span style="display:flex;"><span>[<span style="color:#ff0;font-weight:bold">2023</span>-<span style="color:#ff0;font-weight:bold">05</span>-<span style="color:#ff0;font-weight:bold">27</span> <span style="color:#ff0;font-weight:bold">15</span>:<span style="color:#ff0;font-weight:bold">40</span>:<span style="color:#ff0;font-weight:bold">36</span>,<span style="color:#ff0;font-weight:bold">366</span> E <span style="color:#ff0;font-weight:bold">90917</span> <span style="color:#ff0;font-weight:bold">106900</span>] logging.cc:<span style="color:#ff0;font-weight:bold">361</span>:     <span style="color:#f00">@</span>     <span style="color:#ff0;font-weight:bold">0x7ff3b95f0630</span>  (unknown)  (unknown)
</span></span><span style="display:flex;"><span>Fatal Python error: Segmentation fault
</span></span></code></pre></td></tr></table>
</div>
</div><p>解决方案参考：https://github.com/autogluon/autogluon/issues/1020 主要原因是KNN模型训练时调用了过多线程，导致超过OpenBLAS所支持的上限。</p>
<p>因此可限制KNN使用的线程数（默认调用机器的全部线程），或者干脆使用KNN模型</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>predictor = TabularPredictor(label=<span style="color:#0ff;font-weight:bold">&#34;label&#34;</span>).fit(zuhe_train_Tab,presets=<span style="color:#0ff;font-weight:bold">&#34;high_quality&#34;</span>,excluded_model_types = [<span style="color:#0ff;font-weight:bold">&#39;KNN&#39;</span>])
</span></span></code></pre></td></tr></table>
</div>
</div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://lishensuo.github.io/en/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://lishensuo.github.io/en/posts/basic/120%E6%96%87%E7%8C%AE--%E7%BB%BC%E5%90%88%E5%A4%9A%E7%A7%8D%E5%88%86%E6%9E%90%E5%BB%BA%E7%AB%8Btnbc%E9%A2%84%E5%90%8E%E6%A8%A1%E5%9E%8B/">
    <span class="title">« Prev Page</span>
    <br>
    <span>文献--综合多种分析建立TNBC预后模型</span>
  </a>
  <a class="next" href="https://lishensuo.github.io/en/posts/bioinfo/150%E6%95%B0%E6%8D%AE%E5%BA%93--%E8%8D%AF%E7%89%A9%E4%B8%8E%E8%8D%AF%E7%89%A9%E9%9D%B6%E7%82%B9ttd/">
    <span class="title">Next Page »</span>
    <br>
    <span>数据库--药物与药物靶点TTD</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2025 <a href="https://lishensuo.github.io/en/">Li&#39;s Bioinfo-Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
		<br/>您是本站第 <span id="busuanzi_value_site_uv"></span> 位访问者，总浏览量为 <span id="busuanzi_value_site_pv"></span> 次
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>

<script type="text/javascript"
async
src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
MathJax.Hub.Config({
tex2jax: {
inlineMath: [['$','$'], ['\\(','\\)']],
displayMath: [['$$','$$'], ['\[\[','\]\]']],
processEscapes: true,
processEnvironments: true,
skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
TeX: { equationNumbers: { autoNumber: "AMS" },
extensions: ["AMSmath.js", "AMSsymbols.js"] }
}
});

MathJax.Hub.Queue(function() {



var all = MathJax.Hub.getAllJax(), i;
for(i = 0; i < all.length; i += 1) {
all[i].SourceElement().parentNode.className += ' has-jax';
}
});
</script>

<style>
code.has-jax {
font: inherit;
font-size: 100%;
background: inherit;
border: inherit;
color: #515151;
}
</style></body>
</html>
