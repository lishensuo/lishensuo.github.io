<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">

<link rel="icon" href="/favicon.ico" type="image/x-icon"> 
<title>CMap数据库整理与使用方法 | Li&#39;s Bioinfo-Blog</title>
<meta name="keywords" content="化合物">
<meta name="description" content="
Cmap LINCS计划采用L1000技术进行大规模的细胞系干扰实验测序，得到差异基因。具体可分为Phase-1，Phase-2两个阶段。数据已整理、上传至阿里云盘。本片笔记整理下数据的操作、使用方法。">
<meta name="author" content="Lishensuo">
<link rel="canonical" href="https://lishensuo.github.io/en/posts/bioinfo/151%E6%95%B0%E6%8D%AE%E5%BA%93--%E8%8D%AF%E7%89%A9%E5%B9%B2%E6%89%B0%E8%BD%AC%E5%BD%95%E7%BB%84cmap/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.9e4de5e3ba61ea358168341aa7cdf70abfaafb7c697dfe8624af3ddff9a35c2f.css" integrity="sha256-nk3l47ph6jWBaDQap833Cr&#43;q&#43;3xpff6GJK893/mjXC8=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.555af97124d54bb1457985dd081b8f5616a48103aafeb30ac89fde835d65aa6c.js" integrity="sha256-VVr5cSTVS7FFeYXdCBuPVhakgQOq/rMKyJ/eg11lqmw="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://lishensuo.github.io/img/Q.gif">
<link rel="icon" type="image/png" sizes="16x16" href="https://lishensuo.github.io/img/Q.gif">
<link rel="icon" type="image/png" sizes="32x32" href="https://lishensuo.github.io/img/Q.gif">
<link rel="apple-touch-icon" href="https://lishensuo.github.io/Q.gif">
<link rel="mask-icon" href="https://lishensuo.github.io/Q.gif">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://lishensuo.github.io/en/posts/bioinfo/151%E6%95%B0%E6%8D%AE%E5%BA%93--%E8%8D%AF%E7%89%A9%E5%B9%B2%E6%89%B0%E8%BD%AC%E5%BD%95%E7%BB%84cmap/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="CMap数据库整理与使用方法" />
<meta property="og:description" content="
Cmap LINCS计划采用L1000技术进行大规模的细胞系干扰实验测序，得到差异基因。具体可分为Phase-1，Phase-2两个阶段。数据已整理、上传至阿里云盘。本片笔记整理下数据的操作、使用方法。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lishensuo.github.io/en/posts/bioinfo/151%E6%95%B0%E6%8D%AE%E5%BA%93--%E8%8D%AF%E7%89%A9%E5%B9%B2%E6%89%B0%E8%BD%AC%E5%BD%95%E7%BB%84cmap/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-21T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2022-04-21T00:00:00&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="CMap数据库整理与使用方法"/>
<meta name="twitter:description" content="
Cmap LINCS计划采用L1000技术进行大规模的细胞系干扰实验测序，得到差异基因。具体可分为Phase-1，Phase-2两个阶段。数据已整理、上传至阿里云盘。本片笔记整理下数据的操作、使用方法。"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "分类",
      "item": "https://lishensuo.github.io/en/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "📖 生信数据分析--分析流程，工具包等",
      "item": "https://lishensuo.github.io/en/posts/bioinfo/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "CMap数据库整理与使用方法",
      "item": "https://lishensuo.github.io/en/posts/bioinfo/151%E6%95%B0%E6%8D%AE%E5%BA%93--%E8%8D%AF%E7%89%A9%E5%B9%B2%E6%89%B0%E8%BD%AC%E5%BD%95%E7%BB%84cmap/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "CMap数据库整理与使用方法",
  "name": "CMap数据库整理与使用方法",
  "description": " Cmap LINCS计划采用L1000技术进行大规模的细胞系干扰实验测序，得到差异基因。具体可分为Phase-1，Phase-2两个阶段。数据已整理、上传至阿里云盘。本片笔记整理下数据的操作、使用方法。\n",
  "keywords": [
    "化合物"
  ],
  "articleBody": " Cmap LINCS计划采用L1000技术进行大规模的细胞系干扰实验测序，得到差异基因。具体可分为Phase-1，Phase-2两个阶段。数据已整理、上传至阿里云盘。本片笔记整理下数据的操作、使用方法。\n一、CMap https://clue.io/data/CMap2020#LINCS2020\nCompound类型 ~4w 化合物作用于240个细胞系的72w+ 次干扰试验 1、差异表达矩阵 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 ###根据行列id序号提取指定的差异表达矩阵 ###行名表示基因名；列名表示实验id名 gctx_demo = parse_gctx(\"gctx/level5_beta_trt_cp_n720216x12328.gctx\", cid=1:2, rid=1:2) gctx_demo@mat # ABY001_A375_XH:BRD-A61304759:0.625:24 ABY001_A375_XH:BRD-A61304759:0.625:3 # 10 -0.02435 0.2960798 # 100 0.70715 -0.8559232 gctx_demo@rdesc # id # 1 10 # 2 100 gctx_demo@cdesc # id # 1 ABY001_A375_XH:BRD-A61304759:0.625:24 # 2 ABY001_A375_XH:BRD-A61304759:0.625:3 2、meta注释信息 2.1 实验（行）注释–基本+质量信息 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 sig_info = data.table::fread(\"siginfo_beta.txt\",data.table=FALSE) col_meta \u003c- read_gctx_meta(\"gctx/level5_beta_trt_cp_n720216x12328.gctx\", dim=\"col\") table(col_meta[,\"id\"] %in% sig_info[,\"sig_id\"]) # TRUE #720216 sig_sub = subset(sig_info, sig_id %in% col_meta[,\"id\"]) t(sig_sub[1,]) # bead_batch \"b17\" # nearest_dose NA # pert_dose \"100\" # pert_dose_unit \"ug/ml\" # pert_idose \"100 ug/ml\" # pert_itime \"336 h\" # pert_time \"336\" # pert_time_unit \"h\" # cell_mfc_name \"N8\" # pert_mfc_id \"BRD-U44432129\" # nsample \"4\" # cc_q75 \"0.6164\" # ss_ngene \"446\" # tas \"0.530187\" # pct_self_rank_q25 \"0\" # wt \"0.26,0.26,0.22,0.26\" # median_recall_rank_spearman \"0.925926\" # median_recall_rank_wtcs_50 \"1.15741\" # median_recall_score_spearman \"0.548655\" # median_recall_score_wtcs_50 \"0.705263\" # batch_effect_tstat \"-2.31\" # batch_effect_tstat_pct \"0.488085\" # is_hiq \"1\" # qc_pass \"1\" # pert_id \"BRD-U44432129\" # sig_id \"MET001_N8_XH:BRD-U44432129:100:336\" # pert_type \"trt_cp\" # cell_iname \"NAMEC8\" # det_wells \"H05|H06|H07|H08\" # det_plates \"MET001_N8_XH_X1_B17\" # distil_ids \"MET001_N8_XH_X1_B17:H05|MET001_N8_XH_X1_B17:H06|MET001_N8_XH_X1_B17:H07|MET001_N8_XH_X1_B17:H08\" # build_name NA # project_code \"MET\" # cmap_name \"BRD-U44432129\" # is_exemplar_sig \"0\" # is_ncs_sig \"0\" # is_null_sig \"0\" 2.2 实验（行）注释–化合物与细胞系 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 cp_meta = data.table::fread(\"compoundinfo_beta.txt\") t(cp_meta[1,]) # [,1] # pert_id \"BRD-A08715367\" # cmap_name \"L-theanine\" # target \"\" # moa \"\" # canonical_smiles \"CCNC(=O)CCC(N)C(O)=O\" # inchi_key \"DATAGRPVKZEWHA-UHFFFAOYSA-N\" # compound_aliases \"l-theanine\" cell_meta = data.table::fread(\"cellinfo_beta.txt\") t(cell_meta[1,]) # [,1] # cell_iname \"1HAE\" # cellosaurus_id \"\" # donor_age \"\" # donor_age_death NA # donor_disease_age_onset NA # doubling_time \"\" # growth_medium \"\" # provider_catalog_id \"\" # feature_id \"\" # cell_type \"normal\" # donor_ethnicity \"Unknown\" # donor_sex \"Unknown\" # donor_tumor_phase \"Unknown\" # cell_lineage \"unknown\" # primary_disease \"unknown\" # subtype \"normal fibroblast sample\" # provider_name \"\" # growth_pattern \"unknown\" # ccle_name \"\" # cell_alias \"\" 2.3 实验（列）注释–基因信息 1 2 3 4 5 6 7 8 9 10 gene_meta = data.table::fread(\"geneinfo_beta.txt\") t(gene_meta[1,]) # [,1] # gene_id \"750\" # gene_symbol \"GAS8-AS1\" # ensembl_id \"ENSG00000221819\" # gene_title \"GAS8 antisense RNA 1\" # gene_type \"ncRNA\" # src \"NCBI\" # feature_space \"inferred\" shRNA类型 1、差异表达矩阵 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 gctx_demo = parse_gctx(\"gctx/level5_beta_trt_sh_n238351x12328.gctx\", cid=1:2, rid=1:2) gctx_demo@mat # CGS001_A375_96H:A2M:1 CGS001_A375_96H:AARS:1 # 10 -0.3014087 -0.17930678 # 100 0.2917795 0.05233869 gctx_demo@rdesc # id # 1 10 # 2 100 gctx_demo@cdesc # id # 1 CGS001_A375_96H:A2M:1 # 2 CGS001_A375_96H:AARS:1 2、meta注释信息 2.1 实验（行）注释–基本+质量信息 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 sig_info = data.table::fread(\"siginfo_beta.txt\",data.table=FALSE) col_meta \u003c- read_gctx_meta(\"gctx/level5_beta_trt_sh_n238351x12328.gctx\", dim=\"col\") table(col_meta[,\"id\"] %in% sig_info[,\"sig_id\"]) # TRUE # 238351 t(sig_sub[1,]) # 373 # bead_batch \"b7\" # nearest_dose NA # pert_dose NA # pert_dose_unit \"\" # pert_idose \"\" # pert_itime \"96 h\" # pert_time \"96\" # pert_time_unit \"h\" # cell_mfc_name \"PC3\" # pert_mfc_id \"TRCN0000350275\" # nsample \"2\" # cc_q75 \"0.43\" # ss_ngene \"74\" # tas \"0.180377\" # pct_self_rank_q25 \"0.134953\" # wt \"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\" # median_recall_rank_spearman \"0\" # median_recall_rank_wtcs_50 \"0\" # median_recall_score_spearman \"0.426979\" # median_recall_score_wtcs_50 \"0.697757\" # batch_effect_tstat \"11.81\" # batch_effect_tstat_pct \"51.0192\" # is_hiq \"1\" # qc_pass \"1\" # pert_id \"TRCN0000350275\" # sig_id \"TAK001_PC3_96H:TRCN0000350275:-666\" # pert_type \"trt_sh\" # cell_iname \"PC3\" # det_wells \"P11\" # det_plates \"TAK001_PC3_96H_X1_B7_DUO52HI53LO|TAK001_PC3_96H_X2_B7_DUO52HI53LO\" # distil_ids \"TAK001_PC3_96H_X1_B7_DUO52HI53LO:P11|TAK001_PC3_96H_X2_B7_DUO52HI53LO:P11\" # build_name NA # project_code \"TAK\" # cmap_name \"PIK3CA\" #作用对象基因 # is_exemplar_sig \"1\" # is_ncs_sig \"1\" # is_null_sig \"0\" （1）其余注释同上\n（2）此外还有其它类型干扰(over-expression、CRISPR等)；操作基本同上，不再叙述。\n二、LINCS Phase-1(GSE92742) 1、差异表达矩阵 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 ###根据行列id序号提取指定的差异表达矩阵 ###行名表示基因名；列名表示实验id名 gctx_demo = parse_gctx(\"phase1/GSE92742_Broad_LINCS_Level5_COMPZ.MODZ_n473647x12328.gctx\", cid=1:2, rid=1:2) gctx_demo@mat # CPC005_A375_6H:BRD-A85280935-003-01-7:10 # 5720 0.7737690 # 466 -0.8184680 # CPC005_A375_6H:BRD-A07824748-001-02-6:10 # 5720 -0.6455861 # 466 -0.8107487 ###gctx文件里没有更多的注释信息 gctx_demo@rdesc # id #1 5720 #2 466 gctx_demo@cdesc # id #1 CPC005_A375_6H:BRD-A85280935-003-01-7:10 #2 CPC005_A375_6H:BRD-A07824748-001-02-6:10 由于gctx文件太大，可根据下面的注释信息，仅仅提取部分感兴趣的差异表达矩阵。\n2、meta注释信息 2.1 实验（行）注释–基本信息 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 sig_info = data.table::fread(\"phase1/Fine_phase1_sig_info_473647.csv\", data.table = F) col_meta = read_gctx_meta(\"phase1/GSE92742_Broad_LINCS_Level5_COMPZ.MODZ_n473647x12328.gctx\", dim=\"col\") identical(col_meta$id, sig_info$sig_id) # [1] TRUE t(sig_info[1,]) # [,1] # sig_id \"CPC005_A375_6H:BRD-A85280935-003-01-7:10\" ##实验ID # pert_id \"BRD-A85280935\" ##干扰方法ID # pert_iname \"quinpirole\" ##干扰物命名(化合物或者基因名) # pert_type \"trt_cp\" ##干扰类型(化合物/基因敲除、过表达) # cell_id \"A375\" ##细胞系名 # pert_dose \"10.0\" ##剂量 # pert_dose_unit \"µM\" ##剂量 # pert_idose \"10 µM\" ##剂量 # pert_time \"6\" ##干扰时间 # pert_time_unit \"h\" ##干扰时间 # pert_itime \"6 h\" ##干扰时间 # distil_id \"CPC005_A375_6H_X1_B3_DUO52HI53LO:K06|CPC005_A375_6H_X2_B3_DUO52HI53LO:K06|CPC005_A375_6H_X3_B3_DUO52HI53LO:K06\" table(sig_info$pert_type) # ctl_untrt ctl_untrt.cns ctl_vector ctl_vector.cns ctl_vehicle # 588 30 6826 137 14423 #ctl_vehicle.cns trt_cp trt_lig trt_oe trt_oe.mut # 61 205034 8256 22205 6 # trt_sh trt_sh.cgs trt_sh.css # 154993 36720 24368 2.2 实验（行）注释–实验质量信息 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 sig_metrics = data.table::fread(\"phase1/phase1_sig_metrcs.csv\", data.table = F) col_meta = read_gctx_meta(\"phase1/GSE92742_Broad_LINCS_Level5_COMPZ.MODZ_n473647x12328.gctx\", dim=\"col\") sig_metrics = sig_metrics[match(col_meta$id, sig_metrics$sig_id),] identical(col_meta$id, sig_metrics$sig_id) # [1] TRUE t(sig_metrics[1,]) # 53349 # sig_id \"CPC005_A375_6H:BRD-A85280935-003-01-7:10\" # pert_id \"BRD-A85280935\" # pert_iname \"quinpirole\" # pert_type \"trt_cp\" # distil_cc_q75 \"0.11\" # 重复相同实验的结果相似度指标 # distil_ss \"2.84895\" # 干扰影响强度指标 # ngenes_modulated_up_lm \"18\" # ngenes_modulated_dn_lm \"15\" # tas \"0.101169\" # 综合cc_q75与ss的评价指标结果 # pct_self_rank_q25 \"7.6087\" # is_exemplar \"0\" # distil_nsample \"3\" 2.3 实验（行）注释–干扰物与细胞系 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 ###通过pert_id与前面的信息相关联 #(1)干扰物注释：主要针对化合物类干扰实验，提供化合物的CID等信息 pert_info = data.table::fread(\"phase1/phase1_pert_info.csv\") t(pert_info[1,]) # [,1] # V1 \"1\" # pert_id \"56582\" # pert_iname \"AKT2\" # pert_type \"trt_oe\" # is_touchstone \"0\" # inchi_key_prefix \"-666\" # inchi_key \"-666\" # canonical_smiles \"-666\" # pubchem_cid \"-666\" #(2)细胞系注释：例如是否为肿瘤细胞系，源自那个部位等 cell_info = data.table::fread(\"phase1/phase1_cell_info.csv\") t(cell_info[1,]) # [,1] # cell_id \"A375\" # cell_type \"cell line\" # base_cell_id \"A375\" # precursor_cell_id \"-666\" # modification \"-666\" # sample_type \"tumor\" # primary_site \"skin\" # subtype \"malignant melanoma\" # original_growth_pattern \"adherent\" # provider_catalog_id \"CRL-1619\" # original_source_vendor \"ATCC\" # donor_age \"54\" # donor_sex \"F\" # donor_ethnicity \"-666\" 2.4 实验（列）注释–基因信息 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 gene_info = data.table::fread(\"phase1/Fine_phase1_gene_info_12328.csv\", data.table = F) row_meta \u003c- read_gctx_meta(\"phase1/GSE92742_Broad_LINCS_Level5_COMPZ.MODZ_n473647x12328.gctx\", dim=\"row\") identical(as.integer(row_meta$id), gene_info$pr_gene_id) # [1] TRUE dim(gene_info) # [1] 12328 5 t(gene_info[1,]) # 1 # pr_gene_id \"5720\" # pr_gene_symbol \"PSME1\" # pr_gene_title \"proteasome activator subunit 1\" # pr_is_lm \"1\" # landmark 978 # pr_is_bing \"1\" # landmark + best inferred gene 10174 Phase-2(GSE70138) 1、差异表达矩阵 1 2 3 4 5 6 7 8 ###根据行列id序号提取指定的差异表达矩阵 ###行名表示基因名；列名表示实验id名 gctx_demo = parse_gctx(\"phase2/GSE70138_Broad_LINCS_Level5_COMPZ_n118050x12328_2017-03-06.gctx\", cid=1:2, rid=1:2) gctx_demo@mat # REP.A001_A375_24H:A03 REP.A001_A375_24H:A04 #780 4.2641425 -0.3822108 #7849 0.0572492 0.3043132 2、meta注释信息 2.1 实验（行）注释–基本信息 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 sig_info = data.table::fread(\"phase2/Fine_phase2_sig_info_118050.csv\", data.table = F) col_meta = read_gctx_meta(\"phase2/GSE70138_Broad_LINCS_Level5_COMPZ_n118050x12328_2017-03-06.gctx\", dim=\"col\") identical(col_meta$id, sig_info$sig_id) # [1] TRUE t(sig_info[1,]) # 1 # sig_id \"REP.A001_A375_24H:A03\" # pert_id \"DMSO\" # pert_iname \"DMSO\" # pert_type \"ctl_vehicle\" # cell_id \"A375\" # pert_idose \"-666\" # pert_itime \"24 h\" # distil_id \"REP.A001_A375_24H_X1_B22:A03|REP.A001_A375_24H_X2_B22:A03|REP.A001_A375_24H_X3_B22:A03\" table(sig_info$pert_type) # ctl_untrt ctl_vector ctl_vehicle trt_cp trt_xpr # 88 209 6467 107404 3882 2.2 实验（行）注释–实验质量信息 1 2 3 4 5 6 7 8 sig_metrics = data.table::fread(\"phase2/phase2_sig_metrics.csv\", data.table = F) col_meta = read_gctx_meta(\"phase1/GSE92742_Broad_LINCS_Level5_COMPZ.MODZ_n473647x12328.gctx\", dim=\"col\") sig_metrics = sig_metrics[match(col_meta$id, sig_metrics$sig_id),] identical(col_meta$id, sig_metrics$sig_id) # [1] TRUE t(sig_metrics[1,]) 2.3 实验（行）注释–干扰物与细胞系 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 ###通过pert_id与前面的信息相关联 #(1)干扰物注释：主要针对化合物类干扰实验，提供化合物的CID等信息 pert_info = data.table::fread(\"phase2/phase2_pert_info.csv\") t(pert_info[1,]) # [,1] # pert_id \"BRD-K70792160\" # canonical_smiles \"CCN(CC)CCCCN1c2ccccc2Oc2ccc(Cl)cc12\" # inchi_key \"GYBXAGDWMCJZJK-UHFFFAOYSA-N\" # pert_iname \"10-DEBC\" # pert_type \"trt_cp\" # pubchem_id \"10521421\" #(2)细胞系注释：例如是否为肿瘤细胞系，源自那个部位等 cell_info = data.table::fread(\"phase2/phase2_cell_info.csv\") t(cell_info[1,]) # [,1] # cell_id \"A375\" # cell_type \"cell line\" # base_cell_id \"A375\" # precursor_cell_id \"-666\" # modification \"-666\" # sample_type \"tumor\" # primary_site \"skin\" # subtype \"malignant melanoma\" # original_growth_pattern \"adherent\" # provider_catalog_id \"CRL-1619\" # original_source_vendor \"ATCC\" # donor_age \"54\" # donor_sex \"F\" # donor_ethnicity \"-666\" 2.4 实验（列）注释–基因信息 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 gene_info = data.table::fread(\"phase2/Fine_phase1_gene_info_12328.csv\", data.table = F) row_meta \u003c- read_gctx_meta(\"phase2/GSE92742_Broad_LINCS_Level5_COMPZ.MODZ_n473647x12328.gctx\", dim=\"row\") identical(as.integer(row_meta$id), gene_info$pr_gene_id) # [1] TRUE dim(gene_info) # [1] 12328 5 t(gene_info[1,]) # 1 # pr_gene_id \"5720\" # pr_gene_symbol \"PSME1\" # pr_gene_title \"proteasome activator subunit 1\" # pr_is_lm \"1\" # landmark 978 # pr_is_bing \"1\" # landmark + best inferred gene 10174 ",
  "wordCount" : "2399",
  "inLanguage": "en",
  "datePublished": "2022-04-21T00:00:00Z",
  "dateModified": "2022-04-21T00:00:00Z",
  "author":[{
    "@type": "Person",
    "name": "Lishensuo"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://lishensuo.github.io/en/posts/bioinfo/151%E6%95%B0%E6%8D%AE%E5%BA%93--%E8%8D%AF%E7%89%A9%E5%B9%B2%E6%89%B0%E8%BD%AC%E5%BD%95%E7%BB%84cmap/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Li's Bioinfo-Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://lishensuo.github.io/img/Q.gif"
    }
  }
}
</script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://lishensuo.github.io/en/" accesskey="h" title="Li&#39;s Bioinfo-Blog (Alt + H)">Li&#39;s Bioinfo-Blog</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                </ul>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://lishensuo.github.io/en/" title="主页">
                    <span>主页</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/posts" title="分类">
                    <span>分类</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/tags" title="标签">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/archives/" title="归档">
                    <span>归档</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/about" title="关于">
                    <span>关于</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/search" title="搜索 (Alt &#43; /)" accesskey=/>
                    <span>搜索</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://lishensuo.github.io/en/">Home</a>&nbsp;»&nbsp;<a href="https://lishensuo.github.io/en/posts/">分类</a>&nbsp;»&nbsp;<a href="https://lishensuo.github.io/en/posts/bioinfo/">📖 生信数据分析--分析流程，工具包等</a></div>
    <h1 class="post-title">
      CMap数据库整理与使用方法
    </h1>
    <div class="post-meta">













Create:&amp;nbsp;&lt;span title=&#39;2022-04-21 00:00:00 &#43;0000 UTC&#39;&gt;2022-04-21&lt;/span&gt;&amp;nbsp;|&amp;nbsp;Update:&amp;nbsp;2022-04-21&amp;nbsp;|&amp;nbsp;Words:&amp;nbsp;2399&amp;nbsp;|&amp;nbsp;5 min&amp;nbsp;|&amp;nbsp;Lishensuo

|  Viewers: <span id="busuanzi_value_page_pv"></span> 
	  
    </div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">Table of Contents</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#%e4%b8%80cmap" aria-label="一、CMap">一、CMap</a><ul>
                            
                    <li>
                        <a href="#compound%e7%b1%bb%e5%9e%8b" aria-label="Compound类型">Compound类型</a><ul>
                            
                    <li>
                        <a href="#1%e5%b7%ae%e5%bc%82%e8%a1%a8%e8%be%be%e7%9f%a9%e9%98%b5" aria-label="1、差异表达矩阵">1、差异表达矩阵</a></li>
                    <li>
                        <a href="#2meta%e6%b3%a8%e9%87%8a%e4%bf%a1%e6%81%af" aria-label="2、meta注释信息">2、meta注释信息</a><ul>
                            
                    <li>
                        <a href="#21-%e5%ae%9e%e9%aa%8c%e8%a1%8c%e6%b3%a8%e9%87%8a%e5%9f%ba%e6%9c%ac%e8%b4%a8%e9%87%8f%e4%bf%a1%e6%81%af" aria-label="2.1 实验（行）注释&ndash;基本&#43;质量信息">2.1 实验（行）注释&ndash;基本+质量信息</a></li>
                    <li>
                        <a href="#22-%e5%ae%9e%e9%aa%8c%e8%a1%8c%e6%b3%a8%e9%87%8a%e5%8c%96%e5%90%88%e7%89%a9%e4%b8%8e%e7%bb%86%e8%83%9e%e7%b3%bb" aria-label="2.2 实验（行）注释&ndash;化合物与细胞系">2.2 实验（行）注释&ndash;化合物与细胞系</a></li>
                    <li>
                        <a href="#23-%e5%ae%9e%e9%aa%8c%e5%88%97%e6%b3%a8%e9%87%8a%e5%9f%ba%e5%9b%a0%e4%bf%a1%e6%81%af" aria-label="2.3 实验（列）注释&ndash;基因信息">2.3 实验（列）注释&ndash;基因信息</a></li></ul>
                    </li></ul>
                    </li>
                    <li>
                        <a href="#shrna%e7%b1%bb%e5%9e%8b" aria-label="shRNA类型">shRNA类型</a><ul>
                            
                    <li>
                        <a href="#1%e5%b7%ae%e5%bc%82%e8%a1%a8%e8%be%be%e7%9f%a9%e9%98%b5-1" aria-label="1、差异表达矩阵">1、差异表达矩阵</a></li>
                    <li>
                        <a href="#2meta%e6%b3%a8%e9%87%8a%e4%bf%a1%e6%81%af-1" aria-label="2、meta注释信息">2、meta注释信息</a><ul>
                            
                    <li>
                        <a href="#21-%e5%ae%9e%e9%aa%8c%e8%a1%8c%e6%b3%a8%e9%87%8a%e5%9f%ba%e6%9c%ac%e8%b4%a8%e9%87%8f%e4%bf%a1%e6%81%af-1" aria-label="2.1 实验（行）注释&ndash;基本&#43;质量信息">2.1 实验（行）注释&ndash;基本+质量信息</a></li></ul>
                    </li></ul>
                    </li></ul>
                    </li>
                    <li>
                        <a href="#%e4%ba%8clincs" aria-label="二、LINCS">二、LINCS</a><ul>
                            
                    <li>
                        <a href="#phase-1gse92742" aria-label="Phase-1(GSE92742)">Phase-1(<a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE92742">GSE92742</a>)</a><ul>
                            
                    <li>
                        <a href="#1%e5%b7%ae%e5%bc%82%e8%a1%a8%e8%be%be%e7%9f%a9%e9%98%b5-2" aria-label="1、差异表达矩阵">1、差异表达矩阵</a></li>
                    <li>
                        <a href="#2meta%e6%b3%a8%e9%87%8a%e4%bf%a1%e6%81%af-2" aria-label="2、meta注释信息">2、meta注释信息</a><ul>
                            
                    <li>
                        <a href="#21-%e5%ae%9e%e9%aa%8c%e8%a1%8c%e6%b3%a8%e9%87%8a%e5%9f%ba%e6%9c%ac%e4%bf%a1%e6%81%af" aria-label="2.1 实验（行）注释&ndash;基本信息">2.1 实验（行）注释&ndash;基本信息</a></li>
                    <li>
                        <a href="#22-%e5%ae%9e%e9%aa%8c%e8%a1%8c%e6%b3%a8%e9%87%8a%e5%ae%9e%e9%aa%8c%e8%b4%a8%e9%87%8f%e4%bf%a1%e6%81%af" aria-label="2.2 实验（行）注释&ndash;实验质量信息">2.2 实验（行）注释&ndash;实验质量信息</a></li>
                    <li>
                        <a href="#23-%e5%ae%9e%e9%aa%8c%e8%a1%8c%e6%b3%a8%e9%87%8a%e5%b9%b2%e6%89%b0%e7%89%a9%e4%b8%8e%e7%bb%86%e8%83%9e%e7%b3%bb" aria-label="2.3 实验（行）注释&ndash;干扰物与细胞系">2.3 实验（行）注释&ndash;干扰物与细胞系</a></li>
                    <li>
                        <a href="#24-%e5%ae%9e%e9%aa%8c%e5%88%97%e6%b3%a8%e9%87%8a%e5%9f%ba%e5%9b%a0%e4%bf%a1%e6%81%af" aria-label="2.4 实验（列）注释&ndash;基因信息">2.4 实验（列）注释&ndash;基因信息</a></li></ul>
                    </li></ul>
                    </li>
                    <li>
                        <a href="#phase-2gse70138" aria-label="Phase-2(GSE70138)">Phase-2(<a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE70138">GSE70138</a>)</a><ul>
                            
                    <li>
                        <a href="#1%e5%b7%ae%e5%bc%82%e8%a1%a8%e8%be%be%e7%9f%a9%e9%98%b5-3" aria-label="1、差异表达矩阵">1、差异表达矩阵</a></li>
                    <li>
                        <a href="#2meta%e6%b3%a8%e9%87%8a%e4%bf%a1%e6%81%af-3" aria-label="2、meta注释信息">2、meta注释信息</a><ul>
                            
                    <li>
                        <a href="#21-%e5%ae%9e%e9%aa%8c%e8%a1%8c%e6%b3%a8%e9%87%8a%e5%9f%ba%e6%9c%ac%e4%bf%a1%e6%81%af-1" aria-label="2.1 实验（行）注释&ndash;基本信息">2.1 实验（行）注释&ndash;基本信息</a></li>
                    <li>
                        <a href="#22-%e5%ae%9e%e9%aa%8c%e8%a1%8c%e6%b3%a8%e9%87%8a%e5%ae%9e%e9%aa%8c%e8%b4%a8%e9%87%8f%e4%bf%a1%e6%81%af-1" aria-label="2.2 实验（行）注释&ndash;实验质量信息">2.2 实验（行）注释&ndash;实验质量信息</a></li>
                    <li>
                        <a href="#23-%e5%ae%9e%e9%aa%8c%e8%a1%8c%e6%b3%a8%e9%87%8a%e5%b9%b2%e6%89%b0%e7%89%a9%e4%b8%8e%e7%bb%86%e8%83%9e%e7%b3%bb-1" aria-label="2.3 实验（行）注释&ndash;干扰物与细胞系">2.3 实验（行）注释&ndash;干扰物与细胞系</a></li>
                    <li>
                        <a href="#24-%e5%ae%9e%e9%aa%8c%e5%88%97%e6%b3%a8%e9%87%8a%e5%9f%ba%e5%9b%a0%e4%bf%a1%e6%81%af-1" aria-label="2.4 实验（列）注释&ndash;基因信息">2.4 实验（列）注释&ndash;基因信息</a>
                    </li>
                </ul>
                </li>
                </ul>
                </li>
                </ul>
                </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>


  <div class="post-content"><blockquote>
<p>Cmap LINCS计划采用L1000技术进行大规模的细胞系干扰实验测序，得到差异基因。具体可分为Phase-1，Phase-2两个阶段。数据已整理、上传至阿里云盘。本片笔记整理下数据的操作、使用方法。</p>
<p><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images/main/image-20220421114921060.png" alt="image-20220421114921060"  />
</p></blockquote>
<h2 id="一cmap">一、CMap<a hidden class="anchor" aria-hidden="true" href="#一cmap">#</a></h2>
<ul>
<li>
<p><a href="https://clue.io/data/CMap2020#LINCS2020">https://clue.io/data/CMap2020#LINCS2020</a></p>
<p><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images/main/image-20220421112542707.png" alt="image-20220421112542707"  />
</p>
</li>
</ul>
<h3 id="compound类型">Compound类型<a hidden class="anchor" aria-hidden="true" href="#compound类型">#</a></h3>
<ul>
<li>~4w 化合物作用于240个细胞系的72w+ 次干扰试验</li>
</ul>
<h4 id="1差异表达矩阵">1、差异表达矩阵<a hidden class="anchor" aria-hidden="true" href="#1差异表达矩阵">#</a></h4>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span><span style="color:#007f7f">###根据行列id序号提取指定的差异表达矩阵</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">###行名表示基因名；列名表示实验id名</span>
</span></span><span style="display:flex;"><span>gctx_demo = parse_gctx(<span style="color:#0ff;font-weight:bold">&#34;gctx/level5_beta_trt_cp_n720216x12328.gctx&#34;</span>, 
</span></span><span style="display:flex;"><span>                       cid=<span style="color:#ff0;font-weight:bold">1</span>:<span style="color:#ff0;font-weight:bold">2</span>, rid=<span style="color:#ff0;font-weight:bold">1</span>:<span style="color:#ff0;font-weight:bold">2</span>)
</span></span><span style="display:flex;"><span>gctx_demo@mat
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#     ABY001_A375_XH:BRD-A61304759:0.625:24 ABY001_A375_XH:BRD-A61304759:0.625:3</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 10                               -0.02435                            0.2960798</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 100                               0.70715                           -0.8559232</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>gctx_demo@rdesc
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#    id</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1  10</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 2 100</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>gctx_demo@cdesc
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#                                      id</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1 ABY001_A375_XH:BRD-A61304759:0.625:24</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 2  ABY001_A375_XH:BRD-A61304759:0.625:3</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="2meta注释信息">2、meta注释信息<a hidden class="anchor" aria-hidden="true" href="#2meta注释信息">#</a></h4>
<h5 id="21-实验行注释基本质量信息">2.1 实验（行）注释&ndash;基本+质量信息<a hidden class="anchor" aria-hidden="true" href="#21-实验行注释基本质量信息">#</a></h5>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>sig_info = data.table::fread(<span style="color:#0ff;font-weight:bold">&#34;siginfo_beta.txt&#34;</span>,data.table=<span style="color:#fff;font-weight:bold">FALSE</span>)
</span></span><span style="display:flex;"><span>col_meta &lt;- read_gctx_meta(<span style="color:#0ff;font-weight:bold">&#34;gctx/level5_beta_trt_cp_n720216x12328.gctx&#34;</span>, 
</span></span><span style="display:flex;"><span>						   dim=<span style="color:#0ff;font-weight:bold">&#34;col&#34;</span>)
</span></span><span style="display:flex;"><span>table(col_meta[,<span style="color:#0ff;font-weight:bold">&#34;id&#34;</span>] %in% sig_info[,<span style="color:#0ff;font-weight:bold">&#34;sig_id&#34;</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#  TRUE</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#720216</span>
</span></span><span style="display:flex;"><span>sig_sub = subset(sig_info, sig_id %in% col_meta[,<span style="color:#0ff;font-weight:bold">&#34;id&#34;</span>])
</span></span><span style="display:flex;"><span>t(sig_sub[1,])
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># bead_batch                   &#34;b17&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># nearest_dose                 NA</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_dose                    &#34;100&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_dose_unit               &#34;ug/ml&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_idose                   &#34;100 ug/ml&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_itime                   &#34;336 h&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_time                    &#34;336&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_time_unit               &#34;h&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># cell_mfc_name                &#34;N8&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_mfc_id                  &#34;BRD-U44432129&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># nsample                      &#34;4&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># cc_q75                       &#34;0.6164&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># ss_ngene                     &#34;446&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># tas                          &#34;0.530187&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pct_self_rank_q25            &#34;0&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># wt                           &#34;0.26,0.26,0.22,0.26&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># median_recall_rank_spearman  &#34;0.925926&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># median_recall_rank_wtcs_50   &#34;1.15741&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># median_recall_score_spearman &#34;0.548655&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># median_recall_score_wtcs_50  &#34;0.705263&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># batch_effect_tstat           &#34;-2.31&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># batch_effect_tstat_pct       &#34;0.488085&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># is_hiq                       &#34;1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># qc_pass                      &#34;1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_id                      &#34;BRD-U44432129&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sig_id                       &#34;MET001_N8_XH:BRD-U44432129:100:336&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_type                    &#34;trt_cp&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># cell_iname                   &#34;NAMEC8&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># det_wells                    &#34;H05|H06|H07|H08&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># det_plates                   &#34;MET001_N8_XH_X1_B17&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># distil_ids                   &#34;MET001_N8_XH_X1_B17:H05|MET001_N8_XH_X1_B17:H06|MET001_N8_XH_X1_B17:H07|MET001_N8_XH_X1_B17:H08&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># build_name                   NA</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># project_code                 &#34;MET&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># cmap_name                    &#34;BRD-U44432129&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># is_exemplar_sig              &#34;0&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># is_ncs_sig                   &#34;0&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># is_null_sig                  &#34;0&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="22-实验行注释化合物与细胞系">2.2 实验（行）注释&ndash;化合物与细胞系<a hidden class="anchor" aria-hidden="true" href="#22-实验行注释化合物与细胞系">#</a></h5>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>cp_meta = data.table::fread(<span style="color:#0ff;font-weight:bold">&#34;compoundinfo_beta.txt&#34;</span>)
</span></span><span style="display:flex;"><span>t(cp_meta[1,])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#                  [,1]</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_id          &#34;BRD-A08715367&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># cmap_name        &#34;L-theanine&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># target           &#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># moa              &#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># canonical_smiles &#34;CCNC(=O)CCC(N)C(O)=O&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># inchi_key        &#34;DATAGRPVKZEWHA-UHFFFAOYSA-N&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># compound_aliases &#34;l-theanine&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cell_meta = data.table::fread(<span style="color:#0ff;font-weight:bold">&#34;cellinfo_beta.txt&#34;</span>)
</span></span><span style="display:flex;"><span>t(cell_meta[1,])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#                         [,1]</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># cell_iname              &#34;1HAE&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># cellosaurus_id          &#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># donor_age               &#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># donor_age_death         NA</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># donor_disease_age_onset NA</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># doubling_time           &#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># growth_medium           &#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># provider_catalog_id     &#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># feature_id              &#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># cell_type               &#34;normal&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># donor_ethnicity         &#34;Unknown&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># donor_sex               &#34;Unknown&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># donor_tumor_phase       &#34;Unknown&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># cell_lineage            &#34;unknown&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># primary_disease         &#34;unknown&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># subtype                 &#34;normal fibroblast sample&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># provider_name           &#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># growth_pattern          &#34;unknown&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># ccle_name               &#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># cell_alias              &#34;&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="23-实验列注释基因信息">2.3 实验（列）注释&ndash;基因信息<a hidden class="anchor" aria-hidden="true" href="#23-实验列注释基因信息">#</a></h5>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>gene_meta = data.table::fread(<span style="color:#0ff;font-weight:bold">&#34;geneinfo_beta.txt&#34;</span>)
</span></span><span style="display:flex;"><span>t(gene_meta[1,])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#               [,1]</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># gene_id       &#34;750&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># gene_symbol   &#34;GAS8-AS1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># ensembl_id    &#34;ENSG00000221819&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># gene_title    &#34;GAS8 antisense RNA 1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># gene_type     &#34;ncRNA&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># src           &#34;NCBI&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># feature_space &#34;inferred&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="shrna类型">shRNA类型<a hidden class="anchor" aria-hidden="true" href="#shrna类型">#</a></h3>
<h4 id="1差异表达矩阵-1">1、差异表达矩阵<a hidden class="anchor" aria-hidden="true" href="#1差异表达矩阵-1">#</a></h4>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>gctx_demo = parse_gctx(<span style="color:#0ff;font-weight:bold">&#34;gctx/level5_beta_trt_sh_n238351x12328.gctx&#34;</span>, 
</span></span><span style="display:flex;"><span>                       cid=<span style="color:#ff0;font-weight:bold">1</span>:<span style="color:#ff0;font-weight:bold">2</span>, rid=<span style="color:#ff0;font-weight:bold">1</span>:<span style="color:#ff0;font-weight:bold">2</span>)
</span></span><span style="display:flex;"><span>gctx_demo@mat
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#     CGS001_A375_96H:A2M:1 CGS001_A375_96H:AARS:1</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 10             -0.3014087            -0.17930678</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 100             0.2917795             0.05233869</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>gctx_demo@rdesc
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#    id</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1  10</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 2 100</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>gctx_demo@cdesc
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#                       id</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1  CGS001_A375_96H:A2M:1</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 2 CGS001_A375_96H:AARS:1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="2meta注释信息-1">2、meta注释信息<a hidden class="anchor" aria-hidden="true" href="#2meta注释信息-1">#</a></h4>
<h5 id="21-实验行注释基本质量信息-1">2.1 实验（行）注释&ndash;基本+质量信息<a hidden class="anchor" aria-hidden="true" href="#21-实验行注释基本质量信息-1">#</a></h5>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>sig_info = data.table::fread(<span style="color:#0ff;font-weight:bold">&#34;siginfo_beta.txt&#34;</span>,data.table=<span style="color:#fff;font-weight:bold">FALSE</span>)
</span></span><span style="display:flex;"><span>col_meta &lt;- read_gctx_meta(<span style="color:#0ff;font-weight:bold">&#34;gctx/level5_beta_trt_sh_n238351x12328.gctx&#34;</span>, 
</span></span><span style="display:flex;"><span>						   dim=<span style="color:#0ff;font-weight:bold">&#34;col&#34;</span>)
</span></span><span style="display:flex;"><span>table(col_meta[,<span style="color:#0ff;font-weight:bold">&#34;id&#34;</span>] %in% sig_info[,<span style="color:#0ff;font-weight:bold">&#34;sig_id&#34;</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   TRUE</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 238351</span>
</span></span><span style="display:flex;"><span>t(sig_sub[1,])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#                              373</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># bead_batch                   &#34;b7&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># nearest_dose                 NA</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_dose                    NA</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_dose_unit               &#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_idose                   &#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_itime                   &#34;96 h&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_time                    &#34;96&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_time_unit               &#34;h&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># cell_mfc_name                &#34;PC3&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_mfc_id                  &#34;TRCN0000350275&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># nsample                      &#34;2&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># cc_q75                       &#34;0.43&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># ss_ngene                     &#34;74&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># tas                          &#34;0.180377&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pct_self_rank_q25            &#34;0.134953&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># wt                           &#34;\&#34;\&#34;\&#34;\&#34;\&#34;\&#34;\&#34;\&#34;\&#34;\&#34;\&#34;\&#34;\&#34;\&#34;\&#34;\&#34;\&#34;\&#34;\&#34;\&#34;\&#34;\&#34;\&#34;\&#34;\&#34;\&#34;\&#34;\&#34;\&#34;\&#34;\&#34;\&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># median_recall_rank_spearman  &#34;0&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># median_recall_rank_wtcs_50   &#34;0&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># median_recall_score_spearman &#34;0.426979&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># median_recall_score_wtcs_50  &#34;0.697757&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># batch_effect_tstat           &#34;11.81&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># batch_effect_tstat_pct       &#34;51.0192&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># is_hiq                       &#34;1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># qc_pass                      &#34;1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_id                      &#34;TRCN0000350275&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sig_id                       &#34;TAK001_PC3_96H:TRCN0000350275:-666&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_type                    &#34;trt_sh&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># cell_iname                   &#34;PC3&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># det_wells                    &#34;P11&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># det_plates                   &#34;TAK001_PC3_96H_X1_B7_DUO52HI53LO|TAK001_PC3_96H_X2_B7_DUO52HI53LO&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># distil_ids                   &#34;TAK001_PC3_96H_X1_B7_DUO52HI53LO:P11|TAK001_PC3_96H_X2_B7_DUO52HI53LO:P11&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># build_name                   NA</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># project_code                 &#34;TAK&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># cmap_name                    &#34;PIK3CA&#34; #作用对象基因</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># is_exemplar_sig              &#34;1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># is_ncs_sig                   &#34;1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># is_null_sig                  &#34;0&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>（1）其余注释同上</p>
<p>（2）此外还有其它类型干扰(over-expression、CRISPR等)；操作基本同上，不再叙述。</p>
<h2 id="二lincs">二、LINCS<a hidden class="anchor" aria-hidden="true" href="#二lincs">#</a></h2>
<h3 id="phase-1gse92742">Phase-1(<a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE92742">GSE92742</a>)<a hidden class="anchor" aria-hidden="true" href="#phase-1gse92742">#</a></h3>
<h4 id="1差异表达矩阵-2">1、差异表达矩阵<a hidden class="anchor" aria-hidden="true" href="#1差异表达矩阵-2">#</a></h4>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span><span style="color:#007f7f">###根据行列id序号提取指定的差异表达矩阵</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">###行名表示基因名；列名表示实验id名</span>
</span></span><span style="display:flex;"><span>gctx_demo = parse_gctx(<span style="color:#0ff;font-weight:bold">&#34;phase1/GSE92742_Broad_LINCS_Level5_COMPZ.MODZ_n473647x12328.gctx&#34;</span>, 
</span></span><span style="display:flex;"><span>                       cid=<span style="color:#ff0;font-weight:bold">1</span>:<span style="color:#ff0;font-weight:bold">2</span>, rid=<span style="color:#ff0;font-weight:bold">1</span>:<span style="color:#ff0;font-weight:bold">2</span>)
</span></span><span style="display:flex;"><span>gctx_demo@mat
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#      CPC005_A375_6H:BRD-A85280935-003-01-7:10</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 5720                                0.7737690</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 466                                -0.8184680</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#      CPC005_A375_6H:BRD-A07824748-001-02-6:10</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 5720                               -0.6455861</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 466                                -0.8107487</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">###gctx文件里没有更多的注释信息</span>
</span></span><span style="display:flex;"><span>gctx_demo@rdesc
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#    id</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#1 5720</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#2  466</span>
</span></span><span style="display:flex;"><span>gctx_demo@cdesc
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#                                        id</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#1 CPC005_A375_6H:BRD-A85280935-003-01-7:10</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#2 CPC005_A375_6H:BRD-A07824748-001-02-6:10</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>由于gctx文件太大，可根据下面的注释信息，仅仅提取部分感兴趣的差异表达矩阵。</p></blockquote>
<h4 id="2meta注释信息-2">2、meta注释信息<a hidden class="anchor" aria-hidden="true" href="#2meta注释信息-2">#</a></h4>
<h5 id="21-实验行注释基本信息">2.1 实验（行）注释&ndash;基本信息<a hidden class="anchor" aria-hidden="true" href="#21-实验行注释基本信息">#</a></h5>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>sig_info = data.table::fread(<span style="color:#0ff;font-weight:bold">&#34;phase1/Fine_phase1_sig_info_473647.csv&#34;</span>,
</span></span><span style="display:flex;"><span>                             data.table = <span style="color:#fff;font-weight:bold">F</span>)
</span></span><span style="display:flex;"><span>col_meta = read_gctx_meta(<span style="color:#0ff;font-weight:bold">&#34;phase1/GSE92742_Broad_LINCS_Level5_COMPZ.MODZ_n473647x12328.gctx&#34;</span>, 
</span></span><span style="display:flex;"><span>                           dim=<span style="color:#0ff;font-weight:bold">&#34;col&#34;</span>)
</span></span><span style="display:flex;"><span>identical(col_meta$id, sig_info$sig_id)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># [1] TRUE</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>t(sig_info[1,])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#                 [,1]                                                                                                            </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sig_id         &#34;CPC005_A375_6H:BRD-A85280935-003-01-7:10&#34;   ##实验ID                                                                   </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_id        &#34;BRD-A85280935&#34;    ##干扰方法ID</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_iname     &#34;quinpirole&#34;       ##干扰物命名(化合物或者基因名)                                                                                             </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_type      &#34;trt_cp&#34;           ##干扰类型(化合物/基因敲除、过表达)                                                                                            </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># cell_id        &#34;A375&#34;             ##细胞系名                                                                                           </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_dose      &#34;10.0&#34;             ##剂量                                                                                             </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_dose_unit &#34;µM&#34;               ##剂量                                                                                             </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_idose     &#34;10 µM&#34;            ##剂量                                                                                             </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_time      &#34;6&#34;                ##干扰时间                                                                                             </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_time_unit &#34;h&#34;                ##干扰时间                                                                                             </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_itime     &#34;6 h&#34;              ##干扰时间                                                                                             </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># distil_id      &#34;CPC005_A375_6H_X1_B3_DUO52HI53LO:K06|CPC005_A375_6H_X2_B3_DUO52HI53LO:K06|CPC005_A375_6H_X3_B3_DUO52HI53LO:K06&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>table(sig_info$pert_type)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#      ctl_untrt   ctl_untrt.cns      ctl_vector  ctl_vector.cns     ctl_vehicle</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#            588              30            6826             137           14423</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#ctl_vehicle.cns          trt_cp         trt_lig          trt_oe      trt_oe.mut</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#             61          205034            8256           22205               6</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#         trt_sh      trt_sh.cgs      trt_sh.css</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#         154993           36720           24368</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="22-实验行注释实验质量信息">2.2 实验（行）注释&ndash;实验质量信息<a hidden class="anchor" aria-hidden="true" href="#22-实验行注释实验质量信息">#</a></h5>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>sig_metrics = data.table::fread(<span style="color:#0ff;font-weight:bold">&#34;phase1/phase1_sig_metrcs.csv&#34;</span>,
</span></span><span style="display:flex;"><span>                             data.table = <span style="color:#fff;font-weight:bold">F</span>)
</span></span><span style="display:flex;"><span>col_meta = read_gctx_meta(<span style="color:#0ff;font-weight:bold">&#34;phase1/GSE92742_Broad_LINCS_Level5_COMPZ.MODZ_n473647x12328.gctx&#34;</span>, 
</span></span><span style="display:flex;"><span>                           dim=<span style="color:#0ff;font-weight:bold">&#34;col&#34;</span>)
</span></span><span style="display:flex;"><span>sig_metrics = sig_metrics[match(col_meta$id, sig_metrics$sig_id),]
</span></span><span style="display:flex;"><span>identical(col_meta$id, sig_metrics$sig_id)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># [1] TRUE</span>
</span></span><span style="display:flex;"><span>t(sig_metrics[1,])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#                        53349</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sig_id                 &#34;CPC005_A375_6H:BRD-A85280935-003-01-7:10&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_id                &#34;BRD-A85280935&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_iname             &#34;quinpirole&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_type              &#34;trt_cp&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># distil_cc_q75          &#34;0.11&#34;         # 重复相同实验的结果相似度指标</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># distil_ss              &#34;2.84895&#34;      # 干扰影响强度指标</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># ngenes_modulated_up_lm &#34;18&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># ngenes_modulated_dn_lm &#34;15&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># tas                    &#34;0.101169&#34;     # 综合cc_q75与ss的评价指标结果</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pct_self_rank_q25      &#34;7.6087&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># is_exemplar            &#34;0&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># distil_nsample         &#34;3&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="23-实验行注释干扰物与细胞系">2.3 实验（行）注释&ndash;干扰物与细胞系<a hidden class="anchor" aria-hidden="true" href="#23-实验行注释干扰物与细胞系">#</a></h5>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span><span style="color:#007f7f">###通过pert_id与前面的信息相关联</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#(1)干扰物注释：主要针对化合物类干扰实验，提供化合物的CID等信息</span>
</span></span><span style="display:flex;"><span>pert_info = data.table::fread(<span style="color:#0ff;font-weight:bold">&#34;phase1/phase1_pert_info.csv&#34;</span>)
</span></span><span style="display:flex;"><span>t(pert_info[1,])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#                   [,1]    </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># V1               &#34;1&#34;     </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_id          &#34;56582&#34; </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_iname       &#34;AKT2&#34;  </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_type        &#34;trt_oe&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># is_touchstone    &#34;0&#34;     </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># inchi_key_prefix &#34;-666&#34;  </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># inchi_key        &#34;-666&#34;  </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># canonical_smiles &#34;-666&#34;  </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pubchem_cid      &#34;-666&#34; </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#(2)细胞系注释：例如是否为肿瘤细胞系，源自那个部位等</span>
</span></span><span style="display:flex;"><span>cell_info = data.table::fread(<span style="color:#0ff;font-weight:bold">&#34;phase1/phase1_cell_info.csv&#34;</span>)
</span></span><span style="display:flex;"><span>t(cell_info[1,])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#                         [,1]                </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># cell_id                 &#34;A375&#34;              </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># cell_type               &#34;cell line&#34;         </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># base_cell_id            &#34;A375&#34;              </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># precursor_cell_id       &#34;-666&#34;              </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># modification            &#34;-666&#34;              </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sample_type             &#34;tumor&#34;             </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># primary_site            &#34;skin&#34;              </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># subtype                 &#34;malignant melanoma&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># original_growth_pattern &#34;adherent&#34;          </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># provider_catalog_id     &#34;CRL-1619&#34;          </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># original_source_vendor  &#34;ATCC&#34;              </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># donor_age               &#34;54&#34;                </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># donor_sex               &#34;F&#34;                 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># donor_ethnicity         &#34;-666&#34;  </span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="24-实验列注释基因信息">2.4 实验（列）注释&ndash;基因信息<a hidden class="anchor" aria-hidden="true" href="#24-实验列注释基因信息">#</a></h5>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>gene_info = data.table::fread(<span style="color:#0ff;font-weight:bold">&#34;phase1/Fine_phase1_gene_info_12328.csv&#34;</span>,
</span></span><span style="display:flex;"><span>                              data.table = <span style="color:#fff;font-weight:bold">F</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>row_meta &lt;- read_gctx_meta(<span style="color:#0ff;font-weight:bold">&#34;phase1/GSE92742_Broad_LINCS_Level5_COMPZ.MODZ_n473647x12328.gctx&#34;</span>, dim=<span style="color:#0ff;font-weight:bold">&#34;row&#34;</span>)
</span></span><span style="display:flex;"><span>identical(as.integer(row_meta$id), gene_info$pr_gene_id)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># [1] TRUE</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>dim(gene_info)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># [1] 12328     5</span>
</span></span><span style="display:flex;"><span>t(gene_info[1,])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#                 1                             </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pr_gene_id     &#34;5720&#34;                          </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pr_gene_symbol &#34;PSME1&#34;                         </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pr_gene_title  &#34;proteasome activator subunit 1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pr_is_lm       &#34;1&#34;        # landmark    978                         </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pr_is_bing     &#34;1&#34;        # landmark + best inferred gene   10174</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="phase-2gse70138">Phase-2(<a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE70138">GSE70138</a>)<a hidden class="anchor" aria-hidden="true" href="#phase-2gse70138">#</a></h3>
<h4 id="1差异表达矩阵-3">1、差异表达矩阵<a hidden class="anchor" aria-hidden="true" href="#1差异表达矩阵-3">#</a></h4>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span><span style="color:#007f7f">###根据行列id序号提取指定的差异表达矩阵</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">###行名表示基因名；列名表示实验id名</span>
</span></span><span style="display:flex;"><span>gctx_demo = parse_gctx(<span style="color:#0ff;font-weight:bold">&#34;phase2/GSE70138_Broad_LINCS_Level5_COMPZ_n118050x12328_2017-03-06.gctx&#34;</span>, 
</span></span><span style="display:flex;"><span>                       cid=<span style="color:#ff0;font-weight:bold">1</span>:<span style="color:#ff0;font-weight:bold">2</span>, rid=<span style="color:#ff0;font-weight:bold">1</span>:<span style="color:#ff0;font-weight:bold">2</span>)
</span></span><span style="display:flex;"><span>gctx_demo@mat
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#     REP.A001_A375_24H:A03 REP.A001_A375_24H:A04</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#780              4.2641425            -0.3822108</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#7849             0.0572492             0.3043132</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="2meta注释信息-3">2、meta注释信息<a hidden class="anchor" aria-hidden="true" href="#2meta注释信息-3">#</a></h4>
<h5 id="21-实验行注释基本信息-1">2.1 实验（行）注释&ndash;基本信息<a hidden class="anchor" aria-hidden="true" href="#21-实验行注释基本信息-1">#</a></h5>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>sig_info = data.table::fread(<span style="color:#0ff;font-weight:bold">&#34;phase2/Fine_phase2_sig_info_118050.csv&#34;</span>,
</span></span><span style="display:flex;"><span>                             data.table = <span style="color:#fff;font-weight:bold">F</span>)
</span></span><span style="display:flex;"><span>col_meta = read_gctx_meta(<span style="color:#0ff;font-weight:bold">&#34;phase2/GSE70138_Broad_LINCS_Level5_COMPZ_n118050x12328_2017-03-06.gctx&#34;</span>, 
</span></span><span style="display:flex;"><span>                           dim=<span style="color:#0ff;font-weight:bold">&#34;col&#34;</span>)
</span></span><span style="display:flex;"><span>identical(col_meta$id, sig_info$sig_id)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># [1] TRUE</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>t(sig_info[1,])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#            1</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sig_id     &#34;REP.A001_A375_24H:A03&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_id    &#34;DMSO&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_iname &#34;DMSO&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_type  &#34;ctl_vehicle&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># cell_id    &#34;A375&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_idose &#34;-666&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_itime &#34;24 h&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># distil_id  &#34;REP.A001_A375_24H_X1_B22:A03|REP.A001_A375_24H_X2_B22:A03|REP.A001_A375_24H_X3_B22:A03&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>table(sig_info$pert_type)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#  ctl_untrt  ctl_vector ctl_vehicle      trt_cp     trt_xpr</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#         88         209        6467      107404        3882</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="22-实验行注释实验质量信息-1">2.2 实验（行）注释&ndash;实验质量信息<a hidden class="anchor" aria-hidden="true" href="#22-实验行注释实验质量信息-1">#</a></h5>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>sig_metrics = data.table::fread(<span style="color:#0ff;font-weight:bold">&#34;phase2/phase2_sig_metrics.csv&#34;</span>,
</span></span><span style="display:flex;"><span>                             data.table = <span style="color:#fff;font-weight:bold">F</span>)
</span></span><span style="display:flex;"><span>col_meta = read_gctx_meta(<span style="color:#0ff;font-weight:bold">&#34;phase1/GSE92742_Broad_LINCS_Level5_COMPZ.MODZ_n473647x12328.gctx&#34;</span>, 
</span></span><span style="display:flex;"><span>                           dim=<span style="color:#0ff;font-weight:bold">&#34;col&#34;</span>)
</span></span><span style="display:flex;"><span>sig_metrics = sig_metrics[match(col_meta$id, sig_metrics$sig_id),]
</span></span><span style="display:flex;"><span>identical(col_meta$id, sig_metrics$sig_id)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># [1] TRUE</span>
</span></span><span style="display:flex;"><span>t(sig_metrics[1,])
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="23-实验行注释干扰物与细胞系-1">2.3 实验（行）注释&ndash;干扰物与细胞系<a hidden class="anchor" aria-hidden="true" href="#23-实验行注释干扰物与细胞系-1">#</a></h5>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span><span style="color:#007f7f">###通过pert_id与前面的信息相关联</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#(1)干扰物注释：主要针对化合物类干扰实验，提供化合物的CID等信息</span>
</span></span><span style="display:flex;"><span>pert_info = data.table::fread(<span style="color:#0ff;font-weight:bold">&#34;phase2/phase2_pert_info.csv&#34;</span>)
</span></span><span style="display:flex;"><span>t(pert_info[1,])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#                  [,1]</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_id          &#34;BRD-K70792160&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># canonical_smiles &#34;CCN(CC)CCCCN1c2ccccc2Oc2ccc(Cl)cc12&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># inchi_key        &#34;GYBXAGDWMCJZJK-UHFFFAOYSA-N&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_iname       &#34;10-DEBC&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pert_type        &#34;trt_cp&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pubchem_id       &#34;10521421&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#(2)细胞系注释：例如是否为肿瘤细胞系，源自那个部位等</span>
</span></span><span style="display:flex;"><span>cell_info = data.table::fread(<span style="color:#0ff;font-weight:bold">&#34;phase2/phase2_cell_info.csv&#34;</span>)
</span></span><span style="display:flex;"><span>t(cell_info[1,])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#                         [,1]</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># cell_id                 &#34;A375&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># cell_type               &#34;cell line&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># base_cell_id            &#34;A375&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># precursor_cell_id       &#34;-666&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># modification            &#34;-666&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sample_type             &#34;tumor&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># primary_site            &#34;skin&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># subtype                 &#34;malignant melanoma&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># original_growth_pattern &#34;adherent&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># provider_catalog_id     &#34;CRL-1619&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># original_source_vendor  &#34;ATCC&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># donor_age               &#34;54&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># donor_sex               &#34;F&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># donor_ethnicity         &#34;-666&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="24-实验列注释基因信息-1">2.4 实验（列）注释&ndash;基因信息<a hidden class="anchor" aria-hidden="true" href="#24-实验列注释基因信息-1">#</a></h5>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>gene_info = data.table::fread(<span style="color:#0ff;font-weight:bold">&#34;phase2/Fine_phase1_gene_info_12328.csv&#34;</span>,
</span></span><span style="display:flex;"><span>                              data.table = <span style="color:#fff;font-weight:bold">F</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>row_meta &lt;- read_gctx_meta(<span style="color:#0ff;font-weight:bold">&#34;phase2/GSE92742_Broad_LINCS_Level5_COMPZ.MODZ_n473647x12328.gctx&#34;</span>, dim=<span style="color:#0ff;font-weight:bold">&#34;row&#34;</span>)
</span></span><span style="display:flex;"><span>identical(as.integer(row_meta$id), gene_info$pr_gene_id)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># [1] TRUE</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>dim(gene_info)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># [1] 12328     5</span>
</span></span><span style="display:flex;"><span>t(gene_info[1,])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#                 1                             </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pr_gene_id     &#34;5720&#34;                          </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pr_gene_symbol &#34;PSME1&#34;                         </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pr_gene_title  &#34;proteasome activator subunit 1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pr_is_lm       &#34;1&#34;        # landmark    978                         </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pr_is_bing     &#34;1&#34;        # landmark + best inferred gene   10174</span>
</span></span></code></pre></td></tr></table>
</div>
</div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://lishensuo.github.io/en/tags/%E5%8C%96%E5%90%88%E7%89%A9/">化合物</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://lishensuo.github.io/en/posts/basic/151%E6%96%87%E7%8C%AE--%E5%9F%BA%E4%BA%8Eppi%E7%BD%91%E7%BB%9C%E7%9A%84%E9%9D%B6%E7%82%B9%E7%BE%A4%E8%B7%9D%E7%A6%BB%E9%A2%84%E6%B5%8B%E8%8D%AF%E7%89%A9%E7%BB%84%E5%90%88/">
    <span class="title">« Prev Page</span>
    <br>
    <span>基于PPI网络的靶点群距离预测药物组合</span>
  </a>
  <a class="next" href="https://lishensuo.github.io/en/posts/basic/152%E6%96%87%E7%8C%AE--%E7%9F%A9%E9%98%B5%E7%9B%B8%E4%BC%BC%E6%80%A7%E8%AE%A1%E7%AE%97%E6%A0%B7%E6%9C%AC%E9%80%9A%E8%B7%AF%E4%B8%80%E8%87%B4%E6%80%A7/">
    <span class="title">Next Page »</span>
    <br>
    <span>矩阵相似性计算样本通路一致性</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2025 <a href="https://lishensuo.github.io/en/">Li&#39;s Bioinfo-Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
		<br/>您是本站第 <span id="busuanzi_value_site_uv"></span> 位访问者，总浏览量为 <span id="busuanzi_value_site_pv"></span> 次
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>

<script type="text/javascript"
async
src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
MathJax.Hub.Config({
tex2jax: {
inlineMath: [['$','$'], ['\\(','\\)']],
displayMath: [['$$','$$'], ['\[\[','\]\]']],
processEscapes: true,
processEnvironments: true,
skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
TeX: { equationNumbers: { autoNumber: "AMS" },
extensions: ["AMSmath.js", "AMSsymbols.js"] }
}
});

MathJax.Hub.Queue(function() {



var all = MathJax.Hub.getAllJax(), i;
for(i = 0; i < all.length; i += 1) {
all[i].SourceElement().parentNode.className += ' has-jax';
}
});
</script>

<style>
code.has-jax {
font: inherit;
font-size: 100%;
background: inherit;
border: inherit;
color: #515151;
}
</style></body>
</html>
