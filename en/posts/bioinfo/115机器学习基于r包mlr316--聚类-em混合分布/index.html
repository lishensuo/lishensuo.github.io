<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">

<link rel="icon" href="/favicon.ico" type="image/x-icon"> 
<title>机器学习基于R包mlr3(16)--聚类-EM混合分布 | Li&#39;s Bioinfo-Blog</title>
<meta name="keywords" content="机器学习, mlr3">
<meta name="description" content="1、算法与工具简介
1.1 EM算法
EM， Expectation-Maximization 期望最大化算法
混合分布：来自两种或两种以上概率分布(高斯分布最典型)的随机数据组成的一组混合数据所形成的分布。
混合模型聚类：识别混合分布中，样本的原始分布，从而进行聚类(一种原始分布对应一个聚类)，属于软聚类。">
<meta name="author" content="Lishensuo">
<link rel="canonical" href="https://lishensuo.github.io/en/posts/bioinfo/115%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E4%BA%8Er%E5%8C%85mlr316--%E8%81%9A%E7%B1%BB-em%E6%B7%B7%E5%90%88%E5%88%86%E5%B8%83/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.9e4de5e3ba61ea358168341aa7cdf70abfaafb7c697dfe8624af3ddff9a35c2f.css" integrity="sha256-nk3l47ph6jWBaDQap833Cr&#43;q&#43;3xpff6GJK893/mjXC8=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.555af97124d54bb1457985dd081b8f5616a48103aafeb30ac89fde835d65aa6c.js" integrity="sha256-VVr5cSTVS7FFeYXdCBuPVhakgQOq/rMKyJ/eg11lqmw="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://lishensuo.github.io/img/Q.gif">
<link rel="icon" type="image/png" sizes="16x16" href="https://lishensuo.github.io/img/Q.gif">
<link rel="icon" type="image/png" sizes="32x32" href="https://lishensuo.github.io/img/Q.gif">
<link rel="apple-touch-icon" href="https://lishensuo.github.io/Q.gif">
<link rel="mask-icon" href="https://lishensuo.github.io/Q.gif">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://lishensuo.github.io/en/posts/bioinfo/115%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E4%BA%8Er%E5%8C%85mlr316--%E8%81%9A%E7%B1%BB-em%E6%B7%B7%E5%90%88%E5%88%86%E5%B8%83/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="机器学习基于R包mlr3(16)--聚类-EM混合分布" />
<meta property="og:description" content="1、算法与工具简介
1.1 EM算法
EM， Expectation-Maximization 期望最大化算法
混合分布：来自两种或两种以上概率分布(高斯分布最典型)的随机数据组成的一组混合数据所形成的分布。
混合模型聚类：识别混合分布中，样本的原始分布，从而进行聚类(一种原始分布对应一个聚类)，属于软聚类。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lishensuo.github.io/en/posts/bioinfo/115%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E4%BA%8Er%E5%8C%85mlr316--%E8%81%9A%E7%B1%BB-em%E6%B7%B7%E5%90%88%E5%88%86%E5%B8%83/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-06-18T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2022-06-18T00:00:00&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="机器学习基于R包mlr3(16)--聚类-EM混合分布"/>
<meta name="twitter:description" content="1、算法与工具简介
1.1 EM算法
EM， Expectation-Maximization 期望最大化算法
混合分布：来自两种或两种以上概率分布(高斯分布最典型)的随机数据组成的一组混合数据所形成的分布。
混合模型聚类：识别混合分布中，样本的原始分布，从而进行聚类(一种原始分布对应一个聚类)，属于软聚类。"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "分类",
      "item": "https://lishensuo.github.io/en/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "📖 生信数据分析--分析流程，工具包等",
      "item": "https://lishensuo.github.io/en/posts/bioinfo/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "机器学习基于R包mlr3(16)--聚类-EM混合分布",
      "item": "https://lishensuo.github.io/en/posts/bioinfo/115%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E4%BA%8Er%E5%8C%85mlr316--%E8%81%9A%E7%B1%BB-em%E6%B7%B7%E5%90%88%E5%88%86%E5%B8%83/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "机器学习基于R包mlr3(16)--聚类-EM混合分布",
  "name": "机器学习基于R包mlr3(16)--聚类-EM混合分布",
  "description": "1、算法与工具简介 1.1 EM算法 EM， Expectation-Maximization 期望最大化算法\n混合分布：来自两种或两种以上概率分布(高斯分布最典型)的随机数据组成的一组混合数据所形成的分布。\n混合模型聚类：识别混合分布中，样本的原始分布，从而进行聚类(一种原始分布对应一个聚类)，属于软聚类。\n",
  "keywords": [
    "机器学习", "mlr3"
  ],
  "articleBody": "1、算法与工具简介 1.1 EM算法 EM， Expectation-Maximization 期望最大化算法\n混合分布：来自两种或两种以上概率分布(高斯分布最典型)的随机数据组成的一组混合数据所形成的分布。\n混合模型聚类：识别混合分布中，样本的原始分布，从而进行聚类(一种原始分布对应一个聚类)，属于软聚类。\n假设一组混合分布的30个数据，虚线为混合分布的概率密度。混合模型聚类的目的就是找到其中哪些样本属于红色分布类，哪些样本属于绿色分布类。\n（已知：其中10个来自红色正态分布，20个来自绿色正态分布。在计算时是不知道这一信息）\n后验概率(posterior probability)：样本属于某种特定分布的概率\n似然概率(likelihood probability)：在某种特定分布中观察到样本的概率\n先验概率(prior probability)：在混合样本中，属于某种特定分布的样本数目\n全概率：在混合样本中的概率密度\n根据贝叶斯公式 $$ 后验概率 = \\frac{似然概率×先验概率}{全概率} $$\n某一样本的全概率等于：红色正态分布中出现该样本的概率加上绿色正态分布中出现该样本的概率。 $$ x_i = p(x_i|k_红)×p(k_红) + p(x_i|k_绿)×p(k_绿) $$\n样本属于红色正态分布的概率 $$ p(k_{红}|x_i) = \\frac{p(x_i|k_红)×p(k_红)}{x_i} $$\n样本属于绿色正态分布的概率 $$ p(k_{绿}|x_i) = \\frac{p(x_i|k_绿)×p(k_绿)}{x_i} $$\n（1）首先假定混合分布中样本来自几种原始正态分布，这里假设为2。\n（2）初始化每种正态分布的特征参数(均值、方差)与先验概率(属于两种分布的样本比例)。\n（3）根据每种分布当前的特征参数，计算两种分布对于每个样本的似然概率。\n（4）参考贝叶斯公式计算出每个样本对于每种分布的后验概率。\n（5）根据每个样本属于每种分布的后验概率\n更新每种分布的参数(均值与方差)，以提高似然概率值； 简单来说将样本的后验概率作为权重，使得更新后的分布更接近“属于”(higher posterior probability)它的样本特征。 更新先验概率 如果有很多的样本对于特征分布有较高的后验概率，将具有较高的先验概率。 （6）重复步骤（3），如果总体似然概率的增幅小于预设的阈值(收敛)，则结束；否则继续执行步骤4、5、6，不断更新高斯分布，提高似然概率(最大化)。\n参考下图，EM算法主要分为两步：Expectation Step(对应上述步骤3、4)；Maximization Step(对应上述步骤5)\n1.2 mclust包 mclust包是基于EM算法实现混合分布聚类的常用R包，现在已经更新的5.4.10。\n官方示例教程：https://cran.r-project.org/web/packages/mclust/vignettes/mclust.html\n（1）在具体计算中，每一种Mclust模型结果由聚类数量与混合类型两个参数决定。其中混合类型表示：对于不同类型混合的高斯分布，使用3个字母组合表示14种特征的混合高斯分布。\n第一个字母：（1）E表示等体积，V表示不同体积； 第二个字母：（1）E表示等长径比，V表示不同长径比，I表示球形； 第三个字母：（1）I表示与轴方向正交，E表示不正交，V表示每个分布方向不同。 （2）对于不同Mclust模型的结果，可通过BIC(贝叶斯信息准则)指标进行比较。在模型的似然概率结果的基础上，进一步考虑模型的参数。如果模型中包含太多的参数，BIC就会对模型进行惩罚。\n简单来说在Mclust()结果中，特定模型的BIC指标越小，表示该模型性能越好。 2、R实操 2.1 多变量数据 （1）基础操作 示例数据：100张真钞与100张假钞的特征数据 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 library(mclust) data(banknote, package = \"mclust\") table(banknote$Status) # counterfeit genuine # 100 100 swissTib \u003c- select(banknote, -Status) #仅保留特征数据 dim(swissTib) # [1] 200 6 head(swissTib) # Length Left Right Bottom Top Diagonal # 1 214.8 131.0 131.1 9.0 9.7 141.0 # 2 214.6 129.7 129.7 8.1 9.5 141.7 # 3 214.8 129.7 129.7 8.7 9.6 142.2 # 4 214.8 129.7 129.6 7.5 10.4 142.0 # 5 215.0 129.6 129.7 10.4 7.7 141.8 # 6 215.7 130.8 130.5 9.0 10.1 141.4 在不设置其它参数的情况下，Mclust()默认计算1至9种聚类的14种混合类型的BIC指标结果； 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 swissMclust \u003c- Mclust(swissTib) ##(1) 结果概况 summary(swissMclust) # ---------------------------------------------------- # Gaussian finite mixture model fitted by EM algorithm # ---------------------------------------------------- # # Mclust VVE (ellipsoidal, equal orientation) model with 3 components: # # log-likelihood n df BIC ICL # -663.3814 200 53 -1607.574 -1607.71 # # Clustering table: # 1 2 3 # 18 98 84 #具体展示每种分布模型的分布特征 summary(swissMclust, parameters = TRUE) ##(2) 所有模型的BIC结果 dim(swissMclust$BIC) # [1] 9 14 ##(3) 最优模型的特征 swissMclust$G # [1] 3 swissMclust$modelName # [1] \"VVE\" ##(4) 模型计算结果可视化 #所有模型组合的BIC指标 plot(swissMclust, what = \"BIC\") # plot(swissMclust, what = \"classification\") # plot(swissMclust, what = \"uncertainty\") # plot(swissMclust, what = \"density\") （2）相关参数设置 限定聚类数量或者混合类型 1 2 3 4 5 6 7 8 9 10 11 12 swissMclust2 \u003c- Mclust(swissTib, G=1:3, modelNames = \"VVE\") summary(swissMclust2) swissMclust2$BIC # Bayesian Information Criterion (BIC): # VVE # 1 -1978.941 # 2 -1721.311 # 3 -1607.574 # # Top 3 models based on the BIC criterion: # VVE,3 VVE,2 VVE,1 # -1607.574 -1721.311 -1978.941 初始化设置 1 2 3 4 5 6 hc1 \u003c- hc(swissTib, modelName = \"VVV\", use = \"SVD\") # hc2 \u003c- hc(swissTib, modelName = \"VVV\", use = \"VARS\") # hc3 \u003c- hc(swissTib, modelName = \"EEE\", use = \"SVD\") # swissMclust \u003c- Mclust(swissTib, initialization = list(hcPairs = hc1)) #default swissMclust \u003c- Mclust(swissTib, initialization = list(hcPairs = hc2)) summary(swissMclust) （3）Bootstrap法验证 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 bootClust \u003c- MclustBootstrap(swissMclust) summary(bootClust, what = \"ci\") # summary(bootClust, what = \"se\") # plot(bootClust, what = \"mean\") # plot(bootClust, what = \"pro\") # ---------------------------------------------------------- # Resampling confidence intervals # ---------------------------------------------------------- # Model = VVE # Num. of mixture components = 3 # Replications = 999 # Type = nonparametric bootstrap # Confidence level = 0.95 # # Mixing probabilities: # 1 2 3 # 2.5% 0.05396204 0.4200456 0.3549896 # 97.5% 0.13491555 0.5550405 0.4852951 # .... 2.2 单变量 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 data(acidity) str(acidity) # num [1:155] 2.93 3.91 3.73 3.69 3.82 ... acidityMclust \u003c- Mclust(acidity) summary(acidityMclust, parameters = TRUE) # ---------------------------------------------------- # Gaussian finite mixture model fitted by EM algorithm # ---------------------------------------------------- # # Mclust E (univariate, equal variance) model with 2 components: # # log-likelihood n df BIC ICL # -185.9493 155 4 -392.0723 -398.5554 # # Clustering table: # 1 2 # 98 57 # # Mixing probabilities: # 1 2 # 0.6233595 0.3766405 # # Means: # 1 2 # 4.370946 6.320153 # # Variances: # 1 2 # 0.1863702 0.1863702 table(acidityMclust$classification) # 1 2 # 98 57 plot(acidityMclust, what = \"density\") ",
  "wordCount" : "2237",
  "inLanguage": "en",
  "datePublished": "2022-06-18T00:00:00Z",
  "dateModified": "2022-06-18T00:00:00Z",
  "author":[{
    "@type": "Person",
    "name": "Lishensuo"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://lishensuo.github.io/en/posts/bioinfo/115%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E4%BA%8Er%E5%8C%85mlr316--%E8%81%9A%E7%B1%BB-em%E6%B7%B7%E5%90%88%E5%88%86%E5%B8%83/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Li's Bioinfo-Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://lishensuo.github.io/img/Q.gif"
    }
  }
}
</script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://lishensuo.github.io/en/" accesskey="h" title="Li&#39;s Bioinfo-Blog (Alt + H)">Li&#39;s Bioinfo-Blog</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                </ul>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://lishensuo.github.io/en/" title="主页">
                    <span>主页</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/posts" title="分类">
                    <span>分类</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/tags" title="标签">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/archives/" title="归档">
                    <span>归档</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/about" title="关于">
                    <span>关于</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/search" title="搜索 (Alt &#43; /)" accesskey=/>
                    <span>搜索</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://lishensuo.github.io/en/">Home</a>&nbsp;»&nbsp;<a href="https://lishensuo.github.io/en/posts/">分类</a>&nbsp;»&nbsp;<a href="https://lishensuo.github.io/en/posts/bioinfo/">📖 生信数据分析--分析流程，工具包等</a></div>
    <h1 class="post-title">
      机器学习基于R包mlr3(16)--聚类-EM混合分布
    </h1>
    <div class="post-meta">













Create:&amp;nbsp;&lt;span title=&#39;2022-06-18 00:00:00 &#43;0000 UTC&#39;&gt;2022-06-18&lt;/span&gt;&amp;nbsp;|&amp;nbsp;Update:&amp;nbsp;2022-06-18&amp;nbsp;|&amp;nbsp;Words:&amp;nbsp;2237&amp;nbsp;|&amp;nbsp;5 min&amp;nbsp;|&amp;nbsp;Lishensuo

|  Viewers: <span id="busuanzi_value_page_pv"></span> 
	  
    </div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">Table of Contents</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#1%e7%ae%97%e6%b3%95%e4%b8%8e%e5%b7%a5%e5%85%b7%e7%ae%80%e4%bb%8b" aria-label="1、算法与工具简介">1、算法与工具简介</a><ul>
                            
                    <li>
                        <a href="#11-em%e7%ae%97%e6%b3%95" aria-label="1.1 EM算法">1.1 EM算法</a></li>
                    <li>
                        <a href="#12-mclust%e5%8c%85" aria-label="1.2 mclust包">1.2 mclust包</a></li></ul>
                    </li>
                    <li>
                        <a href="#2r%e5%ae%9e%e6%93%8d" aria-label="2、R实操">2、R实操</a><ul>
                            
                    <li>
                        <a href="#21-%e5%a4%9a%e5%8f%98%e9%87%8f%e6%95%b0%e6%8d%ae" aria-label="2.1 多变量数据">2.1 多变量数据</a><ul>
                            
                    <li>
                        <a href="#1%e5%9f%ba%e7%a1%80%e6%93%8d%e4%bd%9c" aria-label="（1）基础操作">（1）基础操作</a></li>
                    <li>
                        <a href="#2%e7%9b%b8%e5%85%b3%e5%8f%82%e6%95%b0%e8%ae%be%e7%bd%ae" aria-label="（2）相关参数设置">（2）相关参数设置</a></li>
                    <li>
                        <a href="#3bootstrap%e6%b3%95%e9%aa%8c%e8%af%81" aria-label="（3）Bootstrap法验证">（3）Bootstrap法验证</a></li></ul>
                    </li>
                    <li>
                        <a href="#22-%e5%8d%95%e5%8f%98%e9%87%8f" aria-label="2.2 单变量">2.2 单变量</a>
                    </li>
                </ul>
                </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>


  <div class="post-content"><h1 id="1算法与工具简介">1、算法与工具简介<a hidden class="anchor" aria-hidden="true" href="#1算法与工具简介">#</a></h1>
<h2 id="11-em算法">1.1 EM算法<a hidden class="anchor" aria-hidden="true" href="#11-em算法">#</a></h2>
<p>EM， Expectation-Maximization 期望最大化算法</p>
<p>混合分布：来自两种或两种以上概率分布(高斯分布最典型)的随机数据组成的一组混合数据所形成的分布。</p>
<p>混合模型聚类：识别混合分布中，样本的原始分布，从而进行聚类(一种原始分布对应一个聚类)，属于<strong>软聚类</strong>。</p>
<img src="https://raw.githubusercontent.com/lishensuo/images/main/image-20220613223043136.png" alt="image-20220613223043136" style="zoom: 80%;" />
<p>假设一组混合分布的30个数据，虚线为混合分布的概率密度。混合模型聚类的目的就是找到其中哪些样本属于红色分布类，哪些样本属于绿色分布类。</p>
<p>（已知：其中10个来自红色正态分布，20个来自绿色正态分布。在计算时是不知道这一信息）</p>
<p>后验概率(posterior probability)：样本属于某种特定分布的概率</p>
<p>似然概率(likelihood probability)：在某种特定分布中观察到样本的概率</p>
<p>先验概率(prior probability)：在混合样本中，属于某种特定分布的样本数目</p>
<p>全概率：在混合样本中的概率密度</p>
<p>根据贝叶斯公式
$$
后验概率 = \frac{似然概率×先验概率}{全概率}
$$</p>
<ul>
<li>某一样本的全概率等于：红色正态分布中出现该样本的概率加上绿色正态分布中出现该样本的概率。</li>
</ul>
<p>$$
x_i = p(x_i|k_红)×p(k_红) + p(x_i|k_绿)×p(k_绿)
$$</p>
<ul>
<li>样本属于红色正态分布的概率</li>
</ul>
<p>$$
p(k_{红}|x_i) = \frac{p(x_i|k_红)×p(k_红)}{x_i}
$$</p>
<ul>
<li>样本属于绿色正态分布的概率</li>
</ul>
<p>$$
p(k_{绿}|x_i) = \frac{p(x_i|k_绿)×p(k_绿)}{x_i}
$$</p>
<p>（1）首先假定混合分布中样本来自几种原始正态分布，这里假设为2。</p>
<p>（2）初始化每种正态分布的特征参数(均值、方差)与先验概率(属于两种分布的样本比例)。</p>
<p>（3）根据每种分布当前的特征参数，计算两种分布对于每个样本的<strong>似然概率</strong>。</p>
<p>（4）参考贝叶斯公式计算出每个样本对于每种分布的<strong>后验概率</strong>。</p>
<p>（5）根据每个样本属于每种分布的后验概率</p>
<ul>
<li>更新每种分布的参数(均值与方差)，以提高似然概率值；
<ul>
<li>简单来说将样本的后验概率作为权重，使得更新后的分布更接近“属于”(higher posterior probability)它的样本特征。</li>
</ul>
</li>
<li>更新先验概率
<ul>
<li>如果有很多的样本对于特征分布有较高的后验概率，将具有较高的先验概率。</li>
</ul>
</li>
</ul>
<p>（6）重复步骤（3），如果总体似然概率的增幅小于预设的阈值(收敛)，则结束；否则继续执行步骤4、5、6，不断更新高斯分布，提高似然概率(最大化)。</p>
<blockquote>
<p>参考下图，EM算法主要分为两步：Expectation Step(对应上述步骤3、4)；Maximization  Step(对应上述步骤5)</p></blockquote>
<img src="https://raw.githubusercontent.com/lishensuo/images/main/EM21.jpg" alt="Expectation Maximization Algorithm | EM Algorithm Explained" style="zoom: 67%;" />
<h2 id="12-mclust包">1.2 mclust包<a hidden class="anchor" aria-hidden="true" href="#12-mclust包">#</a></h2>
<blockquote>
<p><code>mclust</code>包是基于EM算法实现混合分布聚类的常用R包，现在已经更新的5.4.10。</p>
<p>官方示例教程：https://cran.r-project.org/web/packages/mclust/vignettes/mclust.html</p></blockquote>
<p>（1）在具体计算中，每一种Mclust模型结果由聚类数量与混合类型两个参数决定。其中混合类型表示：对于不同类型混合的高斯分布，使用3个字母组合表示14种特征的混合高斯分布。</p>
<ul>
<li>第一个字母：（1）<strong>E</strong>表示等体积，<strong>V</strong>表示不同体积；</li>
<li>第二个字母：（1）<strong>E</strong>表示等长径比，<strong>V</strong>表示不同长径比，<strong>I</strong>表示球形；</li>
<li>第三个字母：（1）<strong>I</strong>表示与轴方向正交，<strong>E</strong>表示不正交，<strong>V</strong>表示每个分布方向不同。</li>
</ul>
<img src="https://raw.githubusercontent.com/lishensuo/images/main/image-20220618092623386.png" alt="image-20220618092623386" style="zoom: 67%;" />
<p>（2）对于不同Mclust模型的结果，可通过BIC(贝叶斯信息准则)指标进行比较。在模型的似然概率结果的基础上，进一步考虑模型的参数。如果模型中包含太多的参数，BIC就会对模型进行惩罚。</p>
<ul>
<li>简单来说在<code>Mclust()</code>结果中，特定模型的<u>BIC指标越小，表示该模型性能越好</u>。</li>
</ul>
<h1 id="2r实操">2、R实操<a hidden class="anchor" aria-hidden="true" href="#2r实操">#</a></h1>
<h2 id="21-多变量数据">2.1 多变量数据<a hidden class="anchor" aria-hidden="true" href="#21-多变量数据">#</a></h2>
<h3 id="1基础操作">（1）基础操作<a hidden class="anchor" aria-hidden="true" href="#1基础操作">#</a></h3>
<ul>
<li>示例数据：100张真钞与100张假钞的特征数据</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>library(mclust)
</span></span><span style="display:flex;"><span>data(banknote, package = <span style="color:#0ff;font-weight:bold">&#34;mclust&#34;</span>)
</span></span><span style="display:flex;"><span>table(banknote$Status)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># counterfeit     genuine </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#         100         100 </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>swissTib &lt;- select(banknote, -Status)    <span style="color:#007f7f">#仅保留特征数据</span>
</span></span><span style="display:flex;"><span>dim(swissTib)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># [1] 200   6</span>
</span></span><span style="display:flex;"><span>head(swissTib)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   Length  Left Right Bottom  Top Diagonal</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1  214.8 131.0 131.1    9.0  9.7    141.0</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 2  214.6 129.7 129.7    8.1  9.5    141.7</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 3  214.8 129.7 129.7    8.7  9.6    142.2</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 4  214.8 129.7 129.6    7.5 10.4    142.0</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 5  215.0 129.6 129.7   10.4  7.7    141.8</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 6  215.7 130.8 130.5    9.0 10.1    141.4</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>在不设置其它参数的情况下，<code>Mclust()</code>默认计算1至9种聚类的14种混合类型的BIC指标结果；</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>swissMclust &lt;- Mclust(swissTib)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(1) 结果概况</span>
</span></span><span style="display:flex;"><span>summary(swissMclust)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># ---------------------------------------------------- </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   Gaussian finite mixture model fitted by EM algorithm </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># ---------------------------------------------------- </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   Mclust VVE (ellipsoidal, equal orientation) model with 3 components: </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># log-likelihood   n df       BIC      ICL</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#      -663.3814 200 53 -1607.574 -1607.71</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Clustering table:</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   1  2  3 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#  18 98 84 </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#具体展示每种分布模型的分布特征</span>
</span></span><span style="display:flex;"><span>summary(swissMclust, parameters = <span style="color:#fff;font-weight:bold">TRUE</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2) 所有模型的BIC结果</span>
</span></span><span style="display:flex;"><span>dim(swissMclust$BIC)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># [1]  9 14</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(3) 最优模型的特征</span>
</span></span><span style="display:flex;"><span>swissMclust$G
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># [1] 3</span>
</span></span><span style="display:flex;"><span>swissMclust$modelName
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># [1] &#34;VVE&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(4) 模型计算结果可视化</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#所有模型组合的BIC指标</span>
</span></span><span style="display:flex;"><span>plot(swissMclust, what = <span style="color:#0ff;font-weight:bold">&#34;BIC&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># plot(swissMclust, what = &#34;classification&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># plot(swissMclust, what = &#34;uncertainty&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># plot(swissMclust, what = &#34;density&#34;)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://raw.githubusercontent.com/lishensuo/images/main/image-20220618101352587.png" alt="image-20220618101352587" style="zoom:50%;" />
<h3 id="2相关参数设置">（2）相关参数设置<a hidden class="anchor" aria-hidden="true" href="#2相关参数设置">#</a></h3>
<ul>
<li>限定聚类数量或者混合类型</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>swissMclust2 &lt;- Mclust(swissTib, G=<span style="color:#ff0;font-weight:bold">1</span>:<span style="color:#ff0;font-weight:bold">3</span>, modelNames = <span style="color:#0ff;font-weight:bold">&#34;VVE&#34;</span>)
</span></span><span style="display:flex;"><span>summary(swissMclust2)
</span></span><span style="display:flex;"><span>swissMclust2$BIC
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Bayesian Information Criterion (BIC): </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#         VVE</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1 -1978.941</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 2 -1721.311</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 3 -1607.574</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Top 3 models based on the BIC criterion: </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#     VVE,3     VVE,2     VVE,1 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># -1607.574 -1721.311 -1978.941 </span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>初始化设置</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>hc1 &lt;- hc(swissTib, modelName = <span style="color:#0ff;font-weight:bold">&#34;VVV&#34;</span>, use = <span style="color:#0ff;font-weight:bold">&#34;SVD&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># hc2 &lt;- hc(swissTib, modelName = &#34;VVV&#34;, use = &#34;VARS&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># hc3 &lt;- hc(swissTib, modelName = &#34;EEE&#34;, use = &#34;SVD&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># swissMclust &lt;- Mclust(swissTib, initialization = list(hcPairs = hc1))  #default</span>
</span></span><span style="display:flex;"><span>swissMclust &lt;- Mclust(swissTib, initialization = list(hcPairs = hc2))
</span></span><span style="display:flex;"><span>summary(swissMclust)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="3bootstrap法验证">（3）Bootstrap法验证<a hidden class="anchor" aria-hidden="true" href="#3bootstrap法验证">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>bootClust &lt;- MclustBootstrap(swissMclust)
</span></span><span style="display:flex;"><span>summary(bootClust, what = <span style="color:#0ff;font-weight:bold">&#34;ci&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># summary(bootClust, what = &#34;se&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># plot(bootClust, what = &#34;mean&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># plot(bootClust, what = &#34;pro&#34;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># ---------------------------------------------------------- </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   Resampling confidence intervals </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># ---------------------------------------------------------- </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   Model                      = VVE </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Num. of mixture components = 3 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Replications               = 999 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Type                       = nonparametric bootstrap </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Confidence level           = 0.95 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Mixing probabilities:</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   1         2         3</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 2.5%  0.05396204 0.4200456 0.3549896</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 97.5% 0.13491555 0.5550405 0.4852951</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># ....</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="22-单变量">2.2 单变量<a hidden class="anchor" aria-hidden="true" href="#22-单变量">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>data(acidity)
</span></span><span style="display:flex;"><span>str(acidity)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># num [1:155] 2.93 3.91 3.73 3.69 3.82 ...</span>
</span></span><span style="display:flex;"><span>acidityMclust &lt;- Mclust(acidity)
</span></span><span style="display:flex;"><span>summary(acidityMclust, parameters = <span style="color:#fff;font-weight:bold">TRUE</span>)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># ---------------------------------------------------- </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   Gaussian finite mixture model fitted by EM algorithm </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># ---------------------------------------------------- </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   Mclust E (univariate, equal variance) model with 2 components: </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   log-likelihood   n df       BIC       ICL</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#        -185.9493 155  4 -392.0723 -398.5554</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Clustering table:</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   1  2 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 98 57 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Mixing probabilities:</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#         1         2 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 0.6233595 0.3766405 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Means:</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#        1        2 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 4.370946 6.320153 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Variances:</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#         1         2 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 0.1863702 0.1863702 </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>table(acidityMclust$classification)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1  2 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 98 57</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plot(acidityMclust, what = <span style="color:#0ff;font-weight:bold">&#34;density&#34;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images/main/image-20220618103402384.png" alt="image-20220618103402384"  />
</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://lishensuo.github.io/en/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a></li>
      <li><a href="https://lishensuo.github.io/en/tags/mlr3/">Mlr3</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://lishensuo.github.io/en/posts/bioinfo/114%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E4%BA%8Er%E5%8C%85mlr315--%E8%81%9A%E7%B1%BB-%E5%B1%82%E6%AC%A1%E8%81%9A%E7%B1%BB/">
    <span class="title">« Prev Page</span>
    <br>
    <span>机器学习基于R包mlr3(15)--聚类-层次聚类</span>
  </a>
  <a class="next" href="https://lishensuo.github.io/en/posts/bioinfo/116%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E4%BA%8Esklearn1--sklearn%E5%9F%BA%E7%A1%80/">
    <span class="title">Next Page »</span>
    <br>
    <span>机器学习基于sklearn(1)--sklearn基础</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2025 <a href="https://lishensuo.github.io/en/">Li&#39;s Bioinfo-Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
		<br/>您是本站第 <span id="busuanzi_value_site_uv"></span> 位访问者，总浏览量为 <span id="busuanzi_value_site_pv"></span> 次
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>

<script type="text/javascript"
async
src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
MathJax.Hub.Config({
tex2jax: {
inlineMath: [['$','$'], ['\\(','\\)']],
displayMath: [['$$','$$'], ['\[\[','\]\]']],
processEscapes: true,
processEnvironments: true,
skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
TeX: { equationNumbers: { autoNumber: "AMS" },
extensions: ["AMSmath.js", "AMSsymbols.js"] }
}
});

MathJax.Hub.Queue(function() {



var all = MathJax.Hub.getAllJax(), i;
for(i = 0; i < all.length; i += 1) {
all[i].SourceElement().parentNode.className += ' has-jax';
}
});
</script>

<style>
code.has-jax {
font: inherit;
font-size: 100%;
background: inherit;
border: inherit;
color: #515151;
}
</style></body>
</html>
