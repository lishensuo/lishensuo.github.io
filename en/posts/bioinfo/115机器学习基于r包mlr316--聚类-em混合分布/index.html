<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">

<link rel="icon" href="/favicon.ico" type="image/x-icon"> 
<title>æœºå™¨å­¦ä¹ åŸºäºRåŒ…mlr3(16)--èšç±»-EMæ··åˆåˆ†å¸ƒ | Li&#39;s Bioinfo-Blog</title>
<meta name="keywords" content="æœºå™¨å­¦ä¹ , mlr3">
<meta name="description" content="1ã€ç®—æ³•ä¸å·¥å…·ç®€ä»‹
1.1 EMç®—æ³•
EMï¼Œ Expectation-Maximization æœŸæœ›æœ€å¤§åŒ–ç®—æ³•
æ··åˆåˆ†å¸ƒï¼šæ¥è‡ªä¸¤ç§æˆ–ä¸¤ç§ä»¥ä¸Šæ¦‚ç‡åˆ†å¸ƒ(é«˜æ–¯åˆ†å¸ƒæœ€å…¸å‹)çš„éšæœºæ•°æ®ç»„æˆçš„ä¸€ç»„æ··åˆæ•°æ®æ‰€å½¢æˆçš„åˆ†å¸ƒã€‚
æ··åˆæ¨¡å‹èšç±»ï¼šè¯†åˆ«æ··åˆåˆ†å¸ƒä¸­ï¼Œæ ·æœ¬çš„åŸå§‹åˆ†å¸ƒï¼Œä»è€Œè¿›è¡Œèšç±»(ä¸€ç§åŸå§‹åˆ†å¸ƒå¯¹åº”ä¸€ä¸ªèšç±»)ï¼Œå±äºè½¯èšç±»ã€‚">
<meta name="author" content="Lishensuo">
<link rel="canonical" href="https://lishensuo.github.io/en/posts/bioinfo/115%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E4%BA%8Er%E5%8C%85mlr316--%E8%81%9A%E7%B1%BB-em%E6%B7%B7%E5%90%88%E5%88%86%E5%B8%83/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.9e4de5e3ba61ea358168341aa7cdf70abfaafb7c697dfe8624af3ddff9a35c2f.css" integrity="sha256-nk3l47ph6jWBaDQap833Cr&#43;q&#43;3xpff6GJK893/mjXC8=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.555af97124d54bb1457985dd081b8f5616a48103aafeb30ac89fde835d65aa6c.js" integrity="sha256-VVr5cSTVS7FFeYXdCBuPVhakgQOq/rMKyJ/eg11lqmw="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://lishensuo.github.io/img/Q.gif">
<link rel="icon" type="image/png" sizes="16x16" href="https://lishensuo.github.io/img/Q.gif">
<link rel="icon" type="image/png" sizes="32x32" href="https://lishensuo.github.io/img/Q.gif">
<link rel="apple-touch-icon" href="https://lishensuo.github.io/Q.gif">
<link rel="mask-icon" href="https://lishensuo.github.io/Q.gif">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://lishensuo.github.io/en/posts/bioinfo/115%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E4%BA%8Er%E5%8C%85mlr316--%E8%81%9A%E7%B1%BB-em%E6%B7%B7%E5%90%88%E5%88%86%E5%B8%83/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="æœºå™¨å­¦ä¹ åŸºäºRåŒ…mlr3(16)--èšç±»-EMæ··åˆåˆ†å¸ƒ" />
<meta property="og:description" content="1ã€ç®—æ³•ä¸å·¥å…·ç®€ä»‹
1.1 EMç®—æ³•
EMï¼Œ Expectation-Maximization æœŸæœ›æœ€å¤§åŒ–ç®—æ³•
æ··åˆåˆ†å¸ƒï¼šæ¥è‡ªä¸¤ç§æˆ–ä¸¤ç§ä»¥ä¸Šæ¦‚ç‡åˆ†å¸ƒ(é«˜æ–¯åˆ†å¸ƒæœ€å…¸å‹)çš„éšæœºæ•°æ®ç»„æˆçš„ä¸€ç»„æ··åˆæ•°æ®æ‰€å½¢æˆçš„åˆ†å¸ƒã€‚
æ··åˆæ¨¡å‹èšç±»ï¼šè¯†åˆ«æ··åˆåˆ†å¸ƒä¸­ï¼Œæ ·æœ¬çš„åŸå§‹åˆ†å¸ƒï¼Œä»è€Œè¿›è¡Œèšç±»(ä¸€ç§åŸå§‹åˆ†å¸ƒå¯¹åº”ä¸€ä¸ªèšç±»)ï¼Œå±äºè½¯èšç±»ã€‚" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lishensuo.github.io/en/posts/bioinfo/115%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E4%BA%8Er%E5%8C%85mlr316--%E8%81%9A%E7%B1%BB-em%E6%B7%B7%E5%90%88%E5%88%86%E5%B8%83/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-06-18T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2022-06-18T00:00:00&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="æœºå™¨å­¦ä¹ åŸºäºRåŒ…mlr3(16)--èšç±»-EMæ··åˆåˆ†å¸ƒ"/>
<meta name="twitter:description" content="1ã€ç®—æ³•ä¸å·¥å…·ç®€ä»‹
1.1 EMç®—æ³•
EMï¼Œ Expectation-Maximization æœŸæœ›æœ€å¤§åŒ–ç®—æ³•
æ··åˆåˆ†å¸ƒï¼šæ¥è‡ªä¸¤ç§æˆ–ä¸¤ç§ä»¥ä¸Šæ¦‚ç‡åˆ†å¸ƒ(é«˜æ–¯åˆ†å¸ƒæœ€å…¸å‹)çš„éšæœºæ•°æ®ç»„æˆçš„ä¸€ç»„æ··åˆæ•°æ®æ‰€å½¢æˆçš„åˆ†å¸ƒã€‚
æ··åˆæ¨¡å‹èšç±»ï¼šè¯†åˆ«æ··åˆåˆ†å¸ƒä¸­ï¼Œæ ·æœ¬çš„åŸå§‹åˆ†å¸ƒï¼Œä»è€Œè¿›è¡Œèšç±»(ä¸€ç§åŸå§‹åˆ†å¸ƒå¯¹åº”ä¸€ä¸ªèšç±»)ï¼Œå±äºè½¯èšç±»ã€‚"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "åˆ†ç±»",
      "item": "https://lishensuo.github.io/en/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ğŸ“– ç”Ÿä¿¡æ•°æ®åˆ†æ--åˆ†ææµç¨‹ï¼Œå·¥å…·åŒ…ç­‰",
      "item": "https://lishensuo.github.io/en/posts/bioinfo/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "æœºå™¨å­¦ä¹ åŸºäºRåŒ…mlr3(16)--èšç±»-EMæ··åˆåˆ†å¸ƒ",
      "item": "https://lishensuo.github.io/en/posts/bioinfo/115%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E4%BA%8Er%E5%8C%85mlr316--%E8%81%9A%E7%B1%BB-em%E6%B7%B7%E5%90%88%E5%88%86%E5%B8%83/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "æœºå™¨å­¦ä¹ åŸºäºRåŒ…mlr3(16)--èšç±»-EMæ··åˆåˆ†å¸ƒ",
  "name": "æœºå™¨å­¦ä¹ åŸºäºRåŒ…mlr3(16)--èšç±»-EMæ··åˆåˆ†å¸ƒ",
  "description": "1ã€ç®—æ³•ä¸å·¥å…·ç®€ä»‹ 1.1 EMç®—æ³• EMï¼Œ Expectation-Maximization æœŸæœ›æœ€å¤§åŒ–ç®—æ³•\næ··åˆåˆ†å¸ƒï¼šæ¥è‡ªä¸¤ç§æˆ–ä¸¤ç§ä»¥ä¸Šæ¦‚ç‡åˆ†å¸ƒ(é«˜æ–¯åˆ†å¸ƒæœ€å…¸å‹)çš„éšæœºæ•°æ®ç»„æˆçš„ä¸€ç»„æ··åˆæ•°æ®æ‰€å½¢æˆçš„åˆ†å¸ƒã€‚\næ··åˆæ¨¡å‹èšç±»ï¼šè¯†åˆ«æ··åˆåˆ†å¸ƒä¸­ï¼Œæ ·æœ¬çš„åŸå§‹åˆ†å¸ƒï¼Œä»è€Œè¿›è¡Œèšç±»(ä¸€ç§åŸå§‹åˆ†å¸ƒå¯¹åº”ä¸€ä¸ªèšç±»)ï¼Œå±äºè½¯èšç±»ã€‚\n",
  "keywords": [
    "æœºå™¨å­¦ä¹ ", "mlr3"
  ],
  "articleBody": "1ã€ç®—æ³•ä¸å·¥å…·ç®€ä»‹ 1.1 EMç®—æ³• EMï¼Œ Expectation-Maximization æœŸæœ›æœ€å¤§åŒ–ç®—æ³•\næ··åˆåˆ†å¸ƒï¼šæ¥è‡ªä¸¤ç§æˆ–ä¸¤ç§ä»¥ä¸Šæ¦‚ç‡åˆ†å¸ƒ(é«˜æ–¯åˆ†å¸ƒæœ€å…¸å‹)çš„éšæœºæ•°æ®ç»„æˆçš„ä¸€ç»„æ··åˆæ•°æ®æ‰€å½¢æˆçš„åˆ†å¸ƒã€‚\næ··åˆæ¨¡å‹èšç±»ï¼šè¯†åˆ«æ··åˆåˆ†å¸ƒä¸­ï¼Œæ ·æœ¬çš„åŸå§‹åˆ†å¸ƒï¼Œä»è€Œè¿›è¡Œèšç±»(ä¸€ç§åŸå§‹åˆ†å¸ƒå¯¹åº”ä¸€ä¸ªèšç±»)ï¼Œå±äºè½¯èšç±»ã€‚\nå‡è®¾ä¸€ç»„æ··åˆåˆ†å¸ƒçš„30ä¸ªæ•°æ®ï¼Œè™šçº¿ä¸ºæ··åˆåˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦ã€‚æ··åˆæ¨¡å‹èšç±»çš„ç›®çš„å°±æ˜¯æ‰¾åˆ°å…¶ä¸­å“ªäº›æ ·æœ¬å±äºçº¢è‰²åˆ†å¸ƒç±»ï¼Œå“ªäº›æ ·æœ¬å±äºç»¿è‰²åˆ†å¸ƒç±»ã€‚\nï¼ˆå·²çŸ¥ï¼šå…¶ä¸­10ä¸ªæ¥è‡ªçº¢è‰²æ­£æ€åˆ†å¸ƒï¼Œ20ä¸ªæ¥è‡ªç»¿è‰²æ­£æ€åˆ†å¸ƒã€‚åœ¨è®¡ç®—æ—¶æ˜¯ä¸çŸ¥é“è¿™ä¸€ä¿¡æ¯ï¼‰\nåéªŒæ¦‚ç‡(posterior probability)ï¼šæ ·æœ¬å±äºæŸç§ç‰¹å®šåˆ†å¸ƒçš„æ¦‚ç‡\nä¼¼ç„¶æ¦‚ç‡(likelihood probability)ï¼šåœ¨æŸç§ç‰¹å®šåˆ†å¸ƒä¸­è§‚å¯Ÿåˆ°æ ·æœ¬çš„æ¦‚ç‡\nå…ˆéªŒæ¦‚ç‡(prior probability)ï¼šåœ¨æ··åˆæ ·æœ¬ä¸­ï¼Œå±äºæŸç§ç‰¹å®šåˆ†å¸ƒçš„æ ·æœ¬æ•°ç›®\nå…¨æ¦‚ç‡ï¼šåœ¨æ··åˆæ ·æœ¬ä¸­çš„æ¦‚ç‡å¯†åº¦\næ ¹æ®è´å¶æ–¯å…¬å¼ $$ åéªŒæ¦‚ç‡ = \\frac{ä¼¼ç„¶æ¦‚ç‡Ã—å…ˆéªŒæ¦‚ç‡}{å…¨æ¦‚ç‡} $$\næŸä¸€æ ·æœ¬çš„å…¨æ¦‚ç‡ç­‰äºï¼šçº¢è‰²æ­£æ€åˆ†å¸ƒä¸­å‡ºç°è¯¥æ ·æœ¬çš„æ¦‚ç‡åŠ ä¸Šç»¿è‰²æ­£æ€åˆ†å¸ƒä¸­å‡ºç°è¯¥æ ·æœ¬çš„æ¦‚ç‡ã€‚ $$ x_i = p(x_i|k_çº¢)Ã—p(k_çº¢) + p(x_i|k_ç»¿)Ã—p(k_ç»¿) $$\næ ·æœ¬å±äºçº¢è‰²æ­£æ€åˆ†å¸ƒçš„æ¦‚ç‡ $$ p(k_{çº¢}|x_i) = \\frac{p(x_i|k_çº¢)Ã—p(k_çº¢)}{x_i} $$\næ ·æœ¬å±äºç»¿è‰²æ­£æ€åˆ†å¸ƒçš„æ¦‚ç‡ $$ p(k_{ç»¿}|x_i) = \\frac{p(x_i|k_ç»¿)Ã—p(k_ç»¿)}{x_i} $$\nï¼ˆ1ï¼‰é¦–å…ˆå‡å®šæ··åˆåˆ†å¸ƒä¸­æ ·æœ¬æ¥è‡ªå‡ ç§åŸå§‹æ­£æ€åˆ†å¸ƒï¼Œè¿™é‡Œå‡è®¾ä¸º2ã€‚\nï¼ˆ2ï¼‰åˆå§‹åŒ–æ¯ç§æ­£æ€åˆ†å¸ƒçš„ç‰¹å¾å‚æ•°(å‡å€¼ã€æ–¹å·®)ä¸å…ˆéªŒæ¦‚ç‡(å±äºä¸¤ç§åˆ†å¸ƒçš„æ ·æœ¬æ¯”ä¾‹)ã€‚\nï¼ˆ3ï¼‰æ ¹æ®æ¯ç§åˆ†å¸ƒå½“å‰çš„ç‰¹å¾å‚æ•°ï¼Œè®¡ç®—ä¸¤ç§åˆ†å¸ƒå¯¹äºæ¯ä¸ªæ ·æœ¬çš„ä¼¼ç„¶æ¦‚ç‡ã€‚\nï¼ˆ4ï¼‰å‚è€ƒè´å¶æ–¯å…¬å¼è®¡ç®—å‡ºæ¯ä¸ªæ ·æœ¬å¯¹äºæ¯ç§åˆ†å¸ƒçš„åéªŒæ¦‚ç‡ã€‚\nï¼ˆ5ï¼‰æ ¹æ®æ¯ä¸ªæ ·æœ¬å±äºæ¯ç§åˆ†å¸ƒçš„åéªŒæ¦‚ç‡\næ›´æ–°æ¯ç§åˆ†å¸ƒçš„å‚æ•°(å‡å€¼ä¸æ–¹å·®)ï¼Œä»¥æé«˜ä¼¼ç„¶æ¦‚ç‡å€¼ï¼› ç®€å•æ¥è¯´å°†æ ·æœ¬çš„åéªŒæ¦‚ç‡ä½œä¸ºæƒé‡ï¼Œä½¿å¾—æ›´æ–°åçš„åˆ†å¸ƒæ›´æ¥è¿‘â€œå±äºâ€(higher posterior probability)å®ƒçš„æ ·æœ¬ç‰¹å¾ã€‚ æ›´æ–°å…ˆéªŒæ¦‚ç‡ å¦‚æœæœ‰å¾ˆå¤šçš„æ ·æœ¬å¯¹äºç‰¹å¾åˆ†å¸ƒæœ‰è¾ƒé«˜çš„åéªŒæ¦‚ç‡ï¼Œå°†å…·æœ‰è¾ƒé«˜çš„å…ˆéªŒæ¦‚ç‡ã€‚ ï¼ˆ6ï¼‰é‡å¤æ­¥éª¤ï¼ˆ3ï¼‰ï¼Œå¦‚æœæ€»ä½“ä¼¼ç„¶æ¦‚ç‡çš„å¢å¹…å°äºé¢„è®¾çš„é˜ˆå€¼(æ”¶æ•›)ï¼Œåˆ™ç»“æŸï¼›å¦åˆ™ç»§ç»­æ‰§è¡Œæ­¥éª¤4ã€5ã€6ï¼Œä¸æ–­æ›´æ–°é«˜æ–¯åˆ†å¸ƒï¼Œæé«˜ä¼¼ç„¶æ¦‚ç‡(æœ€å¤§åŒ–)ã€‚\nå‚è€ƒä¸‹å›¾ï¼ŒEMç®—æ³•ä¸»è¦åˆ†ä¸ºä¸¤æ­¥ï¼šExpectation Step(å¯¹åº”ä¸Šè¿°æ­¥éª¤3ã€4)ï¼›Maximization Step(å¯¹åº”ä¸Šè¿°æ­¥éª¤5)\n1.2 mcluståŒ… mcluståŒ…æ˜¯åŸºäºEMç®—æ³•å®ç°æ··åˆåˆ†å¸ƒèšç±»çš„å¸¸ç”¨RåŒ…ï¼Œç°åœ¨å·²ç»æ›´æ–°çš„5.4.10ã€‚\nå®˜æ–¹ç¤ºä¾‹æ•™ç¨‹ï¼šhttps://cran.r-project.org/web/packages/mclust/vignettes/mclust.html\nï¼ˆ1ï¼‰åœ¨å…·ä½“è®¡ç®—ä¸­ï¼Œæ¯ä¸€ç§Mclustæ¨¡å‹ç»“æœç”±èšç±»æ•°é‡ä¸æ··åˆç±»å‹ä¸¤ä¸ªå‚æ•°å†³å®šã€‚å…¶ä¸­æ··åˆç±»å‹è¡¨ç¤ºï¼šå¯¹äºä¸åŒç±»å‹æ··åˆçš„é«˜æ–¯åˆ†å¸ƒï¼Œä½¿ç”¨3ä¸ªå­—æ¯ç»„åˆè¡¨ç¤º14ç§ç‰¹å¾çš„æ··åˆé«˜æ–¯åˆ†å¸ƒã€‚\nç¬¬ä¸€ä¸ªå­—æ¯ï¼šï¼ˆ1ï¼‰Eè¡¨ç¤ºç­‰ä½“ç§¯ï¼ŒVè¡¨ç¤ºä¸åŒä½“ç§¯ï¼› ç¬¬äºŒä¸ªå­—æ¯ï¼šï¼ˆ1ï¼‰Eè¡¨ç¤ºç­‰é•¿å¾„æ¯”ï¼ŒVè¡¨ç¤ºä¸åŒé•¿å¾„æ¯”ï¼ŒIè¡¨ç¤ºçƒå½¢ï¼› ç¬¬ä¸‰ä¸ªå­—æ¯ï¼šï¼ˆ1ï¼‰Iè¡¨ç¤ºä¸è½´æ–¹å‘æ­£äº¤ï¼ŒEè¡¨ç¤ºä¸æ­£äº¤ï¼ŒVè¡¨ç¤ºæ¯ä¸ªåˆ†å¸ƒæ–¹å‘ä¸åŒã€‚ ï¼ˆ2ï¼‰å¯¹äºä¸åŒMclustæ¨¡å‹çš„ç»“æœï¼Œå¯é€šè¿‡BIC(è´å¶æ–¯ä¿¡æ¯å‡†åˆ™)æŒ‡æ ‡è¿›è¡Œæ¯”è¾ƒã€‚åœ¨æ¨¡å‹çš„ä¼¼ç„¶æ¦‚ç‡ç»“æœçš„åŸºç¡€ä¸Šï¼Œè¿›ä¸€æ­¥è€ƒè™‘æ¨¡å‹çš„å‚æ•°ã€‚å¦‚æœæ¨¡å‹ä¸­åŒ…å«å¤ªå¤šçš„å‚æ•°ï¼ŒBICå°±ä¼šå¯¹æ¨¡å‹è¿›è¡Œæƒ©ç½šã€‚\nç®€å•æ¥è¯´åœ¨Mclust()ç»“æœä¸­ï¼Œç‰¹å®šæ¨¡å‹çš„BICæŒ‡æ ‡è¶Šå°ï¼Œè¡¨ç¤ºè¯¥æ¨¡å‹æ€§èƒ½è¶Šå¥½ã€‚ 2ã€Rå®æ“ 2.1 å¤šå˜é‡æ•°æ® ï¼ˆ1ï¼‰åŸºç¡€æ“ä½œ ç¤ºä¾‹æ•°æ®ï¼š100å¼ çœŸé’ä¸100å¼ å‡é’çš„ç‰¹å¾æ•°æ® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 library(mclust) data(banknote, package = \"mclust\") table(banknote$Status) # counterfeit genuine # 100 100 swissTib \u003c- select(banknote, -Status) #ä»…ä¿ç•™ç‰¹å¾æ•°æ® dim(swissTib) # [1] 200 6 head(swissTib) # Length Left Right Bottom Top Diagonal # 1 214.8 131.0 131.1 9.0 9.7 141.0 # 2 214.6 129.7 129.7 8.1 9.5 141.7 # 3 214.8 129.7 129.7 8.7 9.6 142.2 # 4 214.8 129.7 129.6 7.5 10.4 142.0 # 5 215.0 129.6 129.7 10.4 7.7 141.8 # 6 215.7 130.8 130.5 9.0 10.1 141.4 åœ¨ä¸è®¾ç½®å…¶å®ƒå‚æ•°çš„æƒ…å†µä¸‹ï¼ŒMclust()é»˜è®¤è®¡ç®—1è‡³9ç§èšç±»çš„14ç§æ··åˆç±»å‹çš„BICæŒ‡æ ‡ç»“æœï¼› 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 swissMclust \u003c- Mclust(swissTib) ##(1) ç»“æœæ¦‚å†µ summary(swissMclust) # ---------------------------------------------------- # Gaussian finite mixture model fitted by EM algorithm # ---------------------------------------------------- # # Mclust VVE (ellipsoidal, equal orientation) model with 3 components: # # log-likelihood n df BIC ICL # -663.3814 200 53 -1607.574 -1607.71 # # Clustering table: # 1 2 3 # 18 98 84 #å…·ä½“å±•ç¤ºæ¯ç§åˆ†å¸ƒæ¨¡å‹çš„åˆ†å¸ƒç‰¹å¾ summary(swissMclust, parameters = TRUE) ##(2) æ‰€æœ‰æ¨¡å‹çš„BICç»“æœ dim(swissMclust$BIC) # [1] 9 14 ##(3) æœ€ä¼˜æ¨¡å‹çš„ç‰¹å¾ swissMclust$G # [1] 3 swissMclust$modelName # [1] \"VVE\" ##(4) æ¨¡å‹è®¡ç®—ç»“æœå¯è§†åŒ– #æ‰€æœ‰æ¨¡å‹ç»„åˆçš„BICæŒ‡æ ‡ plot(swissMclust, what = \"BIC\") # plot(swissMclust, what = \"classification\") # plot(swissMclust, what = \"uncertainty\") # plot(swissMclust, what = \"density\") ï¼ˆ2ï¼‰ç›¸å…³å‚æ•°è®¾ç½® é™å®šèšç±»æ•°é‡æˆ–è€…æ··åˆç±»å‹ 1 2 3 4 5 6 7 8 9 10 11 12 swissMclust2 \u003c- Mclust(swissTib, G=1:3, modelNames = \"VVE\") summary(swissMclust2) swissMclust2$BIC # Bayesian Information Criterion (BIC): # VVE # 1 -1978.941 # 2 -1721.311 # 3 -1607.574 # # Top 3 models based on the BIC criterion: # VVE,3 VVE,2 VVE,1 # -1607.574 -1721.311 -1978.941 åˆå§‹åŒ–è®¾ç½® 1 2 3 4 5 6 hc1 \u003c- hc(swissTib, modelName = \"VVV\", use = \"SVD\") # hc2 \u003c- hc(swissTib, modelName = \"VVV\", use = \"VARS\") # hc3 \u003c- hc(swissTib, modelName = \"EEE\", use = \"SVD\") # swissMclust \u003c- Mclust(swissTib, initialization = list(hcPairs = hc1)) #default swissMclust \u003c- Mclust(swissTib, initialization = list(hcPairs = hc2)) summary(swissMclust) ï¼ˆ3ï¼‰Bootstrapæ³•éªŒè¯ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 bootClust \u003c- MclustBootstrap(swissMclust) summary(bootClust, what = \"ci\") # summary(bootClust, what = \"se\") # plot(bootClust, what = \"mean\") # plot(bootClust, what = \"pro\") # ---------------------------------------------------------- # Resampling confidence intervals # ---------------------------------------------------------- # Model = VVE # Num. of mixture components = 3 # Replications = 999 # Type = nonparametric bootstrap # Confidence level = 0.95 # # Mixing probabilities: # 1 2 3 # 2.5% 0.05396204 0.4200456 0.3549896 # 97.5% 0.13491555 0.5550405 0.4852951 # .... 2.2 å•å˜é‡ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 data(acidity) str(acidity) # num [1:155] 2.93 3.91 3.73 3.69 3.82 ... acidityMclust \u003c- Mclust(acidity) summary(acidityMclust, parameters = TRUE) # ---------------------------------------------------- # Gaussian finite mixture model fitted by EM algorithm # ---------------------------------------------------- # # Mclust E (univariate, equal variance) model with 2 components: # # log-likelihood n df BIC ICL # -185.9493 155 4 -392.0723 -398.5554 # # Clustering table: # 1 2 # 98 57 # # Mixing probabilities: # 1 2 # 0.6233595 0.3766405 # # Means: # 1 2 # 4.370946 6.320153 # # Variances: # 1 2 # 0.1863702 0.1863702 table(acidityMclust$classification) # 1 2 # 98 57 plot(acidityMclust, what = \"density\") ",
  "wordCount" : "2237",
  "inLanguage": "en",
  "datePublished": "2022-06-18T00:00:00Z",
  "dateModified": "2022-06-18T00:00:00Z",
  "author":[{
    "@type": "Person",
    "name": "Lishensuo"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://lishensuo.github.io/en/posts/bioinfo/115%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E4%BA%8Er%E5%8C%85mlr316--%E8%81%9A%E7%B1%BB-em%E6%B7%B7%E5%90%88%E5%88%86%E5%B8%83/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Li's Bioinfo-Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://lishensuo.github.io/img/Q.gif"
    }
  }
}
</script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://lishensuo.github.io/en/" accesskey="h" title="Li&#39;s Bioinfo-Blog (Alt + H)">Li&#39;s Bioinfo-Blog</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                </ul>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://lishensuo.github.io/en/" title="ä¸»é¡µ">
                    <span>ä¸»é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/posts" title="åˆ†ç±»">
                    <span>åˆ†ç±»</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/tags" title="æ ‡ç­¾">
                    <span>æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/archives/" title="å½’æ¡£">
                    <span>å½’æ¡£</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/about" title="å…³äº">
                    <span>å…³äº</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/search" title="æœç´¢ (Alt &#43; /)" accesskey=/>
                    <span>æœç´¢</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://lishensuo.github.io/en/">Home</a>&nbsp;Â»&nbsp;<a href="https://lishensuo.github.io/en/posts/">åˆ†ç±»</a>&nbsp;Â»&nbsp;<a href="https://lishensuo.github.io/en/posts/bioinfo/">ğŸ“– ç”Ÿä¿¡æ•°æ®åˆ†æ--åˆ†ææµç¨‹ï¼Œå·¥å…·åŒ…ç­‰</a></div>
    <h1 class="post-title">
      æœºå™¨å­¦ä¹ åŸºäºRåŒ…mlr3(16)--èšç±»-EMæ··åˆåˆ†å¸ƒ
    </h1>
    <div class="post-meta">













Create:&amp;nbsp;&lt;span title=&#39;2022-06-18 00:00:00 &#43;0000 UTC&#39;&gt;2022-06-18&lt;/span&gt;&amp;nbsp;|&amp;nbsp;Update:&amp;nbsp;2022-06-18&amp;nbsp;|&amp;nbsp;Words:&amp;nbsp;2237&amp;nbsp;|&amp;nbsp;5 min&amp;nbsp;|&amp;nbsp;Lishensuo

|  Viewers: <span id="busuanzi_value_page_pv"></span> 
	  
    </div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">Table of Contents</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#1%e7%ae%97%e6%b3%95%e4%b8%8e%e5%b7%a5%e5%85%b7%e7%ae%80%e4%bb%8b" aria-label="1ã€ç®—æ³•ä¸å·¥å…·ç®€ä»‹">1ã€ç®—æ³•ä¸å·¥å…·ç®€ä»‹</a><ul>
                            
                    <li>
                        <a href="#11-em%e7%ae%97%e6%b3%95" aria-label="1.1 EMç®—æ³•">1.1 EMç®—æ³•</a></li>
                    <li>
                        <a href="#12-mclust%e5%8c%85" aria-label="1.2 mcluståŒ…">1.2 mcluståŒ…</a></li></ul>
                    </li>
                    <li>
                        <a href="#2r%e5%ae%9e%e6%93%8d" aria-label="2ã€Rå®æ“">2ã€Rå®æ“</a><ul>
                            
                    <li>
                        <a href="#21-%e5%a4%9a%e5%8f%98%e9%87%8f%e6%95%b0%e6%8d%ae" aria-label="2.1 å¤šå˜é‡æ•°æ®">2.1 å¤šå˜é‡æ•°æ®</a><ul>
                            
                    <li>
                        <a href="#1%e5%9f%ba%e7%a1%80%e6%93%8d%e4%bd%9c" aria-label="ï¼ˆ1ï¼‰åŸºç¡€æ“ä½œ">ï¼ˆ1ï¼‰åŸºç¡€æ“ä½œ</a></li>
                    <li>
                        <a href="#2%e7%9b%b8%e5%85%b3%e5%8f%82%e6%95%b0%e8%ae%be%e7%bd%ae" aria-label="ï¼ˆ2ï¼‰ç›¸å…³å‚æ•°è®¾ç½®">ï¼ˆ2ï¼‰ç›¸å…³å‚æ•°è®¾ç½®</a></li>
                    <li>
                        <a href="#3bootstrap%e6%b3%95%e9%aa%8c%e8%af%81" aria-label="ï¼ˆ3ï¼‰Bootstrapæ³•éªŒè¯">ï¼ˆ3ï¼‰Bootstrapæ³•éªŒè¯</a></li></ul>
                    </li>
                    <li>
                        <a href="#22-%e5%8d%95%e5%8f%98%e9%87%8f" aria-label="2.2 å•å˜é‡">2.2 å•å˜é‡</a>
                    </li>
                </ul>
                </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>


  <div class="post-content"><h1 id="1ç®—æ³•ä¸å·¥å…·ç®€ä»‹">1ã€ç®—æ³•ä¸å·¥å…·ç®€ä»‹<a hidden class="anchor" aria-hidden="true" href="#1ç®—æ³•ä¸å·¥å…·ç®€ä»‹">#</a></h1>
<h2 id="11-emç®—æ³•">1.1 EMç®—æ³•<a hidden class="anchor" aria-hidden="true" href="#11-emç®—æ³•">#</a></h2>
<p>EMï¼Œ Expectation-Maximization æœŸæœ›æœ€å¤§åŒ–ç®—æ³•</p>
<p>æ··åˆåˆ†å¸ƒï¼šæ¥è‡ªä¸¤ç§æˆ–ä¸¤ç§ä»¥ä¸Šæ¦‚ç‡åˆ†å¸ƒ(é«˜æ–¯åˆ†å¸ƒæœ€å…¸å‹)çš„éšæœºæ•°æ®ç»„æˆçš„ä¸€ç»„æ··åˆæ•°æ®æ‰€å½¢æˆçš„åˆ†å¸ƒã€‚</p>
<p>æ··åˆæ¨¡å‹èšç±»ï¼šè¯†åˆ«æ··åˆåˆ†å¸ƒä¸­ï¼Œæ ·æœ¬çš„åŸå§‹åˆ†å¸ƒï¼Œä»è€Œè¿›è¡Œèšç±»(ä¸€ç§åŸå§‹åˆ†å¸ƒå¯¹åº”ä¸€ä¸ªèšç±»)ï¼Œå±äº<strong>è½¯èšç±»</strong>ã€‚</p>
<img src="https://raw.githubusercontent.com/lishensuo/images/main/image-20220613223043136.png" alt="image-20220613223043136" style="zoom: 80%;" />
<p>å‡è®¾ä¸€ç»„æ··åˆåˆ†å¸ƒçš„30ä¸ªæ•°æ®ï¼Œè™šçº¿ä¸ºæ··åˆåˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦ã€‚æ··åˆæ¨¡å‹èšç±»çš„ç›®çš„å°±æ˜¯æ‰¾åˆ°å…¶ä¸­å“ªäº›æ ·æœ¬å±äºçº¢è‰²åˆ†å¸ƒç±»ï¼Œå“ªäº›æ ·æœ¬å±äºç»¿è‰²åˆ†å¸ƒç±»ã€‚</p>
<p>ï¼ˆå·²çŸ¥ï¼šå…¶ä¸­10ä¸ªæ¥è‡ªçº¢è‰²æ­£æ€åˆ†å¸ƒï¼Œ20ä¸ªæ¥è‡ªç»¿è‰²æ­£æ€åˆ†å¸ƒã€‚åœ¨è®¡ç®—æ—¶æ˜¯ä¸çŸ¥é“è¿™ä¸€ä¿¡æ¯ï¼‰</p>
<p>åéªŒæ¦‚ç‡(posterior probability)ï¼šæ ·æœ¬å±äºæŸç§ç‰¹å®šåˆ†å¸ƒçš„æ¦‚ç‡</p>
<p>ä¼¼ç„¶æ¦‚ç‡(likelihood probability)ï¼šåœ¨æŸç§ç‰¹å®šåˆ†å¸ƒä¸­è§‚å¯Ÿåˆ°æ ·æœ¬çš„æ¦‚ç‡</p>
<p>å…ˆéªŒæ¦‚ç‡(prior probability)ï¼šåœ¨æ··åˆæ ·æœ¬ä¸­ï¼Œå±äºæŸç§ç‰¹å®šåˆ†å¸ƒçš„æ ·æœ¬æ•°ç›®</p>
<p>å…¨æ¦‚ç‡ï¼šåœ¨æ··åˆæ ·æœ¬ä¸­çš„æ¦‚ç‡å¯†åº¦</p>
<p>æ ¹æ®è´å¶æ–¯å…¬å¼
$$
åéªŒæ¦‚ç‡ = \frac{ä¼¼ç„¶æ¦‚ç‡Ã—å…ˆéªŒæ¦‚ç‡}{å…¨æ¦‚ç‡}
$$</p>
<ul>
<li>æŸä¸€æ ·æœ¬çš„å…¨æ¦‚ç‡ç­‰äºï¼šçº¢è‰²æ­£æ€åˆ†å¸ƒä¸­å‡ºç°è¯¥æ ·æœ¬çš„æ¦‚ç‡åŠ ä¸Šç»¿è‰²æ­£æ€åˆ†å¸ƒä¸­å‡ºç°è¯¥æ ·æœ¬çš„æ¦‚ç‡ã€‚</li>
</ul>
<p>$$
x_i = p(x_i|k_çº¢)Ã—p(k_çº¢) + p(x_i|k_ç»¿)Ã—p(k_ç»¿)
$$</p>
<ul>
<li>æ ·æœ¬å±äºçº¢è‰²æ­£æ€åˆ†å¸ƒçš„æ¦‚ç‡</li>
</ul>
<p>$$
p(k_{çº¢}|x_i) = \frac{p(x_i|k_çº¢)Ã—p(k_çº¢)}{x_i}
$$</p>
<ul>
<li>æ ·æœ¬å±äºç»¿è‰²æ­£æ€åˆ†å¸ƒçš„æ¦‚ç‡</li>
</ul>
<p>$$
p(k_{ç»¿}|x_i) = \frac{p(x_i|k_ç»¿)Ã—p(k_ç»¿)}{x_i}
$$</p>
<p>ï¼ˆ1ï¼‰é¦–å…ˆå‡å®šæ··åˆåˆ†å¸ƒä¸­æ ·æœ¬æ¥è‡ªå‡ ç§åŸå§‹æ­£æ€åˆ†å¸ƒï¼Œè¿™é‡Œå‡è®¾ä¸º2ã€‚</p>
<p>ï¼ˆ2ï¼‰åˆå§‹åŒ–æ¯ç§æ­£æ€åˆ†å¸ƒçš„ç‰¹å¾å‚æ•°(å‡å€¼ã€æ–¹å·®)ä¸å…ˆéªŒæ¦‚ç‡(å±äºä¸¤ç§åˆ†å¸ƒçš„æ ·æœ¬æ¯”ä¾‹)ã€‚</p>
<p>ï¼ˆ3ï¼‰æ ¹æ®æ¯ç§åˆ†å¸ƒå½“å‰çš„ç‰¹å¾å‚æ•°ï¼Œè®¡ç®—ä¸¤ç§åˆ†å¸ƒå¯¹äºæ¯ä¸ªæ ·æœ¬çš„<strong>ä¼¼ç„¶æ¦‚ç‡</strong>ã€‚</p>
<p>ï¼ˆ4ï¼‰å‚è€ƒè´å¶æ–¯å…¬å¼è®¡ç®—å‡ºæ¯ä¸ªæ ·æœ¬å¯¹äºæ¯ç§åˆ†å¸ƒçš„<strong>åéªŒæ¦‚ç‡</strong>ã€‚</p>
<p>ï¼ˆ5ï¼‰æ ¹æ®æ¯ä¸ªæ ·æœ¬å±äºæ¯ç§åˆ†å¸ƒçš„åéªŒæ¦‚ç‡</p>
<ul>
<li>æ›´æ–°æ¯ç§åˆ†å¸ƒçš„å‚æ•°(å‡å€¼ä¸æ–¹å·®)ï¼Œä»¥æé«˜ä¼¼ç„¶æ¦‚ç‡å€¼ï¼›
<ul>
<li>ç®€å•æ¥è¯´å°†æ ·æœ¬çš„åéªŒæ¦‚ç‡ä½œä¸ºæƒé‡ï¼Œä½¿å¾—æ›´æ–°åçš„åˆ†å¸ƒæ›´æ¥è¿‘â€œå±äºâ€(higher posterior probability)å®ƒçš„æ ·æœ¬ç‰¹å¾ã€‚</li>
</ul>
</li>
<li>æ›´æ–°å…ˆéªŒæ¦‚ç‡
<ul>
<li>å¦‚æœæœ‰å¾ˆå¤šçš„æ ·æœ¬å¯¹äºç‰¹å¾åˆ†å¸ƒæœ‰è¾ƒé«˜çš„åéªŒæ¦‚ç‡ï¼Œå°†å…·æœ‰è¾ƒé«˜çš„å…ˆéªŒæ¦‚ç‡ã€‚</li>
</ul>
</li>
</ul>
<p>ï¼ˆ6ï¼‰é‡å¤æ­¥éª¤ï¼ˆ3ï¼‰ï¼Œå¦‚æœæ€»ä½“ä¼¼ç„¶æ¦‚ç‡çš„å¢å¹…å°äºé¢„è®¾çš„é˜ˆå€¼(æ”¶æ•›)ï¼Œåˆ™ç»“æŸï¼›å¦åˆ™ç»§ç»­æ‰§è¡Œæ­¥éª¤4ã€5ã€6ï¼Œä¸æ–­æ›´æ–°é«˜æ–¯åˆ†å¸ƒï¼Œæé«˜ä¼¼ç„¶æ¦‚ç‡(æœ€å¤§åŒ–)ã€‚</p>
<blockquote>
<p>å‚è€ƒä¸‹å›¾ï¼ŒEMç®—æ³•ä¸»è¦åˆ†ä¸ºä¸¤æ­¥ï¼šExpectation Step(å¯¹åº”ä¸Šè¿°æ­¥éª¤3ã€4)ï¼›Maximization  Step(å¯¹åº”ä¸Šè¿°æ­¥éª¤5)</p></blockquote>
<img src="https://raw.githubusercontent.com/lishensuo/images/main/EM21.jpg" alt="Expectation Maximization Algorithm | EM Algorithm Explained" style="zoom: 67%;" />
<h2 id="12-mcluståŒ…">1.2 mcluståŒ…<a hidden class="anchor" aria-hidden="true" href="#12-mcluståŒ…">#</a></h2>
<blockquote>
<p><code>mclust</code>åŒ…æ˜¯åŸºäºEMç®—æ³•å®ç°æ··åˆåˆ†å¸ƒèšç±»çš„å¸¸ç”¨RåŒ…ï¼Œç°åœ¨å·²ç»æ›´æ–°çš„5.4.10ã€‚</p>
<p>å®˜æ–¹ç¤ºä¾‹æ•™ç¨‹ï¼šhttps://cran.r-project.org/web/packages/mclust/vignettes/mclust.html</p></blockquote>
<p>ï¼ˆ1ï¼‰åœ¨å…·ä½“è®¡ç®—ä¸­ï¼Œæ¯ä¸€ç§Mclustæ¨¡å‹ç»“æœç”±èšç±»æ•°é‡ä¸æ··åˆç±»å‹ä¸¤ä¸ªå‚æ•°å†³å®šã€‚å…¶ä¸­æ··åˆç±»å‹è¡¨ç¤ºï¼šå¯¹äºä¸åŒç±»å‹æ··åˆçš„é«˜æ–¯åˆ†å¸ƒï¼Œä½¿ç”¨3ä¸ªå­—æ¯ç»„åˆè¡¨ç¤º14ç§ç‰¹å¾çš„æ··åˆé«˜æ–¯åˆ†å¸ƒã€‚</p>
<ul>
<li>ç¬¬ä¸€ä¸ªå­—æ¯ï¼šï¼ˆ1ï¼‰<strong>E</strong>è¡¨ç¤ºç­‰ä½“ç§¯ï¼Œ<strong>V</strong>è¡¨ç¤ºä¸åŒä½“ç§¯ï¼›</li>
<li>ç¬¬äºŒä¸ªå­—æ¯ï¼šï¼ˆ1ï¼‰<strong>E</strong>è¡¨ç¤ºç­‰é•¿å¾„æ¯”ï¼Œ<strong>V</strong>è¡¨ç¤ºä¸åŒé•¿å¾„æ¯”ï¼Œ<strong>I</strong>è¡¨ç¤ºçƒå½¢ï¼›</li>
<li>ç¬¬ä¸‰ä¸ªå­—æ¯ï¼šï¼ˆ1ï¼‰<strong>I</strong>è¡¨ç¤ºä¸è½´æ–¹å‘æ­£äº¤ï¼Œ<strong>E</strong>è¡¨ç¤ºä¸æ­£äº¤ï¼Œ<strong>V</strong>è¡¨ç¤ºæ¯ä¸ªåˆ†å¸ƒæ–¹å‘ä¸åŒã€‚</li>
</ul>
<img src="https://raw.githubusercontent.com/lishensuo/images/main/image-20220618092623386.png" alt="image-20220618092623386" style="zoom: 67%;" />
<p>ï¼ˆ2ï¼‰å¯¹äºä¸åŒMclustæ¨¡å‹çš„ç»“æœï¼Œå¯é€šè¿‡BIC(è´å¶æ–¯ä¿¡æ¯å‡†åˆ™)æŒ‡æ ‡è¿›è¡Œæ¯”è¾ƒã€‚åœ¨æ¨¡å‹çš„ä¼¼ç„¶æ¦‚ç‡ç»“æœçš„åŸºç¡€ä¸Šï¼Œè¿›ä¸€æ­¥è€ƒè™‘æ¨¡å‹çš„å‚æ•°ã€‚å¦‚æœæ¨¡å‹ä¸­åŒ…å«å¤ªå¤šçš„å‚æ•°ï¼ŒBICå°±ä¼šå¯¹æ¨¡å‹è¿›è¡Œæƒ©ç½šã€‚</p>
<ul>
<li>ç®€å•æ¥è¯´åœ¨<code>Mclust()</code>ç»“æœä¸­ï¼Œç‰¹å®šæ¨¡å‹çš„<u>BICæŒ‡æ ‡è¶Šå°ï¼Œè¡¨ç¤ºè¯¥æ¨¡å‹æ€§èƒ½è¶Šå¥½</u>ã€‚</li>
</ul>
<h1 id="2rå®æ“">2ã€Rå®æ“<a hidden class="anchor" aria-hidden="true" href="#2rå®æ“">#</a></h1>
<h2 id="21-å¤šå˜é‡æ•°æ®">2.1 å¤šå˜é‡æ•°æ®<a hidden class="anchor" aria-hidden="true" href="#21-å¤šå˜é‡æ•°æ®">#</a></h2>
<h3 id="1åŸºç¡€æ“ä½œ">ï¼ˆ1ï¼‰åŸºç¡€æ“ä½œ<a hidden class="anchor" aria-hidden="true" href="#1åŸºç¡€æ“ä½œ">#</a></h3>
<ul>
<li>ç¤ºä¾‹æ•°æ®ï¼š100å¼ çœŸé’ä¸100å¼ å‡é’çš„ç‰¹å¾æ•°æ®</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>library(mclust)
</span></span><span style="display:flex;"><span>data(banknote, package = <span style="color:#0ff;font-weight:bold">&#34;mclust&#34;</span>)
</span></span><span style="display:flex;"><span>table(banknote$Status)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># counterfeit     genuine </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#         100         100 </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>swissTib &lt;- select(banknote, -Status)    <span style="color:#007f7f">#ä»…ä¿ç•™ç‰¹å¾æ•°æ®</span>
</span></span><span style="display:flex;"><span>dim(swissTib)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># [1] 200   6</span>
</span></span><span style="display:flex;"><span>head(swissTib)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   Length  Left Right Bottom  Top Diagonal</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1  214.8 131.0 131.1    9.0  9.7    141.0</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 2  214.6 129.7 129.7    8.1  9.5    141.7</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 3  214.8 129.7 129.7    8.7  9.6    142.2</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 4  214.8 129.7 129.6    7.5 10.4    142.0</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 5  215.0 129.6 129.7   10.4  7.7    141.8</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 6  215.7 130.8 130.5    9.0 10.1    141.4</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>åœ¨ä¸è®¾ç½®å…¶å®ƒå‚æ•°çš„æƒ…å†µä¸‹ï¼Œ<code>Mclust()</code>é»˜è®¤è®¡ç®—1è‡³9ç§èšç±»çš„14ç§æ··åˆç±»å‹çš„BICæŒ‡æ ‡ç»“æœï¼›</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>swissMclust &lt;- Mclust(swissTib)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(1) ç»“æœæ¦‚å†µ</span>
</span></span><span style="display:flex;"><span>summary(swissMclust)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># ---------------------------------------------------- </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   Gaussian finite mixture model fitted by EM algorithm </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># ---------------------------------------------------- </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   Mclust VVE (ellipsoidal, equal orientation) model with 3 components: </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># log-likelihood   n df       BIC      ICL</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#      -663.3814 200 53 -1607.574 -1607.71</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Clustering table:</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   1  2  3 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#  18 98 84 </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#å…·ä½“å±•ç¤ºæ¯ç§åˆ†å¸ƒæ¨¡å‹çš„åˆ†å¸ƒç‰¹å¾</span>
</span></span><span style="display:flex;"><span>summary(swissMclust, parameters = <span style="color:#fff;font-weight:bold">TRUE</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2) æ‰€æœ‰æ¨¡å‹çš„BICç»“æœ</span>
</span></span><span style="display:flex;"><span>dim(swissMclust$BIC)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># [1]  9 14</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(3) æœ€ä¼˜æ¨¡å‹çš„ç‰¹å¾</span>
</span></span><span style="display:flex;"><span>swissMclust$G
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># [1] 3</span>
</span></span><span style="display:flex;"><span>swissMclust$modelName
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># [1] &#34;VVE&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(4) æ¨¡å‹è®¡ç®—ç»“æœå¯è§†åŒ–</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#æ‰€æœ‰æ¨¡å‹ç»„åˆçš„BICæŒ‡æ ‡</span>
</span></span><span style="display:flex;"><span>plot(swissMclust, what = <span style="color:#0ff;font-weight:bold">&#34;BIC&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># plot(swissMclust, what = &#34;classification&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># plot(swissMclust, what = &#34;uncertainty&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># plot(swissMclust, what = &#34;density&#34;)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://raw.githubusercontent.com/lishensuo/images/main/image-20220618101352587.png" alt="image-20220618101352587" style="zoom:50%;" />
<h3 id="2ç›¸å…³å‚æ•°è®¾ç½®">ï¼ˆ2ï¼‰ç›¸å…³å‚æ•°è®¾ç½®<a hidden class="anchor" aria-hidden="true" href="#2ç›¸å…³å‚æ•°è®¾ç½®">#</a></h3>
<ul>
<li>é™å®šèšç±»æ•°é‡æˆ–è€…æ··åˆç±»å‹</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>swissMclust2 &lt;- Mclust(swissTib, G=<span style="color:#ff0;font-weight:bold">1</span>:<span style="color:#ff0;font-weight:bold">3</span>, modelNames = <span style="color:#0ff;font-weight:bold">&#34;VVE&#34;</span>)
</span></span><span style="display:flex;"><span>summary(swissMclust2)
</span></span><span style="display:flex;"><span>swissMclust2$BIC
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Bayesian Information Criterion (BIC): </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#         VVE</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1 -1978.941</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 2 -1721.311</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 3 -1607.574</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Top 3 models based on the BIC criterion: </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#     VVE,3     VVE,2     VVE,1 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># -1607.574 -1721.311 -1978.941 </span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>åˆå§‹åŒ–è®¾ç½®</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>hc1 &lt;- hc(swissTib, modelName = <span style="color:#0ff;font-weight:bold">&#34;VVV&#34;</span>, use = <span style="color:#0ff;font-weight:bold">&#34;SVD&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># hc2 &lt;- hc(swissTib, modelName = &#34;VVV&#34;, use = &#34;VARS&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># hc3 &lt;- hc(swissTib, modelName = &#34;EEE&#34;, use = &#34;SVD&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># swissMclust &lt;- Mclust(swissTib, initialization = list(hcPairs = hc1))  #default</span>
</span></span><span style="display:flex;"><span>swissMclust &lt;- Mclust(swissTib, initialization = list(hcPairs = hc2))
</span></span><span style="display:flex;"><span>summary(swissMclust)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="3bootstrapæ³•éªŒè¯">ï¼ˆ3ï¼‰Bootstrapæ³•éªŒè¯<a hidden class="anchor" aria-hidden="true" href="#3bootstrapæ³•éªŒè¯">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>bootClust &lt;- MclustBootstrap(swissMclust)
</span></span><span style="display:flex;"><span>summary(bootClust, what = <span style="color:#0ff;font-weight:bold">&#34;ci&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># summary(bootClust, what = &#34;se&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># plot(bootClust, what = &#34;mean&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># plot(bootClust, what = &#34;pro&#34;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># ---------------------------------------------------------- </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   Resampling confidence intervals </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># ---------------------------------------------------------- </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   Model                      = VVE </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Num. of mixture components = 3 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Replications               = 999 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Type                       = nonparametric bootstrap </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Confidence level           = 0.95 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Mixing probabilities:</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   1         2         3</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 2.5%  0.05396204 0.4200456 0.3549896</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 97.5% 0.13491555 0.5550405 0.4852951</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># ....</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="22-å•å˜é‡">2.2 å•å˜é‡<a hidden class="anchor" aria-hidden="true" href="#22-å•å˜é‡">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>data(acidity)
</span></span><span style="display:flex;"><span>str(acidity)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># num [1:155] 2.93 3.91 3.73 3.69 3.82 ...</span>
</span></span><span style="display:flex;"><span>acidityMclust &lt;- Mclust(acidity)
</span></span><span style="display:flex;"><span>summary(acidityMclust, parameters = <span style="color:#fff;font-weight:bold">TRUE</span>)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># ---------------------------------------------------- </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   Gaussian finite mixture model fitted by EM algorithm </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># ---------------------------------------------------- </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   Mclust E (univariate, equal variance) model with 2 components: </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   log-likelihood   n df       BIC       ICL</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#        -185.9493 155  4 -392.0723 -398.5554</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Clustering table:</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   1  2 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 98 57 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Mixing probabilities:</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#         1         2 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 0.6233595 0.3766405 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Means:</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#        1        2 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 4.370946 6.320153 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Variances:</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#         1         2 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 0.1863702 0.1863702 </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>table(acidityMclust$classification)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1  2 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 98 57</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plot(acidityMclust, what = <span style="color:#0ff;font-weight:bold">&#34;density&#34;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images/main/image-20220618103402384.png" alt="image-20220618103402384"  />
</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://lishensuo.github.io/en/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">æœºå™¨å­¦ä¹ </a></li>
      <li><a href="https://lishensuo.github.io/en/tags/mlr3/">Mlr3</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://lishensuo.github.io/en/posts/bioinfo/114%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E4%BA%8Er%E5%8C%85mlr315--%E8%81%9A%E7%B1%BB-%E5%B1%82%E6%AC%A1%E8%81%9A%E7%B1%BB/">
    <span class="title">Â« Prev Page</span>
    <br>
    <span>æœºå™¨å­¦ä¹ åŸºäºRåŒ…mlr3(15)--èšç±»-å±‚æ¬¡èšç±»</span>
  </a>
  <a class="next" href="https://lishensuo.github.io/en/posts/bioinfo/116%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E4%BA%8Esklearn1--sklearn%E5%9F%BA%E7%A1%80/">
    <span class="title">Next Page Â»</span>
    <br>
    <span>æœºå™¨å­¦ä¹ åŸºäºsklearn(1)--sklearnåŸºç¡€</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2025 <a href="https://lishensuo.github.io/en/">Li&#39;s Bioinfo-Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
		<br/>æ‚¨æ˜¯æœ¬ç«™ç¬¬ <span id="busuanzi_value_site_uv"></span> ä½è®¿é—®è€…ï¼Œæ€»æµè§ˆé‡ä¸º <span id="busuanzi_value_site_pv"></span> æ¬¡
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>

<script type="text/javascript"
async
src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
MathJax.Hub.Config({
tex2jax: {
inlineMath: [['$','$'], ['\\(','\\)']],
displayMath: [['$$','$$'], ['\[\[','\]\]']],
processEscapes: true,
processEnvironments: true,
skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
TeX: { equationNumbers: { autoNumber: "AMS" },
extensions: ["AMSmath.js", "AMSsymbols.js"] }
}
});

MathJax.Hub.Queue(function() {



var all = MathJax.Hub.getAllJax(), i;
for(i = 0; i < all.length; i += 1) {
all[i].SourceElement().parentNode.className += ' has-jax';
}
});
</script>

<style>
code.has-jax {
font: inherit;
font-size: 100%;
background: inherit;
border: inherit;
color: #515151;
}
</style></body>
</html>
