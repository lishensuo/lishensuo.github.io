<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">

<link rel="icon" href="/favicon.ico" type="image/x-icon"> 
<title>D2L--ç¬¬å››ç« å¤šå±‚æ„ŸçŸ¥æœº | Li&#39;s Bioinfo-Blog</title>
<meta name="keywords" content="æ·±åº¦å­¦ä¹ , D2L">
<meta name="description" content="1. å¤šå±‚æ„ŸçŸ¥æœº
1.1 éšè—å±‚

ä¹‹å‰æ‰€å­¦çš„çº¿æ€§æ¨¡å‹æ„å‘³ç€å•è°ƒå‡è®¾ï¼Œå¹¶ä¸é€‚ç”¨äºæ›´å¤æ‚çš„å»ºæ¨¡é—®é¢˜ï¼Œä¾‹å¦‚ä½“æ¸©ä¸ç–¾ç—…ï¼›å›¾ç‰‡æŸä¸ªåƒç´ ç‚¹çš„å¼ºåº¦ä¸çŒ«æˆ–ç‹—çš„å…³ç³»ç­‰ï¼›
å¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰ï¼šåœ¨è¾“å…¥å±‚ä¸è¾“å‡ºå±‚ä¹‹é—´åŠ å…¥ä¸€ä¸ªæˆ–å¤šä¸ªéšè—å±‚ï¼Œä»¥å­¦ä¹ æ›´åŠ å¤æ‚çš„æ¨¡å‹æƒ…å†µï¼›

åªæœ‰éšè—å±‚ä¸è¾“å‡ºå±‚æ¶‰åŠåˆ°ç¥ç»å…ƒè®¡ç®—ä¸å‚æ•°æ›´æ–°ï¼Œå› æ­¤å¦‚ä¸‹ç¤ºä¾‹MLPçš„å±‚æ•°æ˜¯2ï¼›
å¯¹äºå…¶ä¸­çš„éšè—å±‚éœ€è¦åº”ç”¨éçº¿æ€§çš„æ¿€æ´»å‡½æ•°ï¼ˆÏƒï¼‰ï¼Œä»¥çªç ´å¯¹ä»ä¸ºçº¿æ€§æœ¬è´¨çš„é™åˆ¶ã€‚




">
<meta name="author" content="Lishensuo">
<link rel="canonical" href="https://lishensuo.github.io/en/posts/bioinfo/707d2l-%E7%AC%AC%E5%9B%9B%E7%AB%A0%E5%A4%9A%E5%B1%82%E6%84%9F%E7%9F%A5%E6%9C%BA/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.9e4de5e3ba61ea358168341aa7cdf70abfaafb7c697dfe8624af3ddff9a35c2f.css" integrity="sha256-nk3l47ph6jWBaDQap833Cr&#43;q&#43;3xpff6GJK893/mjXC8=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.555af97124d54bb1457985dd081b8f5616a48103aafeb30ac89fde835d65aa6c.js" integrity="sha256-VVr5cSTVS7FFeYXdCBuPVhakgQOq/rMKyJ/eg11lqmw="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://lishensuo.github.io/img/Q.gif">
<link rel="icon" type="image/png" sizes="16x16" href="https://lishensuo.github.io/img/Q.gif">
<link rel="icon" type="image/png" sizes="32x32" href="https://lishensuo.github.io/img/Q.gif">
<link rel="apple-touch-icon" href="https://lishensuo.github.io/Q.gif">
<link rel="mask-icon" href="https://lishensuo.github.io/Q.gif">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://lishensuo.github.io/en/posts/bioinfo/707d2l-%E7%AC%AC%E5%9B%9B%E7%AB%A0%E5%A4%9A%E5%B1%82%E6%84%9F%E7%9F%A5%E6%9C%BA/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="D2L--ç¬¬å››ç« å¤šå±‚æ„ŸçŸ¥æœº" />
<meta property="og:description" content="1. å¤šå±‚æ„ŸçŸ¥æœº
1.1 éšè—å±‚

ä¹‹å‰æ‰€å­¦çš„çº¿æ€§æ¨¡å‹æ„å‘³ç€å•è°ƒå‡è®¾ï¼Œå¹¶ä¸é€‚ç”¨äºæ›´å¤æ‚çš„å»ºæ¨¡é—®é¢˜ï¼Œä¾‹å¦‚ä½“æ¸©ä¸ç–¾ç—…ï¼›å›¾ç‰‡æŸä¸ªåƒç´ ç‚¹çš„å¼ºåº¦ä¸çŒ«æˆ–ç‹—çš„å…³ç³»ç­‰ï¼›
å¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰ï¼šåœ¨è¾“å…¥å±‚ä¸è¾“å‡ºå±‚ä¹‹é—´åŠ å…¥ä¸€ä¸ªæˆ–å¤šä¸ªéšè—å±‚ï¼Œä»¥å­¦ä¹ æ›´åŠ å¤æ‚çš„æ¨¡å‹æƒ…å†µï¼›

åªæœ‰éšè—å±‚ä¸è¾“å‡ºå±‚æ¶‰åŠåˆ°ç¥ç»å…ƒè®¡ç®—ä¸å‚æ•°æ›´æ–°ï¼Œå› æ­¤å¦‚ä¸‹ç¤ºä¾‹MLPçš„å±‚æ•°æ˜¯2ï¼›
å¯¹äºå…¶ä¸­çš„éšè—å±‚éœ€è¦åº”ç”¨éçº¿æ€§çš„æ¿€æ´»å‡½æ•°ï¼ˆÏƒï¼‰ï¼Œä»¥çªç ´å¯¹ä»ä¸ºçº¿æ€§æœ¬è´¨çš„é™åˆ¶ã€‚




" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lishensuo.github.io/en/posts/bioinfo/707d2l-%E7%AC%AC%E5%9B%9B%E7%AB%A0%E5%A4%9A%E5%B1%82%E6%84%9F%E7%9F%A5%E6%9C%BA/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-07-28T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2024-07-28T00:00:00&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="D2L--ç¬¬å››ç« å¤šå±‚æ„ŸçŸ¥æœº"/>
<meta name="twitter:description" content="1. å¤šå±‚æ„ŸçŸ¥æœº
1.1 éšè—å±‚

ä¹‹å‰æ‰€å­¦çš„çº¿æ€§æ¨¡å‹æ„å‘³ç€å•è°ƒå‡è®¾ï¼Œå¹¶ä¸é€‚ç”¨äºæ›´å¤æ‚çš„å»ºæ¨¡é—®é¢˜ï¼Œä¾‹å¦‚ä½“æ¸©ä¸ç–¾ç—…ï¼›å›¾ç‰‡æŸä¸ªåƒç´ ç‚¹çš„å¼ºåº¦ä¸çŒ«æˆ–ç‹—çš„å…³ç³»ç­‰ï¼›
å¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰ï¼šåœ¨è¾“å…¥å±‚ä¸è¾“å‡ºå±‚ä¹‹é—´åŠ å…¥ä¸€ä¸ªæˆ–å¤šä¸ªéšè—å±‚ï¼Œä»¥å­¦ä¹ æ›´åŠ å¤æ‚çš„æ¨¡å‹æƒ…å†µï¼›

åªæœ‰éšè—å±‚ä¸è¾“å‡ºå±‚æ¶‰åŠåˆ°ç¥ç»å…ƒè®¡ç®—ä¸å‚æ•°æ›´æ–°ï¼Œå› æ­¤å¦‚ä¸‹ç¤ºä¾‹MLPçš„å±‚æ•°æ˜¯2ï¼›
å¯¹äºå…¶ä¸­çš„éšè—å±‚éœ€è¦åº”ç”¨éçº¿æ€§çš„æ¿€æ´»å‡½æ•°ï¼ˆÏƒï¼‰ï¼Œä»¥çªç ´å¯¹ä»ä¸ºçº¿æ€§æœ¬è´¨çš„é™åˆ¶ã€‚




"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "åˆ†ç±»",
      "item": "https://lishensuo.github.io/en/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ğŸ“– ç”Ÿä¿¡æ•°æ®åˆ†æ--åˆ†ææµç¨‹ï¼Œå·¥å…·åŒ…ç­‰",
      "item": "https://lishensuo.github.io/en/posts/bioinfo/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "D2L--ç¬¬å››ç« å¤šå±‚æ„ŸçŸ¥æœº",
      "item": "https://lishensuo.github.io/en/posts/bioinfo/707d2l-%E7%AC%AC%E5%9B%9B%E7%AB%A0%E5%A4%9A%E5%B1%82%E6%84%9F%E7%9F%A5%E6%9C%BA/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "D2L--ç¬¬å››ç« å¤šå±‚æ„ŸçŸ¥æœº",
  "name": "D2L--ç¬¬å››ç« å¤šå±‚æ„ŸçŸ¥æœº",
  "description": "1. å¤šå±‚æ„ŸçŸ¥æœº 1.1 éšè—å±‚ ä¹‹å‰æ‰€å­¦çš„çº¿æ€§æ¨¡å‹æ„å‘³ç€å•è°ƒå‡è®¾ï¼Œå¹¶ä¸é€‚ç”¨äºæ›´å¤æ‚çš„å»ºæ¨¡é—®é¢˜ï¼Œä¾‹å¦‚ä½“æ¸©ä¸ç–¾ç—…ï¼›å›¾ç‰‡æŸä¸ªåƒç´ ç‚¹çš„å¼ºåº¦ä¸çŒ«æˆ–ç‹—çš„å…³ç³»ç­‰ï¼› å¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰ï¼šåœ¨è¾“å…¥å±‚ä¸è¾“å‡ºå±‚ä¹‹é—´åŠ å…¥ä¸€ä¸ªæˆ–å¤šä¸ªéšè—å±‚ï¼Œä»¥å­¦ä¹ æ›´åŠ å¤æ‚çš„æ¨¡å‹æƒ…å†µï¼› åªæœ‰éšè—å±‚ä¸è¾“å‡ºå±‚æ¶‰åŠåˆ°ç¥ç»å…ƒè®¡ç®—ä¸å‚æ•°æ›´æ–°ï¼Œå› æ­¤å¦‚ä¸‹ç¤ºä¾‹MLPçš„å±‚æ•°æ˜¯2ï¼› å¯¹äºå…¶ä¸­çš„éšè—å±‚éœ€è¦åº”ç”¨éçº¿æ€§çš„æ¿€æ´»å‡½æ•°ï¼ˆÏƒï¼‰ï¼Œä»¥çªç ´å¯¹ä»ä¸ºçº¿æ€§æœ¬è´¨çš„é™åˆ¶ã€‚ ",
  "keywords": [
    "æ·±åº¦å­¦ä¹ ", "D2L"
  ],
  "articleBody": "1. å¤šå±‚æ„ŸçŸ¥æœº 1.1 éšè—å±‚ ä¹‹å‰æ‰€å­¦çš„çº¿æ€§æ¨¡å‹æ„å‘³ç€å•è°ƒå‡è®¾ï¼Œå¹¶ä¸é€‚ç”¨äºæ›´å¤æ‚çš„å»ºæ¨¡é—®é¢˜ï¼Œä¾‹å¦‚ä½“æ¸©ä¸ç–¾ç—…ï¼›å›¾ç‰‡æŸä¸ªåƒç´ ç‚¹çš„å¼ºåº¦ä¸çŒ«æˆ–ç‹—çš„å…³ç³»ç­‰ï¼› å¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰ï¼šåœ¨è¾“å…¥å±‚ä¸è¾“å‡ºå±‚ä¹‹é—´åŠ å…¥ä¸€ä¸ªæˆ–å¤šä¸ªéšè—å±‚ï¼Œä»¥å­¦ä¹ æ›´åŠ å¤æ‚çš„æ¨¡å‹æƒ…å†µï¼› åªæœ‰éšè—å±‚ä¸è¾“å‡ºå±‚æ¶‰åŠåˆ°ç¥ç»å…ƒè®¡ç®—ä¸å‚æ•°æ›´æ–°ï¼Œå› æ­¤å¦‚ä¸‹ç¤ºä¾‹MLPçš„å±‚æ•°æ˜¯2ï¼› å¯¹äºå…¶ä¸­çš„éšè—å±‚éœ€è¦åº”ç”¨éçº¿æ€§çš„æ¿€æ´»å‡½æ•°ï¼ˆÏƒï¼‰ï¼Œä»¥çªç ´å¯¹ä»ä¸ºçº¿æ€§æœ¬è´¨çš„é™åˆ¶ã€‚ å¯¹äºnä¸ªæ ·æœ¬ï¼Œdä¸ªç‰¹å¾çš„è¾“å…¥X (nÃ—d)ã€‚ä¸­é—´éšè—å±‚çš„ç¥ç»å…ƒä¸ªæ•°ä¸ºhï¼Œæƒé‡å‚æ•°ä¸ºW1(dÃ—h)ï¼Œåç½®å‚æ•°ä¸ºb1(1Ã—h)ã€‚è¾“å‡ºå±‚ç¥ç»å…ƒä¸ªæ•°ä¸ºqï¼Œæƒé‡å‚æ•°ä¸ºW2(hÃ—q)ï¼Œåç½®å‚æ•°ä¸ºb2(1Ã—q)ã€‚ 1.2 æ¿€æ´»å‡½æ•° 1 2 3 %matplotlib inline import torch from d2l import torch as d2l ï¼ˆ1ï¼‰ReLuå‡½æ•°\nå˜æ¢æ–¹å¼ï¼šéšè—å±‚è¾“å‡ºçš„ç»“æœè‹¥ä¸ºè´Ÿæ•°ï¼Œå˜ä¸º0ï¼›æ­£æ•°ä¿æŒä¸å˜ï¼› å®ç°ç®€å•ï¼Œè¡¨ç°è‰¯å¥½ã€‚ 1 2 3 4 5 6 7 8 9 x = torch.arange(-8.0, 8.0, 0.1, requires_grad=True) y = torch.relu(x) # ç»˜åˆ¶æ¿€æ´»å‰ï¼ˆxï¼‰ä¸åï¼ˆyï¼‰ d2l.plot(x.detach(), y.detach(), 'x', 'relu(x)', figsize=(5, 2.5)) # è®¡ç®—æ¿€æ´»å‡½æ•°çš„å¯¼æ•° y.backward(torch.ones_like(x), retain_graph=True) d2l.plot(x.detach(), x.grad, 'x', 'grad of relu', figsize=(5, 2.5)) ä¸è¦å¤ªçº ç»“x=0çš„æƒ…å†µâ€”â€œå¦‚æœå¾®å¦™çš„è¾¹ç•Œæ¡ä»¶å¾ˆé‡è¦ï¼Œæˆ‘ä»¬å¾ˆå¯èƒ½æ˜¯åœ¨ç ”ç©¶æ•°å­¦è€Œéå·¥ç¨‹â€\nï¼ˆ2ï¼‰sigmoidå‡½æ•°\nå˜æ¢æ–¹å¼ï¼šéšè—å±‚è¾“å‡ºçš„ç»“æœå˜æ¢åˆ°0ä¸1ä¹‹é—´ï¼› å¦‚ä»Šåœ¨éšè—å±‚ä¸­å·²ç»ä¸å¸¸ç”¨ï¼Œå¤šç”¨äºäºŒåˆ†ç±»é—®é¢˜ä¸­è¾“å‡ºå±‚çš„æ¿€æ´»å‡½æ•° 1 2 3 4 5 6 7 8 # ç»˜åˆ¶æ¿€æ´»å‰ï¼ˆxï¼‰ä¸åï¼ˆyï¼‰ y = torch.sigmoid(x) d2l.plot(x.detach(), y.detach(), 'x', 'sigmoid(x)', figsize=(5, 2.5)) # è®¡ç®—æ¿€æ´»å‡½æ•°çš„å¯¼æ•° x.grad.data.zero_() y.backward(torch.ones_like(x),retain_graph=True) d2l.plot(x.detach(), x.grad, 'x', 'grad of sigmoid', figsize=(5, 2.5)) ï¼ˆ3ï¼‰tanhå‡½æ•°ï¼ˆåŒæ›²æ­£åˆ‡ï¼‰\nå˜æ¢æ–¹å¼ï¼šéšè—å±‚è¾“å‡ºçš„ç»“æœå˜æ¢åˆ°-1ä¸1ä¹‹é—´ï¼› 1 2 3 4 5 6 7 8 # ç»˜åˆ¶æ¿€æ´»å‰ï¼ˆxï¼‰ä¸åï¼ˆyï¼‰ y = torch.tanh(x) d2l.plot(x.detach(), y.detach(), 'x', 'tanh(x)', figsize=(5, 2.5)) # è®¡ç®—æ¿€æ´»å‡½æ•°çš„å¯¼æ•° x.grad.data.zero_() y.backward(torch.ones_like(x),retain_graph=True) d2l.plot(x.detach(), x.grad, 'x', 'grad of tanh', figsize=(5, 2.5)) 2. å¤šå±‚æ„ŸçŸ¥æœºçš„ä»é›¶å®ç° 1 2 3 4 5 6 import torch from torch import nn from d2l import torch as d2l batch_size = 256 train_iter, test_iter = d2l.load_data_fashion_mnist(batch_size) 2.1 åˆå§‹åŒ–æ¨¡å‹å‚æ•° 1 2 3 4 5 6 7 8 9 10 11 num_inputs, num_outputs, num_hiddens = 784, 10, 256 # éšè—å±‚ W1 = nn.Parameter(torch.randn( num_inputs, num_hiddens, requires_grad=True) * 0.01) b1 = nn.Parameter(torch.zeros(num_hiddens, requires_grad=True)) # è¾“å‡ºå±‚ W2 = nn.Parameter(torch.randn( num_hiddens, num_outputs, requires_grad=True) * 0.01) b2 = nn.Parameter(torch.zeros(num_outputs, requires_grad=True)) params = [W1, b1, W2, b2] 2.2 æ¿€æ´»å‡½æ•° è‡ªå®šä¹‰ReLuå‡½æ•° 1 2 3 def relu(X): a = torch.zeros_like(X) return torch.max(X, a) 2.3 æ¨¡å‹ 2å±‚MLPç»“æ„ 1 2 3 4 def net(X): X = X.reshape((-1, num_inputs)) H = relu(X@W1 + b1) # è¿™é‡Œâ€œ@â€ä»£è¡¨çŸ©é˜µä¹˜æ³• return (H@W2 + b2) 2.4 æŸå¤±å‡½æ•° äº¤å‰ç†µæŸå¤±å‡½æ•° 1 loss = nn.CrossEntropyLoss(reduction='none') 2.5 è®­ç»ƒ è°ƒç”¨ç¬¬ä¸‰ç« çš„è®­ç»ƒå‡½æ•° 1 2 3 num_epochs, lr = 10, 0.1 updater = torch.optim.SGD(params, lr=lr) d2l.train_ch3(net, train_iter, test_iter, loss, num_epochs, updater) 3. å¤šå±‚æ„ŸçŸ¥æœºçš„ç®€æ´å®ç° 1 2 3 import torch from torch import nn from d2l import torch as d2l 1 2 3 4 5 6 7 8 9 10 11 12 # æ¨¡å‹ç»“æ„ net = nn.Sequential(nn.Flatten(), nn.Linear(784, 256), nn.ReLU(), #æ¿€æ´»å‡½æ•° nn.Linear(256, 10)) # å‚æ•°åˆå§‹åŒ– def init_weights(m): if type(m) == nn.Linear: nn.init.normal_(m.weight, std=0.01) net.apply(init_weights); 1 2 3 4 5 6 7 8 batch_size, lr, num_epochs = 256, 0.1, 10 loss = nn.CrossEntropyLoss(reduction='none') trainer = torch.optim.SGD(net.parameters(), lr=lr) train_iter, test_iter = d2l.load_data_fashion_mnist(batch_size) d2l.train_ch3(net, train_iter, test_iter, loss, num_epochs, trainer) 4. æ¨¡å‹æ¬ æ‹Ÿåˆå’Œè¿‡æ‹Ÿåˆ 4.1 è®­ç»ƒè¯¯å·®å’Œæ³›åŒ–è¯¯å·® è®­ç»ƒè¯¯å·®ï¼šæ¨¡å‹åœ¨è®­ç»ƒæ•°æ®é›†ä¸Šè®¡ç®—å¾—åˆ°çš„è¯¯å·®ï¼› æ³›åŒ–è¯¯å·®ï¼šæ¨¡å‹åº”ç”¨åœ¨åŒæ ·ä»åŸå§‹æ ·æœ¬çš„åˆ†å¸ƒä¸­æŠ½å–çš„æ— é™å¤šæ•°æ®æ ·æœ¬æ—¶ï¼Œæ¨¡å‹è¯¯å·®çš„æœŸæœ›ï¼ˆç†è®ºï¼‰ï¼› è¿‡æ‹Ÿåˆï¼šæ¨¡å‹åœ¨è®­ç»ƒæ•°æ®ä¸Šæ‹Ÿåˆçš„æ¯”åœ¨æ½œåœ¨åˆ†å¸ƒä¸­æ›´æ¥è¿‘çš„ç°è±¡ã€‚ å½±å“æ¨¡å‹æ³›åŒ–çš„å› ç´ ï¼š ï¼ˆ1ï¼‰å‚æ•°æ•°é‡ï¼šå¯è°ƒæ•´å‚æ•°çš„æ•°é‡è¶Šå¤šï¼Œè¶Šå®¹æ˜“è¿‡æ‹Ÿåˆï¼› ï¼ˆ2ï¼‰å‚æ•°å–å€¼ï¼šå‚æ•°çš„å–å€¼èŒƒå›´è¶Šå¤§ï¼Œè¶Šå®¹æ˜“è¿‡æ‹Ÿåˆï¼› ï¼ˆ3ï¼‰è®­ç»ƒæ ·æœ¬çš„æ•°é‡ï¼šåŸåˆ™ä¸Šï¼Œè®­ç»ƒæ ·æœ¬è¶Šå°‘ï¼Œè¶Šå®¹æ˜“è¿‡æ‹Ÿåˆã€‚ã€DLè‡³å°‘è¦ä¸Šåƒæ ·æœ¬ã€‘ 4.2 æ¨¡å‹é€‰æ‹© æ¯”è¾ƒä¸åŒè¶…å‚æ•°è®¾ç½®ä¸‹çš„åŒä¸€ç±»æ¨¡å‹ï¼Œä¼šæ¶‰åŠåˆ°æ•°æ®é›†çš„å¤šç§åˆ’åˆ†æ–¹å¼ã€‚ æ–¹å¼1ï¼šå°†æ•°æ®åˆ†ä¸º3ä»½ è®­ç»ƒæ•°æ®é›†ç”¨äºè®­ç»ƒæ¨¡å‹ éªŒè¯æ•°æ®é›†ç”¨äºæ¯”è¾ƒã€é€‰æ‹©æ¨¡å‹ æµ‹è¯•æ•°æ®é›†ç”¨äºæœ€ç»ˆçš„æ³›åŒ–è¯„ä¼°ï¼ˆè”æƒ³é«˜è€ƒï¼‰ åœ¨ä»£ç å®ç°éƒ¨åˆ†ï¼Œæ•™ææ‰€å†™çš„æµ‹è¯•é›†å…¶å®è¿˜æ˜¯éªŒè¯é›†ã€‚\næ–¹å¼2ï¼šKæŠ˜äº¤å‰éªŒè¯ï¼ˆæ ·æœ¬é‡ä¸å¤šæ—¶ï¼‰ å°†æ•°æ®åˆ†ä¸ºKä¸ªå­é›† æ¯æ¬¡é€‰å–K-1ä¸ªå­é›†è®­ç»ƒï¼Œåœ¨å‰©ä½™çš„ä¸€ä¸ªè‡ªå·±éªŒè¯ï¼› å–Kæ¬¡å®éªŒçš„å‡å€¼ã€‚ åœ¨DLä¸­ï¼Œç”±äºè®­ç»ƒæˆæœ¬è¾ƒé«˜ï¼Œä¸ä¼šå¤ªå¸¸ç”¨ï¼›åœ¨MLä¸­å¸¸ç”¨ã€‚\n4.3 æ¬ æ‹Ÿåˆè¿˜æ˜¯è¿‡æ‹Ÿåˆ æ¬ æ‹Ÿåˆ è®­ç»ƒè¯¯å·®ä¸éªŒè¯è¯¯å·®éƒ½å¾ˆå¤§ï¼Œå·®è·è¾ƒå°ï¼› æ¨¡å‹å¯èƒ½è¿‡äºç®€å•ï¼Œæœ‰ç†ç”±ç›¸ä¿¡å¯è®­ç»ƒæ›´å¤æ‚çš„æ¨¡å‹å‡å°è®­ç»ƒè¯¯å·® è¿‡æ‹Ÿåˆ è®­ç»ƒè¯¯å·®æ˜æ˜¾å°äºéªŒè¯è¯¯å·®ï¼› å€¼å¾—æ³¨æ„ï¼Œè¿‡æ‹Ÿåˆå¹¶ä¸æ€»æ˜¯åäº‹ã€‚æœ€ç»ˆè¿˜æ˜¯æ›´å…³å¿ƒéªŒè¯è¯¯å·®ã€‚ 4.4 å¤šé¡¹å¼å›å½’ æ•™æä¸­ä¸¾äº†ä¸€ä¸ªä¾‹å­ç›´è§‚çš„è§£é‡Šäº†æ¨¡å‹å¤æ‚åº¦ï¼ˆå‚æ•°æ•°é‡ï¼‰å¯¹äºæ¨¡å‹æ‹Ÿåˆçš„å½±å“ã€‚ é¦–å…ˆç”Ÿæˆäº†200ä¸ªæ ·æœ¬çš„20ä¸ªç‰¹å¾æ•°æ®ï¼›ç‰¹å¾åˆ†åˆ«æ¥è‡ªäº0~19æ¬¡å¹‚çš„ç»“æœï¼Œè€ŒçœŸå®çš„æ ‡ç­¾yä»…æ¥è‡ªå¦‚ä¸‹å›¾æ‰€ç¤ºçš„å‰å››ä¸ªå¤šé¡¹å¼ã€‚ ç¬¬ä¸€æ¬¡è®­ç»ƒï¼šå–å‰4åˆ—ç‰¹å¾ï¼Œæ‹Ÿåˆæ­£å¸¸ï¼› ç¬¬äºŒæ¬¡è®­ç»ƒï¼šå–å‰2åˆ—ç‰¹å¾ï¼Œæ¬ æ‹Ÿåˆï¼ˆå‚æ•°è¿‡å°‘ï¼‰ï¼› ç¬¬ä¸‰æ¬¡è®­ç»ƒï¼šå–å…¨éƒ¨20åˆ—æ•°æ®ï¼Œè¿‡æ‹Ÿåˆï¼ˆå‚æ•°è¿‡å¤šï¼‰ã€‚ è¯¦è§æ•™æä»£ç ï¼šhttps://zh-v2.d2l.ai/chapter_multilayer-perceptrons/underfit-overfit.html 5. æƒé‡è¡°å‡ 5.1 èŒƒæ•°ä¸æƒé‡è¡°å‡ æ¨¡å‹å¤æ‚åº¦çš„å½±å“å› ç´ ä¹‹ä¸€æ˜¯å‚æ•°çš„å¤§å°å–å€¼èŒƒå›´ï¼Œå¯é€šè¿‡L2èŒƒæ•°è¡¡é‡ï¼› å¯å°†å‚æ•°çš„èŒƒæ•°ä½œä¸ºæƒ©ç½šé¡¹ï¼Œå’Œé¢„æµ‹æŸå¤±å…±åŒä½œä¸ºæœ€å°åŒ–çš„è®­ç»ƒç›®æ ‡ï¼› å¦‚ä¸‹å…¬å¼ï¼Œå…·ä½“å¯é€šè¿‡æ­£åˆ™åŒ–å¸¸æ•°Î»æ§åˆ¶æƒ©ç½šé¡¹çš„å½±å“ç¨‹åº¦ã€‚ è¾ƒå°çš„Î»å€¼å¯¹wçº¦æŸè¾ƒå°ï¼› è¾ƒå¤§çš„Î»å€¼å¯¹wçº¦æŸè¾ƒå¤§ï¼› é€šå¸¸ï¼Œç½‘ç»œè¾“å‡ºå±‚çš„åç½®é¡¹ä¸ä¼šè¢«æ­£åˆ™åŒ–ã€‚\n5.2 é«˜ç»´çº¿æ€§å›å½’ æ¨¡æ‹Ÿæ•°æ®ï¼Œåœ¨5.3æ¼”ç¤ºæƒé‡è¡°å‡çš„ä½œç”¨ 1 2 3 4 5 6 7 8 9 # è®­ç»ƒæ ·æœ¬æ•°(20)è¾ƒå°‘ï¼Œè¾“å…¥ç‰¹å¾è¾ƒå¤š(200)ï¼Œå®¹æ˜“è¿‡æ‹Ÿåˆ n_train, n_test, num_inputs, batch_size = 20, 100, 200, 5 true_w, true_b = torch.ones((num_inputs, 1)) * 0.01, 0.05 train_data = d2l.synthetic_data(true_w, true_b, n_train) train_iter = d2l.load_array(train_data, batch_size) test_data = d2l.synthetic_data(true_w, true_b, n_test) test_iter = d2l.load_array(test_data, batch_size, is_train=False) 5.3 ä»é›¶å¼€å§‹å®ç° åˆå§‹åŒ–æ¨¡å‹å‚æ•° 1 2 3 4 def init_params(): w = torch.normal(0, 1, size=(num_inputs, 1), requires_grad=True) b = torch.zeros(1, requires_grad=True) return [w, b] å®šä¹‰L2èŒƒæ•° 1 2 3 4 5 6 def l2_penalty(w): return torch.sum(w.pow(2)) / 2 ## L1èŒƒæ•° # def l1_penalty(w): # return torch.sum(torch.abs(w)) å®šä¹‰è®­ç»ƒä»£ç å®ç° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 def train(lambd): w, b = init_params() net, loss = lambda X: d2l.linreg(X, w, b), d2l.squared_loss #æ¨¡å‹è¾“å‡ºï¼ŒæŸå¤±å‡½æ•° num_epochs, lr = 100, 0.003 animator = d2l.Animator(xlabel='epochs', ylabel='loss', yscale='log', xlim=[5, num_epochs], legend=['train', 'test']) for epoch in range(num_epochs): for X, y in train_iter: # å¢åŠ äº†L2èŒƒæ•°æƒ©ç½šé¡¹ï¼Œ # å¹¿æ’­æœºåˆ¶ä½¿l2_penalty(w)æˆä¸ºä¸€ä¸ªé•¿åº¦ä¸ºbatch_sizeçš„å‘é‡ l = loss(net(X), y) + lambd * l2_penalty(w) l.sum().backward() d2l.sgd([w, b], lr, batch_size) if (epoch + 1) % 5 == 0: animator.add(epoch + 1, (d2l.evaluate_loss(net, train_iter, loss), d2l.evaluate_loss(net, test_iter, loss))) print('wçš„L2èŒƒæ•°æ˜¯ï¼š', torch.norm(w).item()) è®­ç»ƒ 1 2 3 4 5 6 7 ## (1) å¿½ç•¥æ­£åˆ™åŒ–ç›´æ¥è®­ç»ƒï¼šå·¦å›¾ train(lambd=0) # wçš„L2èŒƒæ•°æ˜¯ï¼š 12.963241577148438 ## (2) ä½¿ç”¨æƒé‡è¡°å‡ï¼šå³å›¾ train(lambd=3) # wçš„L2èŒƒæ•°æ˜¯ï¼š 0.04280993342399597 5.4 ç®€æ´å®ç° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 def train_concise(wd): net = nn.Sequential(nn.Linear(num_inputs, 1)) for param in net.parameters(): param.data.normal_() loss = nn.MSELoss(reduction='none') num_epochs, lr = 100, 0.003 # åç½®å‚æ•°æ²¡æœ‰è¡°å‡ trainer = torch.optim.SGD([ {\"params\":net[0].weight,'weight_decay': wd}, {\"params\":net[0].bias}], lr=lr) animator = d2l.Animator(xlabel='epochs', ylabel='loss', yscale='log', xlim=[5, num_epochs], legend=['train', 'test']) for epoch in range(num_epochs): for X, y in train_iter: trainer.zero_grad() l = loss(net(X), y) l.mean().backward() trainer.step() if (epoch + 1) % 5 == 0: animator.add(epoch + 1, (d2l.evaluate_loss(net, train_iter, loss), d2l.evaluate_loss(net, test_iter, loss))) print('wçš„L2èŒƒæ•°ï¼š', net[0].weight.norm().item()) 1 2 3 train_concise(0) train_concise(3) æ²ç¥æ¨èï¼Œä¸€èˆ¬å¯è®¾ç½®weight_decayä¸º0.01, 0.001, 0.0001\n6. æš‚é€€æ³• 6.1 æ‰°åŠ¨çš„ç¨³å¥æ€§ é˜²æ­¢æ¨¡å‹è¿‡æ‹Ÿåˆçš„å¦ä¸€ä¸ªè§’åº¦æ˜¯å¢åŠ å¹³æ»‘æ€§ï¼Œä¸ä¼šå¯¹è¾“å…¥çš„å¾®å°å˜åŒ–æ•æ„Ÿï¼› æš‚é€€æ³•æ˜¯åœ¨å‰å‘ä¼ æ’­è¿‡ç¨‹ä¸­ï¼Œè®¡ç®—æ¯ä¸€å†…éƒ¨å±‚çš„åŒæ—¶å¼•å…¥å™ªå£°ï¼Œè¡¨ç°ä¸ºéšæœºä¸¢å¼ƒ(drop out)ä¸€äº›ç¥ç»å…ƒ; åœ¨æ ‡å‡†æš‚é€€æ³•æ­£åˆ™åŒ–ä¸­ï¼Œæ¯ä¸ªä¸­é—´éšè—å±‚çš„æ¿€æ´»å€¼hä»¥æš‚é€€æ¦‚ç‡pè¢«éšæœºå˜é‡*hâ€™*æ›¿æ¢ã€‚ ä¸Šè¿°å…¬å¼è¡¨ç¤ºæŒ‰ä¸€ç§æ— åå‘çš„æ–¹å¼å¼•å…¥å™ªå£°ï¼Œæ¯å±‚çš„æœŸæœ›å€¼ç­‰äºæ²¡æœ‰å™ªéŸ³çš„å€¼ã€‚\n6.2 å®è·µä¸­çš„æš‚é€€æ³• æš‚é€€æ³•ä»…ç”¨äºéšè—å±‚çš„(æ¿€æ´»å)è¾“å‡ºç»“æœä¸­ï¼Œä½¿å¾—ä¸è¿‡åº¦ä¾èµ–éšè—å±‚ä¸­çš„ä»»æ„ä¸€ä¸ªå…ƒç´ ï¼› ä»…åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä½¿ç”¨Dropoutï¼Œåœ¨é¢„æµ‹è¿‡ç¨‹ä¸­ä¸éœ€è¦ä½¿ç”¨ï¼› Dropoutå¤šåº”ç”¨äºMLPç¥ç»ç½‘ç»œï¼Œè€Œè¾ƒå°‘åº”ç”¨äºCNNç­‰ 6.3 ä»é›¶å¼€å§‹å®ç° è‡ªå®šä¹‰dropoutå‡½æ•° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 import torch from torch import nn from d2l import torch as d2l def dropout_layer(X, dropout): assert 0 \u003c= dropout \u003c= 1 # åœ¨æœ¬æƒ…å†µä¸­ï¼Œæ‰€æœ‰å…ƒç´ éƒ½è¢«ä¸¢å¼ƒ if dropout == 1: return torch.zeros_like(X) # åœ¨æœ¬æƒ…å†µä¸­ï¼Œæ‰€æœ‰å…ƒç´ éƒ½è¢«ä¿ç•™ if dropout == 0: return X # torch.randç”Ÿæˆéšæœºæ•° mask = (torch.rand(X.shape) \u003e dropout).float() #é€»è¾‘å€¼ return mask * X / (1.0 - dropout) #ä¸¢å¼ƒé€»è¾‘å€¼ä¸ºFALSEçš„ç»“æœ # æ¼”ç¤º X= torch.arange(16, dtype = torch.float32).reshape((2, 8)) print(X) print(dropout_layer(X, 0.)) print(dropout_layer(X, 0.5)) print(dropout_layer(X, 1.)) å®šä¹‰æ¨¡å‹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 # å‚æ•°ï¼šè¾“å…¥è¾“å‡ºå±‚ï¼Œä¸¤å±‚éšè—å±‚ num_inputs, num_outputs, num_hiddens1, num_hiddens2 = 784, 10, 256, 256 # Dropout dropout1, dropout2 = 0.3, 0.5 # å®šä¹‰äº†ä¸€ä¸ªç¥ç»ç½‘ç»œç±» Netï¼Œè¯¥ç±»ç»§æ‰¿è‡ª PyTorch çš„ nn.Module class Net(nn.Module): def __init__(self, num_inputs, num_outputs, num_hiddens1, num_hiddens2, is_training = True): super(Net, self).__init__() #è°ƒç”¨çˆ¶ç±» nn.Module çš„æ„é€ å‡½æ•°æ¥åˆå§‹åŒ–å½“å‰ç±» Net çš„å®ä¾‹ self.num_inputs = num_inputs self.training = is_training self.lin1 = nn.Linear(num_inputs, num_hiddens1) self.lin2 = nn.Linear(num_hiddens1, num_hiddens2) self.lin3 = nn.Linear(num_hiddens2, num_outputs) self.relu = nn.ReLU() def forward(self, X): H1 = self.relu(self.lin1(X.reshape((-1, self.num_inputs)))) # åªæœ‰åœ¨è®­ç»ƒæ¨¡å‹æ—¶æ‰ä½¿ç”¨dropout if self.training == True: # åœ¨ç¬¬ä¸€ä¸ªå…¨è¿æ¥å±‚ä¹‹åæ·»åŠ ä¸€ä¸ªdropoutå±‚ H1 = dropout_layer(H1, dropout1) H2 = self.relu(self.lin2(H1)) if self.training == True: # åœ¨ç¬¬äºŒä¸ªå…¨è¿æ¥å±‚ä¹‹åæ·»åŠ ä¸€ä¸ªdropoutå±‚ H2 = dropout_layer(H2, dropout2) out = self.lin3(H2) return out net = Net(num_inputs, num_outputs, num_hiddens1, num_hiddens2) è®­ç»ƒæµ‹è¯• 1 2 3 4 5 6 num_epochs, lr, batch_size = 10, 0.5, 256 loss = nn.CrossEntropyLoss(reduction='none') train_iter, test_iter = d2l.load_data_fashion_mnist(batch_size) trainer = torch.optim.SGD(net.parameters(), lr=lr) d2l.train_ch3(net, train_iter, test_iter, loss, num_epochs, trainer) #å·¦å›¾ å³å›¾ï¼šDropoutå‡è®¾ä¸º0çš„è®­ç»ƒç»“æœã€‚\n6.4 ç®€æ´å®ç° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 net = nn.Sequential(nn.Flatten(), nn.Linear(784, 256), nn.ReLU(), # åœ¨ç¬¬ä¸€ä¸ªå…¨è¿æ¥å±‚/æ¿€æ´»å‡½æ•°ä¹‹åæ·»åŠ ä¸€ä¸ªdropoutå±‚ nn.Dropout(dropout1), nn.Linear(256, 256), nn.ReLU(), # åœ¨ç¬¬äºŒä¸ªå…¨è¿æ¥å±‚/æ¿€æ´»å‡½æ•°ä¹‹åæ·»åŠ ä¸€ä¸ªdropoutå±‚ nn.Dropout(dropout2), nn.Linear(256, 10)) def init_weights(m): if type(m) == nn.Linear: nn.init.normal_(m.weight, std=0.01) net.apply(init_weights); trainer = torch.optim.SGD(net.parameters(), lr=lr) d2l.train_ch3(net, train_iter, test_iter, loss, num_epochs, trainer) 7. å‰å‘ä¼ æ’­ã€åå‘ä¼ æ’­å’Œè®¡ç®—å›¾ 7.1 å‰å‘ä¼ æ’­ å‰å‘ä¼ æ’­ï¼šæŒ‰é¡ºåºï¼ˆä»è¾“å…¥åˆ°è¾“å‡ºï¼‰è®¡ç®—å’Œå­˜å‚¨ç¥ç»ç½‘ç»œä¸­æ¯å±‚çš„ç»“æœï¼› å¦‚ä¸‹å›¾ä¸¾ä¾‹ï¼ˆç®€å•èµ·è§ï¼Œéšè—å±‚ä¸åŒ…æ‹¬åç½®é¡¹bï¼‰ è¾“å…¥å±‚ï¼šx éšè—å±‚ï¼šå‚æ•°W(1)ï¼Œè¾“å‡ºç»“æœzï¼›æ¿€æ´»å‡½æ•°(Î¦)è¾“å‡ºç»“æœh è¾“å‡ºå±‚ï¼šå‚æ•°W(2)ï¼Œè¾“å‡ºç»“æœo é¢„æµ‹æŸå¤±ï¼šL = l(o, y) æƒ©ç½šé¡¹ï¼šs ~ W(1), W(2) ç›®æ ‡å‡½æ•°ï¼ˆæ­£åˆ™åŒ–æŸå¤±ï¼‰ï¼šJ = L + s 7.2 åå‘ä¼ æ’­ åå‘ä¼ æ’­ï¼šä»è¾“å‡ºå±‚åˆ°è¾“å…¥å±‚è®¡ç®—å’Œå­˜å‚¨ç¥ç»ç½‘ç»œçš„å‚æ•°æ¢¯åº¦ï¼› å¦‚ä¸Šç¤ºä¾‹ é¦–å…ˆè®¡ç®—Jåˆ†åˆ«å…³äºLä¸sçš„æ¢¯åº¦ï¼› ç„¶åå¯è®¡ç®—Jå…³äºoçš„æ¢¯åº¦ï¼Œså…³äºW(1)ã€W(2)çš„æ¢¯åº¦ï¼› å†ä¾æ¬¡è®¡ç®—Jå…³äºW(2)çš„æ¢¯åº¦ï¼ŒJå…³äºhçš„æ¢¯åº¦ï¼ŒJå…³äºzçš„æ¢¯åº¦ï¼ŒJå…³äºW(1)çš„æ¢¯åº¦ 7.3 è®­ç»ƒç¥ç»ç½‘ç»œ å‰å‘ä¼ æ’­ä¸åå‘ä¼ æ’­ç›¸äº’ä¾èµ–ï¼› ä¾‹å¦‚ å‰å‘ä¼ æ’­è®¡ç®—çš„æ­£åˆ™åŒ–é¡¹så–å†³äºæ¨¡å‹w1ä¸w2çš„å½“å‰å€¼ï¼Œç”±ä¼˜åŒ–ç®—æ³•æ ¹æ®æœ€è¿‘è¿­ä»£çš„åå‘ä¼ æ’­ç»™å‡ºçš„ï¼› åå‘ä¼ æ’­å‚æ•°çš„æ¢¯åº¦è®¡ç®—ï¼Œå–å†³äºç”±å‰å‘ä¼ æ’­ç»™å‡ºçš„éšè—å˜é‡hçš„å½“å‰å€¼ã€‚ åå‘ä¼ æ’­éœ€è¦é‡å¤åˆ©ç”¨å‰å‘ä¼ æ’­ä¸­å‚¨å­˜çš„ä¸­é—´å€¼ï¼Œå‰¯ä½œç”¨æ˜¯éœ€è¦æš‚ç”¨è¾ƒå¤šçš„å†…å­˜ã€‚ 8. æ•°å€¼ç¨³å®šæ€§å’Œæ¨¡å‹åˆå§‹åŒ– 8.1 æ¢¯åº¦æ¶ˆå¤±ä¸æ¢¯åº¦çˆ†ç‚¸ å‘é‡å¯¹äºå‘é‡çš„æ¢¯åº¦ä¸ºçŸ©é˜µã€‚å½“è®¡ç®—ç›®æ ‡å‡½æ•°å¯¹äºç‰¹å®šéšè—å±‚å‚æ•°çš„å¯¼æ•°å¯èƒ½æ¶‰åŠå¤šä¸ªçŸ©é˜µçš„ä¹˜ç§¯ã€‚ æ¢¯åº¦æ¶ˆå¤±ï¼šå‚æ•°æ›´æ–°è¿‡å°ï¼Œåœ¨æ¯æ¬¡æ›´æ–°æ—¶å‡ ä¹ä¸ä¼šç§»åŠ¨ï¼Œå¯¼è‡´æ¨¡å‹æ— æ³•å­¦ä¹  ä¸€ä¸ªå¸¸è§çš„ä¾‹å­æ˜¯Sigmoidå‡½æ•°ï¼Œå‚è€ƒä¸Šè¿°2.2éƒ¨åˆ†ä»‹ç» å½“Sigmoidå‡½æ•°çš„è¾“å…¥ä¸è¾“å‡ºå¾ˆå¤§æˆ–å¾ˆå°æ—¶ï¼Œæ¢¯åº¦è¿‘ä¹æ¶ˆå¤±ã€‚ æ¢¯åº¦çˆ†ç‚¸ï¼šå‚æ•°æ›´æ–°è¿‡å¤§ï¼Œç ´åäº†æ¨¡å‹çš„ç¨³å®šæ”¶æ•› 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 import torch M = torch.normal(0, 1, size=(4,4)) print('ä¸€ä¸ªçŸ©é˜µ \\n',M) for i in range(100): M = torch.mm(M,torch.normal(0, 1, size=(4, 4))) print('ä¹˜ä»¥100ä¸ªçŸ©é˜µå\\n', M) #ä¸€ä¸ªçŸ©é˜µ # tensor([[-0.7872, 2.7090, 0.5996, -1.3191], # [-1.8260, -0.7130, -0.5521, 0.1051], # [ 1.1213, 1.0472, -0.3991, -0.3802], # [ 0.5552, 0.4517, -0.3218, 0.5214]]) #ä¹˜ä»¥100ä¸ªçŸ©é˜µå # tensor([[-2.1897e+26, 8.8308e+26, 1.9813e+26, 1.7019e+26], # [ 1.3110e+26, -5.2870e+26, -1.1862e+26, -1.0189e+26], # [-1.6008e+26, 6.4559e+26, 1.4485e+26, 1.2442e+26], # [ 3.0943e+25, -1.2479e+26, -2.7998e+25, -2.4050e+25]]) 8.2 å‚æ•°åˆå§‹åŒ– Xavieråˆå§‹åŒ–ï¼šå¯¹å…¨è¿æ¥å±‚æƒé‡çš„åˆå§‹åŒ–å–å†³äºè¾“å…¥ä¸è¾“å‡ºå±‚çš„ç¥ç»å…ƒæ•°é‡ ï¼ˆ1ï¼‰è‹¥æ˜¯æ­£æ€åˆ†å¸ƒï¼Œåˆ™ä»å‡å€¼ä¸º0ï¼Œæ–¹å·®å¦‚ä¸‹çš„é«˜æ–¯åˆ†å¸ƒä¸­æŠ½æ ·æƒé‡ï¼›\nï¼ˆ2ï¼‰ä¹Ÿå¯ä»¥æ”¹ä¸ºä»ä¸‹è¿°èŒƒå›´çš„å‡åŒ€åˆ†å¸ƒä¸­æŠ½æ ·æƒé‡\n",
  "wordCount" : "4159",
  "inLanguage": "en",
  "datePublished": "2024-07-28T00:00:00Z",
  "dateModified": "2024-07-28T00:00:00Z",
  "author":[{
    "@type": "Person",
    "name": "Lishensuo"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://lishensuo.github.io/en/posts/bioinfo/707d2l-%E7%AC%AC%E5%9B%9B%E7%AB%A0%E5%A4%9A%E5%B1%82%E6%84%9F%E7%9F%A5%E6%9C%BA/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Li's Bioinfo-Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://lishensuo.github.io/img/Q.gif"
    }
  }
}
</script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://lishensuo.github.io/en/" accesskey="h" title="Li&#39;s Bioinfo-Blog (Alt + H)">Li&#39;s Bioinfo-Blog</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                </ul>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://lishensuo.github.io/en/" title="ä¸»é¡µ">
                    <span>ä¸»é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/posts" title="åˆ†ç±»">
                    <span>åˆ†ç±»</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/tags" title="æ ‡ç­¾">
                    <span>æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/archives/" title="å½’æ¡£">
                    <span>å½’æ¡£</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/about" title="å…³äº">
                    <span>å…³äº</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/search" title="æœç´¢ (Alt &#43; /)" accesskey=/>
                    <span>æœç´¢</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://lishensuo.github.io/en/">Home</a>&nbsp;Â»&nbsp;<a href="https://lishensuo.github.io/en/posts/">åˆ†ç±»</a>&nbsp;Â»&nbsp;<a href="https://lishensuo.github.io/en/posts/bioinfo/">ğŸ“– ç”Ÿä¿¡æ•°æ®åˆ†æ--åˆ†ææµç¨‹ï¼Œå·¥å…·åŒ…ç­‰</a></div>
    <h1 class="post-title">
      D2L--ç¬¬å››ç« å¤šå±‚æ„ŸçŸ¥æœº
    </h1>
    <div class="post-meta">













Create:&amp;nbsp;&lt;span title=&#39;2024-07-28 00:00:00 &#43;0000 UTC&#39;&gt;2024-07-28&lt;/span&gt;&amp;nbsp;|&amp;nbsp;Update:&amp;nbsp;2024-07-28&amp;nbsp;|&amp;nbsp;Words:&amp;nbsp;4159&amp;nbsp;|&amp;nbsp;9 min&amp;nbsp;|&amp;nbsp;Lishensuo

|  Viewers: <span id="busuanzi_value_page_pv"></span> 
	  
    </div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">Table of Contents</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#1-%e5%a4%9a%e5%b1%82%e6%84%9f%e7%9f%a5%e6%9c%ba" aria-label="1. å¤šå±‚æ„ŸçŸ¥æœº">1. å¤šå±‚æ„ŸçŸ¥æœº</a><ul>
                            
                    <li>
                        <a href="#11-%e9%9a%90%e8%97%8f%e5%b1%82" aria-label="1.1 éšè—å±‚">1.1 éšè—å±‚</a></li>
                    <li>
                        <a href="#12-%e6%bf%80%e6%b4%bb%e5%87%bd%e6%95%b0" aria-label="1.2 æ¿€æ´»å‡½æ•°">1.2 æ¿€æ´»å‡½æ•°</a></li></ul>
                    </li>
                    <li>
                        <a href="#2-%e5%a4%9a%e5%b1%82%e6%84%9f%e7%9f%a5%e6%9c%ba%e7%9a%84%e4%bb%8e%e9%9b%b6%e5%ae%9e%e7%8e%b0" aria-label="2. å¤šå±‚æ„ŸçŸ¥æœºçš„ä»é›¶å®ç°">2. å¤šå±‚æ„ŸçŸ¥æœºçš„ä»é›¶å®ç°</a><ul>
                            
                    <li>
                        <a href="#21-%e5%88%9d%e5%a7%8b%e5%8c%96%e6%a8%a1%e5%9e%8b%e5%8f%82%e6%95%b0" aria-label="2.1 åˆå§‹åŒ–æ¨¡å‹å‚æ•°">2.1 åˆå§‹åŒ–æ¨¡å‹å‚æ•°</a></li>
                    <li>
                        <a href="#22-%e6%bf%80%e6%b4%bb%e5%87%bd%e6%95%b0" aria-label="2.2 æ¿€æ´»å‡½æ•°">2.2 æ¿€æ´»å‡½æ•°</a></li>
                    <li>
                        <a href="#23-%e6%a8%a1%e5%9e%8b" aria-label="2.3 æ¨¡å‹">2.3 æ¨¡å‹</a></li>
                    <li>
                        <a href="#24-%e6%8d%9f%e5%a4%b1%e5%87%bd%e6%95%b0" aria-label="2.4 æŸå¤±å‡½æ•°">2.4 æŸå¤±å‡½æ•°</a></li>
                    <li>
                        <a href="#25-%e8%ae%ad%e7%bb%83" aria-label="2.5 è®­ç»ƒ">2.5 è®­ç»ƒ</a></li></ul>
                    </li>
                    <li>
                        <a href="#3-%e5%a4%9a%e5%b1%82%e6%84%9f%e7%9f%a5%e6%9c%ba%e7%9a%84%e7%ae%80%e6%b4%81%e5%ae%9e%e7%8e%b0" aria-label="3. å¤šå±‚æ„ŸçŸ¥æœºçš„ç®€æ´å®ç°">3. å¤šå±‚æ„ŸçŸ¥æœºçš„ç®€æ´å®ç°</a></li>
                    <li>
                        <a href="#4-%e6%a8%a1%e5%9e%8b%e6%ac%a0%e6%8b%9f%e5%90%88%e5%92%8c%e8%bf%87%e6%8b%9f%e5%90%88" aria-label="4. æ¨¡å‹æ¬ æ‹Ÿåˆå’Œè¿‡æ‹Ÿåˆ">4. æ¨¡å‹æ¬ æ‹Ÿåˆå’Œè¿‡æ‹Ÿåˆ</a><ul>
                            
                    <li>
                        <a href="#41-%e8%ae%ad%e7%bb%83%e8%af%af%e5%b7%ae%e5%92%8c%e6%b3%9b%e5%8c%96%e8%af%af%e5%b7%ae" aria-label="4.1 è®­ç»ƒè¯¯å·®å’Œæ³›åŒ–è¯¯å·®">4.1 è®­ç»ƒè¯¯å·®å’Œæ³›åŒ–è¯¯å·®</a></li>
                    <li>
                        <a href="#42-%e6%a8%a1%e5%9e%8b%e9%80%89%e6%8b%a9" aria-label="4.2 æ¨¡å‹é€‰æ‹©">4.2 æ¨¡å‹é€‰æ‹©</a></li>
                    <li>
                        <a href="#43-%e6%ac%a0%e6%8b%9f%e5%90%88%e8%bf%98%e6%98%af%e8%bf%87%e6%8b%9f%e5%90%88" aria-label="4.3 æ¬ æ‹Ÿåˆè¿˜æ˜¯è¿‡æ‹Ÿåˆ">4.3 æ¬ æ‹Ÿåˆè¿˜æ˜¯è¿‡æ‹Ÿåˆ</a></li>
                    <li>
                        <a href="#44-%e5%a4%9a%e9%a1%b9%e5%bc%8f%e5%9b%9e%e5%bd%92" aria-label="4.4 å¤šé¡¹å¼å›å½’">4.4 å¤šé¡¹å¼å›å½’</a></li></ul>
                    </li>
                    <li>
                        <a href="#5-%e6%9d%83%e9%87%8d%e8%a1%b0%e5%87%8f" aria-label="5. æƒé‡è¡°å‡">5. æƒé‡è¡°å‡</a><ul>
                            
                    <li>
                        <a href="#51-%e8%8c%83%e6%95%b0%e4%b8%8e%e6%9d%83%e9%87%8d%e8%a1%b0%e5%87%8f" aria-label="5.1 èŒƒæ•°ä¸æƒé‡è¡°å‡">5.1 èŒƒæ•°ä¸æƒé‡è¡°å‡</a></li>
                    <li>
                        <a href="#52-%e9%ab%98%e7%bb%b4%e7%ba%bf%e6%80%a7%e5%9b%9e%e5%bd%92" aria-label="5.2 é«˜ç»´çº¿æ€§å›å½’">5.2 é«˜ç»´çº¿æ€§å›å½’</a></li>
                    <li>
                        <a href="#53-%e4%bb%8e%e9%9b%b6%e5%bc%80%e5%a7%8b%e5%ae%9e%e7%8e%b0" aria-label="5.3 ä»é›¶å¼€å§‹å®ç°">5.3 ä»é›¶å¼€å§‹å®ç°</a></li>
                    <li>
                        <a href="#54-%e7%ae%80%e6%b4%81%e5%ae%9e%e7%8e%b0" aria-label="5.4 ç®€æ´å®ç°">5.4 ç®€æ´å®ç°</a></li></ul>
                    </li>
                    <li>
                        <a href="#6-%e6%9a%82%e9%80%80%e6%b3%95" aria-label="6. æš‚é€€æ³•">6. æš‚é€€æ³•</a><ul>
                            
                    <li>
                        <a href="#61-%e6%89%b0%e5%8a%a8%e7%9a%84%e7%a8%b3%e5%81%a5%e6%80%a7" aria-label="6.1 æ‰°åŠ¨çš„ç¨³å¥æ€§">6.1 æ‰°åŠ¨çš„ç¨³å¥æ€§</a></li>
                    <li>
                        <a href="#62-%e5%ae%9e%e8%b7%b5%e4%b8%ad%e7%9a%84%e6%9a%82%e9%80%80%e6%b3%95" aria-label="6.2 å®è·µä¸­çš„æš‚é€€æ³•">6.2 å®è·µä¸­çš„æš‚é€€æ³•</a></li>
                    <li>
                        <a href="#63-%e4%bb%8e%e9%9b%b6%e5%bc%80%e5%a7%8b%e5%ae%9e%e7%8e%b0" aria-label="6.3 ä»é›¶å¼€å§‹å®ç°">6.3 ä»é›¶å¼€å§‹å®ç°</a></li>
                    <li>
                        <a href="#64-%e7%ae%80%e6%b4%81%e5%ae%9e%e7%8e%b0" aria-label="6.4 ç®€æ´å®ç°">6.4 ç®€æ´å®ç°</a></li></ul>
                    </li>
                    <li>
                        <a href="#7-%e5%89%8d%e5%90%91%e4%bc%a0%e6%92%ad%e5%90%8e%e5%90%91%e4%bc%a0%e6%92%ad%e5%92%8c%e8%ae%a1%e7%ae%97%e5%9b%be" aria-label="7. å‰å‘ä¼ æ’­ã€åå‘ä¼ æ’­å’Œè®¡ç®—å›¾">7. å‰å‘ä¼ æ’­ã€åå‘ä¼ æ’­å’Œè®¡ç®—å›¾</a><ul>
                            
                    <li>
                        <a href="#71-%e5%89%8d%e5%90%91%e4%bc%a0%e6%92%ad" aria-label="7.1 å‰å‘ä¼ æ’­">7.1 å‰å‘ä¼ æ’­</a></li>
                    <li>
                        <a href="#72-%e5%8f%8d%e5%90%91%e4%bc%a0%e6%92%ad" aria-label="7.2 åå‘ä¼ æ’­">7.2 åå‘ä¼ æ’­</a></li>
                    <li>
                        <a href="#73-%e8%ae%ad%e7%bb%83%e7%a5%9e%e7%bb%8f%e7%bd%91%e7%bb%9c" aria-label="7.3 è®­ç»ƒç¥ç»ç½‘ç»œ">7.3 è®­ç»ƒç¥ç»ç½‘ç»œ</a></li></ul>
                    </li>
                    <li>
                        <a href="#8-%e6%95%b0%e5%80%bc%e7%a8%b3%e5%ae%9a%e6%80%a7%e5%92%8c%e6%a8%a1%e5%9e%8b%e5%88%9d%e5%a7%8b%e5%8c%96" aria-label="8. æ•°å€¼ç¨³å®šæ€§å’Œæ¨¡å‹åˆå§‹åŒ–">8. æ•°å€¼ç¨³å®šæ€§å’Œæ¨¡å‹åˆå§‹åŒ–</a><ul>
                            
                    <li>
                        <a href="#81-%e6%a2%af%e5%ba%a6%e6%b6%88%e5%a4%b1%e4%b8%8e%e6%a2%af%e5%ba%a6%e7%88%86%e7%82%b8" aria-label="8.1 æ¢¯åº¦æ¶ˆå¤±ä¸æ¢¯åº¦çˆ†ç‚¸">8.1 æ¢¯åº¦æ¶ˆå¤±ä¸æ¢¯åº¦çˆ†ç‚¸</a></li>
                    <li>
                        <a href="#82-%e5%8f%82%e6%95%b0%e5%88%9d%e5%a7%8b%e5%8c%96" aria-label="8.2 å‚æ•°åˆå§‹åŒ–">8.2 å‚æ•°åˆå§‹åŒ–</a>
                    </li>
                </ul>
                </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>


  <div class="post-content"><h1 id="1-å¤šå±‚æ„ŸçŸ¥æœº">1. å¤šå±‚æ„ŸçŸ¥æœº<a hidden class="anchor" aria-hidden="true" href="#1-å¤šå±‚æ„ŸçŸ¥æœº">#</a></h1>
<h2 id="11-éšè—å±‚">1.1 éšè—å±‚<a hidden class="anchor" aria-hidden="true" href="#11-éšè—å±‚">#</a></h2>
<ul>
<li>ä¹‹å‰æ‰€å­¦çš„çº¿æ€§æ¨¡å‹æ„å‘³ç€å•è°ƒå‡è®¾ï¼Œå¹¶ä¸é€‚ç”¨äºæ›´å¤æ‚çš„å»ºæ¨¡é—®é¢˜ï¼Œä¾‹å¦‚ä½“æ¸©ä¸ç–¾ç—…ï¼›å›¾ç‰‡æŸä¸ªåƒç´ ç‚¹çš„å¼ºåº¦ä¸çŒ«æˆ–ç‹—çš„å…³ç³»ç­‰ï¼›</li>
<li>å¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰ï¼šåœ¨è¾“å…¥å±‚ä¸è¾“å‡ºå±‚ä¹‹é—´åŠ å…¥ä¸€ä¸ªæˆ–å¤šä¸ªéšè—å±‚ï¼Œä»¥å­¦ä¹ æ›´åŠ å¤æ‚çš„æ¨¡å‹æƒ…å†µï¼›
<ul>
<li>åªæœ‰éšè—å±‚ä¸è¾“å‡ºå±‚æ¶‰åŠåˆ°ç¥ç»å…ƒè®¡ç®—ä¸å‚æ•°æ›´æ–°ï¼Œå› æ­¤å¦‚ä¸‹ç¤ºä¾‹MLPçš„å±‚æ•°æ˜¯2ï¼›</li>
<li>å¯¹äºå…¶ä¸­çš„éšè—å±‚éœ€è¦åº”ç”¨éçº¿æ€§çš„æ¿€æ´»å‡½æ•°ï¼ˆÏƒï¼‰ï¼Œä»¥çªç ´å¯¹ä»ä¸ºçº¿æ€§æœ¬è´¨çš„é™åˆ¶ã€‚</li>
</ul>
</li>
</ul>
<p><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images2/main/img01/image-20240723082016977.png" alt="image-20240723082016977"  />
</p>
<ul>
<li>å¯¹äºnä¸ªæ ·æœ¬ï¼Œdä¸ªç‰¹å¾çš„è¾“å…¥<strong>X</strong> (nÃ—d)ã€‚ä¸­é—´éšè—å±‚çš„ç¥ç»å…ƒä¸ªæ•°ä¸ºhï¼Œæƒé‡å‚æ•°ä¸º<strong>W1</strong>(dÃ—h)ï¼Œåç½®å‚æ•°ä¸º<strong>b1</strong>(1Ã—h)ã€‚è¾“å‡ºå±‚ç¥ç»å…ƒä¸ªæ•°ä¸ºqï¼Œæƒé‡å‚æ•°ä¸º<strong>W2</strong>(hÃ—q)ï¼Œåç½®å‚æ•°ä¸º<strong>b2</strong>(1Ã—q)ã€‚</li>
</ul>
<p><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images2/main/img01/image-20240723083413900.png" alt="image-20240723083413900"  />
</p>
<h2 id="12-æ¿€æ´»å‡½æ•°">1.2 æ¿€æ´»å‡½æ•°<a hidden class="anchor" aria-hidden="true" href="#12-æ¿€æ´»å‡½æ•°">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>%matplotlib inline
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> torch
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">from</span> d2l <span style="color:#fff;font-weight:bold">import</span> torch <span style="color:#fff;font-weight:bold">as</span> d2l
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ï¼ˆ1ï¼‰ReLuå‡½æ•°</strong></p>
<ul>
<li>å˜æ¢æ–¹å¼ï¼šéšè—å±‚è¾“å‡ºçš„ç»“æœè‹¥ä¸ºè´Ÿæ•°ï¼Œå˜ä¸º0ï¼›æ­£æ•°ä¿æŒä¸å˜ï¼›</li>
<li>å®ç°ç®€å•ï¼Œè¡¨ç°è‰¯å¥½ã€‚</li>
</ul>
<p><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images2/main/img01/image-20240723131359090.png" alt="image-20240723131359090"  />
</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>x = torch.arange(-<span style="color:#ff0;font-weight:bold">8.0</span>, <span style="color:#ff0;font-weight:bold">8.0</span>, <span style="color:#ff0;font-weight:bold">0.1</span>, requires_grad=<span style="color:#fff;font-weight:bold">True</span>)
</span></span><span style="display:flex;"><span>y = torch.relu(x)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># ç»˜åˆ¶æ¿€æ´»å‰ï¼ˆxï¼‰ä¸åï¼ˆyï¼‰</span>
</span></span><span style="display:flex;"><span>d2l.plot(x.detach(), y.detach(), <span style="color:#0ff;font-weight:bold">&#39;x&#39;</span>, <span style="color:#0ff;font-weight:bold">&#39;relu(x)&#39;</span>, figsize=(<span style="color:#ff0;font-weight:bold">5</span>, <span style="color:#ff0;font-weight:bold">2.5</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># è®¡ç®—æ¿€æ´»å‡½æ•°çš„å¯¼æ•°</span>
</span></span><span style="display:flex;"><span>y.backward(torch.ones_like(x), retain_graph=<span style="color:#fff;font-weight:bold">True</span>)
</span></span><span style="display:flex;"><span>d2l.plot(x.detach(), x.grad, <span style="color:#0ff;font-weight:bold">&#39;x&#39;</span>, <span style="color:#0ff;font-weight:bold">&#39;grad of relu&#39;</span>, figsize=(<span style="color:#ff0;font-weight:bold">5</span>, <span style="color:#ff0;font-weight:bold">2.5</span>))
</span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images2/main/img01/image-20240723132432201.png" alt="image-20240723132432201"  />
</p>
<blockquote>
<p>ä¸è¦å¤ªçº ç»“x=0çš„æƒ…å†µâ€”â€œå¦‚æœå¾®å¦™çš„è¾¹ç•Œæ¡ä»¶å¾ˆé‡è¦ï¼Œæˆ‘ä»¬å¾ˆå¯èƒ½æ˜¯åœ¨ç ”ç©¶æ•°å­¦è€Œéå·¥ç¨‹â€</p></blockquote>
<p><strong>ï¼ˆ2ï¼‰sigmoidå‡½æ•°</strong></p>
<ul>
<li>å˜æ¢æ–¹å¼ï¼šéšè—å±‚è¾“å‡ºçš„ç»“æœå˜æ¢åˆ°0ä¸1ä¹‹é—´ï¼›</li>
<li>å¦‚ä»Šåœ¨éšè—å±‚ä¸­å·²ç»ä¸å¸¸ç”¨ï¼Œå¤šç”¨äºäºŒåˆ†ç±»é—®é¢˜ä¸­è¾“å‡ºå±‚çš„æ¿€æ´»å‡½æ•°</li>
</ul>
<p><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images2/main/img01/image-20240723132744827.png" alt="image-20240723132744827"  />
</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#007f7f"># ç»˜åˆ¶æ¿€æ´»å‰ï¼ˆxï¼‰ä¸åï¼ˆyï¼‰</span>
</span></span><span style="display:flex;"><span>y = torch.sigmoid(x)
</span></span><span style="display:flex;"><span>d2l.plot(x.detach(), y.detach(), <span style="color:#0ff;font-weight:bold">&#39;x&#39;</span>, <span style="color:#0ff;font-weight:bold">&#39;sigmoid(x)&#39;</span>, figsize=(<span style="color:#ff0;font-weight:bold">5</span>, <span style="color:#ff0;font-weight:bold">2.5</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># è®¡ç®—æ¿€æ´»å‡½æ•°çš„å¯¼æ•°</span>
</span></span><span style="display:flex;"><span>x.grad.data.zero_()
</span></span><span style="display:flex;"><span>y.backward(torch.ones_like(x),retain_graph=<span style="color:#fff;font-weight:bold">True</span>)
</span></span><span style="display:flex;"><span>d2l.plot(x.detach(), x.grad, <span style="color:#0ff;font-weight:bold">&#39;x&#39;</span>, <span style="color:#0ff;font-weight:bold">&#39;grad of sigmoid&#39;</span>, figsize=(<span style="color:#ff0;font-weight:bold">5</span>, <span style="color:#ff0;font-weight:bold">2.5</span>))
</span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images2/main/img01/image-20240723133604798.png" alt="image-20240723133604798"  />
</p>
<p><strong>ï¼ˆ3ï¼‰tanhå‡½æ•°ï¼ˆåŒæ›²æ­£åˆ‡ï¼‰</strong></p>
<ul>
<li>å˜æ¢æ–¹å¼ï¼šéšè—å±‚è¾“å‡ºçš„ç»“æœå˜æ¢åˆ°-1ä¸1ä¹‹é—´ï¼›</li>
</ul>
<p><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images2/main/img01/image-20240728225804350.png" alt="image-20240728225804350"  />
</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#007f7f"># ç»˜åˆ¶æ¿€æ´»å‰ï¼ˆxï¼‰ä¸åï¼ˆyï¼‰</span>
</span></span><span style="display:flex;"><span>y = torch.tanh(x)
</span></span><span style="display:flex;"><span>d2l.plot(x.detach(), y.detach(), <span style="color:#0ff;font-weight:bold">&#39;x&#39;</span>, <span style="color:#0ff;font-weight:bold">&#39;tanh(x)&#39;</span>, figsize=(<span style="color:#ff0;font-weight:bold">5</span>, <span style="color:#ff0;font-weight:bold">2.5</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># è®¡ç®—æ¿€æ´»å‡½æ•°çš„å¯¼æ•°</span>
</span></span><span style="display:flex;"><span>x.grad.data.zero_()
</span></span><span style="display:flex;"><span>y.backward(torch.ones_like(x),retain_graph=<span style="color:#fff;font-weight:bold">True</span>)
</span></span><span style="display:flex;"><span>d2l.plot(x.detach(), x.grad, <span style="color:#0ff;font-weight:bold">&#39;x&#39;</span>, <span style="color:#0ff;font-weight:bold">&#39;grad of tanh&#39;</span>, figsize=(<span style="color:#ff0;font-weight:bold">5</span>, <span style="color:#ff0;font-weight:bold">2.5</span>))
</span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images2/main/img01/image-20240723134023390.png" alt="image-20240723134023390"  />
</p>
<h1 id="2-å¤šå±‚æ„ŸçŸ¥æœºçš„ä»é›¶å®ç°">2. å¤šå±‚æ„ŸçŸ¥æœºçš„ä»é›¶å®ç°<a hidden class="anchor" aria-hidden="true" href="#2-å¤šå±‚æ„ŸçŸ¥æœºçš„ä»é›¶å®ç°">#</a></h1>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> torch
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">from</span> torch <span style="color:#fff;font-weight:bold">import</span> nn
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">from</span> d2l <span style="color:#fff;font-weight:bold">import</span> torch <span style="color:#fff;font-weight:bold">as</span> d2l
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>batch_size = <span style="color:#ff0;font-weight:bold">256</span>
</span></span><span style="display:flex;"><span>train_iter, test_iter = d2l.load_data_fashion_mnist(batch_size)
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="21-åˆå§‹åŒ–æ¨¡å‹å‚æ•°">2.1 åˆå§‹åŒ–æ¨¡å‹å‚æ•°<a hidden class="anchor" aria-hidden="true" href="#21-åˆå§‹åŒ–æ¨¡å‹å‚æ•°">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>num_inputs, num_outputs, num_hiddens = <span style="color:#ff0;font-weight:bold">784</span>, <span style="color:#ff0;font-weight:bold">10</span>, <span style="color:#ff0;font-weight:bold">256</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># éšè—å±‚</span>
</span></span><span style="display:flex;"><span>W1 = nn.Parameter(torch.randn(
</span></span><span style="display:flex;"><span>    num_inputs, num_hiddens, requires_grad=<span style="color:#fff;font-weight:bold">True</span>) * <span style="color:#ff0;font-weight:bold">0.01</span>)
</span></span><span style="display:flex;"><span>b1 = nn.Parameter(torch.zeros(num_hiddens, requires_grad=<span style="color:#fff;font-weight:bold">True</span>))
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># è¾“å‡ºå±‚</span>
</span></span><span style="display:flex;"><span>W2 = nn.Parameter(torch.randn(
</span></span><span style="display:flex;"><span>    num_hiddens, num_outputs, requires_grad=<span style="color:#fff;font-weight:bold">True</span>) * <span style="color:#ff0;font-weight:bold">0.01</span>)
</span></span><span style="display:flex;"><span>b2 = nn.Parameter(torch.zeros(num_outputs, requires_grad=<span style="color:#fff;font-weight:bold">True</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>params = [W1, b1, W2, b2]
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="22-æ¿€æ´»å‡½æ•°">2.2 æ¿€æ´»å‡½æ•°<a hidden class="anchor" aria-hidden="true" href="#22-æ¿€æ´»å‡½æ•°">#</a></h2>
<ul>
<li>è‡ªå®šä¹‰ReLuå‡½æ•°</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> relu(X):
</span></span><span style="display:flex;"><span>    a = torch.zeros_like(X)
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> torch.max(X, a)
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="23-æ¨¡å‹">2.3 æ¨¡å‹<a hidden class="anchor" aria-hidden="true" href="#23-æ¨¡å‹">#</a></h2>
<ul>
<li>2å±‚MLPç»“æ„</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> net(X):
</span></span><span style="display:flex;"><span>    X = X.reshape((-<span style="color:#ff0;font-weight:bold">1</span>, num_inputs))
</span></span><span style="display:flex;"><span>    H = relu(X@W1 + b1)  <span style="color:#007f7f"># è¿™é‡Œâ€œ@â€ä»£è¡¨çŸ©é˜µä¹˜æ³•</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> (H@W2 + b2)
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="24-æŸå¤±å‡½æ•°">2.4 æŸå¤±å‡½æ•°<a hidden class="anchor" aria-hidden="true" href="#24-æŸå¤±å‡½æ•°">#</a></h2>
<ul>
<li>äº¤å‰ç†µæŸå¤±å‡½æ•°</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>loss = nn.CrossEntropyLoss(reduction=<span style="color:#0ff;font-weight:bold">&#39;none&#39;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="25-è®­ç»ƒ">2.5 è®­ç»ƒ<a hidden class="anchor" aria-hidden="true" href="#25-è®­ç»ƒ">#</a></h2>
<ul>
<li>è°ƒç”¨ç¬¬ä¸‰ç« çš„è®­ç»ƒå‡½æ•°</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>num_epochs, lr = <span style="color:#ff0;font-weight:bold">10</span>, <span style="color:#ff0;font-weight:bold">0.1</span>
</span></span><span style="display:flex;"><span>updater = torch.optim.SGD(params, lr=lr)
</span></span><span style="display:flex;"><span>d2l.train_ch3(net, train_iter, test_iter, loss, num_epochs, updater)
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="3-å¤šå±‚æ„ŸçŸ¥æœºçš„ç®€æ´å®ç°">3. å¤šå±‚æ„ŸçŸ¥æœºçš„ç®€æ´å®ç°<a hidden class="anchor" aria-hidden="true" href="#3-å¤šå±‚æ„ŸçŸ¥æœºçš„ç®€æ´å®ç°">#</a></h1>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> torch
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">from</span> torch <span style="color:#fff;font-weight:bold">import</span> nn
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">from</span> d2l <span style="color:#fff;font-weight:bold">import</span> torch <span style="color:#fff;font-weight:bold">as</span> d2l
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#007f7f"># æ¨¡å‹ç»“æ„</span>
</span></span><span style="display:flex;"><span>net = nn.Sequential(nn.Flatten(),
</span></span><span style="display:flex;"><span>                    nn.Linear(<span style="color:#ff0;font-weight:bold">784</span>, <span style="color:#ff0;font-weight:bold">256</span>),
</span></span><span style="display:flex;"><span>                    nn.ReLU(), <span style="color:#007f7f">#æ¿€æ´»å‡½æ•°</span>
</span></span><span style="display:flex;"><span>                    nn.Linear(<span style="color:#ff0;font-weight:bold">256</span>, <span style="color:#ff0;font-weight:bold">10</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># å‚æ•°åˆå§‹åŒ–</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> init_weights(m):
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> <span style="color:#fff;font-weight:bold">type</span>(m) == nn.Linear:
</span></span><span style="display:flex;"><span>        nn.init.normal_(m.weight, std=<span style="color:#ff0;font-weight:bold">0.01</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>net.apply(init_weights);
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>batch_size, lr, num_epochs = <span style="color:#ff0;font-weight:bold">256</span>, <span style="color:#ff0;font-weight:bold">0.1</span>, <span style="color:#ff0;font-weight:bold">10</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>loss = nn.CrossEntropyLoss(reduction=<span style="color:#0ff;font-weight:bold">&#39;none&#39;</span>)
</span></span><span style="display:flex;"><span>trainer = torch.optim.SGD(net.parameters(), lr=lr)
</span></span><span style="display:flex;"><span>train_iter, test_iter = d2l.load_data_fashion_mnist(batch_size)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>d2l.train_ch3(net, train_iter, test_iter, loss, num_epochs, trainer)
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="4-æ¨¡å‹æ¬ æ‹Ÿåˆå’Œè¿‡æ‹Ÿåˆ">4. æ¨¡å‹æ¬ æ‹Ÿåˆå’Œè¿‡æ‹Ÿåˆ<a hidden class="anchor" aria-hidden="true" href="#4-æ¨¡å‹æ¬ æ‹Ÿåˆå’Œè¿‡æ‹Ÿåˆ">#</a></h1>
<h2 id="41-è®­ç»ƒè¯¯å·®å’Œæ³›åŒ–è¯¯å·®">4.1 è®­ç»ƒè¯¯å·®å’Œæ³›åŒ–è¯¯å·®<a hidden class="anchor" aria-hidden="true" href="#41-è®­ç»ƒè¯¯å·®å’Œæ³›åŒ–è¯¯å·®">#</a></h2>
<ul>
<li>è®­ç»ƒè¯¯å·®ï¼šæ¨¡å‹åœ¨è®­ç»ƒæ•°æ®é›†ä¸Šè®¡ç®—å¾—åˆ°çš„è¯¯å·®ï¼›</li>
<li>æ³›åŒ–è¯¯å·®ï¼šæ¨¡å‹åº”ç”¨åœ¨åŒæ ·ä»åŸå§‹æ ·æœ¬çš„åˆ†å¸ƒä¸­æŠ½å–çš„æ— é™å¤šæ•°æ®æ ·æœ¬æ—¶ï¼Œæ¨¡å‹è¯¯å·®çš„æœŸæœ›ï¼ˆç†è®ºï¼‰ï¼›</li>
<li>è¿‡æ‹Ÿåˆï¼šæ¨¡å‹åœ¨è®­ç»ƒæ•°æ®ä¸Šæ‹Ÿåˆçš„æ¯”åœ¨æ½œåœ¨åˆ†å¸ƒä¸­æ›´æ¥è¿‘çš„ç°è±¡ã€‚</li>
<li>å½±å“æ¨¡å‹æ³›åŒ–çš„å› ç´ ï¼š
<ul>
<li>ï¼ˆ1ï¼‰å‚æ•°æ•°é‡ï¼šå¯è°ƒæ•´å‚æ•°çš„æ•°é‡è¶Šå¤šï¼Œè¶Šå®¹æ˜“è¿‡æ‹Ÿåˆï¼›</li>
<li>ï¼ˆ2ï¼‰å‚æ•°å–å€¼ï¼šå‚æ•°çš„å–å€¼èŒƒå›´è¶Šå¤§ï¼Œè¶Šå®¹æ˜“è¿‡æ‹Ÿåˆï¼›</li>
<li>ï¼ˆ3ï¼‰è®­ç»ƒæ ·æœ¬çš„æ•°é‡ï¼šåŸåˆ™ä¸Šï¼Œè®­ç»ƒæ ·æœ¬è¶Šå°‘ï¼Œè¶Šå®¹æ˜“è¿‡æ‹Ÿåˆã€‚ã€DLè‡³å°‘è¦ä¸Šåƒæ ·æœ¬ã€‘</li>
</ul>
</li>
</ul>
<h2 id="42-æ¨¡å‹é€‰æ‹©">4.2 æ¨¡å‹é€‰æ‹©<a hidden class="anchor" aria-hidden="true" href="#42-æ¨¡å‹é€‰æ‹©">#</a></h2>
<ul>
<li>æ¯”è¾ƒä¸åŒè¶…å‚æ•°è®¾ç½®ä¸‹çš„åŒä¸€ç±»æ¨¡å‹ï¼Œä¼šæ¶‰åŠåˆ°æ•°æ®é›†çš„å¤šç§åˆ’åˆ†æ–¹å¼ã€‚</li>
<li>æ–¹å¼1ï¼šå°†æ•°æ®åˆ†ä¸º3ä»½
<ul>
<li>è®­ç»ƒæ•°æ®é›†ç”¨äºè®­ç»ƒæ¨¡å‹</li>
<li>éªŒè¯æ•°æ®é›†ç”¨äºæ¯”è¾ƒã€é€‰æ‹©æ¨¡å‹</li>
<li>æµ‹è¯•æ•°æ®é›†ç”¨äºæœ€ç»ˆçš„æ³›åŒ–è¯„ä¼°ï¼ˆè”æƒ³é«˜è€ƒï¼‰</li>
</ul>
</li>
</ul>
<blockquote>
<p>åœ¨ä»£ç å®ç°éƒ¨åˆ†ï¼Œæ•™ææ‰€å†™çš„æµ‹è¯•é›†å…¶å®è¿˜æ˜¯éªŒè¯é›†ã€‚</p></blockquote>
<ul>
<li>æ–¹å¼2ï¼šKæŠ˜äº¤å‰éªŒè¯ï¼ˆæ ·æœ¬é‡ä¸å¤šæ—¶ï¼‰
<ul>
<li>å°†æ•°æ®åˆ†ä¸ºKä¸ªå­é›†</li>
<li>æ¯æ¬¡é€‰å–K-1ä¸ªå­é›†è®­ç»ƒï¼Œåœ¨å‰©ä½™çš„ä¸€ä¸ªè‡ªå·±éªŒè¯ï¼›</li>
<li>å–Kæ¬¡å®éªŒçš„å‡å€¼ã€‚</li>
</ul>
</li>
</ul>
<blockquote>
<p>åœ¨DLä¸­ï¼Œç”±äºè®­ç»ƒæˆæœ¬è¾ƒé«˜ï¼Œä¸ä¼šå¤ªå¸¸ç”¨ï¼›åœ¨MLä¸­å¸¸ç”¨ã€‚</p></blockquote>
<h2 id="43-æ¬ æ‹Ÿåˆè¿˜æ˜¯è¿‡æ‹Ÿåˆ">4.3 æ¬ æ‹Ÿåˆè¿˜æ˜¯è¿‡æ‹Ÿåˆ<a hidden class="anchor" aria-hidden="true" href="#43-æ¬ æ‹Ÿåˆè¿˜æ˜¯è¿‡æ‹Ÿåˆ">#</a></h2>
<ul>
<li>æ¬ æ‹Ÿåˆ
<ul>
<li>è®­ç»ƒè¯¯å·®ä¸éªŒè¯è¯¯å·®éƒ½å¾ˆå¤§ï¼Œå·®è·è¾ƒå°ï¼›</li>
<li>æ¨¡å‹å¯èƒ½è¿‡äºç®€å•ï¼Œæœ‰ç†ç”±ç›¸ä¿¡å¯è®­ç»ƒæ›´å¤æ‚çš„æ¨¡å‹å‡å°è®­ç»ƒè¯¯å·®</li>
</ul>
</li>
<li>è¿‡æ‹Ÿåˆ
<ul>
<li>è®­ç»ƒè¯¯å·®æ˜æ˜¾å°äºéªŒè¯è¯¯å·®ï¼›</li>
<li>å€¼å¾—æ³¨æ„ï¼Œè¿‡æ‹Ÿåˆå¹¶ä¸æ€»æ˜¯åäº‹ã€‚æœ€ç»ˆè¿˜æ˜¯æ›´å…³å¿ƒéªŒè¯è¯¯å·®ã€‚</li>
</ul>
</li>
</ul>
<p><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images2/main/img01/image-20240723210626475.png" alt="image-20240723210626475"  />
</p>
<h2 id="44-å¤šé¡¹å¼å›å½’">4.4 å¤šé¡¹å¼å›å½’<a hidden class="anchor" aria-hidden="true" href="#44-å¤šé¡¹å¼å›å½’">#</a></h2>
<ul>
<li>æ•™æä¸­ä¸¾äº†ä¸€ä¸ªä¾‹å­ç›´è§‚çš„è§£é‡Šäº†æ¨¡å‹å¤æ‚åº¦ï¼ˆå‚æ•°æ•°é‡ï¼‰å¯¹äºæ¨¡å‹æ‹Ÿåˆçš„å½±å“ã€‚</li>
<li>é¦–å…ˆç”Ÿæˆäº†200ä¸ªæ ·æœ¬çš„20ä¸ªç‰¹å¾æ•°æ®ï¼›ç‰¹å¾åˆ†åˆ«æ¥è‡ªäº0~19æ¬¡å¹‚çš„ç»“æœï¼Œè€ŒçœŸå®çš„æ ‡ç­¾yä»…æ¥è‡ªå¦‚ä¸‹å›¾æ‰€ç¤ºçš„å‰å››ä¸ªå¤šé¡¹å¼ã€‚
<ul>
<li>ç¬¬ä¸€æ¬¡è®­ç»ƒï¼šå–å‰4åˆ—ç‰¹å¾ï¼Œæ‹Ÿåˆæ­£å¸¸ï¼›</li>
<li>ç¬¬äºŒæ¬¡è®­ç»ƒï¼šå–å‰2åˆ—ç‰¹å¾ï¼Œæ¬ æ‹Ÿåˆï¼ˆå‚æ•°è¿‡å°‘ï¼‰ï¼›</li>
<li>ç¬¬ä¸‰æ¬¡è®­ç»ƒï¼šå–å…¨éƒ¨20åˆ—æ•°æ®ï¼Œè¿‡æ‹Ÿåˆï¼ˆå‚æ•°è¿‡å¤šï¼‰ã€‚</li>
</ul>
</li>
<li>è¯¦è§æ•™æä»£ç ï¼šhttps://zh-v2.d2l.ai/chapter_multilayer-perceptrons/underfit-overfit.html</li>
</ul>
<p><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images2/main/img01/image-20240723220009110.png" alt="image-20240723220009110"  />
</p>
<h1 id="5-æƒé‡è¡°å‡">5. æƒé‡è¡°å‡<a hidden class="anchor" aria-hidden="true" href="#5-æƒé‡è¡°å‡">#</a></h1>
<h2 id="51-èŒƒæ•°ä¸æƒé‡è¡°å‡">5.1 èŒƒæ•°ä¸æƒé‡è¡°å‡<a hidden class="anchor" aria-hidden="true" href="#51-èŒƒæ•°ä¸æƒé‡è¡°å‡">#</a></h2>
<ul>
<li>æ¨¡å‹å¤æ‚åº¦çš„å½±å“å› ç´ ä¹‹ä¸€æ˜¯å‚æ•°çš„å¤§å°å–å€¼èŒƒå›´ï¼Œå¯é€šè¿‡<strong>L2èŒƒæ•°</strong>è¡¡é‡ï¼›</li>
<li>å¯å°†å‚æ•°çš„èŒƒæ•°ä½œä¸º<strong>æƒ©ç½šé¡¹</strong>ï¼Œå’Œé¢„æµ‹æŸå¤±å…±åŒä½œä¸ºæœ€å°åŒ–çš„è®­ç»ƒç›®æ ‡ï¼›</li>
<li>å¦‚ä¸‹å…¬å¼ï¼Œå…·ä½“å¯é€šè¿‡æ­£åˆ™åŒ–å¸¸æ•°<strong>Î»</strong>æ§åˆ¶æƒ©ç½šé¡¹çš„å½±å“ç¨‹åº¦ã€‚
<ul>
<li>è¾ƒå°çš„<strong>Î»</strong>å€¼å¯¹<strong>w</strong>çº¦æŸè¾ƒå°ï¼›</li>
<li>è¾ƒå¤§çš„<strong>Î»</strong>å€¼å¯¹<strong>w</strong>çº¦æŸè¾ƒå¤§ï¼›</li>
</ul>
</li>
</ul>
<p><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images2/main/img01/image-20240724203448047.png" alt="image-20240724203448047"  />
</p>
<blockquote>
<p>é€šå¸¸ï¼Œç½‘ç»œè¾“å‡ºå±‚çš„åç½®é¡¹ä¸ä¼šè¢«æ­£åˆ™åŒ–ã€‚</p></blockquote>
<h2 id="52-é«˜ç»´çº¿æ€§å›å½’">5.2 é«˜ç»´çº¿æ€§å›å½’<a hidden class="anchor" aria-hidden="true" href="#52-é«˜ç»´çº¿æ€§å›å½’">#</a></h2>
<ul>
<li>æ¨¡æ‹Ÿæ•°æ®ï¼Œåœ¨5.3æ¼”ç¤ºæƒé‡è¡°å‡çš„ä½œç”¨</li>
</ul>
<p><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images2/main/img01/image-20240724205316374.png" alt="image-20240724205316374"  />
</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#007f7f"># è®­ç»ƒæ ·æœ¬æ•°(20)è¾ƒå°‘ï¼Œè¾“å…¥ç‰¹å¾è¾ƒå¤š(200)ï¼Œå®¹æ˜“è¿‡æ‹Ÿåˆ</span>
</span></span><span style="display:flex;"><span>n_train, n_test, num_inputs, batch_size = <span style="color:#ff0;font-weight:bold">20</span>, <span style="color:#ff0;font-weight:bold">100</span>, <span style="color:#ff0;font-weight:bold">200</span>, <span style="color:#ff0;font-weight:bold">5</span>
</span></span><span style="display:flex;"><span>true_w, true_b = torch.ones((num_inputs, <span style="color:#ff0;font-weight:bold">1</span>)) * <span style="color:#ff0;font-weight:bold">0.01</span>, <span style="color:#ff0;font-weight:bold">0.05</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>train_data = d2l.synthetic_data(true_w, true_b, n_train)
</span></span><span style="display:flex;"><span>train_iter = d2l.load_array(train_data, batch_size)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>test_data = d2l.synthetic_data(true_w, true_b, n_test)
</span></span><span style="display:flex;"><span>test_iter = d2l.load_array(test_data, batch_size, is_train=<span style="color:#fff;font-weight:bold">False</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="53-ä»é›¶å¼€å§‹å®ç°">5.3 ä»é›¶å¼€å§‹å®ç°<a hidden class="anchor" aria-hidden="true" href="#53-ä»é›¶å¼€å§‹å®ç°">#</a></h2>
<ul>
<li>åˆå§‹åŒ–æ¨¡å‹å‚æ•°</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> init_params():
</span></span><span style="display:flex;"><span>    w = torch.normal(<span style="color:#ff0;font-weight:bold">0</span>, <span style="color:#ff0;font-weight:bold">1</span>, size=(num_inputs, <span style="color:#ff0;font-weight:bold">1</span>), requires_grad=<span style="color:#fff;font-weight:bold">True</span>)
</span></span><span style="display:flex;"><span>    b = torch.zeros(<span style="color:#ff0;font-weight:bold">1</span>, requires_grad=<span style="color:#fff;font-weight:bold">True</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> [w, b]
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>å®šä¹‰L2èŒƒæ•°</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> l2_penalty(w):
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> torch.sum(w.pow(<span style="color:#ff0;font-weight:bold">2</span>)) / <span style="color:#ff0;font-weight:bold">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">## L1èŒƒæ•°</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># def l1_penalty(w):</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#     return torch.sum(torch.abs(w))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>å®šä¹‰è®­ç»ƒä»£ç å®ç°</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> train(lambd):
</span></span><span style="display:flex;"><span>    w, b = init_params()
</span></span><span style="display:flex;"><span>    net, loss = <span style="color:#fff;font-weight:bold">lambda</span> X: d2l.linreg(X, w, b), d2l.squared_loss  <span style="color:#007f7f">#æ¨¡å‹è¾“å‡ºï¼ŒæŸå¤±å‡½æ•°</span>
</span></span><span style="display:flex;"><span>    num_epochs, lr = <span style="color:#ff0;font-weight:bold">100</span>, <span style="color:#ff0;font-weight:bold">0.003</span>
</span></span><span style="display:flex;"><span>    animator = d2l.Animator(xlabel=<span style="color:#0ff;font-weight:bold">&#39;epochs&#39;</span>, ylabel=<span style="color:#0ff;font-weight:bold">&#39;loss&#39;</span>, yscale=<span style="color:#0ff;font-weight:bold">&#39;log&#39;</span>,
</span></span><span style="display:flex;"><span>                            xlim=[<span style="color:#ff0;font-weight:bold">5</span>, num_epochs], legend=[<span style="color:#0ff;font-weight:bold">&#39;train&#39;</span>, <span style="color:#0ff;font-weight:bold">&#39;test&#39;</span>])
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">for</span> epoch in <span style="color:#fff;font-weight:bold">range</span>(num_epochs):
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">for</span> X, y in train_iter:
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f"># å¢åŠ äº†L2èŒƒæ•°æƒ©ç½šé¡¹ï¼Œ</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f"># å¹¿æ’­æœºåˆ¶ä½¿l2_penalty(w)æˆä¸ºä¸€ä¸ªé•¿åº¦ä¸ºbatch_sizeçš„å‘é‡</span>
</span></span><span style="display:flex;"><span>            l = loss(net(X), y) + lambd * l2_penalty(w)
</span></span><span style="display:flex;"><span>            l.sum().backward()
</span></span><span style="display:flex;"><span>            d2l.sgd([w, b], lr, batch_size)
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> (epoch + <span style="color:#ff0;font-weight:bold">1</span>) % <span style="color:#ff0;font-weight:bold">5</span> == <span style="color:#ff0;font-weight:bold">0</span>:
</span></span><span style="display:flex;"><span>            animator.add(epoch + <span style="color:#ff0;font-weight:bold">1</span>, (d2l.evaluate_loss(net, train_iter, loss),
</span></span><span style="display:flex;"><span>                                     d2l.evaluate_loss(net, test_iter, loss)))
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">print</span>(<span style="color:#0ff;font-weight:bold">&#39;wçš„L2èŒƒæ•°æ˜¯ï¼š&#39;</span>, torch.norm(w).item())
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>è®­ç»ƒ</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#007f7f">## (1) å¿½ç•¥æ­£åˆ™åŒ–ç›´æ¥è®­ç»ƒï¼šå·¦å›¾</span>
</span></span><span style="display:flex;"><span>train(lambd=<span style="color:#ff0;font-weight:bold">0</span>)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># wçš„L2èŒƒæ•°æ˜¯ï¼š 12.963241577148438</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">## (2) ä½¿ç”¨æƒé‡è¡°å‡ï¼šå³å›¾</span>
</span></span><span style="display:flex;"><span>train(lambd=<span style="color:#ff0;font-weight:bold">3</span>)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># wçš„L2èŒƒæ•°æ˜¯ï¼š 0.04280993342399597</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images2/main/img01/image-20240724210337762.png" alt="image-20240724210337762"  />
</p>
<h2 id="54-ç®€æ´å®ç°">5.4 ç®€æ´å®ç°<a hidden class="anchor" aria-hidden="true" href="#54-ç®€æ´å®ç°">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> train_concise(wd):
</span></span><span style="display:flex;"><span>    net = nn.Sequential(nn.Linear(num_inputs, <span style="color:#ff0;font-weight:bold">1</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">for</span> param in net.parameters():
</span></span><span style="display:flex;"><span>        param.data.normal_()
</span></span><span style="display:flex;"><span>    loss = nn.MSELoss(reduction=<span style="color:#0ff;font-weight:bold">&#39;none&#39;</span>)
</span></span><span style="display:flex;"><span>    num_epochs, lr = <span style="color:#ff0;font-weight:bold">100</span>, <span style="color:#ff0;font-weight:bold">0.003</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># åç½®å‚æ•°æ²¡æœ‰è¡°å‡</span>
</span></span><span style="display:flex;"><span>    trainer = torch.optim.SGD([
</span></span><span style="display:flex;"><span>        {<span style="color:#0ff;font-weight:bold">&#34;params&#34;</span>:net[<span style="color:#ff0;font-weight:bold">0</span>].weight,<span style="color:#0ff;font-weight:bold">&#39;weight_decay&#39;</span>: wd},
</span></span><span style="display:flex;"><span>        {<span style="color:#0ff;font-weight:bold">&#34;params&#34;</span>:net[<span style="color:#ff0;font-weight:bold">0</span>].bias}], lr=lr)
</span></span><span style="display:flex;"><span>    animator = d2l.Animator(xlabel=<span style="color:#0ff;font-weight:bold">&#39;epochs&#39;</span>, ylabel=<span style="color:#0ff;font-weight:bold">&#39;loss&#39;</span>, yscale=<span style="color:#0ff;font-weight:bold">&#39;log&#39;</span>,
</span></span><span style="display:flex;"><span>                            xlim=[<span style="color:#ff0;font-weight:bold">5</span>, num_epochs], legend=[<span style="color:#0ff;font-weight:bold">&#39;train&#39;</span>, <span style="color:#0ff;font-weight:bold">&#39;test&#39;</span>])
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">for</span> epoch in <span style="color:#fff;font-weight:bold">range</span>(num_epochs):
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">for</span> X, y in train_iter:
</span></span><span style="display:flex;"><span>            trainer.zero_grad()
</span></span><span style="display:flex;"><span>            l = loss(net(X), y)
</span></span><span style="display:flex;"><span>            l.mean().backward()
</span></span><span style="display:flex;"><span>            trainer.step()
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> (epoch + <span style="color:#ff0;font-weight:bold">1</span>) % <span style="color:#ff0;font-weight:bold">5</span> == <span style="color:#ff0;font-weight:bold">0</span>:
</span></span><span style="display:flex;"><span>            animator.add(epoch + <span style="color:#ff0;font-weight:bold">1</span>,
</span></span><span style="display:flex;"><span>                         (d2l.evaluate_loss(net, train_iter, loss),
</span></span><span style="display:flex;"><span>                          d2l.evaluate_loss(net, test_iter, loss)))
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">print</span>(<span style="color:#0ff;font-weight:bold">&#39;wçš„L2èŒƒæ•°ï¼š&#39;</span>, net[<span style="color:#ff0;font-weight:bold">0</span>].weight.norm().item())
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>train_concise(<span style="color:#ff0;font-weight:bold">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>train_concise(<span style="color:#ff0;font-weight:bold">3</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>æ²ç¥æ¨èï¼Œä¸€èˆ¬å¯è®¾ç½®weight_decayä¸º0.01, 0.001, 0.0001</p></blockquote>
<h1 id="6-æš‚é€€æ³•">6. æš‚é€€æ³•<a hidden class="anchor" aria-hidden="true" href="#6-æš‚é€€æ³•">#</a></h1>
<h2 id="61-æ‰°åŠ¨çš„ç¨³å¥æ€§">6.1 æ‰°åŠ¨çš„ç¨³å¥æ€§<a hidden class="anchor" aria-hidden="true" href="#61-æ‰°åŠ¨çš„ç¨³å¥æ€§">#</a></h2>
<ul>
<li>é˜²æ­¢æ¨¡å‹è¿‡æ‹Ÿåˆçš„å¦ä¸€ä¸ªè§’åº¦æ˜¯å¢åŠ å¹³æ»‘æ€§ï¼Œä¸ä¼šå¯¹è¾“å…¥çš„å¾®å°å˜åŒ–æ•æ„Ÿï¼›</li>
<li>æš‚é€€æ³•æ˜¯åœ¨å‰å‘ä¼ æ’­è¿‡ç¨‹ä¸­ï¼Œè®¡ç®—æ¯ä¸€å†…éƒ¨å±‚çš„åŒæ—¶å¼•å…¥å™ªå£°ï¼Œè¡¨ç°ä¸ºéšæœºä¸¢å¼ƒ(drop out)ä¸€äº›ç¥ç»å…ƒ;</li>
<li>åœ¨æ ‡å‡†æš‚é€€æ³•æ­£åˆ™åŒ–ä¸­ï¼Œæ¯ä¸ªä¸­é—´éšè—å±‚çš„æ¿€æ´»å€¼<em>h</em>ä»¥æš‚é€€æ¦‚ç‡<em>p</em>è¢«éšæœºå˜é‡*h&rsquo;*æ›¿æ¢ã€‚</li>
</ul>
<h4 id="image-20240724215837412"><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images2/main/img01/image-20240724215837412.png" alt="image-20240724215837412"  />
</h4>
<blockquote>
<p>ä¸Šè¿°å…¬å¼è¡¨ç¤ºæŒ‰ä¸€ç§æ— åå‘çš„æ–¹å¼å¼•å…¥å™ªå£°ï¼Œæ¯å±‚çš„æœŸæœ›å€¼ç­‰äºæ²¡æœ‰å™ªéŸ³çš„å€¼ã€‚</p></blockquote>
<h2 id="62-å®è·µä¸­çš„æš‚é€€æ³•">6.2 å®è·µä¸­çš„æš‚é€€æ³•<a hidden class="anchor" aria-hidden="true" href="#62-å®è·µä¸­çš„æš‚é€€æ³•">#</a></h2>
<ul>
<li>æš‚é€€æ³•ä»…ç”¨äºéšè—å±‚çš„(æ¿€æ´»å)è¾“å‡ºç»“æœä¸­ï¼Œä½¿å¾—ä¸è¿‡åº¦ä¾èµ–éšè—å±‚ä¸­çš„ä»»æ„ä¸€ä¸ªå…ƒç´ ï¼›</li>
<li>ä»…åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä½¿ç”¨Dropoutï¼Œåœ¨é¢„æµ‹è¿‡ç¨‹ä¸­ä¸éœ€è¦ä½¿ç”¨ï¼›</li>
<li>Dropoutå¤šåº”ç”¨äºMLPç¥ç»ç½‘ç»œï¼Œè€Œè¾ƒå°‘åº”ç”¨äºCNNç­‰</li>
</ul>
<p><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images2/main/img01/image-20240724220754441.png" alt="image-20240724220754441"  />
</p>
<h2 id="63-ä»é›¶å¼€å§‹å®ç°">6.3 ä»é›¶å¼€å§‹å®ç°<a hidden class="anchor" aria-hidden="true" href="#63-ä»é›¶å¼€å§‹å®ç°">#</a></h2>
<ul>
<li>è‡ªå®šä¹‰dropoutå‡½æ•°</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> torch
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">from</span> torch <span style="color:#fff;font-weight:bold">import</span> nn
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">from</span> d2l <span style="color:#fff;font-weight:bold">import</span> torch <span style="color:#fff;font-weight:bold">as</span> d2l
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> dropout_layer(X, dropout):
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">assert</span> <span style="color:#ff0;font-weight:bold">0</span> &lt;= dropout &lt;= <span style="color:#ff0;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># åœ¨æœ¬æƒ…å†µä¸­ï¼Œæ‰€æœ‰å…ƒç´ éƒ½è¢«ä¸¢å¼ƒ</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> dropout == <span style="color:#ff0;font-weight:bold">1</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> torch.zeros_like(X)
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># åœ¨æœ¬æƒ…å†µä¸­ï¼Œæ‰€æœ‰å…ƒç´ éƒ½è¢«ä¿ç•™</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> dropout == <span style="color:#ff0;font-weight:bold">0</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> X
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f"># torch.randç”Ÿæˆéšæœºæ•°</span>
</span></span><span style="display:flex;"><span>    mask = (torch.rand(X.shape) &gt; dropout).float() <span style="color:#007f7f">#é€»è¾‘å€¼</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> mask * X / (<span style="color:#ff0;font-weight:bold">1.0</span> - dropout)  <span style="color:#007f7f">#ä¸¢å¼ƒé€»è¾‘å€¼ä¸ºFALSEçš„ç»“æœ</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># æ¼”ç¤º</span>
</span></span><span style="display:flex;"><span>X= torch.arange(<span style="color:#ff0;font-weight:bold">16</span>, dtype = torch.float32).reshape((<span style="color:#ff0;font-weight:bold">2</span>, <span style="color:#ff0;font-weight:bold">8</span>))
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">print</span>(X)
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">print</span>(dropout_layer(X, <span style="color:#ff0;font-weight:bold">0.</span>))
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">print</span>(dropout_layer(X, <span style="color:#ff0;font-weight:bold">0.5</span>))
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">print</span>(dropout_layer(X, <span style="color:#ff0;font-weight:bold">1.</span>))
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>å®šä¹‰æ¨¡å‹</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#007f7f"># å‚æ•°ï¼šè¾“å…¥è¾“å‡ºå±‚ï¼Œä¸¤å±‚éšè—å±‚</span>
</span></span><span style="display:flex;"><span>num_inputs, num_outputs, num_hiddens1, num_hiddens2 = <span style="color:#ff0;font-weight:bold">784</span>, <span style="color:#ff0;font-weight:bold">10</span>, <span style="color:#ff0;font-weight:bold">256</span>, <span style="color:#ff0;font-weight:bold">256</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Dropout</span>
</span></span><span style="display:flex;"><span>dropout1, dropout2 = <span style="color:#ff0;font-weight:bold">0.3</span>, <span style="color:#ff0;font-weight:bold">0.5</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># å®šä¹‰äº†ä¸€ä¸ªç¥ç»ç½‘ç»œç±» Netï¼Œè¯¥ç±»ç»§æ‰¿è‡ª PyTorch çš„ nn.Module</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">class</span> Net(nn.Module):
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">def</span> __init__(<span style="color:#fff;font-weight:bold">self</span>, num_inputs, num_outputs, num_hiddens1, num_hiddens2,
</span></span><span style="display:flex;"><span>                 is_training = <span style="color:#fff;font-weight:bold">True</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">super</span>(Net, <span style="color:#fff;font-weight:bold">self</span>).__init__() <span style="color:#007f7f">#è°ƒç”¨çˆ¶ç±» nn.Module çš„æ„é€ å‡½æ•°æ¥åˆå§‹åŒ–å½“å‰ç±» Net çš„å®ä¾‹</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">self</span>.num_inputs = num_inputs
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">self</span>.training = is_training
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">self</span>.lin1 = nn.Linear(num_inputs, num_hiddens1)
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">self</span>.lin2 = nn.Linear(num_hiddens1, num_hiddens2)
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">self</span>.lin3 = nn.Linear(num_hiddens2, num_outputs)
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">self</span>.relu = nn.ReLU()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">def</span> forward(<span style="color:#fff;font-weight:bold">self</span>, X):
</span></span><span style="display:flex;"><span>        H1 = <span style="color:#fff;font-weight:bold">self</span>.relu(<span style="color:#fff;font-weight:bold">self</span>.lin1(X.reshape((-<span style="color:#ff0;font-weight:bold">1</span>, <span style="color:#fff;font-weight:bold">self</span>.num_inputs))))
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f"># åªæœ‰åœ¨è®­ç»ƒæ¨¡å‹æ—¶æ‰ä½¿ç”¨dropout</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> <span style="color:#fff;font-weight:bold">self</span>.training == <span style="color:#fff;font-weight:bold">True</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f"># åœ¨ç¬¬ä¸€ä¸ªå…¨è¿æ¥å±‚ä¹‹åæ·»åŠ ä¸€ä¸ªdropoutå±‚</span>
</span></span><span style="display:flex;"><span>            H1 = dropout_layer(H1, dropout1)
</span></span><span style="display:flex;"><span>        H2 = <span style="color:#fff;font-weight:bold">self</span>.relu(<span style="color:#fff;font-weight:bold">self</span>.lin2(H1))
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> <span style="color:#fff;font-weight:bold">self</span>.training == <span style="color:#fff;font-weight:bold">True</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f"># åœ¨ç¬¬äºŒä¸ªå…¨è¿æ¥å±‚ä¹‹åæ·»åŠ ä¸€ä¸ªdropoutå±‚</span>
</span></span><span style="display:flex;"><span>            H2 = dropout_layer(H2, dropout2)
</span></span><span style="display:flex;"><span>        out = <span style="color:#fff;font-weight:bold">self</span>.lin3(H2)
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> out
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>net = Net(num_inputs, num_outputs, num_hiddens1, num_hiddens2)
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>è®­ç»ƒæµ‹è¯•</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>num_epochs, lr, batch_size = <span style="color:#ff0;font-weight:bold">10</span>, <span style="color:#ff0;font-weight:bold">0.5</span>, <span style="color:#ff0;font-weight:bold">256</span>
</span></span><span style="display:flex;"><span>loss = nn.CrossEntropyLoss(reduction=<span style="color:#0ff;font-weight:bold">&#39;none&#39;</span>)
</span></span><span style="display:flex;"><span>train_iter, test_iter = d2l.load_data_fashion_mnist(batch_size)
</span></span><span style="display:flex;"><span>trainer = torch.optim.SGD(net.parameters(), lr=lr)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>d2l.train_ch3(net, train_iter, test_iter, loss, num_epochs, trainer) <span style="color:#007f7f">#å·¦å›¾</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images2/main/img01/image-20240724223822753.png" alt="image-20240724223822753"  />
</p>
<blockquote>
<p>å³å›¾ï¼šDropoutå‡è®¾ä¸º0çš„è®­ç»ƒç»“æœã€‚</p></blockquote>
<h2 id="64-ç®€æ´å®ç°">6.4 ç®€æ´å®ç°<a hidden class="anchor" aria-hidden="true" href="#64-ç®€æ´å®ç°">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>net = nn.Sequential(nn.Flatten(),
</span></span><span style="display:flex;"><span>        nn.Linear(<span style="color:#ff0;font-weight:bold">784</span>, <span style="color:#ff0;font-weight:bold">256</span>),
</span></span><span style="display:flex;"><span>        nn.ReLU(),
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f"># åœ¨ç¬¬ä¸€ä¸ªå…¨è¿æ¥å±‚/æ¿€æ´»å‡½æ•°ä¹‹åæ·»åŠ ä¸€ä¸ªdropoutå±‚</span>
</span></span><span style="display:flex;"><span>        nn.Dropout(dropout1),
</span></span><span style="display:flex;"><span>        nn.Linear(<span style="color:#ff0;font-weight:bold">256</span>, <span style="color:#ff0;font-weight:bold">256</span>),
</span></span><span style="display:flex;"><span>        nn.ReLU(),
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f"># åœ¨ç¬¬äºŒä¸ªå…¨è¿æ¥å±‚/æ¿€æ´»å‡½æ•°ä¹‹åæ·»åŠ ä¸€ä¸ªdropoutå±‚</span>
</span></span><span style="display:flex;"><span>        nn.Dropout(dropout2),
</span></span><span style="display:flex;"><span>        nn.Linear(<span style="color:#ff0;font-weight:bold">256</span>, <span style="color:#ff0;font-weight:bold">10</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">def</span> init_weights(m):
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> <span style="color:#fff;font-weight:bold">type</span>(m) == nn.Linear:
</span></span><span style="display:flex;"><span>        nn.init.normal_(m.weight, std=<span style="color:#ff0;font-weight:bold">0.01</span>)
</span></span><span style="display:flex;"><span>net.apply(init_weights);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>trainer = torch.optim.SGD(net.parameters(), lr=lr)
</span></span><span style="display:flex;"><span>d2l.train_ch3(net, train_iter, test_iter, loss, num_epochs, trainer)
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="7-å‰å‘ä¼ æ’­åå‘ä¼ æ’­å’Œè®¡ç®—å›¾">7. å‰å‘ä¼ æ’­ã€åå‘ä¼ æ’­å’Œè®¡ç®—å›¾<a hidden class="anchor" aria-hidden="true" href="#7-å‰å‘ä¼ æ’­åå‘ä¼ æ’­å’Œè®¡ç®—å›¾">#</a></h1>
<h2 id="71-å‰å‘ä¼ æ’­">7.1 å‰å‘ä¼ æ’­<a hidden class="anchor" aria-hidden="true" href="#71-å‰å‘ä¼ æ’­">#</a></h2>
<ul>
<li><strong>å‰å‘ä¼ æ’­</strong>ï¼šæŒ‰é¡ºåºï¼ˆä»è¾“å…¥åˆ°è¾“å‡ºï¼‰è®¡ç®—å’Œå­˜å‚¨ç¥ç»ç½‘ç»œä¸­æ¯å±‚çš„ç»“æœï¼›</li>
<li>å¦‚ä¸‹å›¾ä¸¾ä¾‹ï¼ˆç®€å•èµ·è§ï¼Œéšè—å±‚ä¸åŒ…æ‹¬åç½®é¡¹bï¼‰
<ul>
<li>è¾“å…¥å±‚ï¼š<strong>x</strong></li>
<li>éšè—å±‚ï¼šå‚æ•°<strong>W(1)</strong>ï¼Œè¾“å‡ºç»“æœ<strong>z</strong>ï¼›æ¿€æ´»å‡½æ•°(Î¦)è¾“å‡ºç»“æœ<strong>h</strong></li>
<li>è¾“å‡ºå±‚ï¼šå‚æ•°<strong>W(2)</strong>ï¼Œè¾“å‡ºç»“æœ<strong>o</strong></li>
<li>é¢„æµ‹æŸå¤±ï¼šL = l(o, y)</li>
<li>æƒ©ç½šé¡¹ï¼šs ~ W(1), W(2)</li>
<li>ç›®æ ‡å‡½æ•°ï¼ˆæ­£åˆ™åŒ–æŸå¤±ï¼‰ï¼šJ = L + s</li>
</ul>
</li>
</ul>
<p><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images2/main/img01/image-20240725074137329.png" alt="image-20240725074137329"  />
</p>
<h2 id="72-åå‘ä¼ æ’­">7.2 åå‘ä¼ æ’­<a hidden class="anchor" aria-hidden="true" href="#72-åå‘ä¼ æ’­">#</a></h2>
<ul>
<li>åå‘ä¼ æ’­ï¼šä»è¾“å‡ºå±‚åˆ°è¾“å…¥å±‚è®¡ç®—å’Œå­˜å‚¨ç¥ç»ç½‘ç»œçš„å‚æ•°æ¢¯åº¦ï¼›</li>
<li>å¦‚ä¸Šç¤ºä¾‹
<ul>
<li>é¦–å…ˆè®¡ç®—Jåˆ†åˆ«å…³äºLä¸sçš„æ¢¯åº¦ï¼›</li>
<li>ç„¶åå¯è®¡ç®—Jå…³äºoçš„æ¢¯åº¦ï¼Œså…³äºW(1)ã€W(2)çš„æ¢¯åº¦ï¼›</li>
<li>å†ä¾æ¬¡è®¡ç®—Jå…³äºW(2)çš„æ¢¯åº¦ï¼ŒJå…³äºhçš„æ¢¯åº¦ï¼ŒJå…³äºzçš„æ¢¯åº¦ï¼ŒJå…³äºW(1)çš„æ¢¯åº¦</li>
</ul>
</li>
</ul>
<h2 id="73-è®­ç»ƒç¥ç»ç½‘ç»œ">7.3 è®­ç»ƒç¥ç»ç½‘ç»œ<a hidden class="anchor" aria-hidden="true" href="#73-è®­ç»ƒç¥ç»ç½‘ç»œ">#</a></h2>
<ul>
<li>å‰å‘ä¼ æ’­ä¸åå‘ä¼ æ’­ç›¸äº’ä¾èµ–ï¼›</li>
<li>ä¾‹å¦‚
<ul>
<li>å‰å‘ä¼ æ’­è®¡ç®—çš„æ­£åˆ™åŒ–é¡¹så–å†³äºæ¨¡å‹w1ä¸w2çš„å½“å‰å€¼ï¼Œç”±ä¼˜åŒ–ç®—æ³•æ ¹æ®æœ€è¿‘è¿­ä»£çš„åå‘ä¼ æ’­ç»™å‡ºçš„ï¼›</li>
<li>åå‘ä¼ æ’­å‚æ•°çš„æ¢¯åº¦è®¡ç®—ï¼Œå–å†³äºç”±å‰å‘ä¼ æ’­ç»™å‡ºçš„éšè—å˜é‡hçš„å½“å‰å€¼ã€‚</li>
</ul>
</li>
<li>åå‘ä¼ æ’­éœ€è¦é‡å¤åˆ©ç”¨å‰å‘ä¼ æ’­ä¸­å‚¨å­˜çš„ä¸­é—´å€¼ï¼Œå‰¯ä½œç”¨æ˜¯éœ€è¦æš‚ç”¨è¾ƒå¤šçš„å†…å­˜ã€‚</li>
</ul>
<h1 id="8-æ•°å€¼ç¨³å®šæ€§å’Œæ¨¡å‹åˆå§‹åŒ–">8. æ•°å€¼ç¨³å®šæ€§å’Œæ¨¡å‹åˆå§‹åŒ–<a hidden class="anchor" aria-hidden="true" href="#8-æ•°å€¼ç¨³å®šæ€§å’Œæ¨¡å‹åˆå§‹åŒ–">#</a></h1>
<h2 id="81-æ¢¯åº¦æ¶ˆå¤±ä¸æ¢¯åº¦çˆ†ç‚¸">8.1 æ¢¯åº¦æ¶ˆå¤±ä¸æ¢¯åº¦çˆ†ç‚¸<a hidden class="anchor" aria-hidden="true" href="#81-æ¢¯åº¦æ¶ˆå¤±ä¸æ¢¯åº¦çˆ†ç‚¸">#</a></h2>
<ul>
<li>å‘é‡å¯¹äºå‘é‡çš„æ¢¯åº¦ä¸ºçŸ©é˜µã€‚å½“è®¡ç®—ç›®æ ‡å‡½æ•°å¯¹äºç‰¹å®šéšè—å±‚å‚æ•°çš„å¯¼æ•°å¯èƒ½æ¶‰åŠå¤šä¸ªçŸ©é˜µçš„ä¹˜ç§¯ã€‚</li>
</ul>
<p><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images2/main/img01/image-20240725134342762.png" alt="image-20240725134342762"  />
</p>
<ul>
<li><strong>æ¢¯åº¦æ¶ˆå¤±</strong>ï¼šå‚æ•°æ›´æ–°è¿‡å°ï¼Œåœ¨æ¯æ¬¡æ›´æ–°æ—¶å‡ ä¹ä¸ä¼šç§»åŠ¨ï¼Œå¯¼è‡´æ¨¡å‹æ— æ³•å­¦ä¹ 
<ul>
<li>ä¸€ä¸ªå¸¸è§çš„ä¾‹å­æ˜¯Sigmoidå‡½æ•°ï¼Œå‚è€ƒä¸Šè¿°2.2éƒ¨åˆ†ä»‹ç»</li>
<li>å½“Sigmoidå‡½æ•°çš„è¾“å…¥ä¸è¾“å‡ºå¾ˆå¤§æˆ–å¾ˆå°æ—¶ï¼Œæ¢¯åº¦è¿‘ä¹æ¶ˆå¤±ã€‚</li>
</ul>
</li>
<li><strong>æ¢¯åº¦çˆ†ç‚¸</strong>ï¼šå‚æ•°æ›´æ–°è¿‡å¤§ï¼Œç ´åäº†æ¨¡å‹çš„ç¨³å®šæ”¶æ•›</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> torch
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>M = torch.normal(<span style="color:#ff0;font-weight:bold">0</span>, <span style="color:#ff0;font-weight:bold">1</span>, size=(<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#ff0;font-weight:bold">4</span>))
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">print</span>(<span style="color:#0ff;font-weight:bold">&#39;ä¸€ä¸ªçŸ©é˜µ </span><span style="color:#0ff;font-weight:bold">\n</span><span style="color:#0ff;font-weight:bold">&#39;</span>,M)
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">for</span> i in <span style="color:#fff;font-weight:bold">range</span>(<span style="color:#ff0;font-weight:bold">100</span>):
</span></span><span style="display:flex;"><span>    M = torch.mm(M,torch.normal(<span style="color:#ff0;font-weight:bold">0</span>, <span style="color:#ff0;font-weight:bold">1</span>, size=(<span style="color:#ff0;font-weight:bold">4</span>, <span style="color:#ff0;font-weight:bold">4</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">print</span>(<span style="color:#0ff;font-weight:bold">&#39;ä¹˜ä»¥100ä¸ªçŸ©é˜µå</span><span style="color:#0ff;font-weight:bold">\n</span><span style="color:#0ff;font-weight:bold">&#39;</span>, M)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#ä¸€ä¸ªçŸ©é˜µ</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># tensor([[-0.7872,  2.7090,  0.5996, -1.3191],</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#        [-1.8260, -0.7130, -0.5521,  0.1051],</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#        [ 1.1213,  1.0472, -0.3991, -0.3802],</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#        [ 0.5552,  0.4517, -0.3218,  0.5214]])</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#ä¹˜ä»¥100ä¸ªçŸ©é˜µå</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># tensor([[-2.1897e+26,  8.8308e+26,  1.9813e+26,  1.7019e+26],</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#        [ 1.3110e+26, -5.2870e+26, -1.1862e+26, -1.0189e+26],</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#        [-1.6008e+26,  6.4559e+26,  1.4485e+26,  1.2442e+26],</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#        [ 3.0943e+25, -1.2479e+26, -2.7998e+25, -2.4050e+25]])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="82-å‚æ•°åˆå§‹åŒ–">8.2 å‚æ•°åˆå§‹åŒ–<a hidden class="anchor" aria-hidden="true" href="#82-å‚æ•°åˆå§‹åŒ–">#</a></h2>
<ul>
<li><strong>Xavieråˆå§‹åŒ–</strong>ï¼šå¯¹å…¨è¿æ¥å±‚æƒé‡çš„åˆå§‹åŒ–å–å†³äºè¾“å…¥ä¸è¾“å‡ºå±‚çš„ç¥ç»å…ƒæ•°é‡</li>
</ul>
<p>ï¼ˆ1ï¼‰è‹¥æ˜¯æ­£æ€åˆ†å¸ƒï¼Œåˆ™ä»å‡å€¼ä¸º0ï¼Œæ–¹å·®å¦‚ä¸‹çš„é«˜æ–¯åˆ†å¸ƒä¸­æŠ½æ ·æƒé‡ï¼›</p>
<p><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images2/main/img01/image-20240725135448048.png" alt="image-20240725135448048"  />
</p>
<p>ï¼ˆ2ï¼‰ä¹Ÿå¯ä»¥æ”¹ä¸ºä»ä¸‹è¿°èŒƒå›´çš„å‡åŒ€åˆ†å¸ƒä¸­æŠ½æ ·æƒé‡</p>
<p><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images2/main/img01/image-20240725135618444.png" alt="image-20240725135618444"  />
</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://lishensuo.github.io/en/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">æ·±åº¦å­¦ä¹ </a></li>
      <li><a href="https://lishensuo.github.io/en/tags/d2l/">D2L</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://lishensuo.github.io/en/posts/bioinfo/706d2l-%E7%AC%AC%E4%B8%89%E7%AB%A0%E7%BA%BF%E6%80%A7%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/">
    <span class="title">Â« Prev Page</span>
    <br>
    <span>D2L--ç¬¬ä¸‰ç« çº¿æ€§ç¥ç»ç½‘ç»œ</span>
  </a>
  <a class="next" href="https://lishensuo.github.io/en/posts/bioinfo/708d2l-%E7%AC%AC%E4%BA%94%E7%AB%A0%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E8%AE%A1%E7%AE%97/">
    <span class="title">Next Page Â»</span>
    <br>
    <span>D2L--ç¬¬äº”ç« æ·±åº¦å­¦ä¹ è®¡ç®—</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2025 <a href="https://lishensuo.github.io/en/">Li&#39;s Bioinfo-Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
		<br/>æ‚¨æ˜¯æœ¬ç«™ç¬¬ <span id="busuanzi_value_site_uv"></span> ä½è®¿é—®è€…ï¼Œæ€»æµè§ˆé‡ä¸º <span id="busuanzi_value_site_pv"></span> æ¬¡
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>

<script type="text/javascript"
async
src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
MathJax.Hub.Config({
tex2jax: {
inlineMath: [['$','$'], ['\\(','\\)']],
displayMath: [['$$','$$'], ['\[\[','\]\]']],
processEscapes: true,
processEnvironments: true,
skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
TeX: { equationNumbers: { autoNumber: "AMS" },
extensions: ["AMSmath.js", "AMSsymbols.js"] }
}
});

MathJax.Hub.Queue(function() {



var all = MathJax.Hub.getAllJax(), i;
for(i = 0; i < all.length; i += 1) {
all[i].SourceElement().parentNode.className += ' has-jax';
}
});
</script>

<style>
code.has-jax {
font: inherit;
font-size: 100%;
background: inherit;
border: inherit;
color: #515151;
}
</style></body>
</html>
