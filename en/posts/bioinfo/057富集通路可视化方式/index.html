<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">

<link rel="icon" href="/favicon.ico" type="image/x-icon"> 
<title>å¯Œé›†é€šè·¯å¯è§†åŒ–æ–¹å¼ | Li&#39;s Bioinfo-Blog</title>
<meta name="keywords" content="è½¬å½•ç»„">
<meta name="description" content="0ã€ç¤ºä¾‹æ•°æ®


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29


library(clusterProfiler)
library(org.Hs.eg.db)

data(geneList, package=&#34;DOSE&#34;)
str(geneList)
# Named num [1:12495] 4.57 4.51 4.42 4.14 3.88 ...
# - attr(*, &#34;names&#34;)= chr [1:12495] &#34;4312&#34; &#34;8318&#34; &#34;10874&#34; &#34;55143&#34; ...
gene_ids&lt;-AnnotationDbi::select(org.Hs.eg.db, keys=as.character(names(gene_list)), 
                                columns=&#34;SYMBOL&#34;, #ç›®æ ‡æ ¼å¼
                                keytype=&#34;ENTREZID&#34;) #ç›®å‰çš„æ ¼å¼
# &#39;select()&#39; returned 1:1 mapping between keys and columns
## ORAåˆ†æ
gene_deg = names(geneList)[abs(geneList) &gt; 2]
ego &lt;- enrichGO(gene          = gene_deg,
                OrgDb         = org.Hs.eg.db,
                ont           = &#34;CC&#34;, # &#34;BP&#34;,&#34;MF&#34;,&#34;ALL&#34;
                pAdjustMethod = &#34;BH&#34;,
                pvalueCutoff  = 0.01,
                qvalueCutoff  = 0.05,
                readable      = TRUE)
## GSEAåˆ†æ
gseago &lt;- gseGO(geneList     = geneList,
                OrgDb        = org.Hs.eg.db,
                ont          = &#34;CC&#34;,
                minGSSize    = 100,
                maxGSSize    = 500,
                pvalueCutoff = 0.05,
                verbose      = FALSE)
gseago = setReadable(gseago, OrgDb = org.Hs.eg.db)


1ã€ggplot2


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30


## ORA
library(tidyverse)
ego_df = ego@result %&gt;% head(10) %&gt;% 
  dplyr::mutate(logp = -log10(p.adjust)) %&gt;% 
  dplyr::arrange(logp) %&gt;% 
  dplyr::mutate(Label=str_wrap(gsub(&#34;_&#34;,&#34; &#34;,Description), width = 50)) %&gt;% 
  dplyr::mutate(Label = factor(Label, levels=Label)) %&gt;% 
  tibble::remove_rownames() %&gt;% 
  dplyr::select(Label, logp)
head(ego_df)
#                                      Label     logp
# 1           microtubule associated complex 5.419514
# 2                          spindle midzone 5.681085
# 3                      spindle microtubule 7.341138

ggplot(ego_df, aes(x=Label, y=logp)) &#43; 
  geom_bar(stat=&#34;identity&#34;, fill=&#34;#1b9e77&#34;) &#43; 
  xlab(&#34;Pathway names&#34;) &#43;
  ylab(&#34;-log10(P.adj)&#34;) &#43;
  scale_y_continuous(expand=c(0,0)) &#43; 
  coord_flip() &#43; 
  xlab(&#34;GO Pathway&#34;) &#43; 
  ylab(&#34;Adjusted P value(-log10)&#34;) &#43; 
  geom_text(aes(label = Label, y=0.2), hjust = 0, size=5) &#43;
  theme_classic() &#43;
  theme(axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        axis.title.y = element_text(size = 25),
        axis.title.x = element_text(size = 20),
        axis.text.x = element_text(size = 16))





 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20


## GSEA
library(tidyverse)
gseago_df = gseago@result %&gt;% head(20) %&gt;% 
  dplyr::mutate(logp = -log10(p.adjust)) %&gt;% 
  dplyr::arrange(logp) %&gt;% 
  dplyr::mutate(Label=str_wrap(gsub(&#34;_&#34;,&#34; &#34;,Description), width = 50)) %&gt;% 
  dplyr::mutate(Label = factor(Label, levels=Label)) %&gt;% 
  tibble::remove_rownames() %&gt;% 
  dplyr::select(Label, logp, NES)
head(gseago_df)
#                            Label     logp      NES
# 1   polymeric cytoskeletal fiber 3.755730 1.487284
# 2   chromosome, telomeric region 4.311816 1.907511
# 3 microtubule associated complex 4.432327 1.944046
ggplot(gseago_df, 
       aes(NES, fct_reorder(Label, NES), fill=qvalue)) &#43; 
  geom_bar(stat=&#39;identity&#39;) &#43; 
  scale_fill_continuous(low=&#39;red&#39;, high=&#39;blue&#39;, 
                        guide=guide_colorbar(reverse=TRUE)) &#43; 
  theme_minimal() &#43; ylab(NULL)



2ã€GOplot

å®˜æ–¹æ•™ç¨‹ï¼šhttps://wencke.github.io/



 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33


# install.packages(&#39;GOplot&#39;)
library(GOplot)
# (1) å‡†å¤‡æ•°æ®
## å¯Œé›†é€šè·¯ç»“æœ
res_enrich = ego@result %&gt;% 
  dplyr::select(ID, Description, geneID,p.adjust) %&gt;% 
  dplyr::mutate(Category = &#34;GO&#34;, .before=1) %&gt;%  
  dplyr::mutate(geneID = gsub(&#34;/&#34;,&#34;, &#34;, geneID)) %&gt;% 
  dplyr::rename(&#34;Term&#34;=&#34;Description&#34;, &#34;Genes&#34;=&#34;geneID&#34;, &#34;adj_pval&#34;=&#34;p.adjust&#34;) %&gt;%
  dplyr::select(Category,ID,Term,Genes,adj_pval) %&gt;% 
  tibble::remove_rownames()
t(res_enrich[1,])
#           1                                                                                                                                                                                   
# Category &#34;GO&#34;                                                                                                                                                                                
# ID       &#34;GO:0005819&#34;                                                                                                                                                                        
# Term     &#34;spindle&#34;                                                                                                                                                                           
# Genes    &#34;CDCA8, CDC20, KIF23, CENPE, ASPM, DLGAP5, SKA1, NUSAP1, TPX2, TACC3, NEK2, CDK1, MAD2L1, KIF18A, BIRC5, KIF11, TRAT1, TTK, AURKB, PRC1, KIFC1, KIF18B, KIF20A, AURKA, CCNB1, KIF4A&#34;
# adj_pval &#34;6.339976e-11&#34;
## å¦‚ä¸Šï¼ŒIDä¸ºoptionalï¼ŒCategoryä¸ºrequired

## (2) åŸºå› å·®å¼‚å€æ•°
res_logfc = data.frame(ID=gene_ids$SYMBOL,
                       logFC=geneList)
head(res_logfc)
#      ID    logFC
# 1  MMP1 4.572613
# 2 CDC45 4.514594
# 3   NMU 4.418218
## å¦‚æ— ç›¸å…³æ•°æ®ï¼Œå¯éšä¾¿è®¾ç½®ä¸º0

## (3) æ„å»ºç»˜å›¾å¯¹è±¡
circ &lt;- circle_dat(res_enrich, res_logfc)
head(circ)




Circular visualization">
<meta name="author" content="Lishensuo">
<link rel="canonical" href="https://lishensuo.github.io/en/posts/bioinfo/057%E5%AF%8C%E9%9B%86%E9%80%9A%E8%B7%AF%E5%8F%AF%E8%A7%86%E5%8C%96%E6%96%B9%E5%BC%8F/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.9e4de5e3ba61ea358168341aa7cdf70abfaafb7c697dfe8624af3ddff9a35c2f.css" integrity="sha256-nk3l47ph6jWBaDQap833Cr&#43;q&#43;3xpff6GJK893/mjXC8=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.555af97124d54bb1457985dd081b8f5616a48103aafeb30ac89fde835d65aa6c.js" integrity="sha256-VVr5cSTVS7FFeYXdCBuPVhakgQOq/rMKyJ/eg11lqmw="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://lishensuo.github.io/img/Q.gif">
<link rel="icon" type="image/png" sizes="16x16" href="https://lishensuo.github.io/img/Q.gif">
<link rel="icon" type="image/png" sizes="32x32" href="https://lishensuo.github.io/img/Q.gif">
<link rel="apple-touch-icon" href="https://lishensuo.github.io/Q.gif">
<link rel="mask-icon" href="https://lishensuo.github.io/Q.gif">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://lishensuo.github.io/en/posts/bioinfo/057%E5%AF%8C%E9%9B%86%E9%80%9A%E8%B7%AF%E5%8F%AF%E8%A7%86%E5%8C%96%E6%96%B9%E5%BC%8F/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="å¯Œé›†é€šè·¯å¯è§†åŒ–æ–¹å¼" />
<meta property="og:description" content="0ã€ç¤ºä¾‹æ•°æ®


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29


library(clusterProfiler)
library(org.Hs.eg.db)

data(geneList, package=&#34;DOSE&#34;)
str(geneList)
# Named num [1:12495] 4.57 4.51 4.42 4.14 3.88 ...
# - attr(*, &#34;names&#34;)= chr [1:12495] &#34;4312&#34; &#34;8318&#34; &#34;10874&#34; &#34;55143&#34; ...
gene_ids&lt;-AnnotationDbi::select(org.Hs.eg.db, keys=as.character(names(gene_list)), 
                                columns=&#34;SYMBOL&#34;, #ç›®æ ‡æ ¼å¼
                                keytype=&#34;ENTREZID&#34;) #ç›®å‰çš„æ ¼å¼
# &#39;select()&#39; returned 1:1 mapping between keys and columns
## ORAåˆ†æ
gene_deg = names(geneList)[abs(geneList) &gt; 2]
ego &lt;- enrichGO(gene          = gene_deg,
                OrgDb         = org.Hs.eg.db,
                ont           = &#34;CC&#34;, # &#34;BP&#34;,&#34;MF&#34;,&#34;ALL&#34;
                pAdjustMethod = &#34;BH&#34;,
                pvalueCutoff  = 0.01,
                qvalueCutoff  = 0.05,
                readable      = TRUE)
## GSEAåˆ†æ
gseago &lt;- gseGO(geneList     = geneList,
                OrgDb        = org.Hs.eg.db,
                ont          = &#34;CC&#34;,
                minGSSize    = 100,
                maxGSSize    = 500,
                pvalueCutoff = 0.05,
                verbose      = FALSE)
gseago = setReadable(gseago, OrgDb = org.Hs.eg.db)


1ã€ggplot2


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30


## ORA
library(tidyverse)
ego_df = ego@result %&gt;% head(10) %&gt;% 
  dplyr::mutate(logp = -log10(p.adjust)) %&gt;% 
  dplyr::arrange(logp) %&gt;% 
  dplyr::mutate(Label=str_wrap(gsub(&#34;_&#34;,&#34; &#34;,Description), width = 50)) %&gt;% 
  dplyr::mutate(Label = factor(Label, levels=Label)) %&gt;% 
  tibble::remove_rownames() %&gt;% 
  dplyr::select(Label, logp)
head(ego_df)
#                                      Label     logp
# 1           microtubule associated complex 5.419514
# 2                          spindle midzone 5.681085
# 3                      spindle microtubule 7.341138

ggplot(ego_df, aes(x=Label, y=logp)) &#43; 
  geom_bar(stat=&#34;identity&#34;, fill=&#34;#1b9e77&#34;) &#43; 
  xlab(&#34;Pathway names&#34;) &#43;
  ylab(&#34;-log10(P.adj)&#34;) &#43;
  scale_y_continuous(expand=c(0,0)) &#43; 
  coord_flip() &#43; 
  xlab(&#34;GO Pathway&#34;) &#43; 
  ylab(&#34;Adjusted P value(-log10)&#34;) &#43; 
  geom_text(aes(label = Label, y=0.2), hjust = 0, size=5) &#43;
  theme_classic() &#43;
  theme(axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        axis.title.y = element_text(size = 25),
        axis.title.x = element_text(size = 20),
        axis.text.x = element_text(size = 16))





 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20


## GSEA
library(tidyverse)
gseago_df = gseago@result %&gt;% head(20) %&gt;% 
  dplyr::mutate(logp = -log10(p.adjust)) %&gt;% 
  dplyr::arrange(logp) %&gt;% 
  dplyr::mutate(Label=str_wrap(gsub(&#34;_&#34;,&#34; &#34;,Description), width = 50)) %&gt;% 
  dplyr::mutate(Label = factor(Label, levels=Label)) %&gt;% 
  tibble::remove_rownames() %&gt;% 
  dplyr::select(Label, logp, NES)
head(gseago_df)
#                            Label     logp      NES
# 1   polymeric cytoskeletal fiber 3.755730 1.487284
# 2   chromosome, telomeric region 4.311816 1.907511
# 3 microtubule associated complex 4.432327 1.944046
ggplot(gseago_df, 
       aes(NES, fct_reorder(Label, NES), fill=qvalue)) &#43; 
  geom_bar(stat=&#39;identity&#39;) &#43; 
  scale_fill_continuous(low=&#39;red&#39;, high=&#39;blue&#39;, 
                        guide=guide_colorbar(reverse=TRUE)) &#43; 
  theme_minimal() &#43; ylab(NULL)



2ã€GOplot

å®˜æ–¹æ•™ç¨‹ï¼šhttps://wencke.github.io/



 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33


# install.packages(&#39;GOplot&#39;)
library(GOplot)
# (1) å‡†å¤‡æ•°æ®
## å¯Œé›†é€šè·¯ç»“æœ
res_enrich = ego@result %&gt;% 
  dplyr::select(ID, Description, geneID,p.adjust) %&gt;% 
  dplyr::mutate(Category = &#34;GO&#34;, .before=1) %&gt;%  
  dplyr::mutate(geneID = gsub(&#34;/&#34;,&#34;, &#34;, geneID)) %&gt;% 
  dplyr::rename(&#34;Term&#34;=&#34;Description&#34;, &#34;Genes&#34;=&#34;geneID&#34;, &#34;adj_pval&#34;=&#34;p.adjust&#34;) %&gt;%
  dplyr::select(Category,ID,Term,Genes,adj_pval) %&gt;% 
  tibble::remove_rownames()
t(res_enrich[1,])
#           1                                                                                                                                                                                   
# Category &#34;GO&#34;                                                                                                                                                                                
# ID       &#34;GO:0005819&#34;                                                                                                                                                                        
# Term     &#34;spindle&#34;                                                                                                                                                                           
# Genes    &#34;CDCA8, CDC20, KIF23, CENPE, ASPM, DLGAP5, SKA1, NUSAP1, TPX2, TACC3, NEK2, CDK1, MAD2L1, KIF18A, BIRC5, KIF11, TRAT1, TTK, AURKB, PRC1, KIFC1, KIF18B, KIF20A, AURKA, CCNB1, KIF4A&#34;
# adj_pval &#34;6.339976e-11&#34;
## å¦‚ä¸Šï¼ŒIDä¸ºoptionalï¼ŒCategoryä¸ºrequired

## (2) åŸºå› å·®å¼‚å€æ•°
res_logfc = data.frame(ID=gene_ids$SYMBOL,
                       logFC=geneList)
head(res_logfc)
#      ID    logFC
# 1  MMP1 4.572613
# 2 CDC45 4.514594
# 3   NMU 4.418218
## å¦‚æ— ç›¸å…³æ•°æ®ï¼Œå¯éšä¾¿è®¾ç½®ä¸º0

## (3) æ„å»ºç»˜å›¾å¯¹è±¡
circ &lt;- circle_dat(res_enrich, res_logfc)
head(circ)




Circular visualization" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lishensuo.github.io/en/posts/bioinfo/057%E5%AF%8C%E9%9B%86%E9%80%9A%E8%B7%AF%E5%8F%AF%E8%A7%86%E5%8C%96%E6%96%B9%E5%BC%8F/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-14T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2023-06-17T00:00:00&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="å¯Œé›†é€šè·¯å¯è§†åŒ–æ–¹å¼"/>
<meta name="twitter:description" content="0ã€ç¤ºä¾‹æ•°æ®


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29


library(clusterProfiler)
library(org.Hs.eg.db)

data(geneList, package=&#34;DOSE&#34;)
str(geneList)
# Named num [1:12495] 4.57 4.51 4.42 4.14 3.88 ...
# - attr(*, &#34;names&#34;)= chr [1:12495] &#34;4312&#34; &#34;8318&#34; &#34;10874&#34; &#34;55143&#34; ...
gene_ids&lt;-AnnotationDbi::select(org.Hs.eg.db, keys=as.character(names(gene_list)), 
                                columns=&#34;SYMBOL&#34;, #ç›®æ ‡æ ¼å¼
                                keytype=&#34;ENTREZID&#34;) #ç›®å‰çš„æ ¼å¼
# &#39;select()&#39; returned 1:1 mapping between keys and columns
## ORAåˆ†æ
gene_deg = names(geneList)[abs(geneList) &gt; 2]
ego &lt;- enrichGO(gene          = gene_deg,
                OrgDb         = org.Hs.eg.db,
                ont           = &#34;CC&#34;, # &#34;BP&#34;,&#34;MF&#34;,&#34;ALL&#34;
                pAdjustMethod = &#34;BH&#34;,
                pvalueCutoff  = 0.01,
                qvalueCutoff  = 0.05,
                readable      = TRUE)
## GSEAåˆ†æ
gseago &lt;- gseGO(geneList     = geneList,
                OrgDb        = org.Hs.eg.db,
                ont          = &#34;CC&#34;,
                minGSSize    = 100,
                maxGSSize    = 500,
                pvalueCutoff = 0.05,
                verbose      = FALSE)
gseago = setReadable(gseago, OrgDb = org.Hs.eg.db)


1ã€ggplot2


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30


## ORA
library(tidyverse)
ego_df = ego@result %&gt;% head(10) %&gt;% 
  dplyr::mutate(logp = -log10(p.adjust)) %&gt;% 
  dplyr::arrange(logp) %&gt;% 
  dplyr::mutate(Label=str_wrap(gsub(&#34;_&#34;,&#34; &#34;,Description), width = 50)) %&gt;% 
  dplyr::mutate(Label = factor(Label, levels=Label)) %&gt;% 
  tibble::remove_rownames() %&gt;% 
  dplyr::select(Label, logp)
head(ego_df)
#                                      Label     logp
# 1           microtubule associated complex 5.419514
# 2                          spindle midzone 5.681085
# 3                      spindle microtubule 7.341138

ggplot(ego_df, aes(x=Label, y=logp)) &#43; 
  geom_bar(stat=&#34;identity&#34;, fill=&#34;#1b9e77&#34;) &#43; 
  xlab(&#34;Pathway names&#34;) &#43;
  ylab(&#34;-log10(P.adj)&#34;) &#43;
  scale_y_continuous(expand=c(0,0)) &#43; 
  coord_flip() &#43; 
  xlab(&#34;GO Pathway&#34;) &#43; 
  ylab(&#34;Adjusted P value(-log10)&#34;) &#43; 
  geom_text(aes(label = Label, y=0.2), hjust = 0, size=5) &#43;
  theme_classic() &#43;
  theme(axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        axis.title.y = element_text(size = 25),
        axis.title.x = element_text(size = 20),
        axis.text.x = element_text(size = 16))





 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20


## GSEA
library(tidyverse)
gseago_df = gseago@result %&gt;% head(20) %&gt;% 
  dplyr::mutate(logp = -log10(p.adjust)) %&gt;% 
  dplyr::arrange(logp) %&gt;% 
  dplyr::mutate(Label=str_wrap(gsub(&#34;_&#34;,&#34; &#34;,Description), width = 50)) %&gt;% 
  dplyr::mutate(Label = factor(Label, levels=Label)) %&gt;% 
  tibble::remove_rownames() %&gt;% 
  dplyr::select(Label, logp, NES)
head(gseago_df)
#                            Label     logp      NES
# 1   polymeric cytoskeletal fiber 3.755730 1.487284
# 2   chromosome, telomeric region 4.311816 1.907511
# 3 microtubule associated complex 4.432327 1.944046
ggplot(gseago_df, 
       aes(NES, fct_reorder(Label, NES), fill=qvalue)) &#43; 
  geom_bar(stat=&#39;identity&#39;) &#43; 
  scale_fill_continuous(low=&#39;red&#39;, high=&#39;blue&#39;, 
                        guide=guide_colorbar(reverse=TRUE)) &#43; 
  theme_minimal() &#43; ylab(NULL)



2ã€GOplot

å®˜æ–¹æ•™ç¨‹ï¼šhttps://wencke.github.io/



 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33


# install.packages(&#39;GOplot&#39;)
library(GOplot)
# (1) å‡†å¤‡æ•°æ®
## å¯Œé›†é€šè·¯ç»“æœ
res_enrich = ego@result %&gt;% 
  dplyr::select(ID, Description, geneID,p.adjust) %&gt;% 
  dplyr::mutate(Category = &#34;GO&#34;, .before=1) %&gt;%  
  dplyr::mutate(geneID = gsub(&#34;/&#34;,&#34;, &#34;, geneID)) %&gt;% 
  dplyr::rename(&#34;Term&#34;=&#34;Description&#34;, &#34;Genes&#34;=&#34;geneID&#34;, &#34;adj_pval&#34;=&#34;p.adjust&#34;) %&gt;%
  dplyr::select(Category,ID,Term,Genes,adj_pval) %&gt;% 
  tibble::remove_rownames()
t(res_enrich[1,])
#           1                                                                                                                                                                                   
# Category &#34;GO&#34;                                                                                                                                                                                
# ID       &#34;GO:0005819&#34;                                                                                                                                                                        
# Term     &#34;spindle&#34;                                                                                                                                                                           
# Genes    &#34;CDCA8, CDC20, KIF23, CENPE, ASPM, DLGAP5, SKA1, NUSAP1, TPX2, TACC3, NEK2, CDK1, MAD2L1, KIF18A, BIRC5, KIF11, TRAT1, TTK, AURKB, PRC1, KIFC1, KIF18B, KIF20A, AURKA, CCNB1, KIF4A&#34;
# adj_pval &#34;6.339976e-11&#34;
## å¦‚ä¸Šï¼ŒIDä¸ºoptionalï¼ŒCategoryä¸ºrequired

## (2) åŸºå› å·®å¼‚å€æ•°
res_logfc = data.frame(ID=gene_ids$SYMBOL,
                       logFC=geneList)
head(res_logfc)
#      ID    logFC
# 1  MMP1 4.572613
# 2 CDC45 4.514594
# 3   NMU 4.418218
## å¦‚æ— ç›¸å…³æ•°æ®ï¼Œå¯éšä¾¿è®¾ç½®ä¸º0

## (3) æ„å»ºç»˜å›¾å¯¹è±¡
circ &lt;- circle_dat(res_enrich, res_logfc)
head(circ)




Circular visualization"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "åˆ†ç±»",
      "item": "https://lishensuo.github.io/en/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ğŸ“– ç”Ÿä¿¡æ•°æ®åˆ†æ--åˆ†ææµç¨‹ï¼Œå·¥å…·åŒ…ç­‰",
      "item": "https://lishensuo.github.io/en/posts/bioinfo/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "å¯Œé›†é€šè·¯å¯è§†åŒ–æ–¹å¼",
      "item": "https://lishensuo.github.io/en/posts/bioinfo/057%E5%AF%8C%E9%9B%86%E9%80%9A%E8%B7%AF%E5%8F%AF%E8%A7%86%E5%8C%96%E6%96%B9%E5%BC%8F/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "å¯Œé›†é€šè·¯å¯è§†åŒ–æ–¹å¼",
  "name": "å¯Œé›†é€šè·¯å¯è§†åŒ–æ–¹å¼",
  "description": "0ã€ç¤ºä¾‹æ•°æ® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 library(clusterProfiler) library(org.Hs.eg.db) data(geneList, package=\u0026#34;DOSE\u0026#34;) str(geneList) # Named num [1:12495] 4.57 4.51 4.42 4.14 3.88 ... # - attr(*, \u0026#34;names\u0026#34;)= chr [1:12495] \u0026#34;4312\u0026#34; \u0026#34;8318\u0026#34; \u0026#34;10874\u0026#34; \u0026#34;55143\u0026#34; ... gene_ids\u0026lt;-AnnotationDbi::select(org.Hs.eg.db, keys=as.character(names(gene_list)), columns=\u0026#34;SYMBOL\u0026#34;, #ç›®æ ‡æ ¼å¼ keytype=\u0026#34;ENTREZID\u0026#34;) #ç›®å‰çš„æ ¼å¼ # \u0026#39;select()\u0026#39; returned 1:1 mapping between keys and columns ## ORAåˆ†æ gene_deg = names(geneList)[abs(geneList) \u0026gt; 2] ego \u0026lt;- enrichGO(gene = gene_deg, OrgDb = org.Hs.eg.db, ont = \u0026#34;CC\u0026#34;, # \u0026#34;BP\u0026#34;,\u0026#34;MF\u0026#34;,\u0026#34;ALL\u0026#34; pAdjustMethod = \u0026#34;BH\u0026#34;, pvalueCutoff = 0.01, qvalueCutoff = 0.05, readable = TRUE) ## GSEAåˆ†æ gseago \u0026lt;- gseGO(geneList = geneList, OrgDb = org.Hs.eg.db, ont = \u0026#34;CC\u0026#34;, minGSSize = 100, maxGSSize = 500, pvalueCutoff = 0.05, verbose = FALSE) gseago = setReadable(gseago, OrgDb = org.Hs.eg.db) 1ã€ggplot2 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 ## ORA library(tidyverse) ego_df = ego@result %\u0026gt;% head(10) %\u0026gt;% dplyr::mutate(logp = -log10(p.adjust)) %\u0026gt;% dplyr::arrange(logp) %\u0026gt;% dplyr::mutate(Label=str_wrap(gsub(\u0026#34;_\u0026#34;,\u0026#34; \u0026#34;,Description), width = 50)) %\u0026gt;% dplyr::mutate(Label = factor(Label, levels=Label)) %\u0026gt;% tibble::remove_rownames() %\u0026gt;% dplyr::select(Label, logp) head(ego_df) # Label logp # 1 microtubule associated complex 5.419514 # 2 spindle midzone 5.681085 # 3 spindle microtubule 7.341138 ggplot(ego_df, aes(x=Label, y=logp)) + geom_bar(stat=\u0026#34;identity\u0026#34;, fill=\u0026#34;#1b9e77\u0026#34;) + xlab(\u0026#34;Pathway names\u0026#34;) + ylab(\u0026#34;-log10(P.adj)\u0026#34;) + scale_y_continuous(expand=c(0,0)) + coord_flip() + xlab(\u0026#34;GO Pathway\u0026#34;) + ylab(\u0026#34;Adjusted P value(-log10)\u0026#34;) + geom_text(aes(label = Label, y=0.2), hjust = 0, size=5) + theme_classic() + theme(axis.text.y = element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_text(size = 25), axis.title.x = element_text(size = 20), axis.text.x = element_text(size = 16)) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 ## GSEA library(tidyverse) gseago_df = gseago@result %\u0026gt;% head(20) %\u0026gt;% dplyr::mutate(logp = -log10(p.adjust)) %\u0026gt;% dplyr::arrange(logp) %\u0026gt;% dplyr::mutate(Label=str_wrap(gsub(\u0026#34;_\u0026#34;,\u0026#34; \u0026#34;,Description), width = 50)) %\u0026gt;% dplyr::mutate(Label = factor(Label, levels=Label)) %\u0026gt;% tibble::remove_rownames() %\u0026gt;% dplyr::select(Label, logp, NES) head(gseago_df) # Label logp NES # 1 polymeric cytoskeletal fiber 3.755730 1.487284 # 2 chromosome, telomeric region 4.311816 1.907511 # 3 microtubule associated complex 4.432327 1.944046 ggplot(gseago_df, aes(NES, fct_reorder(Label, NES), fill=qvalue)) + geom_bar(stat=\u0026#39;identity\u0026#39;) + scale_fill_continuous(low=\u0026#39;red\u0026#39;, high=\u0026#39;blue\u0026#39;, guide=guide_colorbar(reverse=TRUE)) + theme_minimal() + ylab(NULL) 2ã€GOplot å®˜æ–¹æ•™ç¨‹ï¼šhttps://wencke.github.io/ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 # install.packages(\u0026#39;GOplot\u0026#39;) library(GOplot) # (1) å‡†å¤‡æ•°æ® ## å¯Œé›†é€šè·¯ç»“æœ res_enrich = ego@result %\u0026gt;% dplyr::select(ID, Description, geneID,p.adjust) %\u0026gt;% dplyr::mutate(Category = \u0026#34;GO\u0026#34;, .before=1) %\u0026gt;% dplyr::mutate(geneID = gsub(\u0026#34;/\u0026#34;,\u0026#34;, \u0026#34;, geneID)) %\u0026gt;% dplyr::rename(\u0026#34;Term\u0026#34;=\u0026#34;Description\u0026#34;, \u0026#34;Genes\u0026#34;=\u0026#34;geneID\u0026#34;, \u0026#34;adj_pval\u0026#34;=\u0026#34;p.adjust\u0026#34;) %\u0026gt;% dplyr::select(Category,ID,Term,Genes,adj_pval) %\u0026gt;% tibble::remove_rownames() t(res_enrich[1,]) # 1 # Category \u0026#34;GO\u0026#34; # ID \u0026#34;GO:0005819\u0026#34; # Term \u0026#34;spindle\u0026#34; # Genes \u0026#34;CDCA8, CDC20, KIF23, CENPE, ASPM, DLGAP5, SKA1, NUSAP1, TPX2, TACC3, NEK2, CDK1, MAD2L1, KIF18A, BIRC5, KIF11, TRAT1, TTK, AURKB, PRC1, KIFC1, KIF18B, KIF20A, AURKA, CCNB1, KIF4A\u0026#34; # adj_pval \u0026#34;6.339976e-11\u0026#34; ## å¦‚ä¸Šï¼ŒIDä¸ºoptionalï¼ŒCategoryä¸ºrequired ## (2) åŸºå› å·®å¼‚å€æ•° res_logfc = data.frame(ID=gene_ids$SYMBOL, logFC=geneList) head(res_logfc) # ID logFC # 1 MMP1 4.572613 # 2 CDC45 4.514594 # 3 NMU 4.418218 ## å¦‚æ— ç›¸å…³æ•°æ®ï¼Œå¯éšä¾¿è®¾ç½®ä¸º0 ## (3) æ„å»ºç»˜å›¾å¯¹è±¡ circ \u0026lt;- circle_dat(res_enrich, res_logfc) head(circ) Circular visualization\n",
  "keywords": [
    "è½¬å½•ç»„"
  ],
  "articleBody": "0ã€ç¤ºä¾‹æ•°æ® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 library(clusterProfiler) library(org.Hs.eg.db) data(geneList, package=\"DOSE\") str(geneList) # Named num [1:12495] 4.57 4.51 4.42 4.14 3.88 ... # - attr(*, \"names\")= chr [1:12495] \"4312\" \"8318\" \"10874\" \"55143\" ... gene_ids\u003c-AnnotationDbi::select(org.Hs.eg.db, keys=as.character(names(gene_list)), columns=\"SYMBOL\", #ç›®æ ‡æ ¼å¼ keytype=\"ENTREZID\") #ç›®å‰çš„æ ¼å¼ # 'select()' returned 1:1 mapping between keys and columns ## ORAåˆ†æ gene_deg = names(geneList)[abs(geneList) \u003e 2] ego \u003c- enrichGO(gene = gene_deg, OrgDb = org.Hs.eg.db, ont = \"CC\", # \"BP\",\"MF\",\"ALL\" pAdjustMethod = \"BH\", pvalueCutoff = 0.01, qvalueCutoff = 0.05, readable = TRUE) ## GSEAåˆ†æ gseago \u003c- gseGO(geneList = geneList, OrgDb = org.Hs.eg.db, ont = \"CC\", minGSSize = 100, maxGSSize = 500, pvalueCutoff = 0.05, verbose = FALSE) gseago = setReadable(gseago, OrgDb = org.Hs.eg.db) 1ã€ggplot2 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 ## ORA library(tidyverse) ego_df = ego@result %\u003e% head(10) %\u003e% dplyr::mutate(logp = -log10(p.adjust)) %\u003e% dplyr::arrange(logp) %\u003e% dplyr::mutate(Label=str_wrap(gsub(\"_\",\" \",Description), width = 50)) %\u003e% dplyr::mutate(Label = factor(Label, levels=Label)) %\u003e% tibble::remove_rownames() %\u003e% dplyr::select(Label, logp) head(ego_df) # Label logp # 1 microtubule associated complex 5.419514 # 2 spindle midzone 5.681085 # 3 spindle microtubule 7.341138 ggplot(ego_df, aes(x=Label, y=logp)) + geom_bar(stat=\"identity\", fill=\"#1b9e77\") + xlab(\"Pathway names\") + ylab(\"-log10(P.adj)\") + scale_y_continuous(expand=c(0,0)) + coord_flip() + xlab(\"GO Pathway\") + ylab(\"Adjusted P value(-log10)\") + geom_text(aes(label = Label, y=0.2), hjust = 0, size=5) + theme_classic() + theme(axis.text.y = element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_text(size = 25), axis.title.x = element_text(size = 20), axis.text.x = element_text(size = 16)) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 ## GSEA library(tidyverse) gseago_df = gseago@result %\u003e% head(20) %\u003e% dplyr::mutate(logp = -log10(p.adjust)) %\u003e% dplyr::arrange(logp) %\u003e% dplyr::mutate(Label=str_wrap(gsub(\"_\",\" \",Description), width = 50)) %\u003e% dplyr::mutate(Label = factor(Label, levels=Label)) %\u003e% tibble::remove_rownames() %\u003e% dplyr::select(Label, logp, NES) head(gseago_df) # Label logp NES # 1 polymeric cytoskeletal fiber 3.755730 1.487284 # 2 chromosome, telomeric region 4.311816 1.907511 # 3 microtubule associated complex 4.432327 1.944046 ggplot(gseago_df, aes(NES, fct_reorder(Label, NES), fill=qvalue)) + geom_bar(stat='identity') + scale_fill_continuous(low='red', high='blue', guide=guide_colorbar(reverse=TRUE)) + theme_minimal() + ylab(NULL) 2ã€GOplot å®˜æ–¹æ•™ç¨‹ï¼šhttps://wencke.github.io/ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 # install.packages('GOplot') library(GOplot) # (1) å‡†å¤‡æ•°æ® ## å¯Œé›†é€šè·¯ç»“æœ res_enrich = ego@result %\u003e% dplyr::select(ID, Description, geneID,p.adjust) %\u003e% dplyr::mutate(Category = \"GO\", .before=1) %\u003e% dplyr::mutate(geneID = gsub(\"/\",\", \", geneID)) %\u003e% dplyr::rename(\"Term\"=\"Description\", \"Genes\"=\"geneID\", \"adj_pval\"=\"p.adjust\") %\u003e% dplyr::select(Category,ID,Term,Genes,adj_pval) %\u003e% tibble::remove_rownames() t(res_enrich[1,]) # 1 # Category \"GO\" # ID \"GO:0005819\" # Term \"spindle\" # Genes \"CDCA8, CDC20, KIF23, CENPE, ASPM, DLGAP5, SKA1, NUSAP1, TPX2, TACC3, NEK2, CDK1, MAD2L1, KIF18A, BIRC5, KIF11, TRAT1, TTK, AURKB, PRC1, KIFC1, KIF18B, KIF20A, AURKA, CCNB1, KIF4A\" # adj_pval \"6.339976e-11\" ## å¦‚ä¸Šï¼ŒIDä¸ºoptionalï¼ŒCategoryä¸ºrequired ## (2) åŸºå› å·®å¼‚å€æ•° res_logfc = data.frame(ID=gene_ids$SYMBOL, logFC=geneList) head(res_logfc) # ID logFC # 1 MMP1 4.572613 # 2 CDC45 4.514594 # 3 NMU 4.418218 ## å¦‚æ— ç›¸å…³æ•°æ®ï¼Œå¯éšä¾¿è®¾ç½®ä¸º0 ## (3) æ„å»ºç»˜å›¾å¯¹è±¡ circ \u003c- circle_dat(res_enrich, res_logfc) head(circ) Circular visualization\næ­¤ç§ç»˜å›¾æ–¹å¼ï¼ŒIDåˆ—ä¸ºrequired\n1 2 GOCircle(circ, nsub = 10) # GOCircle(circ, nsub = 5) Chord visualization 1 2 3 4 5 6 7 8 ## å±•ç¤ºæŒ‡å®šé€šè·¯ pw_sle = ego@result$Description[1:4] ## å±•ç¤ºæŒ‡å®šåŸºå›  gene_sle = res_logfc ## æ„å»ºç»˜å›¾å¯¹è±¡ gene_sle = res_logfc # chord \u003c- chord_dat(data = circ, genes = gene_sle) # chord \u003c- chord_dat(data = circ, process = pw_sle) 1 2 3 4 5 6 7 8 9 10 11 12 13 ## å«æœ‰å·®å¼‚å€æ•°ä¿¡æ¯æƒ…å†µ GOChord(chord, limit = c(0, 0), # ç¬¬1ä¸ªæ•°ï¼šåŸºå› è‡³å°‘å¯Œé›†åˆ°0æ¡é€šè·¯ # ç¬¬2ä¸ªæ•°ï¼šåŸºå› è‡³å°‘å¯Œé›†åˆ°0æ¡å±•ç¤ºé€šè·¯ space = 0.02, #åŸºå› çŸ©å½¢çš„é—´è· gene.order = 'none', process.label = 10, #legendå­—ä½“å¤§å° lfc.col = c(\"red\",\"gray\",\"blue\"), #æ˜ å°„å·®å¼‚å€æ•°çš„é¢œè‰² ribbon.col=brewer.pal(length(pw_sle), \"Set1\"), #é€šè·¯æ¡å¸¦é¢œè‰² gene.space = 0.25, #åŸºå› åè‡³åœ†çš„è·ç¦» gene.size = 3 # åŸºå› åçš„å¤§å° ) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 ## å¿½ç•¥å·®å¼‚å€æ•°ä¿¡æ¯æƒ…å†µ GOChord(chord[,-1*ncol(chord)], nlfc = 0, limit = c(3, 3), # ç¬¬1ä¸ªæ•°ï¼šåŸºå› è‡³å°‘å¯Œé›†åˆ°3æ¡é€šè·¯ # ç¬¬2ä¸ªæ•°ï¼šåŸºå› è‡³å°‘å¯Œé›†åˆ°3æ¡å±•ç¤ºé€šè·¯ space = 0.02, #åŸºå› çŸ©å½¢çš„é—´è· gene.order = 'none', process.label = 10, #legendå­—ä½“å¤§å° lfc.col = \"red\", #æ˜ å°„å·®å¼‚å€æ•°çš„é¢œè‰² ribbon.col=brewer.pal(length(pw_sle), \"Set1\"), #é€šè·¯æ¡å¸¦é¢œè‰² gene.space = 0.25, #åŸºå› åè‡³åœ†çš„è·ç¦» gene.size = 3 # åŸºå› åçš„å¤§å° ) 3ã€aPEAR å‚è€ƒï¼šhttps://github.com/ievaKer/aPEARï¼Œ https://cran.r-project.org/web/packages/aPEAR/vignettes/aPEAR-vignette.html\nç®€ä»‹ï¼šè¯¥åŒ…å¯é’ˆå¯¹å¯Œé›†åˆ†æç»“æœè¿›è¡Œé€šè·¯èšç±»ï¼Œå¾—åˆ°è‹¥å¹²clusterï¼Œç„¶åå†è¿›è¡Œç½‘ç»œå›¾å¯è§†åŒ–ã€‚\n1 2 3 4 5 library(tidyverse) library(clusterProfiler) library(DOSE) library(org.Hs.eg.db) library(aPEAR) è¯¥åŒ…çš„ä¸€ä¸ªæ ¸å¿ƒå‡½æ•°æ˜¯enrichmentNetwork()ï¼Œå…¶éœ€è¦çš„ä¸»è¦å‚æ•°æ˜¯è¡¨ç¤ºå¯Œé›†åˆ†æçš„æ•°æ®æ¡†ã€‚éœ€è¦åŒ…å«å¦‚ä¸‹å‡ åˆ—\nDescriptionï¼šæè¿°é€šè·¯çš„å«ä¹‰ï¼›\npathwayGenesï¼šé€šè·¯çš„ç»„æˆåŸºå› ã€‚\nit will be used to calculate the similarities between the pathways. It can be leading edge genes or the full gene list. The ID type (Ensembl, Gene symbol, etc.) does not matter but should be the same between all the pathways. The genes should be separated by â€œ/â€.\né€šè·¯å¯Œé›†ç¨‹åº¦çš„åˆ—ï¼Œå¯ä»¥ä¸ºPå€¼ï¼›å¯¹äºGSEAç»“æœä¹Ÿå¯ä»¥æ˜¯NESï¼›\né€šè·¯åŸºå› æ•°ç›®çš„åˆ—ã€‚\n1 2 3 4 5 6 data(geneList) enrich \u003c- gseGO(geneList, OrgDb = org.Hs.eg.db, ont = 'CC') enrich_df = enrich@result enrich_df2plot = enrich_df[,c(\"Description\",\"core_enrichment\",\"NES\",\"setSize\")] colnames(enrich_df2plot) = c(\"Description\",\"pathwayGenes\",\"NES\",\"Size\") æ­¤å¤–è¿˜æœ‰å…¶å®ƒå‚æ•°å¯ä»¥è°ƒæ•´ï¼ŒåŒ…æ‹¬èšç±»ã€é¢œè‰²ç­‰\nè®¡ç®—é€šè·¯ç›¸ä¼¼åº¦æ–¹æ³• simMethod = c(â€œjaccardâ€, â€œcosineâ€, â€œcorâ€) èšç±»ç®—æ³• clustMethod = c(â€œmarkovâ€, â€œhierâ€, â€œspectralâ€) ç±»åˆ«å clustNameMethod = c(â€œpagerankâ€, â€œhitsâ€, â€œnoneâ€) ç­›é€‰ç±»-æ¯ç±»åŒ…å«çš„æœ€å°é€šè·¯æ•°ç›® minClusterSize = 2 è®¤ä¸ºç±»åˆ«å†…/é—´ï¼Œé€šè·¯ç›¸ä¼¼çš„é˜ˆå€¼ innerCutoff/outerCutoff 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 set.seed(123) # å¦‚æœå½“å‰ç½‘ç»œæ’ç‰ˆä¸ç†æƒ³ï¼Œå¯ä»¥è°ƒæ•´seed net.list= enrichmentNetwork(enrich_df2plot, simMethod = \"jaccard\", clustMethod = \"markov\", clustNameMethod = \"pagerank\", minClusterSize = 5, innerCutoff = 0.1, outerCutoff = 0.5, drawEllipses = FALSE, fontSize = 3, repelLabels = FALSE, colorBy = \"NES\", colorType = \"nes\", # c(\"nes\", \"pval\") pCutoff = -10, # when colorType = \"pval\" nodeSize = \"Size\", plotOnly = FALSE) net_cluster = net.list$clusters table(net_cluster$Cluster) # ciliary plasm condensed chromosome, centromeric region # 6 6 # external encapsulating structure mitotic spindle # 5 12 # postsynaptic specialization membrane vesicle lumen # 5 6 net.list$plot ",
  "wordCount" : "1544",
  "inLanguage": "en",
  "datePublished": "2023-01-14T00:00:00Z",
  "dateModified": "2023-06-17T00:00:00Z",
  "author":[{
    "@type": "Person",
    "name": "Lishensuo"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://lishensuo.github.io/en/posts/bioinfo/057%E5%AF%8C%E9%9B%86%E9%80%9A%E8%B7%AF%E5%8F%AF%E8%A7%86%E5%8C%96%E6%96%B9%E5%BC%8F/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Li's Bioinfo-Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://lishensuo.github.io/img/Q.gif"
    }
  }
}
</script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://lishensuo.github.io/en/" accesskey="h" title="Li&#39;s Bioinfo-Blog (Alt + H)">Li&#39;s Bioinfo-Blog</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                </ul>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://lishensuo.github.io/en/" title="ä¸»é¡µ">
                    <span>ä¸»é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/posts" title="åˆ†ç±»">
                    <span>åˆ†ç±»</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/tags" title="æ ‡ç­¾">
                    <span>æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/archives/" title="å½’æ¡£">
                    <span>å½’æ¡£</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/about" title="å…³äº">
                    <span>å…³äº</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/search" title="æœç´¢ (Alt &#43; /)" accesskey=/>
                    <span>æœç´¢</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://lishensuo.github.io/en/">Home</a>&nbsp;Â»&nbsp;<a href="https://lishensuo.github.io/en/posts/">åˆ†ç±»</a>&nbsp;Â»&nbsp;<a href="https://lishensuo.github.io/en/posts/bioinfo/">ğŸ“– ç”Ÿä¿¡æ•°æ®åˆ†æ--åˆ†ææµç¨‹ï¼Œå·¥å…·åŒ…ç­‰</a></div>
    <h1 class="post-title">
      å¯Œé›†é€šè·¯å¯è§†åŒ–æ–¹å¼
    </h1>
    <div class="post-meta">













Create:&amp;nbsp;&lt;span title=&#39;2023-01-14 00:00:00 &#43;0000 UTC&#39;&gt;2023-01-14&lt;/span&gt;&amp;nbsp;|&amp;nbsp;Update:&amp;nbsp;2023-06-17&amp;nbsp;|&amp;nbsp;Words:&amp;nbsp;1544&amp;nbsp;|&amp;nbsp;4 min&amp;nbsp;|&amp;nbsp;Lishensuo

|  Viewers: <span id="busuanzi_value_page_pv"></span> 
	  
    </div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">Table of Contents</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#0%e7%a4%ba%e4%be%8b%e6%95%b0%e6%8d%ae" aria-label="0ã€ç¤ºä¾‹æ•°æ®">0ã€ç¤ºä¾‹æ•°æ®</a></li>
                    <li>
                        <a href="#1ggplot2" aria-label="1ã€ggplot2">1ã€ggplot2</a></li>
                    <li>
                        <a href="#2goplot" aria-label="2ã€GOplot">2ã€GOplot</a></li>
                    <li>
                        <a href="#3apear" aria-label="3ã€aPEAR">3ã€aPEAR</a>
                    </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>


  <div class="post-content"><h2 id="0ç¤ºä¾‹æ•°æ®">0ã€ç¤ºä¾‹æ•°æ®<a hidden class="anchor" aria-hidden="true" href="#0ç¤ºä¾‹æ•°æ®">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>library(clusterProfiler)
</span></span><span style="display:flex;"><span>library(org.Hs.eg.db)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data(geneList, package=<span style="color:#0ff;font-weight:bold">&#34;DOSE&#34;</span>)
</span></span><span style="display:flex;"><span>str(geneList)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Named num [1:12495] 4.57 4.51 4.42 4.14 3.88 ...</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># - attr(*, &#34;names&#34;)= chr [1:12495] &#34;4312&#34; &#34;8318&#34; &#34;10874&#34; &#34;55143&#34; ...</span>
</span></span><span style="display:flex;"><span>gene_ids&lt;-AnnotationDbi::select(org.Hs.eg.db, keys=as.character(names(gene_list)), 
</span></span><span style="display:flex;"><span>                                columns=<span style="color:#0ff;font-weight:bold">&#34;SYMBOL&#34;</span>, <span style="color:#007f7f">#ç›®æ ‡æ ¼å¼</span>
</span></span><span style="display:flex;"><span>                                keytype=<span style="color:#0ff;font-weight:bold">&#34;ENTREZID&#34;</span>) <span style="color:#007f7f">#ç›®å‰çš„æ ¼å¼</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># &#39;select()&#39; returned 1:1 mapping between keys and columns</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">## ORAåˆ†æ</span>
</span></span><span style="display:flex;"><span>gene_deg = names(geneList)[abs(geneList) &gt; <span style="color:#ff0;font-weight:bold">2</span>]
</span></span><span style="display:flex;"><span>ego &lt;- enrichGO(gene          = gene_deg,
</span></span><span style="display:flex;"><span>                OrgDb         = org.Hs.eg.db,
</span></span><span style="display:flex;"><span>                ont           = <span style="color:#0ff;font-weight:bold">&#34;CC&#34;</span>, <span style="color:#007f7f"># &#34;BP&#34;,&#34;MF&#34;,&#34;ALL&#34;</span>
</span></span><span style="display:flex;"><span>                pAdjustMethod = <span style="color:#0ff;font-weight:bold">&#34;BH&#34;</span>,
</span></span><span style="display:flex;"><span>                pvalueCutoff  = <span style="color:#ff0;font-weight:bold">0.01</span>,
</span></span><span style="display:flex;"><span>                qvalueCutoff  = <span style="color:#ff0;font-weight:bold">0.05</span>,
</span></span><span style="display:flex;"><span>                readable      = <span style="color:#fff;font-weight:bold">TRUE</span>)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">## GSEAåˆ†æ</span>
</span></span><span style="display:flex;"><span>gseago &lt;- gseGO(geneList     = geneList,
</span></span><span style="display:flex;"><span>                OrgDb        = org.Hs.eg.db,
</span></span><span style="display:flex;"><span>                ont          = <span style="color:#0ff;font-weight:bold">&#34;CC&#34;</span>,
</span></span><span style="display:flex;"><span>                minGSSize    = <span style="color:#ff0;font-weight:bold">100</span>,
</span></span><span style="display:flex;"><span>                maxGSSize    = <span style="color:#ff0;font-weight:bold">500</span>,
</span></span><span style="display:flex;"><span>                pvalueCutoff = <span style="color:#ff0;font-weight:bold">0.05</span>,
</span></span><span style="display:flex;"><span>                verbose      = <span style="color:#fff;font-weight:bold">FALSE</span>)
</span></span><span style="display:flex;"><span>gseago = setReadable(gseago, OrgDb = org.Hs.eg.db)
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="1ggplot2">1ã€ggplot2<a hidden class="anchor" aria-hidden="true" href="#1ggplot2">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span><span style="color:#007f7f">## ORA</span>
</span></span><span style="display:flex;"><span>library(tidyverse)
</span></span><span style="display:flex;"><span>ego_df = ego@result %&gt;% head(<span style="color:#ff0;font-weight:bold">10</span>) %&gt;% 
</span></span><span style="display:flex;"><span>  dplyr::mutate(logp = -log10(p.adjust)) %&gt;% 
</span></span><span style="display:flex;"><span>  dplyr::arrange(logp) %&gt;% 
</span></span><span style="display:flex;"><span>  dplyr::mutate(Label=str_wrap(gsub(<span style="color:#0ff;font-weight:bold">&#34;_&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34; &#34;</span>,Description), width = <span style="color:#ff0;font-weight:bold">50</span>)) %&gt;% 
</span></span><span style="display:flex;"><span>  dplyr::mutate(Label = factor(Label, levels=Label)) %&gt;% 
</span></span><span style="display:flex;"><span>  tibble::remove_rownames() %&gt;% 
</span></span><span style="display:flex;"><span>  dplyr::select(Label, logp)
</span></span><span style="display:flex;"><span>head(ego_df)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#                                      Label     logp</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1           microtubule associated complex 5.419514</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 2                          spindle midzone 5.681085</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 3                      spindle microtubule 7.341138</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ggplot(ego_df, aes(x=Label, y=logp)) + 
</span></span><span style="display:flex;"><span>  geom_bar(stat=<span style="color:#0ff;font-weight:bold">&#34;identity&#34;</span>, fill=<span style="color:#0ff;font-weight:bold">&#34;#1b9e77&#34;</span>) + 
</span></span><span style="display:flex;"><span>  xlab(<span style="color:#0ff;font-weight:bold">&#34;Pathway names&#34;</span>) +
</span></span><span style="display:flex;"><span>  ylab(<span style="color:#0ff;font-weight:bold">&#34;-log10(P.adj)&#34;</span>) +
</span></span><span style="display:flex;"><span>  scale_y_continuous(expand=c(<span style="color:#ff0;font-weight:bold">0</span>,<span style="color:#ff0;font-weight:bold">0</span>)) + 
</span></span><span style="display:flex;"><span>  coord_flip() + 
</span></span><span style="display:flex;"><span>  xlab(<span style="color:#0ff;font-weight:bold">&#34;GO Pathway&#34;</span>) + 
</span></span><span style="display:flex;"><span>  ylab(<span style="color:#0ff;font-weight:bold">&#34;Adjusted P value(-log10)&#34;</span>) + 
</span></span><span style="display:flex;"><span>  geom_text(aes(label = Label, y=<span style="color:#ff0;font-weight:bold">0.2</span>), hjust = <span style="color:#ff0;font-weight:bold">0</span>, size=<span style="color:#ff0;font-weight:bold">5</span>) +
</span></span><span style="display:flex;"><span>  theme_classic() +
</span></span><span style="display:flex;"><span>  theme(axis.text.y = element_blank(),
</span></span><span style="display:flex;"><span>        axis.ticks.y = element_blank(),
</span></span><span style="display:flex;"><span>        axis.title.y = element_text(size = <span style="color:#ff0;font-weight:bold">25</span>),
</span></span><span style="display:flex;"><span>        axis.title.x = element_text(size = <span style="color:#ff0;font-weight:bold">20</span>),
</span></span><span style="display:flex;"><span>        axis.text.x = element_text(size = <span style="color:#ff0;font-weight:bold">16</span>))
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://raw.githubusercontent.com/lishensuo/images/main/image-20230114200216781.png" alt="image-20230114200216781" style="zoom: 33%;" />
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span><span style="color:#007f7f">## GSEA</span>
</span></span><span style="display:flex;"><span>library(tidyverse)
</span></span><span style="display:flex;"><span>gseago_df = gseago@result %&gt;% head(<span style="color:#ff0;font-weight:bold">20</span>) %&gt;% 
</span></span><span style="display:flex;"><span>  dplyr::mutate(logp = -log10(p.adjust)) %&gt;% 
</span></span><span style="display:flex;"><span>  dplyr::arrange(logp) %&gt;% 
</span></span><span style="display:flex;"><span>  dplyr::mutate(Label=str_wrap(gsub(<span style="color:#0ff;font-weight:bold">&#34;_&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34; &#34;</span>,Description), width = <span style="color:#ff0;font-weight:bold">50</span>)) %&gt;% 
</span></span><span style="display:flex;"><span>  dplyr::mutate(Label = factor(Label, levels=Label)) %&gt;% 
</span></span><span style="display:flex;"><span>  tibble::remove_rownames() %&gt;% 
</span></span><span style="display:flex;"><span>  dplyr::select(Label, logp, NES)
</span></span><span style="display:flex;"><span>head(gseago_df)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#                            Label     logp      NES</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1   polymeric cytoskeletal fiber 3.755730 1.487284</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 2   chromosome, telomeric region 4.311816 1.907511</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 3 microtubule associated complex 4.432327 1.944046</span>
</span></span><span style="display:flex;"><span>ggplot(gseago_df, 
</span></span><span style="display:flex;"><span>       aes(NES, fct_reorder(Label, NES), fill=qvalue)) + 
</span></span><span style="display:flex;"><span>  geom_bar(stat=<span style="color:#0ff;font-weight:bold">&#39;identity&#39;</span>) + 
</span></span><span style="display:flex;"><span>  scale_fill_continuous(low=<span style="color:#0ff;font-weight:bold">&#39;red&#39;</span>, high=<span style="color:#0ff;font-weight:bold">&#39;blue&#39;</span>, 
</span></span><span style="display:flex;"><span>                        guide=guide_colorbar(reverse=<span style="color:#fff;font-weight:bold">TRUE</span>)) + 
</span></span><span style="display:flex;"><span>  theme_minimal() + ylab(<span style="color:#fff;font-weight:bold">NULL</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://raw.githubusercontent.com/lishensuo/images/main/image-20230114200540657.png" alt="image-20230114200540657" style="zoom:50%;" />
<h2 id="2goplot">2ã€GOplot<a hidden class="anchor" aria-hidden="true" href="#2goplot">#</a></h2>
<ul>
<li>å®˜æ–¹æ•™ç¨‹ï¼šhttps://wencke.github.io/</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span><span style="color:#007f7f"># install.packages(&#39;GOplot&#39;)</span>
</span></span><span style="display:flex;"><span>library(GOplot)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># (1) å‡†å¤‡æ•°æ®</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">## å¯Œé›†é€šè·¯ç»“æœ</span>
</span></span><span style="display:flex;"><span>res_enrich = ego@result %&gt;% 
</span></span><span style="display:flex;"><span>  dplyr::select(ID, Description, geneID,p.adjust) %&gt;% 
</span></span><span style="display:flex;"><span>  dplyr::mutate(Category = <span style="color:#0ff;font-weight:bold">&#34;GO&#34;</span>, .before=<span style="color:#ff0;font-weight:bold">1</span>) %&gt;%  
</span></span><span style="display:flex;"><span>  dplyr::mutate(geneID = gsub(<span style="color:#0ff;font-weight:bold">&#34;/&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;, &#34;</span>, geneID)) %&gt;% 
</span></span><span style="display:flex;"><span>  dplyr::rename(<span style="color:#0ff;font-weight:bold">&#34;Term&#34;</span>=<span style="color:#0ff;font-weight:bold">&#34;Description&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;Genes&#34;</span>=<span style="color:#0ff;font-weight:bold">&#34;geneID&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;adj_pval&#34;</span>=<span style="color:#0ff;font-weight:bold">&#34;p.adjust&#34;</span>) %&gt;%
</span></span><span style="display:flex;"><span>  dplyr::select(Category,ID,Term,Genes,adj_pval) %&gt;% 
</span></span><span style="display:flex;"><span>  tibble::remove_rownames()
</span></span><span style="display:flex;"><span>t(res_enrich[1,])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#           1                                                                                                                                                                                   </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Category &#34;GO&#34;                                                                                                                                                                                </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># ID       &#34;GO:0005819&#34;                                                                                                                                                                        </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Term     &#34;spindle&#34;                                                                                                                                                                           </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Genes    &#34;CDCA8, CDC20, KIF23, CENPE, ASPM, DLGAP5, SKA1, NUSAP1, TPX2, TACC3, NEK2, CDK1, MAD2L1, KIF18A, BIRC5, KIF11, TRAT1, TTK, AURKB, PRC1, KIFC1, KIF18B, KIF20A, AURKA, CCNB1, KIF4A&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># adj_pval &#34;6.339976e-11&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">## å¦‚ä¸Šï¼ŒIDä¸ºoptionalï¼ŒCategoryä¸ºrequired</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">## (2) åŸºå› å·®å¼‚å€æ•°</span>
</span></span><span style="display:flex;"><span>res_logfc = data.frame(ID=gene_ids$SYMBOL,
</span></span><span style="display:flex;"><span>                       logFC=geneList)
</span></span><span style="display:flex;"><span>head(res_logfc)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#      ID    logFC</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1  MMP1 4.572613</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 2 CDC45 4.514594</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 3   NMU 4.418218</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">## å¦‚æ— ç›¸å…³æ•°æ®ï¼Œå¯éšä¾¿è®¾ç½®ä¸º0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">## (3) æ„å»ºç»˜å›¾å¯¹è±¡</span>
</span></span><span style="display:flex;"><span>circ &lt;- circle_dat(res_enrich, res_logfc)
</span></span><span style="display:flex;"><span>head(circ)
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>Circular visualization</p>
<p>æ­¤ç§ç»˜å›¾æ–¹å¼ï¼ŒIDåˆ—ä¸ºrequired</p>
</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>GOCircle(circ, nsub = <span style="color:#ff0;font-weight:bold">10</span>)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># GOCircle(circ, nsub = 5)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://raw.githubusercontent.com/lishensuo/images/main/image-20230114202946549.png" alt="image-20230114202946549" style="zoom: 33%;" />
<ul>
<li>Chord visualization</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span><span style="color:#007f7f">## å±•ç¤ºæŒ‡å®šé€šè·¯</span>
</span></span><span style="display:flex;"><span>pw_sle = ego@result$Description[1:<span style="color:#ff0;font-weight:bold">4</span>]
</span></span><span style="display:flex;"><span><span style="color:#007f7f">## å±•ç¤ºæŒ‡å®šåŸºå› </span>
</span></span><span style="display:flex;"><span>gene_sle = res_logfc
</span></span><span style="display:flex;"><span><span style="color:#007f7f">## æ„å»ºç»˜å›¾å¯¹è±¡</span>
</span></span><span style="display:flex;"><span>gene_sle = res_logfc
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># chord &lt;- chord_dat(data = circ, genes = gene_sle)</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># chord &lt;- chord_dat(data = circ, process = pw_sle)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span><span style="color:#007f7f">## å«æœ‰å·®å¼‚å€æ•°ä¿¡æ¯æƒ…å†µ</span>
</span></span><span style="display:flex;"><span>GOChord(chord, 
</span></span><span style="display:flex;"><span>        limit = c(<span style="color:#ff0;font-weight:bold">0</span>, <span style="color:#ff0;font-weight:bold">0</span>), 
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f"># ç¬¬1ä¸ªæ•°ï¼šåŸºå› è‡³å°‘å¯Œé›†åˆ°0æ¡é€šè·¯</span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f"># ç¬¬2ä¸ªæ•°ï¼šåŸºå› è‡³å°‘å¯Œé›†åˆ°0æ¡å±•ç¤ºé€šè·¯</span>
</span></span><span style="display:flex;"><span>        space = <span style="color:#ff0;font-weight:bold">0.02</span>, <span style="color:#007f7f">#åŸºå› çŸ©å½¢çš„é—´è·</span>
</span></span><span style="display:flex;"><span>        gene.order = <span style="color:#0ff;font-weight:bold">&#39;none&#39;</span>, 
</span></span><span style="display:flex;"><span>        process.label = <span style="color:#ff0;font-weight:bold">10</span>,  <span style="color:#007f7f">#legendå­—ä½“å¤§å°</span>
</span></span><span style="display:flex;"><span>        lfc.col = c(<span style="color:#0ff;font-weight:bold">&#34;red&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;gray&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;blue&#34;</span>),  <span style="color:#007f7f">#æ˜ å°„å·®å¼‚å€æ•°çš„é¢œè‰²</span>
</span></span><span style="display:flex;"><span>        ribbon.col=brewer.pal(length(pw_sle), <span style="color:#0ff;font-weight:bold">&#34;Set1&#34;</span>), <span style="color:#007f7f">#é€šè·¯æ¡å¸¦é¢œè‰²</span>
</span></span><span style="display:flex;"><span>        gene.space = <span style="color:#ff0;font-weight:bold">0.25</span>, <span style="color:#007f7f">#åŸºå› åè‡³åœ†çš„è·ç¦»</span>
</span></span><span style="display:flex;"><span>        gene.size = <span style="color:#ff0;font-weight:bold">3</span>  <span style="color:#007f7f"># åŸºå› åçš„å¤§å°</span>
</span></span><span style="display:flex;"><span>        )
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://raw.githubusercontent.com/lishensuo/images/main/image-20230114203752900.png" alt="image-20230114203752900" style="zoom:33%;" />
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span><span style="color:#007f7f">## å¿½ç•¥å·®å¼‚å€æ•°ä¿¡æ¯æƒ…å†µ</span>
</span></span><span style="display:flex;"><span>GOChord(chord[,<span style="color:#ff0;font-weight:bold">-1</span>*ncol(chord)], 
</span></span><span style="display:flex;"><span>        nlfc = <span style="color:#ff0;font-weight:bold">0</span>,
</span></span><span style="display:flex;"><span>        limit = c(<span style="color:#ff0;font-weight:bold">3</span>, <span style="color:#ff0;font-weight:bold">3</span>), 
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f"># ç¬¬1ä¸ªæ•°ï¼šåŸºå› è‡³å°‘å¯Œé›†åˆ°3æ¡é€šè·¯</span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f"># ç¬¬2ä¸ªæ•°ï¼šåŸºå› è‡³å°‘å¯Œé›†åˆ°3æ¡å±•ç¤ºé€šè·¯</span>
</span></span><span style="display:flex;"><span>        space = <span style="color:#ff0;font-weight:bold">0.02</span>, <span style="color:#007f7f">#åŸºå› çŸ©å½¢çš„é—´è·</span>
</span></span><span style="display:flex;"><span>        gene.order = <span style="color:#0ff;font-weight:bold">&#39;none&#39;</span>, 
</span></span><span style="display:flex;"><span>        process.label = <span style="color:#ff0;font-weight:bold">10</span>,  <span style="color:#007f7f">#legendå­—ä½“å¤§å°</span>
</span></span><span style="display:flex;"><span>        lfc.col = <span style="color:#0ff;font-weight:bold">&#34;red&#34;</span>,  <span style="color:#007f7f">#æ˜ å°„å·®å¼‚å€æ•°çš„é¢œè‰²</span>
</span></span><span style="display:flex;"><span>        ribbon.col=brewer.pal(length(pw_sle), <span style="color:#0ff;font-weight:bold">&#34;Set1&#34;</span>), <span style="color:#007f7f">#é€šè·¯æ¡å¸¦é¢œè‰²</span>
</span></span><span style="display:flex;"><span>        gene.space = <span style="color:#ff0;font-weight:bold">0.25</span>, <span style="color:#007f7f">#åŸºå› åè‡³åœ†çš„è·ç¦»</span>
</span></span><span style="display:flex;"><span>        gene.size = <span style="color:#ff0;font-weight:bold">3</span>  <span style="color:#007f7f"># åŸºå› åçš„å¤§å°</span>
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://raw.githubusercontent.com/lishensuo/images/main/image-20230114203917215.png" alt="image-20230114203917215" style="zoom:33%;" />
<h2 id="3apear">3ã€aPEAR<a hidden class="anchor" aria-hidden="true" href="#3apear">#</a></h2>
<ul>
<li>
<p>å‚è€ƒï¼šhttps://github.com/ievaKer/aPEARï¼Œ <a href="https://cran.r-project.org/web/packages/aPEAR/vignettes/aPEAR-vignette.html">https://cran.r-project.org/web/packages/aPEAR/vignettes/aPEAR-vignette.html</a></p>
</li>
<li>
<p>ç®€ä»‹ï¼šè¯¥åŒ…å¯é’ˆå¯¹å¯Œé›†åˆ†æç»“æœè¿›è¡Œé€šè·¯èšç±»ï¼Œå¾—åˆ°è‹¥å¹²clusterï¼Œç„¶åå†è¿›è¡Œç½‘ç»œå›¾å¯è§†åŒ–ã€‚</p>
</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>library(tidyverse)
</span></span><span style="display:flex;"><span>library(clusterProfiler)
</span></span><span style="display:flex;"><span>library(DOSE)
</span></span><span style="display:flex;"><span>library(org.Hs.eg.db)
</span></span><span style="display:flex;"><span>library(aPEAR)
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¯¥åŒ…çš„ä¸€ä¸ªæ ¸å¿ƒå‡½æ•°æ˜¯<code>enrichmentNetwork()</code>ï¼Œå…¶éœ€è¦çš„ä¸»è¦å‚æ•°æ˜¯è¡¨ç¤ºå¯Œé›†åˆ†æçš„æ•°æ®æ¡†ã€‚éœ€è¦åŒ…å«å¦‚ä¸‹å‡ åˆ—</p>
<ul>
<li>
<p>Descriptionï¼šæè¿°é€šè·¯çš„å«ä¹‰ï¼›</p>
</li>
<li>
<p>pathwayGenesï¼šé€šè·¯çš„ç»„æˆåŸºå› ã€‚</p>
<blockquote>
<p>it will be used to calculate the similarities between the pathways. It can be leading edge genes or the full gene list. The ID type (Ensembl, Gene symbol, etc.) does not matter but should be the same between all the pathways. The genes should be separated by â€œ/â€.</p></blockquote>
</li>
<li>
<p>é€šè·¯å¯Œé›†ç¨‹åº¦çš„åˆ—ï¼Œå¯ä»¥ä¸ºPå€¼ï¼›å¯¹äºGSEAç»“æœä¹Ÿå¯ä»¥æ˜¯NESï¼›</p>
</li>
<li>
<p>é€šè·¯åŸºå› æ•°ç›®çš„åˆ—ã€‚</p>
</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>data(geneList)
</span></span><span style="display:flex;"><span>enrich &lt;- gseGO(geneList, OrgDb = org.Hs.eg.db, ont = <span style="color:#0ff;font-weight:bold">&#39;CC&#39;</span>)
</span></span><span style="display:flex;"><span>enrich_df = enrich@result
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>enrich_df2plot = enrich_df[,c(<span style="color:#0ff;font-weight:bold">&#34;Description&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;core_enrichment&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;NES&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;setSize&#34;</span>)]
</span></span><span style="display:flex;"><span>colnames(enrich_df2plot) = c(<span style="color:#0ff;font-weight:bold">&#34;Description&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;pathwayGenes&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;NES&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;Size&#34;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ­¤å¤–è¿˜æœ‰å…¶å®ƒå‚æ•°å¯ä»¥è°ƒæ•´ï¼ŒåŒ…æ‹¬èšç±»ã€é¢œè‰²ç­‰</p>
<ul>
<li>è®¡ç®—é€šè·¯ç›¸ä¼¼åº¦æ–¹æ³• simMethod = c(&ldquo;jaccard&rdquo;, &ldquo;cosine&rdquo;, &ldquo;cor&rdquo;)</li>
<li>èšç±»ç®—æ³• clustMethod = c(&ldquo;markov&rdquo;, &ldquo;hier&rdquo;, &ldquo;spectral&rdquo;)</li>
<li>ç±»åˆ«å clustNameMethod = c(&ldquo;pagerank&rdquo;, &ldquo;hits&rdquo;, &ldquo;none&rdquo;)</li>
<li>ç­›é€‰ç±»-æ¯ç±»åŒ…å«çš„æœ€å°é€šè·¯æ•°ç›® minClusterSize = 2</li>
<li>è®¤ä¸ºç±»åˆ«å†…/é—´ï¼Œé€šè·¯ç›¸ä¼¼çš„é˜ˆå€¼ innerCutoff/outerCutoff</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>set.seed(<span style="color:#ff0;font-weight:bold">123</span>) <span style="color:#007f7f"># å¦‚æœå½“å‰ç½‘ç»œæ’ç‰ˆä¸ç†æƒ³ï¼Œå¯ä»¥è°ƒæ•´seed</span>
</span></span><span style="display:flex;"><span>net.list= enrichmentNetwork(enrich_df2plot, 
</span></span><span style="display:flex;"><span>                            simMethod = <span style="color:#0ff;font-weight:bold">&#34;jaccard&#34;</span>, 
</span></span><span style="display:flex;"><span>                            clustMethod = <span style="color:#0ff;font-weight:bold">&#34;markov&#34;</span>,
</span></span><span style="display:flex;"><span>                            clustNameMethod = <span style="color:#0ff;font-weight:bold">&#34;pagerank&#34;</span>,
</span></span><span style="display:flex;"><span>                            
</span></span><span style="display:flex;"><span>                            minClusterSize = <span style="color:#ff0;font-weight:bold">5</span>,
</span></span><span style="display:flex;"><span>                            innerCutoff = <span style="color:#ff0;font-weight:bold">0.1</span>,
</span></span><span style="display:flex;"><span>                            outerCutoff = <span style="color:#ff0;font-weight:bold">0.5</span>,
</span></span><span style="display:flex;"><span>                            drawEllipses = <span style="color:#fff;font-weight:bold">FALSE</span>,
</span></span><span style="display:flex;"><span>                            fontSize = <span style="color:#ff0;font-weight:bold">3</span>,
</span></span><span style="display:flex;"><span>                            repelLabels = <span style="color:#fff;font-weight:bold">FALSE</span>,
</span></span><span style="display:flex;"><span>                            
</span></span><span style="display:flex;"><span>                            colorBy = <span style="color:#0ff;font-weight:bold">&#34;NES&#34;</span>,
</span></span><span style="display:flex;"><span>                            colorType = <span style="color:#0ff;font-weight:bold">&#34;nes&#34;</span>, <span style="color:#007f7f"># c(&#34;nes&#34;, &#34;pval&#34;)</span>
</span></span><span style="display:flex;"><span>                            pCutoff = <span style="color:#ff0;font-weight:bold">-10</span>,     <span style="color:#007f7f"># when colorType = &#34;pval&#34;</span>
</span></span><span style="display:flex;"><span>                            nodeSize = <span style="color:#0ff;font-weight:bold">&#34;Size&#34;</span>,
</span></span><span style="display:flex;"><span>                            
</span></span><span style="display:flex;"><span>                            plotOnly = <span style="color:#fff;font-weight:bold">FALSE</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>net_cluster = net.list$clusters
</span></span><span style="display:flex;"><span>table(net_cluster$Cluster)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#                        ciliary plasm condensed chromosome, centromeric region </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#                                    6                                        6 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#     external encapsulating structure                          mitotic spindle </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#                                    5                                       12 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># postsynaptic specialization membrane                            vesicle lumen </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#                                    5                                        6 </span>
</span></span><span style="display:flex;"><span>net.list$plot
</span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="https://raw.githubusercontent.com/lishensuo/images/main/image-20230617100401078.png" alt="image-20230617100401078"  />
</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://lishensuo.github.io/en/tags/%E8%BD%AC%E5%BD%95%E7%BB%84/">è½¬å½•ç»„</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://lishensuo.github.io/en/posts/bioinfo/056clusterprofiler%E5%8C%85%E5%AF%8C%E9%9B%86%E5%88%86%E6%9E%90%E4%B8%8E%E5%8F%AF%E8%A7%86%E5%8C%96/">
    <span class="title">Â« Prev Page</span>
    <br>
    <span>clusterProfileråŒ…å¯Œé›†åˆ†æä¸å¯è§†åŒ–</span>
  </a>
  <a class="next" href="https://lishensuo.github.io/en/posts/bioinfo/071wgcna%E5%9F%BA%E5%9B%A0%E5%8A%A0%E6%9D%83%E5%85%B1%E8%A1%A8%E8%BE%BE%E7%BD%91%E7%BB%9C%E5%88%86%E6%9E%90/">
    <span class="title">Next Page Â»</span>
    <br>
    <span>WGCNAåŸºå› åŠ æƒå…±è¡¨è¾¾ç½‘ç»œåˆ†æ</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2025 <a href="https://lishensuo.github.io/en/">Li&#39;s Bioinfo-Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
		<br/>æ‚¨æ˜¯æœ¬ç«™ç¬¬ <span id="busuanzi_value_site_uv"></span> ä½è®¿é—®è€…ï¼Œæ€»æµè§ˆé‡ä¸º <span id="busuanzi_value_site_pv"></span> æ¬¡
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>

<script type="text/javascript"
async
src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
MathJax.Hub.Config({
tex2jax: {
inlineMath: [['$','$'], ['\\(','\\)']],
displayMath: [['$$','$$'], ['\[\[','\]\]']],
processEscapes: true,
processEnvironments: true,
skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
TeX: { equationNumbers: { autoNumber: "AMS" },
extensions: ["AMSmath.js", "AMSsymbols.js"] }
}
});

MathJax.Hub.Queue(function() {



var all = MathJax.Hub.getAllJax(), i;
for(i = 0; i < all.length; i += 1) {
all[i].SourceElement().parentNode.className += ' has-jax';
}
});
</script>

<style>
code.has-jax {
font: inherit;
font-size: 100%;
background: inherit;
border: inherit;
color: #515151;
}
</style></body>
</html>
