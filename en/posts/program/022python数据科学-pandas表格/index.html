<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">

<link rel="icon" href="/favicon.ico" type="image/x-icon"> 
<title>Pythonæ•°æ®ç§‘å­¦-(3)Pandasè¡¨æ ¼ | Li&#39;s Bioinfo-Blog</title>
<meta name="keywords" content="Python">
<meta name="description" content="
Pandasç›¸æ¯”Numpyæ•°ç»„æ”¯æŒè¡Œåˆ—æ ‡ç­¾ã€å¤šç§æ•°æ®ç±»å‹ï¼Œç±»ä¼¼Rè¯­è¨€ä¸­data.frameæ•°æ®æ¡†ã€‚

1ã€Pandasç»“æ„
1.1 Seriesï¼šæœ‰ç´¢å¼•çš„ä¸€ç»´æ•°ç»„
1.1.1 åˆ›å»ºSerieså¯¹è±¡

é€šè¿‡pd.Seriseå‡½æ•°åˆ›å»º



 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15


##(1) é€šè¿‡indexå‚æ•°è®¾ç½®ç´¢å¼•
import pandas as pd
data = pd.Series([1,2,3,4,5], index=[&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;,&#39;e&#39;])
#a    1
#b    2
#c    3
#d    4
#e    5
#dtype: int64

##(2)å¦‚ä¸è®¾ç½®indexå‚æ•°ï¼Œåˆ™ç´¢å¼•é»˜è®¤ä¸º range(len)
data1 = pd.Series([1,2,3,4,5])

##(3)ä¹Ÿå¯ä»¥ä»¥å­—å…¸çš„å½¢å¼åˆ›å»ºï¼Œé”®å€¼åˆ†åˆ«å¯¹åº”ç´¢å¼•ä¸å€¼
data2 = pd.Series({&#39;a&#39;:1,&#39;b&#39;:2,&#39;c&#39;:3,&#39;d&#39;:4,&#39;e&#39;:5})


1.1.2 Serieså¯¹è±¡æ“ä½œ


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20


import pandas as pd
data = pd.Series([1,2,3,4,5], index=[&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;,&#39;e&#39;])
##(1) æå–Seriesçš„ä¸€ç»´æ•°ç»„ä¸ç´¢å¼•æ ‡ç­¾
data.values
# array([1, 2, 3, 4, 5])
data.index
# Index([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;], dtype=&#39;object&#39;)

##(2) æŒ‰æ˜¾ç¤ºç´¢å¼•å–Serieså­é›†
data[&#39;a&#39;] 
data[&#39;a&#39;:&#39;c&#39;]
data[[&#34;a&#34;,&#34;c&#34;,&#34;e&#34;]]
data[data&gt;3]
data.loc[&#34;a&#34;:&#34;c&#34;]

##(3) æŒ‰éšå¼ç´¢å¼•å–Serieså­é›†
data[0]
data[0:3]
data[[0,2,4]]
data.iloc[1:3]



.locä¸.ilocçš„ä½œç”¨ä¸»è¦ä½“ç°åœ¨ï¼šSeriesçš„indexä¹Ÿæ˜¯æ•°å€¼å‹æ—¶ï¼Œå®¹æ˜“ä¸éšå¼ç´¢å¼•æ··æ·†ã€‚">
<meta name="author" content="Lishensuo">
<link rel="canonical" href="https://lishensuo.github.io/en/posts/program/022python%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6-pandas%E8%A1%A8%E6%A0%BC/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.9e4de5e3ba61ea358168341aa7cdf70abfaafb7c697dfe8624af3ddff9a35c2f.css" integrity="sha256-nk3l47ph6jWBaDQap833Cr&#43;q&#43;3xpff6GJK893/mjXC8=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.555af97124d54bb1457985dd081b8f5616a48103aafeb30ac89fde835d65aa6c.js" integrity="sha256-VVr5cSTVS7FFeYXdCBuPVhakgQOq/rMKyJ/eg11lqmw="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://lishensuo.github.io/img/Q.gif">
<link rel="icon" type="image/png" sizes="16x16" href="https://lishensuo.github.io/img/Q.gif">
<link rel="icon" type="image/png" sizes="32x32" href="https://lishensuo.github.io/img/Q.gif">
<link rel="apple-touch-icon" href="https://lishensuo.github.io/Q.gif">
<link rel="mask-icon" href="https://lishensuo.github.io/Q.gif">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://lishensuo.github.io/en/posts/program/022python%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6-pandas%E8%A1%A8%E6%A0%BC/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Pythonæ•°æ®ç§‘å­¦-(3)Pandasè¡¨æ ¼" />
<meta property="og:description" content="
Pandasç›¸æ¯”Numpyæ•°ç»„æ”¯æŒè¡Œåˆ—æ ‡ç­¾ã€å¤šç§æ•°æ®ç±»å‹ï¼Œç±»ä¼¼Rè¯­è¨€ä¸­data.frameæ•°æ®æ¡†ã€‚

1ã€Pandasç»“æ„
1.1 Seriesï¼šæœ‰ç´¢å¼•çš„ä¸€ç»´æ•°ç»„
1.1.1 åˆ›å»ºSerieså¯¹è±¡

é€šè¿‡pd.Seriseå‡½æ•°åˆ›å»º



 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15


##(1) é€šè¿‡indexå‚æ•°è®¾ç½®ç´¢å¼•
import pandas as pd
data = pd.Series([1,2,3,4,5], index=[&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;,&#39;e&#39;])
#a    1
#b    2
#c    3
#d    4
#e    5
#dtype: int64

##(2)å¦‚ä¸è®¾ç½®indexå‚æ•°ï¼Œåˆ™ç´¢å¼•é»˜è®¤ä¸º range(len)
data1 = pd.Series([1,2,3,4,5])

##(3)ä¹Ÿå¯ä»¥ä»¥å­—å…¸çš„å½¢å¼åˆ›å»ºï¼Œé”®å€¼åˆ†åˆ«å¯¹åº”ç´¢å¼•ä¸å€¼
data2 = pd.Series({&#39;a&#39;:1,&#39;b&#39;:2,&#39;c&#39;:3,&#39;d&#39;:4,&#39;e&#39;:5})


1.1.2 Serieså¯¹è±¡æ“ä½œ


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20


import pandas as pd
data = pd.Series([1,2,3,4,5], index=[&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;,&#39;e&#39;])
##(1) æå–Seriesçš„ä¸€ç»´æ•°ç»„ä¸ç´¢å¼•æ ‡ç­¾
data.values
# array([1, 2, 3, 4, 5])
data.index
# Index([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;], dtype=&#39;object&#39;)

##(2) æŒ‰æ˜¾ç¤ºç´¢å¼•å–Serieså­é›†
data[&#39;a&#39;] 
data[&#39;a&#39;:&#39;c&#39;]
data[[&#34;a&#34;,&#34;c&#34;,&#34;e&#34;]]
data[data&gt;3]
data.loc[&#34;a&#34;:&#34;c&#34;]

##(3) æŒ‰éšå¼ç´¢å¼•å–Serieså­é›†
data[0]
data[0:3]
data[[0,2,4]]
data.iloc[1:3]



.locä¸.ilocçš„ä½œç”¨ä¸»è¦ä½“ç°åœ¨ï¼šSeriesçš„indexä¹Ÿæ˜¯æ•°å€¼å‹æ—¶ï¼Œå®¹æ˜“ä¸éšå¼ç´¢å¼•æ··æ·†ã€‚" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lishensuo.github.io/en/posts/program/022python%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6-pandas%E8%A1%A8%E6%A0%BC/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-03T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2022-05-10T00:00:00&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Pythonæ•°æ®ç§‘å­¦-(3)Pandasè¡¨æ ¼"/>
<meta name="twitter:description" content="
Pandasç›¸æ¯”Numpyæ•°ç»„æ”¯æŒè¡Œåˆ—æ ‡ç­¾ã€å¤šç§æ•°æ®ç±»å‹ï¼Œç±»ä¼¼Rè¯­è¨€ä¸­data.frameæ•°æ®æ¡†ã€‚

1ã€Pandasç»“æ„
1.1 Seriesï¼šæœ‰ç´¢å¼•çš„ä¸€ç»´æ•°ç»„
1.1.1 åˆ›å»ºSerieså¯¹è±¡

é€šè¿‡pd.Seriseå‡½æ•°åˆ›å»º



 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15


##(1) é€šè¿‡indexå‚æ•°è®¾ç½®ç´¢å¼•
import pandas as pd
data = pd.Series([1,2,3,4,5], index=[&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;,&#39;e&#39;])
#a    1
#b    2
#c    3
#d    4
#e    5
#dtype: int64

##(2)å¦‚ä¸è®¾ç½®indexå‚æ•°ï¼Œåˆ™ç´¢å¼•é»˜è®¤ä¸º range(len)
data1 = pd.Series([1,2,3,4,5])

##(3)ä¹Ÿå¯ä»¥ä»¥å­—å…¸çš„å½¢å¼åˆ›å»ºï¼Œé”®å€¼åˆ†åˆ«å¯¹åº”ç´¢å¼•ä¸å€¼
data2 = pd.Series({&#39;a&#39;:1,&#39;b&#39;:2,&#39;c&#39;:3,&#39;d&#39;:4,&#39;e&#39;:5})


1.1.2 Serieså¯¹è±¡æ“ä½œ


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20


import pandas as pd
data = pd.Series([1,2,3,4,5], index=[&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;,&#39;e&#39;])
##(1) æå–Seriesçš„ä¸€ç»´æ•°ç»„ä¸ç´¢å¼•æ ‡ç­¾
data.values
# array([1, 2, 3, 4, 5])
data.index
# Index([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;], dtype=&#39;object&#39;)

##(2) æŒ‰æ˜¾ç¤ºç´¢å¼•å–Serieså­é›†
data[&#39;a&#39;] 
data[&#39;a&#39;:&#39;c&#39;]
data[[&#34;a&#34;,&#34;c&#34;,&#34;e&#34;]]
data[data&gt;3]
data.loc[&#34;a&#34;:&#34;c&#34;]

##(3) æŒ‰éšå¼ç´¢å¼•å–Serieså­é›†
data[0]
data[0:3]
data[[0,2,4]]
data.iloc[1:3]



.locä¸.ilocçš„ä½œç”¨ä¸»è¦ä½“ç°åœ¨ï¼šSeriesçš„indexä¹Ÿæ˜¯æ•°å€¼å‹æ—¶ï¼Œå®¹æ˜“ä¸éšå¼ç´¢å¼•æ··æ·†ã€‚"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "åˆ†ç±»",
      "item": "https://lishensuo.github.io/en/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ğŸ“– R\u0026Python\u0026Shell --- ç¼–ç¨‹åŸºç¡€ã€å¯è§†åŒ–ç­‰",
      "item": "https://lishensuo.github.io/en/posts/program/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Pythonæ•°æ®ç§‘å­¦-(3)Pandasè¡¨æ ¼",
      "item": "https://lishensuo.github.io/en/posts/program/022python%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6-pandas%E8%A1%A8%E6%A0%BC/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Pythonæ•°æ®ç§‘å­¦-(3)Pandasè¡¨æ ¼",
  "name": "Pythonæ•°æ®ç§‘å­¦-(3)Pandasè¡¨æ ¼",
  "description": " Pandasç›¸æ¯”Numpyæ•°ç»„æ”¯æŒè¡Œåˆ—æ ‡ç­¾ã€å¤šç§æ•°æ®ç±»å‹ï¼Œç±»ä¼¼Rè¯­è¨€ä¸­data.frameæ•°æ®æ¡†ã€‚\n1ã€Pandasç»“æ„ 1.1 Seriesï¼šæœ‰ç´¢å¼•çš„ä¸€ç»´æ•°ç»„ 1.1.1 åˆ›å»ºSerieså¯¹è±¡ é€šè¿‡pd.Seriseå‡½æ•°åˆ›å»º 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 ##(1) é€šè¿‡indexå‚æ•°è®¾ç½®ç´¢å¼• import pandas as pd data = pd.Series([1,2,3,4,5], index=[\u0026#39;a\u0026#39;,\u0026#39;b\u0026#39;,\u0026#39;c\u0026#39;,\u0026#39;d\u0026#39;,\u0026#39;e\u0026#39;]) #a 1 #b 2 #c 3 #d 4 #e 5 #dtype: int64 ##(2)å¦‚ä¸è®¾ç½®indexå‚æ•°ï¼Œåˆ™ç´¢å¼•é»˜è®¤ä¸º range(len) data1 = pd.Series([1,2,3,4,5]) ##(3)ä¹Ÿå¯ä»¥ä»¥å­—å…¸çš„å½¢å¼åˆ›å»ºï¼Œé”®å€¼åˆ†åˆ«å¯¹åº”ç´¢å¼•ä¸å€¼ data2 = pd.Series({\u0026#39;a\u0026#39;:1,\u0026#39;b\u0026#39;:2,\u0026#39;c\u0026#39;:3,\u0026#39;d\u0026#39;:4,\u0026#39;e\u0026#39;:5}) 1.1.2 Serieså¯¹è±¡æ“ä½œ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 import pandas as pd data = pd.Series([1,2,3,4,5], index=[\u0026#39;a\u0026#39;,\u0026#39;b\u0026#39;,\u0026#39;c\u0026#39;,\u0026#39;d\u0026#39;,\u0026#39;e\u0026#39;]) ##(1) æå–Seriesçš„ä¸€ç»´æ•°ç»„ä¸ç´¢å¼•æ ‡ç­¾ data.values # array([1, 2, 3, 4, 5]) data.index # Index([\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;, \u0026#39;d\u0026#39;, \u0026#39;e\u0026#39;], dtype=\u0026#39;object\u0026#39;) ##(2) æŒ‰æ˜¾ç¤ºç´¢å¼•å–Serieså­é›† data[\u0026#39;a\u0026#39;] data[\u0026#39;a\u0026#39;:\u0026#39;c\u0026#39;] data[[\u0026#34;a\u0026#34;,\u0026#34;c\u0026#34;,\u0026#34;e\u0026#34;]] data[data\u0026gt;3] data.loc[\u0026#34;a\u0026#34;:\u0026#34;c\u0026#34;] ##(3) æŒ‰éšå¼ç´¢å¼•å–Serieså­é›† data[0] data[0:3] data[[0,2,4]] data.iloc[1:3] .locä¸.ilocçš„ä½œç”¨ä¸»è¦ä½“ç°åœ¨ï¼šSeriesçš„indexä¹Ÿæ˜¯æ•°å€¼å‹æ—¶ï¼Œå®¹æ˜“ä¸éšå¼ç´¢å¼•æ··æ·†ã€‚\n",
  "keywords": [
    "Python"
  ],
  "articleBody": " Pandasç›¸æ¯”Numpyæ•°ç»„æ”¯æŒè¡Œåˆ—æ ‡ç­¾ã€å¤šç§æ•°æ®ç±»å‹ï¼Œç±»ä¼¼Rè¯­è¨€ä¸­data.frameæ•°æ®æ¡†ã€‚\n1ã€Pandasç»“æ„ 1.1 Seriesï¼šæœ‰ç´¢å¼•çš„ä¸€ç»´æ•°ç»„ 1.1.1 åˆ›å»ºSerieså¯¹è±¡ é€šè¿‡pd.Seriseå‡½æ•°åˆ›å»º 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 ##(1) é€šè¿‡indexå‚æ•°è®¾ç½®ç´¢å¼• import pandas as pd data = pd.Series([1,2,3,4,5], index=['a','b','c','d','e']) #a 1 #b 2 #c 3 #d 4 #e 5 #dtype: int64 ##(2)å¦‚ä¸è®¾ç½®indexå‚æ•°ï¼Œåˆ™ç´¢å¼•é»˜è®¤ä¸º range(len) data1 = pd.Series([1,2,3,4,5]) ##(3)ä¹Ÿå¯ä»¥ä»¥å­—å…¸çš„å½¢å¼åˆ›å»ºï¼Œé”®å€¼åˆ†åˆ«å¯¹åº”ç´¢å¼•ä¸å€¼ data2 = pd.Series({'a':1,'b':2,'c':3,'d':4,'e':5}) 1.1.2 Serieså¯¹è±¡æ“ä½œ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 import pandas as pd data = pd.Series([1,2,3,4,5], index=['a','b','c','d','e']) ##(1) æå–Seriesçš„ä¸€ç»´æ•°ç»„ä¸ç´¢å¼•æ ‡ç­¾ data.values # array([1, 2, 3, 4, 5]) data.index # Index(['a', 'b', 'c', 'd', 'e'], dtype='object') ##(2) æŒ‰æ˜¾ç¤ºç´¢å¼•å–Serieså­é›† data['a'] data['a':'c'] data[[\"a\",\"c\",\"e\"]] data[data\u003e3] data.loc[\"a\":\"c\"] ##(3) æŒ‰éšå¼ç´¢å¼•å–Serieså­é›† data[0] data[0:3] data[[0,2,4]] data.iloc[1:3] .locä¸.ilocçš„ä½œç”¨ä¸»è¦ä½“ç°åœ¨ï¼šSeriesçš„indexä¹Ÿæ˜¯æ•°å€¼å‹æ—¶ï¼Œå®¹æ˜“ä¸éšå¼ç´¢å¼•æ··æ·†ã€‚\n1.2 DataFrameï¼šå¤šä¸ªSerieså¯¹è±¡ç»„æˆ DataFrameå¯¹è±¡å¯ä»¥è®¤ä¸ºæ˜¯å¤šä¸ªç­‰é•¿ã€ç´¢å¼•å€¼å¯¹åº”ç›¸åŒçš„Serieså¯¹è±¡ç»„æˆ\n1.2.1 åˆ›å»ºDataFrameå¯¹è±¡ é€šè¿‡pd.DataFrameåˆ›å»º 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 ##(1) å•ä¸ªSeriesè½¬ä¸ºDataFrame,é€šè¿‡columnså‚æ•°è®¾ç½®åˆ—å import pandas as pd s1 = pd.Series({'a':1,'b':2,'c':3,'d':4,'e':5}) d1 = pd.DataFrame(s1, columns=[\"col_01\"]) # col_01 #a 1 #b 2 #c 3 #d 4 #e 5 ##(2) å¤šä¸ªç›¸åŒç´¢å¼•çš„Serieså¯¹è±¡æ„æˆçš„å­—å…¸ s2 = pd.Series({'a':\"Dog\",'b':\"Cat\",'c':\"Pig\",'d':\"Cow\",'e':\"Sheep\"}) pd.DataFrame({\"col_1\":s1, \"col_2\":s2}) ##(3) é€šè¿‡å­—å…¸åˆ—è¡¨åˆ›å»ºï¼šæ¯ä¸ªå­å­—å…¸ä»£è¡¨ä¸€è¡Œï¼›é”®åè¡¨ç¤ºåˆ—åï¼Œå¯é€šè¿‡indexè®¾ç½®è¡Œå pd.DataFrame([{'a':1,'b':2,'c':3}, {'a':2,'b':4,'c':6}], index=[\"XiaoLi\",\"XiaoWang\"]) # a b c #XiaoLi 1 2 3 #XiaoWang 2 4 6 ##(4) å°†NumPyäºŒç»´æ•°ç»„è½¬ä¸ºDataFrame import numpy as np pd.DataFrame(np.random.randint(0,10,(2,3)), columns=['a','b','c'], index=['sp1','sp2']) 1.2.2 DataFrameå¯¹è±¡æ“ä½œ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 import pandas as pd import numpy as np s1 = pd.Series(np.random.choice(10,5,replace=False), index=[\"stuA\",'stuB','stuC','stuD','stuE']) s2 = pd.Series(np.random.randint(60,100,5), index=[\"stuA\",'stuB','stuC','stuD','stuE']) s3 = pd.Series(['class01','class01','class02','class02','class02'], index=[\"stuA\",'stuB','stuC','stuD','stuE']) df = pd.DataFrame({'Grade':s1,\"Score\":s2,\"Class\":s3}) # Grade Score Class #stuA 3 95 class01 #stuB 9 96 class01 #stuC 1 85 class02 #stuD 5 76 class02 #stuE 8 70 class02 ##(0) åˆæ­¥æ¢ç´¢ df.head() df.info() #è¡¨æ ¼æ¦‚è¿°ä¿¡æ¯ df.dtypes #æ¯åˆ—çš„æ•°æ®ç±»å‹ df.shape df.size df.values #è¿”å›äºŒç»´æ•°ç»„ df.T #è¡Œåˆ—è½¬æ¢ ##(1)è·å–è¡Œã€åˆ—åï¼ˆå‡ä¸ºIndexå¯¹è±¡ï¼‰ä»¥åŠå€¼ df.index #è¡Œå df.columns #åˆ—å ##(2)è¿”å›åˆ— df['Grade'] df.Grade df[['Grade','Score']] df.loc[:,'Grade':'Class'] df.iloc[:,0:3] df['newCol'] = 0 ##(3)è¿”å›è¡Œ df.loc['stuA':'stuC',:] df.loc[df[\"Score\"]\u003e80,:] df.loc[['stuA','stuC'],:] df.iloc[1:3,:] df[1:3] df.iloc[[0,2,4],:] df[df.Grade\u003e5] #ç­›é€‰ç¬¦åˆæ¡ä»¶çš„è¡Œ ##æ³¨æ„ï¼šå¦‚æœä»…å–DataFrameçš„ä¸€è¡Œ/ä¸€åˆ—ï¼Œä¼šè¿”å›ä¸ºSerireså¯¹è±¡ï¼›å¯åŠ ä¸Šä¸­æ‹¬å·ï¼Œè¿”å›ä¸ºDataFrame df[['Grade']] df.loc[['stuC'],:] 1.3 Indexç´¢å¼•=åˆ—å+è¡Œå 1.3.1 Indexç´¢å¼•å¯¹è±¡ å¦‚ä¸ŠSeriesæœ‰ç´¢å¼•ï¼ŒDataFrameæœ‰è¡Œã€åˆ—çš„ç´¢å¼•ã€‚å¯ä»¥ä¸ºæ•°å€¼å‹(int)æˆ–è€…å­—ç¬¦å‹(object)\nä¸€æ–¹é¢Indexå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ç»´æ•°ç»„ï¼ˆä¸å¯æ”¹å˜å…¶å†…å®¹å’Œé¡ºåºï¼‰ï¼›å¦ä¸€æ–¹é¢æ‹¥æœ‰é›†åˆå¯¹è±¡çš„ç›¸å…³æ“ä½œã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 import pandas as pd idx = pd.Index([1,2,3,4,5]) # Int64Index([1, 2, 3, 4, 5], dtype='int64') ##(1) æ•°ç»„ç›¸å…³æ“ä½œ idx[0] #æ”¯æŒä¸€ç»´æ•°ç»„çš„å„ç§å–å€¼æ–¹å¼ list(idx) #è½¬ä¸ºæ™®é€šåˆ—è¡¨ ##(2) é›†åˆç›¸å…³æ“ä½œ idx2 = pd.Index([4,5,6,7]) idx.intersection(idx2) # Int64Index([4, 5], dtype='int64') idx.union(idx2) 1.3.2 Indexç´¢å¼•ä¿®æ”¹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 import pandas as pd import numpy as np s1 = pd.Series(np.random.choice(10,3,replace=False), index=[\"stuA\",'stuB','stuC']) s2 = pd.Series(np.random.randint(60,100,3), index=[\"stuA\",'stuB','stuC']) s3 = pd.Series(['class01','class01','class02'], index=[\"stuA\",'stuB','stuC']) s4 = pd.Series(['Zhang','Li','Liu'], index=[\"stuA\",'stuB','stuC']) df = pd.DataFrame({'Grade':s1,\"Score\":s2,\"Class\":s3,\"Name\":s4}) # Grade Score Class Name #stuA 0 60 class01 Zhang #stuB 8 65 class01 Li #stuC 2 80 class02 Liu ##(1)ä¿®æ”¹åˆ—å df.rename(columns = {\"Grade\":\"Level\"}) # {\"Old_name\":\"New_name\"} ##(2)å°†ç‰¹å®šåˆ—å˜æˆè¡Œå df.set_index(\"Name\") ##(3)å°†è¡Œåå˜ä¸ºåˆ— df[\"ID\"] = df.index 2ã€ç¼ºå¤±å€¼å¤„ç† Noneæ˜¯ä¸€ä¸ªpythonå¯¹è±¡ï¼Œè¡¨ç¤ºç¼ºå¤±å€¼ã€‚åœ¨æ•°ç»„ä¸­å±äºobjectç±»å‹(å­—ç¬¦ä¸²å±äºobjectç±»å‹) NaNæ˜¯æœ‰numpyå®šä¹‰çš„ç¼ºå¤±å€¼ï¼Œå±äºæµ®ç‚¹å‹æ•°æ® 2.1 numpyä¸­çš„ç¼ºå¤±å€¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 import numpy as np import pandas as pd ##(1) Noneç¼ºå¤±å€¼ n1 = np.array([1,2,3,None]) # array([1, 2, 3, None], dtype=object) n1.min() # TypeError n1.astype(np.float64) #array([ 1., 2., 3., nan]) ##(2) NaNç¼ºå¤±å€¼ n2 = np.array([1,2,3,np.nan]) # array([ 1., 2., 3., nan]) # dtype('float64') #å«nançš„ä¸€èˆ¬ç»Ÿè®¡è¿ç®—éƒ½ä¼šè¿”å›nanå€¼ n2.min() # nan #å¯ä½¿ç”¨é’ˆå¯¹å¤„ç†å«æœ‰nançš„numpyæ•°æ® np.nanmin(n1) # 1.0 2.2 Pandaså¤„ç†ç¼ºå¤±å€¼ pandaså°†Noneä¹Ÿè§†ä¸ºnp.nanï¼Œå³æµ®ç‚¹ç±»å‹çš„ç¼ºå¤±å€¼ã€‚è®°å½•ä¸ºNaN 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 pd.Series([1,np.nan,3, None]) #0 1.0 #1 NaN #2 3.0 #3 NaN #dtype: float64 #å½“pandasæ•´å‹æ•°æ®ä¸­å‡ºç°ä¸€ä¸ªç¼ºå¤±å€¼æ—¶ï¼Œä¼šè‡ªåŠ¨è½¬ä¸ºæµ®ç‚¹å‹æ•°æ® s1 = pd.Series(np.random.choice(10,5,replace=False), index=[\"stuA\",'stuB','stuC','stuD','stuE']) s2 = pd.Series(np.random.randint(60,100,5), index=[\"stuA\",'stuB','stuC','stuD','stuE']) s3 = pd.Series(['class01','class01','class02','class02','class02'], index=[\"stuA\",'stuB','stuC','stuD','stuE']) df = pd.DataFrame({'Grade':s1,\"Score\":s2,\"Class\":s3}) df.iloc[2,0:2]=None df.iloc[4,1]=np.nan # Grade Score Class # stuA 1.0 91.0 class01 # stuB 3.0 61.0 class01 # stuC NaN NaN class02 # stuD 0.0 94.0 class02 # stuE 7.0 NaN class02 ##(1)åˆ¤æ–­ç¼ºå¤±å€¼ df.isnull() #æ˜¯å¦ä¸ºç¼ºå¤±å€¼ df.notnull() #æ˜¯å¦ä¸ºéç¼ºå¤±å€¼ ##(2)å»é™¤ç¼ºå¤±å€¼ df.dropna() #åˆ é™¤å«æœ‰ç¼ºå¤±å€¼çš„æ•´è¡Œæ•°æ® # axis=1 :åˆ é™¤å«æœ‰ç¼ºå¤±å€¼çš„æ•´åˆ—æ•°æ® # how :é»˜è®¤ä¸º'any';'all'è¡¨ç¤ºå…¨ä¸ºç¼ºå¤±å€¼æ‰åˆ é™¤ ##(3)å¡«è¡¥ç¼ºå¤±å€¼ df.fillna(10) #å›ºå®šå€¼å¡«å…… df.fillna(method='ffill') #ä½¿ç”¨ç¼ºå¤±å€¼å‰é¢çš„æ•°æ®å¡«å…… df.fillna(method='bfill') #ä½¿ç”¨ç¼ºå¤±å€¼åé¢çš„æ•°æ®å¡«å…… 3ã€Pandasè¿ç®—ä¸ç»Ÿè®¡ 3.1 Pandasè¿ç®— 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 import pandas as pd import numpy as np ##(1)æ•´ä½“ç®—æ•°è¿ç®—ï¼šé€‚ç”¨äºä»‹ç»çš„npç®—æ³•è¿ç®—, ä¸å½±å“åŸæœ‰ç»“æ„ s1 = pd.Series({'a':1,'b':2,'c':3,'d':4,'e':5}) #a 1 #b 2 #c 3 #d 4 #e 5 #dtype: int64 df1 = pd.DataFrame(np.random.randint(0,10,(2,3)), columns=['a','b','c'], index=['sp1','sp2']) # a b c #sp1 5 9 4 #sp2 6 3 4 np.log(s1 + 1) df1 / 10 ##(2)Seriesä¹‹é—´ç´¢å¼•å¯¹é½è¿ç®—ï¼šå³ä½¿é¡ºåºä¸åŒï¼ŒæŒ‰ç…§ç´¢å¼•ä¸€ä¸€å¯¹åº”è®¡ç®— s2 = pd.Series({'a':1,'d':4,'e':5,'b':2,'c':3}) s1 + s2 #å¦‚æœç´¢å¼•ä¸ä¸€è‡´ï¼ŒæŒ‰å…¨é›†å¤„ç†ï¼Œç”¨NaNå¡«å…… s3 = pd.Series({'a':1,'d':4,'e':5}) s1 + s3 ##(3)DataFrameä¸Series(è¡Œ/åˆ—)ä¹‹é—´è¿ç®— #æŒ‰è¡Œ ss1 = pd.Series({'a':1,'b':2,'c':3}) df1 - ss1 #æ‰€æœ‰è¡Œç›¸å‡ df1.loc[[\"sp1\"],:]=df1.loc[[\"sp1\"],:]-ss1 #ç‰¹å®šè¡Œç›¸å‡ #æŒ‰åˆ— ss2 = pd.Series({'sp1':10,'sp2':20}) df1.subtract(ss2, axis=0) #æ‰€æœ‰åˆ—ç›¸å‡ df1.loc[:,\"a\"] = df1.loc[:,\"a\"] - ss2 #ç‰¹å®šåˆ—ç›¸å‡ å¦‚ä¸Šï¼ŒSeriesä¹‹é—´æˆ–è€…DataFrameä¸SeriesæŒ‰è¡ŒæŒ‰åˆ—ä¹‹é—´è®¡ç®—æ—¶ï¼Œä¼šè€ƒè™‘ç´¢å¼•å¯¹é½çš„é—®é¢˜ï¼›å¦‚æœç´¢å¼•ä¸ä¸€è‡´ï¼Œä¼šå–å…¨é›†ï¼Œç”¨NaNå¡«è¡¥ã€‚å¦‚æœSeries/DataFrameæ˜¯ä¸æ•°ç»„/åˆ—è¡¨è¿ç®—ï¼Œåˆ™å¿…é¡»ä¿æŒè¿ç®—åŒæ–¹ç»´åº¦ä¸€è‡´ï¼Œå¹¶ä¸”æŒ‰é¡ºåºè®¡ç®—ã€‚\n3.2 Pandasç»Ÿè®¡ 1 2 3 4 5 6 7 8 9 10 11 12 13 import pandas as pd import numpy as np df = pd.DataFrame(np.random.randint(0,100,(10,6)), index= [\"stu%s\" % (x) for x in range(10)], columns=[\"col1\",\"col2\",\"col3\",\"col4\",\"col5\",\"col6\"]) df[\"Group\"] = [\"Group%s\" % (x) for x in list(\"A\"*5 + \"B\"*5)] df.head() # col1 col2 col3 col4 col5 col6 Group # stu0 0 30 31 72 20 2 GroupA # stu1 11 47 47 53 92 80 GroupA # stu2 47 39 11 25 78 57 GroupA # stu3 15 90 57 28 90 54 GroupA # stu4 30 9 92 85 40 7 GroupA Pandaså†…ç½®å¸¸ç”¨æ•°å€¼åˆ—ç»Ÿè®¡æ–¹æ³•æœ‰ count() è®¡(è¡Œ)æ•°ï¼ˆä½†æ˜¯ä¼šå¿½ç•¥NAå€¼ï¼Œéœ€è¦æ ¼å¤–æ³¨æ„ï¼‰\nfirst(), last() ç¬¬ä¸€é¡¹ä¸æœ€åä¸€é¡¹\nsum() æ±‚å’Œ\nmean(), median(), min(), max()\nstd(), var(), mad()\ndescribe() å¯ä»¥è®¡ç®—æ¯ä¸€åˆ—çš„è‹¥å¹²å¸¸ç”¨ç»Ÿè®¡å€¼\n3.2.1 åŸºç¡€ç»Ÿè®¡ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 ##(1)æ•°å€¼åˆ—ç»Ÿè®¡æ–¹æ³•é»˜è®¤åªä¼šå¯¹æ•°å€¼åˆ—ç»Ÿè®¡ df.col1.sum() # 349 df.mean() # col1 34.9 # col2 39.8 # col3 54.2 # col4 34.9 # col5 64.4 # col6 43.5 # dtype: float64 df.describe() # col1 col2 col3 col4 col5 col6 # count 10.000000 10.000000 10.000000 10.000000 10.000000 10.0000 # mean 34.900000 39.800000 54.200000 34.900000 64.400000 43.5000 # std 23.811528 24.548365 31.688764 27.404176 31.885908 26.7426 # min 0.000000 9.000000 2.000000 1.000000 11.000000 2.0000 # 25% 17.250000 23.250000 35.000000 19.000000 42.250000 28.2500 # 50% 31.000000 36.000000 56.500000 28.500000 78.000000 50.0000 # 75% 50.750000 47.000000 78.500000 48.250000 89.250000 56.2500 # max 70.000000 90.000000 92.000000 85.000000 99.000000 80.0000 ##(2)ç»Ÿè®¡åˆ†ç±» df.Group.value_counts() #é¢‘æ•° df.Group.value_counts(normalize=True) #ç™¾åˆ†æ¯” df.Group.unique() #å”¯ä¸€å€¼ df.describe(include=[\"O\"]) #åˆ†åˆ«ç»Ÿè®¡æ‰€æœ‰å­—ç¬¦ä¸²åˆ— pd.crosstab(df.Group, df.Group) #ç±»ä¼¼Rè¯­è¨€çš„table() 3.2.2 åˆ†ç»„ç»Ÿè®¡ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 ##(1) æŒ‡å®šDataFrameè¡¨æ ¼ä¸­çš„è¡¨ç¤ºåˆ†ç»„ä¿¡æ¯çš„åˆ—ï¼Œè¿›è¡Œåˆ†ç»„ç»Ÿè®¡ df.groupby('Group')[\"col2\"].mean() #æ ¹æ®åˆ†ç»„åˆ—ï¼Œåˆ†ç»„ç»Ÿè®¡1åˆ—çš„å€¼ # Group # GroupA 43.0 # GroupB 36.6 # Name: col2, dtype: float64 df.groupby('Group', as_index=False).mean() #æ ¹æ®åˆ†ç»„åˆ—ï¼Œåˆ†ç»„ç»Ÿè®¡æ‰€æœ‰åˆ—çš„å€¼ df.groupby('Group')[\"col2\"].agg([\"min\",\"max\"]) #æ ¹æ®åˆ†ç»„åˆ—ï¼Œåˆ†ç»„ç»Ÿè®¡1åˆ—çš„å¤šä¸ªæŒ‡æ ‡ df.groupby('Group')[\"col2\"].describe() #æ ¹æ®åˆ†ç»„åˆ—ï¼Œåˆ†ç»„ç»Ÿè®¡1åˆ—çš„å¤šä¸ªæŒ‡æ ‡ ##(2) æŒ‡å®šå…¶å®ƒèƒ½å¤Ÿè¡¨ç¤ºåˆ†ç»„ä¿¡æ¯çš„ï¼Œåˆ—è¡¨ã€Serisesã€å­—å…¸ç­‰è¿›è¡Œåˆ†ç»„ç»Ÿè®¡ Class = [\"Class01\",\"Class01\",\"Class01\",\"Class02\",\"Class02\",\"Class02\", \"Class03\",\"Class03\",\"Class03\",\"Class03\"] df.groupby(Class)[\"col2\"].mean() # Class01 38.666667 # Class02 55.333333 # Class03 29.000000 # Name: col2, dtype: float64 3.3 Pandasæ’åº 1 2 3 4 5 6 7 8 9 10 11 import pandas as pd import numpy as np df = pd.DataFrame(np.random.randint(0,100,(10,6)), index= [\"stu%s\" % (x) for x in range(10)], columns=[\"col1\",\"col2\",\"col3\",\"col4\",\"col5\",\"col6\"]) df[\"Group\"] = [\"Group%s\" % (x) for x in list(\"A\"*5 + \"B\"*5)] df.sort_values(\"col1\") #æŒ‰ç…§æŒ‡å®šåˆ—å‡åºæ’åˆ— df.sort_values(\"col1\", ascending=False) #æŒ‰ç…§æŒ‡å®šåˆ—é™åºæ’åˆ— df.sort_values([\"col1\", \"col2\"], ascending=[True, False]) 4ã€å­—ç¬¦ä¸²åˆ—å¤„ç† Pandasä¸ºDataFrameå¯¹è±¡çš„å­—ç¬¦ä¸²åˆ—(ä¹ŸåŒ…æ‹¬Serieså¯¹è±¡)æä¾›äº†strå±æ€§ï¼Œæä¾›äº†è®¸å¤šå‘é‡åŒ–å¤„ç†å­—ç¬¦ä¸²çš„æ–¹æ³•ï¼Œå…¶ä¸­å¾ˆå¤šä¸Pythonçš„å­—ç¬¦ä¸²æ–¹æ³•ç›¸ä¼¼ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 import pandas as pd import numpy as np s1 = pd.Series(list(\"ABBAC\"), index=[\"stuA\",'stuB','stuC','stuD','stuE']) s2 = pd.Series(np.random.randint(60,100,5), index=[\"stuA\",'stuB','stuC','stuD','stuE']) s3 = pd.Series(['class01','class01','class02','class02','class02'], index=[\"stuA\",'stuB','stuC','stuD','stuE']) df = pd.DataFrame({'Grade':s1,\"Score\":s2,\"Class\":s3}) # Grade Score Class # stuA A 84 class01 # stuB B 68 class01 # stuC B 84 class02 # stuD A 78 class02 # stuE C 74 class02 ##(1) Pythonå¤„ç†å­—ç¬¦ä¸²æ–¹æ³• \"level \" + df.Grade df.Grade.str.len() df.Class.str.upper() df.Class.str.split(\"0\") # stuA [class, 1] # stuB [class, 1] # stuC [class, 2] # stuD [class, 2] # stuE [class, 2] # Name: Class, dtype: object ##(2) æ­£åˆ™åŒ–å¤„ç†å­—ç¬¦ä¸²ï¼Œç±»ä¼¼ re æ¨¡å— df.Class.str.match('([A-Za-z]+)') #è¿”å›é€»è¾‘å€¼ df.Class.str.extract('([A-Za-z]+)') #æå–åŒ¹é…å­å­—ç¬¦ä¸² ##(3) åˆ‡ç‰‡å–å€¼ç­‰ df.Class.str[0:3] df.Class.str.split(\"0\").str.get(0) df.Class.str.split(\"0\").str[0] 5ã€DataFrameç­›é€‰ä¸ä¿®æ”¹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 import pandas as pd import numpy as np df = pd.DataFrame(np.random.randint(0,100,(10,6)), index= [\"stu%s\" % (x) for x in range(10)], columns=[\"col1\",\"col2\",\"col3\",\"col4\",\"col5\",\"col6\"]) df[\"Group\"] = [\"Group%s\" % (x) for x in list(\"A\"*3 + \"B\"*3 + \"C\"*4)] df.head() # col1 col2 col3 col4 col5 col6 Group # stu0 13 24 72 45 58 77 GroupA # stu1 93 29 67 38 95 7 GroupA # stu2 32 85 54 34 51 84 GroupA # stu3 16 92 36 10 51 67 GroupB # stu4 78 69 96 32 1 87 GroupB #### ä¸‹è¿°é»˜è®¤æ˜¯æŒ‡ç­›é€‰åˆ°ç¬¦åˆæ¡ä»¶çš„è¡Œ ##(1) æ•°å€¼åˆ—ç­›é€‰ df[df.col1\u003e80] ##(2) å­—ç¬¦ä¸²åˆ—ç­›é€‰ ##å¯ç»“åˆæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ç­›é€‰ df[df.Group==\"GroupA\"] ##(3) å¤šä¸ªæ¡ä»¶ç­›é€‰ df[(df.col1\u003e50) \u0026 (df.Group==\"GroupA\")] ##(4) ç­›é€‰ç‰¹å®šèŒƒå›´çš„å€¼ df[df.Group.isin([\"GroupA\",\"GroupB\"])] df[~df.Group.isin([\"GroupA\",\"GroupB\"])] # ~ è¡¨ç¤ºé€»è¾‘ é ##(5) queryè¯­å¥ df.query('col1\u003e50 and Group==\"GroupC\"') ##(6) å»é‡ df.drop_duplicates([\"Group\"]) ##ç›´æ¥åˆ é™¤æŒ‡å®šåˆ— df.drop([column], axis=1) ##ç›´æ¥åˆ é™¤æŒ‡å®šè¡Œ df.drop([index]) 1 2 3 4 5 6 7 8 9 10 11 12 13 ##(1) replaceæ›¿æ¢ df.Group.unique() # array(['GroupA', 'GroupB', 'GroupC'], dtype=object) ##ä¸€å¯¹ä¸€æ›¿æ¢ df[\"Group\"].replace(\"GroupA\",\"GroupC\").unique() # array(['GroupC', 'GroupB'], dtype=object) ##å¤šå¯¹ä¸€æ›¿æ¢ df[\"Group\"].replace([\"GroupA\",\"GroupB\"],\"GroupC\").unique() # array(['GroupC'], dtype=object) ##(2) mapæ›¿æ¢ df[\"Group\"].map({\"GroupA\":\"class01\", \"GroupB\":\"class02\", \"GroupC\":\"class03\"}).unique() # array(['class01', 'class02', 'class03'], dtype=object) 6ã€DataFrameåˆå¹¶ 6.1 pd.concat å¯¹äºSerieså¯¹è±¡çš„åˆå¹¶æ¯”è¾ƒç®€å•ï¼Œå®¹æ˜“ï¼›\npd.concatåˆå¹¶ä¸¤ä¸ªDataFrameæ—¶ï¼Œé€‚åˆäºè¿™ä¸¤ä¸ªDataFrameçš„è¡Œåæˆ–åˆ—åç´¢å¼•å®Œå…¨ç›¸åŒï¼Œå¤§éƒ¨åˆ†ç›¸åŒçš„æƒ…å†µã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 import numpy as np import pandas as pd df1 = pd.DataFrame(np.random.randint(0, 20, (3,4)), columns=['col1','col2','col3','col4'], index=['sp1','sp2','sp3']) # col1 col2 col3 col4 # sp1 11 10 19 13 # sp2 6 13 18 10 # sp3 5 14 6 10 df2 = pd.DataFrame(np.random.randint(0, 20, (2,4)), columns=['col1','col2','col3','col4'], index=['sp4','sp5']) # col1 col2 col3 col4 # sp4 11 2 0 2 # sp5 11 19 12 4 df3 = pd.DataFrame(np.random.randint(0, 20, (2,4)), columns=['col1','col2','col3','col4'], index=['sp3','sp4']) # col1 col2 col3 col4 # sp3 13 5 3 15 # sp4 7 2 2 13 df4 = pd.DataFrame(np.random.randint(0, 20, (2,4)), columns=['col3','col4','col5','col6'], index=['sp4','sp5']) # col3 col4 col5 col6 # sp4 11 1 2 15 # sp5 18 2 5 18 df5 = pd.DataFrame(np.random.randint(0, 6, (3,2)), columns=['col5','col6'], index=['sp1','sp2','sp3']) # col5 col6 # sp1 0 5 # sp2 5 3 # sp3 2 0 ##(1)æ™®é€šåˆå¹¶--åˆ—åç›¸åŒï¼Œè¡Œåä¸åŒï¼Œä¸Šä¸‹åˆå¹¶ pd.concat([df1, df2]) ##(2)æ™®é€šåˆå¹¶--è¡Œåç›¸åŒï¼Œåˆ—åä¸åŒï¼Œå·¦å³åˆå¹¶ pd.concat([df1, df5], axis=1) ##(3)ä¸Šä¸‹åˆå¹¶æ—¶ï¼Œå¿½ç•¥ç´¢å¼•é‡å¤ pd.concat([df1, df3]) #å…è®¸å­˜åœ¨é‡å¤è¡Œå pd.concat([df1, df3]).reset_index() pd.concat([df1, df3], verify_integrity=True) #æœ‰é‡å¤è¡Œåä¼šæŠ¥é”™ pd.concat([df1, df3], ignore_index=True) #é‡å‘½åæ‰€æœ‰åˆ—åå»é‡ ##(4)ä¸Šä¸‹åˆå¹¶æ—¶ï¼Œåˆ—åä¸å®Œå…¨ä¸€è‡´ pd.concat([df1, df4]) #é»˜è®¤ä¿ç•™å…¨é›†åˆ—å pd.concat([df1, df4], join='inner') #ä»…ä¿ç•™äº¤é›†ç´¢å¼• 6.2 pd.merge ç±»ä¼¼Rè¯­è¨€ä¸­dplyråŒ…çš„joinç³»åˆ—å‡½æ•°ï¼›\nä¸»è¦ç”¨äºä¸¤ä¸ªDataFrameæœ‰ç›¸åŒåˆ—çš„æƒ…å†µã€‚\n6.2.1 æœ‰ç›¸åŒåˆ—ï¼Œåˆ—åç›¸åŒ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 df1 = pd.DataFrame([{'Stu':\"XiaoLi\",'Grade':2,'Class':'C01'}, {'Stu':\"XiaoSun\",'Grade':1,'Class':'C01'}, {'Stu':\"XiaoAi\",'Grade':3,'Class':'C02'}]) # Stu Grade Class # 0 XiaoLi 2 C01 # 1 XiaoSun 1 C01 # 2 XiaoAi 3 C02 df2 = pd.DataFrame([{'Class':\"C01\",'Teacher':\"Mr.Zhou\"}, {'Class':\"C02\",'Teacher':\"Mr.Wu\"}]) # Class Teacher # 0 C01 Mr.Zhou # 1 C02 Mr.Wu ##å¦‚ä¸Šä¼šè‡ªåŠ¨æŒ‰ç…§Classåˆ—åˆå¹¶ä¸¤ä¸ªDataFrmae pd.merge(df1, df2) #ç­‰ä»·äº pd.merge(df1, df2, on=\"Class\") å½“ä¸¤ä¸ªDataFrameä¸­ä¸åŒå«ä¹‰çš„åˆ—ç¢°å·§å…·æœ‰ç›¸åŒçš„åˆ—åæ—¶ï¼Œå¯è¿›è¡Œé‡å‘½ååŠ ä»¥åŒºåˆ† 1 2 3 4 5 6 7 df1 = pd.DataFrame([{'Stu':\"XiaoLi\",'Grade':2,'Class':'C01'}, {'Stu':\"XiaoSun\",'Grade':1,'Class':'C01'}, {'Stu':\"XiaoAi\",'Grade':3,'Class':'C02'}]) df2 = pd.DataFrame([{'Class':\"C01\",'Teacher':\"Mr.Zhou\",'Grade':'A'}, {'Class':\"C02\",'Teacher':\"Mr.Wu\",'Grade':'B'}]) pd.merge(df1, df2, on=\"Class\") pd.merge(df1, df2, on=\"Class\", suffixes=[\"_stu\",\"_class\"]) 6.2.2 æœ‰ç›¸åŒåˆ—ï¼Œåˆ—åä¸åŒ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 ##(1) æŒ‡å®šåˆ—ååˆå¹¶ df1 = pd.DataFrame([{'Stu':\"XiaoLi\",'Grade':2,'Class':'C01'}, {'Stu':\"XiaoSun\",'Grade':1,'Class':'C01'}, {'Stu':\"XiaoAi\",'Grade':3,'Class':'C02'}]) df2 = pd.DataFrame([{'Room':\"C01\",'Teacher':\"Mr.Zhou\"}, {'Room':\"C02\",'Teacher':\"Mr.Wu\"}]) #å¦‚ä¸Šdf1çš„Classåˆ—ä¸df2çš„Roomåˆ—è¡¨ç¤ºç›¸åŒçš„å«ä¹‰ pd.merge(df1, df2, left_on=\"Class\", right_on=\"Room\") pd.merge(df1, df2, left_on=\"Class\", right_on=\"Room\").drop(\"Room\", axis=1) ##(2)æŒ‡å®šç´¢å¼•åˆå¹¶ df2.set_index(\"Room\", inplace=True) # Teacher # Room # C01 Mr.Zhou # C02 Mr.Wu pd.merge(df1, df2, left_on=\"Class\", right_index=True) 6.2.3 åˆ—çš„å†…å®¹ä¸å®Œå…¨ç›¸åŒ å½“ä¸¤ä¸ªDataFrameçš„ç›¸åŒåˆ—çš„å†…å®¹ä¸å®Œå…¨æ—¶ï¼Œå¯è®¾ç½®pd.merge()çš„howå‚æ•°è¿›è¡Œä¸åŒçš„åˆå¹¶ï¼Œå¯é€‰inner(default), left, right, outer\nç±»ä¼¼RåŒ…dplyrçš„inner_join(), left_join(), right_join(), full_join()å‡½æ•°\n1 2 3 4 5 6 7 8 9 10 11 12 13 ##ä»¥å…¶ä¸­çš„how=\"left\"ä¸ºä¾‹ df1 = pd.DataFrame([{'Stu':\"XiaoLi\",'Grade':2,'Class':'C01'}, {'Stu':\"XiaoSun\",'Grade':1,'Class':'C01'}, {'Stu':\"XiaoAi\",'Grade':3,'Class':'C02'}, {'Stu':\"XiaoHe\",'Grade':3,'Class':'C03'},]) df2 = pd.DataFrame([{'Class':\"C01\",'Teacher':\"Mr.Zhou\"}, {'Class':\"C02\",'Teacher':\"Mr.Wu\"}]) pd.merge(df1, df2, how=\"left\") # Stu Grade Class Teacher # 0 XiaoLi 2 C01 Mr.Zhou # 1 XiaoSun 1 C01 Mr.Zhou # 2 XiaoAi 3 C02 Mr.Wu # 3 XiaoHe 3 C03 NaN 7ã€DataFrameå¯¼å…¥ä¸å¯¼å‡º 1 2 3 4 5 6 7 8 9 10 import numpy as np import pandas as pd df = pd.DataFrame(np.random.randint(0, 20, (3,4)), columns=['col1','col2','col3','col4'], index=['sp1','sp2','sp3']) # col1 col2 col3 col4 # sp1 11 10 19 13 # sp2 6 13 18 10 # sp3 5 14 6 10 7.1 å¯¼å‡º 1 2 3 4 5 6 7 8 9 df.to_csv('test.csv') df.to_csv('test.txt', sep=\"\\t\") #æŒ‡å®šåˆ†éš”ç¬¦ df.to_csv('test.csv', index=False) #ä¸ä¿å­˜è¡Œå df.to_csv('test.csv', header=False) #ä¸ä¿å­˜åˆ—å df.to_excel('test.xlsx') #éœ€è¦æå‰å®‰è£…openpyxlæ¨¡å— df.to_excel('test.xlsx',sheet_name='Sheet1') #è‡ªå®šä¹‰ä¿å­˜çš„sheetåç§° df. 7.2 å¯¼å…¥ 1 2 3 4 5 6 7 8 9 df0 = pd.read_csv('./test.txt') #é»˜è®¤ç¬¬ä¸€è¡Œä¸ºåˆ—åï¼Œä¸”æ²¡æœ‰è¡Œå df0 = pd.read_csv('./test.txt', sep=\"\\t\") #æŒ‡å®šåˆ†éš”ç¬¦ df0 = pd.read_csv('./test.csv', header=None) #ä¸è®¾ç½®åˆ—å df0 = pd.read_csv('./test.csv', names=list(\"ABCD\")) #è‡ªå®šä¹‰åˆ—å df0 = pd.read_csv('./test.csv', index_col=0) #æŒ‡å®šç¬¬ä¸€åˆ—(ç´¢å¼•ä¸º0)ä½œä¸ºè¡Œå df0 = pd.read_csv('./test.csv', index_col=\"col1\") #æŒ‡å®šåˆ—ä½œä¸ºè¡Œå df0 = pd.read_excel('test.xlsx') 8ã€é•¿å®½è½¬æ¢ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 data = { 'Name': ['Alice', 'Bob'], 'Math': [85, 90], 'English': [92, 88] } df_wide = pd.DataFrame(data) # Name Math English # 0 Alice 85 92 # 1 Bob 90 88 ## (1) å®½å˜é•¿ df_long = df_wide.melt(id_vars=['Name'], var_name='Subject', value_name='Score') # Name Subject Score # 0 Alice Math 85 # 1 Bob Math 90 # 2 Alice English 92 # 3 Bob English 88 ## (2) é•¿å˜å®½ df_wide = df_long.pivot(index='Name', columns='Subject', values='Score') # Subject English Math # Name # Alice 92 85 # Bob 88 90 ",
  "wordCount" : "4749",
  "inLanguage": "en",
  "datePublished": "2022-05-03T00:00:00Z",
  "dateModified": "2022-05-10T00:00:00Z",
  "author":[{
    "@type": "Person",
    "name": "Lishensuo"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://lishensuo.github.io/en/posts/program/022python%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6-pandas%E8%A1%A8%E6%A0%BC/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Li's Bioinfo-Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://lishensuo.github.io/img/Q.gif"
    }
  }
}
</script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://lishensuo.github.io/en/" accesskey="h" title="Li&#39;s Bioinfo-Blog (Alt + H)">Li&#39;s Bioinfo-Blog</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                </ul>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://lishensuo.github.io/en/" title="ä¸»é¡µ">
                    <span>ä¸»é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/posts" title="åˆ†ç±»">
                    <span>åˆ†ç±»</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/tags" title="æ ‡ç­¾">
                    <span>æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/archives/" title="å½’æ¡£">
                    <span>å½’æ¡£</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/about" title="å…³äº">
                    <span>å…³äº</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/search" title="æœç´¢ (Alt &#43; /)" accesskey=/>
                    <span>æœç´¢</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://lishensuo.github.io/en/">Home</a>&nbsp;Â»&nbsp;<a href="https://lishensuo.github.io/en/posts/">åˆ†ç±»</a>&nbsp;Â»&nbsp;<a href="https://lishensuo.github.io/en/posts/program/">ğŸ“– R&amp;Python&amp;Shell --- ç¼–ç¨‹åŸºç¡€ã€å¯è§†åŒ–ç­‰</a></div>
    <h1 class="post-title">
      Pythonæ•°æ®ç§‘å­¦-(3)Pandasè¡¨æ ¼
    </h1>
    <div class="post-meta">













Create:&amp;nbsp;&lt;span title=&#39;2022-05-03 00:00:00 &#43;0000 UTC&#39;&gt;2022-05-03&lt;/span&gt;&amp;nbsp;|&amp;nbsp;Update:&amp;nbsp;2022-05-10&amp;nbsp;|&amp;nbsp;Words:&amp;nbsp;4749&amp;nbsp;|&amp;nbsp;10 min&amp;nbsp;|&amp;nbsp;Lishensuo

|  Viewers: <span id="busuanzi_value_page_pv"></span> 
	  
    </div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">Table of Contents</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#1pandas%e7%bb%93%e6%9e%84" aria-label="1ã€Pandasç»“æ„">1ã€Pandasç»“æ„</a><ul>
                            
                    <li>
                        <a href="#11-series%e6%9c%89%e7%b4%a2%e5%bc%95%e7%9a%84%e4%b8%80%e7%bb%b4%e6%95%b0%e7%bb%84" aria-label="1.1 Seriesï¼šæœ‰ç´¢å¼•çš„ä¸€ç»´æ•°ç»„">1.1 Seriesï¼šæœ‰ç´¢å¼•çš„ä¸€ç»´æ•°ç»„</a><ul>
                            
                    <li>
                        <a href="#111-%e5%88%9b%e5%bb%baseries%e5%af%b9%e8%b1%a1" aria-label="1.1.1 åˆ›å»ºSerieså¯¹è±¡">1.1.1 åˆ›å»ºSerieså¯¹è±¡</a></li>
                    <li>
                        <a href="#112-series%e5%af%b9%e8%b1%a1%e6%93%8d%e4%bd%9c" aria-label="1.1.2 Serieså¯¹è±¡æ“ä½œ">1.1.2 Serieså¯¹è±¡æ“ä½œ</a></li></ul>
                    </li>
                    <li>
                        <a href="#12-dataframe%e5%a4%9a%e4%b8%aaseries%e5%af%b9%e8%b1%a1%e7%bb%84%e6%88%90" aria-label="1.2 DataFrameï¼šå¤šä¸ªSerieså¯¹è±¡ç»„æˆ">1.2 DataFrameï¼šå¤šä¸ªSerieså¯¹è±¡ç»„æˆ</a><ul>
                            
                    <li>
                        <a href="#121-%e5%88%9b%e5%bb%badataframe%e5%af%b9%e8%b1%a1" aria-label="1.2.1 åˆ›å»ºDataFrameå¯¹è±¡">1.2.1 åˆ›å»ºDataFrameå¯¹è±¡</a></li>
                    <li>
                        <a href="#122-dataframe%e5%af%b9%e8%b1%a1%e6%93%8d%e4%bd%9c" aria-label="1.2.2 DataFrameå¯¹è±¡æ“ä½œ">1.2.2 DataFrameå¯¹è±¡æ“ä½œ</a></li></ul>
                    </li>
                    <li>
                        <a href="#13-index%e7%b4%a2%e5%bc%95%e5%88%97%e5%90%8d%e8%a1%8c%e5%90%8d" aria-label="1.3 Indexç´¢å¼•=åˆ—å&#43;è¡Œå">1.3 Indexç´¢å¼•=åˆ—å+è¡Œå</a><ul>
                            
                    <li>
                        <a href="#131-index%e7%b4%a2%e5%bc%95%e5%af%b9%e8%b1%a1" aria-label="1.3.1 Indexç´¢å¼•å¯¹è±¡">1.3.1 Indexç´¢å¼•å¯¹è±¡</a></li>
                    <li>
                        <a href="#132-index%e7%b4%a2%e5%bc%95%e4%bf%ae%e6%94%b9" aria-label="1.3.2 Indexç´¢å¼•ä¿®æ”¹">1.3.2 Indexç´¢å¼•ä¿®æ”¹</a></li></ul>
                    </li></ul>
                    </li>
                    <li>
                        <a href="#2%e7%bc%ba%e5%a4%b1%e5%80%bc%e5%a4%84%e7%90%86" aria-label="2ã€ç¼ºå¤±å€¼å¤„ç†">2ã€ç¼ºå¤±å€¼å¤„ç†</a><ul>
                            
                    <li>
                        <a href="#21-numpy%e4%b8%ad%e7%9a%84%e7%bc%ba%e5%a4%b1%e5%80%bc" aria-label="2.1 numpyä¸­çš„ç¼ºå¤±å€¼">2.1 numpyä¸­çš„ç¼ºå¤±å€¼</a></li>
                    <li>
                        <a href="#22-pandas%e5%a4%84%e7%90%86%e7%bc%ba%e5%a4%b1%e5%80%bc" aria-label="2.2 Pandaså¤„ç†ç¼ºå¤±å€¼">2.2 Pandaså¤„ç†ç¼ºå¤±å€¼</a></li></ul>
                    </li>
                    <li>
                        <a href="#3pandas%e8%bf%90%e7%ae%97%e4%b8%8e%e7%bb%9f%e8%ae%a1" aria-label="3ã€Pandasè¿ç®—ä¸ç»Ÿè®¡">3ã€Pandasè¿ç®—ä¸ç»Ÿè®¡</a><ul>
                            
                    <li>
                        <a href="#31-pandas%e8%bf%90%e7%ae%97" aria-label="3.1 Pandasè¿ç®—">3.1 Pandasè¿ç®—</a></li>
                    <li>
                        <a href="#32-pandas%e7%bb%9f%e8%ae%a1" aria-label="3.2 Pandasç»Ÿè®¡">3.2 Pandasç»Ÿè®¡</a><ul>
                            
                    <li>
                        <a href="#321-%e5%9f%ba%e7%a1%80%e7%bb%9f%e8%ae%a1" aria-label="3.2.1 åŸºç¡€ç»Ÿè®¡">3.2.1 åŸºç¡€ç»Ÿè®¡</a></li>
                    <li>
                        <a href="#322-%e5%88%86%e7%bb%84%e7%bb%9f%e8%ae%a1" aria-label="3.2.2 åˆ†ç»„ç»Ÿè®¡">3.2.2 åˆ†ç»„ç»Ÿè®¡</a></li></ul>
                    </li>
                    <li>
                        <a href="#33-pandas%e6%8e%92%e5%ba%8f" aria-label="3.3 Pandasæ’åº">3.3 Pandasæ’åº</a></li></ul>
                    </li>
                    <li>
                        <a href="#4%e5%ad%97%e7%ac%a6%e4%b8%b2%e5%88%97%e5%a4%84%e7%90%86" aria-label="4ã€å­—ç¬¦ä¸²åˆ—å¤„ç†">4ã€å­—ç¬¦ä¸²åˆ—å¤„ç†</a></li>
                    <li>
                        <a href="#5dataframe%e7%ad%9b%e9%80%89%e4%b8%8e%e4%bf%ae%e6%94%b9" aria-label="5ã€DataFrameç­›é€‰ä¸ä¿®æ”¹">5ã€DataFrameç­›é€‰ä¸ä¿®æ”¹</a></li>
                    <li>
                        <a href="#6dataframe%e5%90%88%e5%b9%b6" aria-label="6ã€DataFrameåˆå¹¶">6ã€DataFrameåˆå¹¶</a><ul>
                            
                    <li>
                        <a href="#61-pdconcat" aria-label="6.1 pd.concat">6.1 pd.concat</a></li>
                    <li>
                        <a href="#62-pdmerge" aria-label="6.2 pd.merge">6.2 pd.merge</a><ul>
                            
                    <li>
                        <a href="#621-%e6%9c%89%e7%9b%b8%e5%90%8c%e5%88%97%e5%88%97%e5%90%8d%e7%9b%b8%e5%90%8c" aria-label="6.2.1 æœ‰ç›¸åŒåˆ—ï¼Œåˆ—åç›¸åŒ">6.2.1 æœ‰ç›¸åŒåˆ—ï¼Œåˆ—åç›¸åŒ</a></li>
                    <li>
                        <a href="#622-%e6%9c%89%e7%9b%b8%e5%90%8c%e5%88%97%e5%88%97%e5%90%8d%e4%b8%8d%e5%90%8c" aria-label="6.2.2 æœ‰ç›¸åŒåˆ—ï¼Œåˆ—åä¸åŒ">6.2.2 æœ‰ç›¸åŒåˆ—ï¼Œåˆ—åä¸åŒ</a></li>
                    <li>
                        <a href="#623-%e5%88%97%e7%9a%84%e5%86%85%e5%ae%b9%e4%b8%8d%e5%ae%8c%e5%85%a8%e7%9b%b8%e5%90%8c" aria-label="6.2.3 åˆ—çš„å†…å®¹ä¸å®Œå…¨ç›¸åŒ">6.2.3 åˆ—çš„å†…å®¹ä¸å®Œå…¨ç›¸åŒ</a></li></ul>
                    </li></ul>
                    </li>
                    <li>
                        <a href="#7dataframe%e5%af%bc%e5%85%a5%e4%b8%8e%e5%af%bc%e5%87%ba" aria-label="7ã€DataFrameå¯¼å…¥ä¸å¯¼å‡º">7ã€DataFrameå¯¼å…¥ä¸å¯¼å‡º</a><ul>
                            
                    <li>
                        <a href="#71-%e5%af%bc%e5%87%ba" aria-label="7.1 å¯¼å‡º">7.1 å¯¼å‡º</a></li>
                    <li>
                        <a href="#72-%e5%af%bc%e5%85%a5" aria-label="7.2 å¯¼å…¥">7.2 å¯¼å…¥</a></li></ul>
                    </li>
                    <li>
                        <a href="#8%e9%95%bf%e5%ae%bd%e8%bd%ac%e6%8d%a2" aria-label="8ã€é•¿å®½è½¬æ¢">8ã€é•¿å®½è½¬æ¢</a>
                    </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>


  <div class="post-content"><blockquote>
<p>Pandasç›¸æ¯”Numpyæ•°ç»„æ”¯æŒè¡Œåˆ—æ ‡ç­¾ã€å¤šç§æ•°æ®ç±»å‹ï¼Œç±»ä¼¼Rè¯­è¨€ä¸­data.frameæ•°æ®æ¡†ã€‚</p>
<img src="https://raw.githubusercontent.com/lishensuo/images/main/20354525-b4c441acfb525f6e.png" alt="img" style="zoom: 33%;" /></blockquote>
<h1 id="1pandasç»“æ„">1ã€Pandasç»“æ„<a hidden class="anchor" aria-hidden="true" href="#1pandasç»“æ„">#</a></h1>
<h2 id="11-seriesæœ‰ç´¢å¼•çš„ä¸€ç»´æ•°ç»„">1.1 Seriesï¼šæœ‰ç´¢å¼•çš„ä¸€ç»´æ•°ç»„<a hidden class="anchor" aria-hidden="true" href="#11-seriesæœ‰ç´¢å¼•çš„ä¸€ç»´æ•°ç»„">#</a></h2>
<h3 id="111-åˆ›å»ºserieså¯¹è±¡">1.1.1 åˆ›å»ºSerieså¯¹è±¡<a hidden class="anchor" aria-hidden="true" href="#111-åˆ›å»ºserieså¯¹è±¡">#</a></h3>
<ul>
<li>é€šè¿‡<code>pd.Serise</code>å‡½æ•°åˆ›å»º</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#007f7f">##(1) é€šè¿‡indexå‚æ•°è®¾ç½®ç´¢å¼•</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> pandas <span style="color:#fff;font-weight:bold">as</span> pd
</span></span><span style="display:flex;"><span>data = pd.Series([<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#ff0;font-weight:bold">5</span>], index=[<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;b&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;c&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;d&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;e&#39;</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#a    1</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#b    2</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#c    3</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#d    4</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#e    5</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#dtype: int64</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2)å¦‚ä¸è®¾ç½®indexå‚æ•°ï¼Œåˆ™ç´¢å¼•é»˜è®¤ä¸º range(len)</span>
</span></span><span style="display:flex;"><span>data1 = pd.Series([<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#ff0;font-weight:bold">5</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(3)ä¹Ÿå¯ä»¥ä»¥å­—å…¸çš„å½¢å¼åˆ›å»ºï¼Œé”®å€¼åˆ†åˆ«å¯¹åº”ç´¢å¼•ä¸å€¼</span>
</span></span><span style="display:flex;"><span>data2 = pd.Series({<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>:<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#0ff;font-weight:bold">&#39;b&#39;</span>:<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#0ff;font-weight:bold">&#39;c&#39;</span>:<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#0ff;font-weight:bold">&#39;d&#39;</span>:<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#0ff;font-weight:bold">&#39;e&#39;</span>:<span style="color:#ff0;font-weight:bold">5</span>})
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="112-serieså¯¹è±¡æ“ä½œ">1.1.2 Serieså¯¹è±¡æ“ä½œ<a hidden class="anchor" aria-hidden="true" href="#112-serieså¯¹è±¡æ“ä½œ">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> pandas <span style="color:#fff;font-weight:bold">as</span> pd
</span></span><span style="display:flex;"><span>data = pd.Series([<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#ff0;font-weight:bold">5</span>], index=[<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;b&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;c&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;d&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;e&#39;</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(1) æå–Seriesçš„ä¸€ç»´æ•°ç»„ä¸ç´¢å¼•æ ‡ç­¾</span>
</span></span><span style="display:flex;"><span>data.values
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># array([1, 2, 3, 4, 5])</span>
</span></span><span style="display:flex;"><span>data.index
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Index([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;], dtype=&#39;object&#39;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2) æŒ‰æ˜¾ç¤ºç´¢å¼•å–Serieså­é›†</span>
</span></span><span style="display:flex;"><span>data[<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>] 
</span></span><span style="display:flex;"><span>data[<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;c&#39;</span>]
</span></span><span style="display:flex;"><span>data[[<span style="color:#0ff;font-weight:bold">&#34;a&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;c&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;e&#34;</span>]]
</span></span><span style="display:flex;"><span>data[data&gt;<span style="color:#ff0;font-weight:bold">3</span>]
</span></span><span style="display:flex;"><span>data.loc[<span style="color:#0ff;font-weight:bold">&#34;a&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;c&#34;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(3) æŒ‰éšå¼ç´¢å¼•å–Serieså­é›†</span>
</span></span><span style="display:flex;"><span>data[<span style="color:#ff0;font-weight:bold">0</span>]
</span></span><span style="display:flex;"><span>data[<span style="color:#ff0;font-weight:bold">0</span>:<span style="color:#ff0;font-weight:bold">3</span>]
</span></span><span style="display:flex;"><span>data[[<span style="color:#ff0;font-weight:bold">0</span>,<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">4</span>]]
</span></span><span style="display:flex;"><span>data.iloc[<span style="color:#ff0;font-weight:bold">1</span>:<span style="color:#ff0;font-weight:bold">3</span>]
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><code>.loc</code>ä¸<code>.iloc</code>çš„ä½œç”¨ä¸»è¦ä½“ç°åœ¨ï¼šSeriesçš„indexä¹Ÿæ˜¯æ•°å€¼å‹æ—¶ï¼Œå®¹æ˜“ä¸éšå¼ç´¢å¼•æ··æ·†ã€‚</p></blockquote>
<h2 id="12-dataframeå¤šä¸ªserieså¯¹è±¡ç»„æˆ">1.2 DataFrameï¼šå¤šä¸ªSerieså¯¹è±¡ç»„æˆ<a hidden class="anchor" aria-hidden="true" href="#12-dataframeå¤šä¸ªserieså¯¹è±¡ç»„æˆ">#</a></h2>
<p>DataFrameå¯¹è±¡å¯ä»¥è®¤ä¸ºæ˜¯å¤šä¸ªç­‰é•¿ã€ç´¢å¼•å€¼å¯¹åº”ç›¸åŒçš„Serieså¯¹è±¡ç»„æˆ</p>
<h3 id="121-åˆ›å»ºdataframeå¯¹è±¡">1.2.1 åˆ›å»ºDataFrameå¯¹è±¡<a hidden class="anchor" aria-hidden="true" href="#121-åˆ›å»ºdataframeå¯¹è±¡">#</a></h3>
<ul>
<li>é€šè¿‡<code>pd.DataFrame</code>åˆ›å»º</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#007f7f">##(1) å•ä¸ªSeriesè½¬ä¸ºDataFrame,é€šè¿‡columnså‚æ•°è®¾ç½®åˆ—å</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> pandas <span style="color:#fff;font-weight:bold">as</span> pd
</span></span><span style="display:flex;"><span>s1 = pd.Series({<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>:<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#0ff;font-weight:bold">&#39;b&#39;</span>:<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#0ff;font-weight:bold">&#39;c&#39;</span>:<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#0ff;font-weight:bold">&#39;d&#39;</span>:<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#0ff;font-weight:bold">&#39;e&#39;</span>:<span style="color:#ff0;font-weight:bold">5</span>})
</span></span><span style="display:flex;"><span>d1 = pd.DataFrame(s1, columns=[<span style="color:#0ff;font-weight:bold">&#34;col_01&#34;</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   col_01</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#a       1</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#b       2</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#c       3</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#d       4</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#e       5</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2) å¤šä¸ªç›¸åŒç´¢å¼•çš„Serieså¯¹è±¡æ„æˆçš„å­—å…¸</span>
</span></span><span style="display:flex;"><span>s2 = pd.Series({<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;Dog&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;b&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;Cat&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;c&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;Pig&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;d&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;Cow&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;e&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;Sheep&#34;</span>})
</span></span><span style="display:flex;"><span>pd.DataFrame({<span style="color:#0ff;font-weight:bold">&#34;col_1&#34;</span>:s1, <span style="color:#0ff;font-weight:bold">&#34;col_2&#34;</span>:s2})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(3) é€šè¿‡å­—å…¸åˆ—è¡¨åˆ›å»ºï¼šæ¯ä¸ªå­å­—å…¸ä»£è¡¨ä¸€è¡Œï¼›é”®åè¡¨ç¤ºåˆ—åï¼Œå¯é€šè¿‡indexè®¾ç½®è¡Œå</span>
</span></span><span style="display:flex;"><span>pd.DataFrame([{<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>:<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#0ff;font-weight:bold">&#39;b&#39;</span>:<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#0ff;font-weight:bold">&#39;c&#39;</span>:<span style="color:#ff0;font-weight:bold">3</span>},
</span></span><span style="display:flex;"><span>              {<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>:<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#0ff;font-weight:bold">&#39;b&#39;</span>:<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#0ff;font-weight:bold">&#39;c&#39;</span>:<span style="color:#ff0;font-weight:bold">6</span>}], 
</span></span><span style="display:flex;"><span>             index=[<span style="color:#0ff;font-weight:bold">&#34;XiaoLi&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;XiaoWang&#34;</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#          a  b  c</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#XiaoLi    1  2  3</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#XiaoWang  2  4  6</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(4) å°†NumPyäºŒç»´æ•°ç»„è½¬ä¸ºDataFrame</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> numpy <span style="color:#fff;font-weight:bold">as</span> np
</span></span><span style="display:flex;"><span>pd.DataFrame(np.random.randint(<span style="color:#ff0;font-weight:bold">0</span>,<span style="color:#ff0;font-weight:bold">10</span>,(<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">3</span>)),
</span></span><span style="display:flex;"><span>             columns=[<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;b&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;c&#39;</span>],
</span></span><span style="display:flex;"><span>             index=[<span style="color:#0ff;font-weight:bold">&#39;sp1&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;sp2&#39;</span>])
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="122-dataframeå¯¹è±¡æ“ä½œ">1.2.2 DataFrameå¯¹è±¡æ“ä½œ<a hidden class="anchor" aria-hidden="true" href="#122-dataframeå¯¹è±¡æ“ä½œ">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> pandas <span style="color:#fff;font-weight:bold">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> numpy <span style="color:#fff;font-weight:bold">as</span> np
</span></span><span style="display:flex;"><span>s1 = pd.Series(np.random.choice(<span style="color:#ff0;font-weight:bold">10</span>,<span style="color:#ff0;font-weight:bold">5</span>,replace=<span style="color:#fff;font-weight:bold">False</span>), 
</span></span><span style="display:flex;"><span>               index=[<span style="color:#0ff;font-weight:bold">&#34;stuA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuB&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuD&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuE&#39;</span>])
</span></span><span style="display:flex;"><span>s2 = pd.Series(np.random.randint(<span style="color:#ff0;font-weight:bold">60</span>,<span style="color:#ff0;font-weight:bold">100</span>,<span style="color:#ff0;font-weight:bold">5</span>), 
</span></span><span style="display:flex;"><span>               index=[<span style="color:#0ff;font-weight:bold">&#34;stuA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuB&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuD&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuE&#39;</span>])
</span></span><span style="display:flex;"><span>s3 = pd.Series([<span style="color:#0ff;font-weight:bold">&#39;class01&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;class01&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;class02&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;class02&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;class02&#39;</span>], 
</span></span><span style="display:flex;"><span>               index=[<span style="color:#0ff;font-weight:bold">&#34;stuA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuB&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuD&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuE&#39;</span>])
</span></span><span style="display:flex;"><span>df = pd.DataFrame({<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:s1,<span style="color:#0ff;font-weight:bold">&#34;Score&#34;</span>:s2,<span style="color:#0ff;font-weight:bold">&#34;Class&#34;</span>:s3})
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#      Grade  Score    Class</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#stuA      3     95  class01</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#stuB      9     96  class01</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#stuC      1     85  class02</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#stuD      5     76  class02</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#stuE      8     70  class02</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(0) åˆæ­¥æ¢ç´¢</span>
</span></span><span style="display:flex;"><span>df.head()
</span></span><span style="display:flex;"><span>df.info()    <span style="color:#007f7f">#è¡¨æ ¼æ¦‚è¿°ä¿¡æ¯</span>
</span></span><span style="display:flex;"><span>df.dtypes    <span style="color:#007f7f">#æ¯åˆ—çš„æ•°æ®ç±»å‹</span>
</span></span><span style="display:flex;"><span>df.shape
</span></span><span style="display:flex;"><span>df.size
</span></span><span style="display:flex;"><span>df.values    <span style="color:#007f7f">#è¿”å›äºŒç»´æ•°ç»„</span>
</span></span><span style="display:flex;"><span>df.T         <span style="color:#007f7f">#è¡Œåˆ—è½¬æ¢</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(1)è·å–è¡Œã€åˆ—åï¼ˆå‡ä¸ºIndexå¯¹è±¡ï¼‰ä»¥åŠå€¼</span>
</span></span><span style="display:flex;"><span>df.index   <span style="color:#007f7f">#è¡Œå</span>
</span></span><span style="display:flex;"><span>df.columns <span style="color:#007f7f">#åˆ—å</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2)è¿”å›åˆ—</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>]
</span></span><span style="display:flex;"><span>df.Grade
</span></span><span style="display:flex;"><span>df[[<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;Score&#39;</span>]]
</span></span><span style="display:flex;"><span>df.loc[:,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>]
</span></span><span style="display:flex;"><span>df.iloc[:,<span style="color:#ff0;font-weight:bold">0</span>:<span style="color:#ff0;font-weight:bold">3</span>]
</span></span><span style="display:flex;"><span>df[<span style="color:#0ff;font-weight:bold">&#39;newCol&#39;</span>] = <span style="color:#ff0;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(3)è¿”å›è¡Œ</span>
</span></span><span style="display:flex;"><span>df.loc[<span style="color:#0ff;font-weight:bold">&#39;stuA&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>,:]
</span></span><span style="display:flex;"><span>df.loc[df[<span style="color:#0ff;font-weight:bold">&#34;Score&#34;</span>]&gt;<span style="color:#ff0;font-weight:bold">80</span>,:]
</span></span><span style="display:flex;"><span>df.loc[[<span style="color:#0ff;font-weight:bold">&#39;stuA&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>],:]
</span></span><span style="display:flex;"><span>df.iloc[<span style="color:#ff0;font-weight:bold">1</span>:<span style="color:#ff0;font-weight:bold">3</span>,:]
</span></span><span style="display:flex;"><span>df[<span style="color:#ff0;font-weight:bold">1</span>:<span style="color:#ff0;font-weight:bold">3</span>]
</span></span><span style="display:flex;"><span>df.iloc[[<span style="color:#ff0;font-weight:bold">0</span>,<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">4</span>],:]
</span></span><span style="display:flex;"><span>df[df.Grade&gt;<span style="color:#ff0;font-weight:bold">5</span>]  <span style="color:#007f7f">#ç­›é€‰ç¬¦åˆæ¡ä»¶çš„è¡Œ</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##æ³¨æ„ï¼šå¦‚æœä»…å–DataFrameçš„ä¸€è¡Œ/ä¸€åˆ—ï¼Œä¼šè¿”å›ä¸ºSerireså¯¹è±¡ï¼›å¯åŠ ä¸Šä¸­æ‹¬å·ï¼Œè¿”å›ä¸ºDataFrame</span>
</span></span><span style="display:flex;"><span>df[[<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>]]
</span></span><span style="display:flex;"><span>df.loc[[<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>],:]
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="13-indexç´¢å¼•åˆ—åè¡Œå">1.3 Indexç´¢å¼•=åˆ—å+è¡Œå<a hidden class="anchor" aria-hidden="true" href="#13-indexç´¢å¼•åˆ—åè¡Œå">#</a></h2>
<h3 id="131-indexç´¢å¼•å¯¹è±¡">1.3.1 Indexç´¢å¼•å¯¹è±¡<a hidden class="anchor" aria-hidden="true" href="#131-indexç´¢å¼•å¯¹è±¡">#</a></h3>
<p>å¦‚ä¸ŠSeriesæœ‰ç´¢å¼•ï¼ŒDataFrameæœ‰è¡Œã€åˆ—çš„ç´¢å¼•ã€‚å¯ä»¥ä¸ºæ•°å€¼å‹(int)æˆ–è€…å­—ç¬¦å‹(object)</p>
<p>ä¸€æ–¹é¢Indexå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ç»´æ•°ç»„ï¼ˆä¸å¯æ”¹å˜å…¶å†…å®¹å’Œé¡ºåºï¼‰ï¼›å¦ä¸€æ–¹é¢æ‹¥æœ‰é›†åˆå¯¹è±¡çš„ç›¸å…³æ“ä½œã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> pandas <span style="color:#fff;font-weight:bold">as</span> pd
</span></span><span style="display:flex;"><span>idx = pd.Index([<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#ff0;font-weight:bold">5</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Int64Index([1, 2, 3, 4, 5], dtype=&#39;int64&#39;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(1) æ•°ç»„ç›¸å…³æ“ä½œ</span>
</span></span><span style="display:flex;"><span>idx[<span style="color:#ff0;font-weight:bold">0</span>]    <span style="color:#007f7f">#æ”¯æŒä¸€ç»´æ•°ç»„çš„å„ç§å–å€¼æ–¹å¼</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">list</span>(idx) <span style="color:#007f7f">#è½¬ä¸ºæ™®é€šåˆ—è¡¨</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2) é›†åˆç›¸å…³æ“ä½œ</span>
</span></span><span style="display:flex;"><span>idx2 = pd.Index([<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#ff0;font-weight:bold">5</span>,<span style="color:#ff0;font-weight:bold">6</span>,<span style="color:#ff0;font-weight:bold">7</span>])
</span></span><span style="display:flex;"><span>idx.intersection(idx2)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Int64Index([4, 5], dtype=&#39;int64&#39;)</span>
</span></span><span style="display:flex;"><span>idx.union(idx2)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="132-indexç´¢å¼•ä¿®æ”¹">1.3.2 Indexç´¢å¼•ä¿®æ”¹<a hidden class="anchor" aria-hidden="true" href="#132-indexç´¢å¼•ä¿®æ”¹">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> pandas <span style="color:#fff;font-weight:bold">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> numpy <span style="color:#fff;font-weight:bold">as</span> np
</span></span><span style="display:flex;"><span>s1 = pd.Series(np.random.choice(<span style="color:#ff0;font-weight:bold">10</span>,<span style="color:#ff0;font-weight:bold">3</span>,replace=<span style="color:#fff;font-weight:bold">False</span>), 
</span></span><span style="display:flex;"><span>               index=[<span style="color:#0ff;font-weight:bold">&#34;stuA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuB&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>])
</span></span><span style="display:flex;"><span>s2 = pd.Series(np.random.randint(<span style="color:#ff0;font-weight:bold">60</span>,<span style="color:#ff0;font-weight:bold">100</span>,<span style="color:#ff0;font-weight:bold">3</span>), 
</span></span><span style="display:flex;"><span>               index=[<span style="color:#0ff;font-weight:bold">&#34;stuA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuB&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>])
</span></span><span style="display:flex;"><span>s3 = pd.Series([<span style="color:#0ff;font-weight:bold">&#39;class01&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;class01&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;class02&#39;</span>], 
</span></span><span style="display:flex;"><span>               index=[<span style="color:#0ff;font-weight:bold">&#34;stuA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuB&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>])
</span></span><span style="display:flex;"><span>s4 = pd.Series([<span style="color:#0ff;font-weight:bold">&#39;Zhang&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;Li&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;Liu&#39;</span>], 
</span></span><span style="display:flex;"><span>               index=[<span style="color:#0ff;font-weight:bold">&#34;stuA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuB&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>])
</span></span><span style="display:flex;"><span>df = pd.DataFrame({<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:s1,<span style="color:#0ff;font-weight:bold">&#34;Score&#34;</span>:s2,<span style="color:#0ff;font-weight:bold">&#34;Class&#34;</span>:s3,<span style="color:#0ff;font-weight:bold">&#34;Name&#34;</span>:s4})
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#      Grade  Score    Class   Name</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#stuA      0     60  class01  Zhang</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#stuB      8     65  class01     Li</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#stuC      2     80  class02    Liu</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(1)ä¿®æ”¹åˆ—å</span>
</span></span><span style="display:flex;"><span>df.rename(columns = {<span style="color:#0ff;font-weight:bold">&#34;Grade&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;Level&#34;</span>})  <span style="color:#007f7f"># {&#34;Old_name&#34;:&#34;New_name&#34;}</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2)å°†ç‰¹å®šåˆ—å˜æˆè¡Œå</span>
</span></span><span style="display:flex;"><span>df.set_index(<span style="color:#0ff;font-weight:bold">&#34;Name&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(3)å°†è¡Œåå˜ä¸ºåˆ—</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#0ff;font-weight:bold">&#34;ID&#34;</span>] = df.index
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="2ç¼ºå¤±å€¼å¤„ç†">2ã€ç¼ºå¤±å€¼å¤„ç†<a hidden class="anchor" aria-hidden="true" href="#2ç¼ºå¤±å€¼å¤„ç†">#</a></h1>
<ul>
<li><code>None</code>æ˜¯ä¸€ä¸ªpythonå¯¹è±¡ï¼Œè¡¨ç¤ºç¼ºå¤±å€¼ã€‚åœ¨æ•°ç»„ä¸­å±äºobjectç±»å‹(å­—ç¬¦ä¸²å±äºobjectç±»å‹)</li>
<li><code>NaN</code>æ˜¯æœ‰numpyå®šä¹‰çš„ç¼ºå¤±å€¼ï¼Œå±äºæµ®ç‚¹å‹æ•°æ®</li>
</ul>
<h2 id="21-numpyä¸­çš„ç¼ºå¤±å€¼">2.1 numpyä¸­çš„ç¼ºå¤±å€¼<a hidden class="anchor" aria-hidden="true" href="#21-numpyä¸­çš„ç¼ºå¤±å€¼">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> numpy <span style="color:#fff;font-weight:bold">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> pandas <span style="color:#fff;font-weight:bold">as</span> pd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(1) Noneç¼ºå¤±å€¼</span>
</span></span><span style="display:flex;"><span>n1 = np.array([<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#fff;font-weight:bold">None</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># array([1, 2, 3, None], dtype=object)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>n1.min()  <span style="color:#007f7f"># TypeError</span>
</span></span><span style="display:flex;"><span>n1.astype(np.float64)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#array([ 1.,  2.,  3., nan])</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2) NaNç¼ºå¤±å€¼</span>
</span></span><span style="display:flex;"><span>n2 = np.array([<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">3</span>,np.nan])
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># array([ 1.,  2.,  3., nan])</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># dtype(&#39;float64&#39;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#å«nançš„ä¸€èˆ¬ç»Ÿè®¡è¿ç®—éƒ½ä¼šè¿”å›nanå€¼</span>
</span></span><span style="display:flex;"><span>n2.min()      <span style="color:#007f7f"># nan</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#å¯ä½¿ç”¨é’ˆå¯¹å¤„ç†å«æœ‰nançš„numpyæ•°æ®</span>
</span></span><span style="display:flex;"><span>np.nanmin(n1) <span style="color:#007f7f"># 1.0</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="22-pandaså¤„ç†ç¼ºå¤±å€¼">2.2 Pandaså¤„ç†ç¼ºå¤±å€¼<a hidden class="anchor" aria-hidden="true" href="#22-pandaså¤„ç†ç¼ºå¤±å€¼">#</a></h2>
<ul>
<li>pandaså°†Noneä¹Ÿè§†ä¸ºnp.nanï¼Œå³æµ®ç‚¹ç±»å‹çš„ç¼ºå¤±å€¼ã€‚è®°å½•ä¸º<code>NaN</code></li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pd.Series([<span style="color:#ff0;font-weight:bold">1</span>,np.nan,<span style="color:#ff0;font-weight:bold">3</span>, <span style="color:#fff;font-weight:bold">None</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#0    1.0</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#1    NaN</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#2    3.0</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#3    NaN</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#dtype: float64</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#å½“pandasæ•´å‹æ•°æ®ä¸­å‡ºç°ä¸€ä¸ªç¼ºå¤±å€¼æ—¶ï¼Œä¼šè‡ªåŠ¨è½¬ä¸ºæµ®ç‚¹å‹æ•°æ®</span>
</span></span><span style="display:flex;"><span>s1 = pd.Series(np.random.choice(<span style="color:#ff0;font-weight:bold">10</span>,<span style="color:#ff0;font-weight:bold">5</span>,replace=<span style="color:#fff;font-weight:bold">False</span>), 
</span></span><span style="display:flex;"><span>               index=[<span style="color:#0ff;font-weight:bold">&#34;stuA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuB&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuD&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuE&#39;</span>])
</span></span><span style="display:flex;"><span>s2 = pd.Series(np.random.randint(<span style="color:#ff0;font-weight:bold">60</span>,<span style="color:#ff0;font-weight:bold">100</span>,<span style="color:#ff0;font-weight:bold">5</span>), 
</span></span><span style="display:flex;"><span>               index=[<span style="color:#0ff;font-weight:bold">&#34;stuA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuB&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuD&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuE&#39;</span>])
</span></span><span style="display:flex;"><span>s3 = pd.Series([<span style="color:#0ff;font-weight:bold">&#39;class01&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;class01&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;class02&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;class02&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;class02&#39;</span>], 
</span></span><span style="display:flex;"><span>               index=[<span style="color:#0ff;font-weight:bold">&#34;stuA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuB&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuD&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuE&#39;</span>])
</span></span><span style="display:flex;"><span>df = pd.DataFrame({<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:s1,<span style="color:#0ff;font-weight:bold">&#34;Score&#34;</span>:s2,<span style="color:#0ff;font-weight:bold">&#34;Class&#34;</span>:s3})
</span></span><span style="display:flex;"><span>df.iloc[<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">0</span>:<span style="color:#ff0;font-weight:bold">2</span>]=<span style="color:#fff;font-weight:bold">None</span>
</span></span><span style="display:flex;"><span>df.iloc[<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#ff0;font-weight:bold">1</span>]=np.nan
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#       Grade  Score    Class</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuA    1.0   91.0  class01</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuB    3.0   61.0  class01</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuC    NaN    NaN  class02</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuD    0.0   94.0  class02</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuE    7.0    NaN  class02</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(1)åˆ¤æ–­ç¼ºå¤±å€¼</span>
</span></span><span style="display:flex;"><span>df.isnull()   <span style="color:#007f7f">#æ˜¯å¦ä¸ºç¼ºå¤±å€¼</span>
</span></span><span style="display:flex;"><span>df.notnull()  <span style="color:#007f7f">#æ˜¯å¦ä¸ºéç¼ºå¤±å€¼</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2)å»é™¤ç¼ºå¤±å€¼</span>
</span></span><span style="display:flex;"><span>df.dropna()       <span style="color:#007f7f">#åˆ é™¤å«æœ‰ç¼ºå¤±å€¼çš„æ•´è¡Œæ•°æ®</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># axis=1 :åˆ é™¤å«æœ‰ç¼ºå¤±å€¼çš„æ•´åˆ—æ•°æ®</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># how    :é»˜è®¤ä¸º&#39;any&#39;;&#39;all&#39;è¡¨ç¤ºå…¨ä¸ºç¼ºå¤±å€¼æ‰åˆ é™¤</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(3)å¡«è¡¥ç¼ºå¤±å€¼</span>
</span></span><span style="display:flex;"><span>df.fillna(<span style="color:#ff0;font-weight:bold">10</span>)             <span style="color:#007f7f">#å›ºå®šå€¼å¡«å……</span>
</span></span><span style="display:flex;"><span>df.fillna(method=<span style="color:#0ff;font-weight:bold">&#39;ffill&#39;</span>) <span style="color:#007f7f">#ä½¿ç”¨ç¼ºå¤±å€¼å‰é¢çš„æ•°æ®å¡«å……</span>
</span></span><span style="display:flex;"><span>df.fillna(method=<span style="color:#0ff;font-weight:bold">&#39;bfill&#39;</span>) <span style="color:#007f7f">#ä½¿ç”¨ç¼ºå¤±å€¼åé¢çš„æ•°æ®å¡«å……</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="3pandasè¿ç®—ä¸ç»Ÿè®¡">3ã€Pandasè¿ç®—ä¸ç»Ÿè®¡<a hidden class="anchor" aria-hidden="true" href="#3pandasè¿ç®—ä¸ç»Ÿè®¡">#</a></h1>
<h2 id="31-pandasè¿ç®—">3.1 Pandasè¿ç®—<a hidden class="anchor" aria-hidden="true" href="#31-pandasè¿ç®—">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> pandas <span style="color:#fff;font-weight:bold">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> numpy <span style="color:#fff;font-weight:bold">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(1)æ•´ä½“ç®—æ•°è¿ç®—ï¼šé€‚ç”¨äºä»‹ç»çš„npç®—æ³•è¿ç®—, ä¸å½±å“åŸæœ‰ç»“æ„</span>
</span></span><span style="display:flex;"><span>s1 = pd.Series({<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>:<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#0ff;font-weight:bold">&#39;b&#39;</span>:<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#0ff;font-weight:bold">&#39;c&#39;</span>:<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#0ff;font-weight:bold">&#39;d&#39;</span>:<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#0ff;font-weight:bold">&#39;e&#39;</span>:<span style="color:#ff0;font-weight:bold">5</span>})  
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#a    1</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#b    2</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#c    3</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#d    4</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#e    5</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#dtype: int64</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df1 = pd.DataFrame(np.random.randint(<span style="color:#ff0;font-weight:bold">0</span>,<span style="color:#ff0;font-weight:bold">10</span>,(<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">3</span>)),
</span></span><span style="display:flex;"><span>                   columns=[<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;b&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;c&#39;</span>],
</span></span><span style="display:flex;"><span>                   index=[<span style="color:#0ff;font-weight:bold">&#39;sp1&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;sp2&#39;</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#     a  b  c</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#sp1  5  9  4</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#sp2  6  3  4</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>np.log(s1 + <span style="color:#ff0;font-weight:bold">1</span>)
</span></span><span style="display:flex;"><span>df1 / <span style="color:#ff0;font-weight:bold">10</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2)Seriesä¹‹é—´ç´¢å¼•å¯¹é½è¿ç®—ï¼šå³ä½¿é¡ºåºä¸åŒï¼ŒæŒ‰ç…§ç´¢å¼•ä¸€ä¸€å¯¹åº”è®¡ç®—</span>
</span></span><span style="display:flex;"><span>s2 = pd.Series({<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>:<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#0ff;font-weight:bold">&#39;d&#39;</span>:<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#0ff;font-weight:bold">&#39;e&#39;</span>:<span style="color:#ff0;font-weight:bold">5</span>,<span style="color:#0ff;font-weight:bold">&#39;b&#39;</span>:<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#0ff;font-weight:bold">&#39;c&#39;</span>:<span style="color:#ff0;font-weight:bold">3</span>})   
</span></span><span style="display:flex;"><span>s1 + s2
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#å¦‚æœç´¢å¼•ä¸ä¸€è‡´ï¼ŒæŒ‰å…¨é›†å¤„ç†ï¼Œç”¨NaNå¡«å……</span>
</span></span><span style="display:flex;"><span>s3 = pd.Series({<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>:<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#0ff;font-weight:bold">&#39;d&#39;</span>:<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#0ff;font-weight:bold">&#39;e&#39;</span>:<span style="color:#ff0;font-weight:bold">5</span>})   
</span></span><span style="display:flex;"><span>s1 + s3
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(3)DataFrameä¸Series(è¡Œ/åˆ—)ä¹‹é—´è¿ç®—</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#æŒ‰è¡Œ</span>
</span></span><span style="display:flex;"><span>ss1 = pd.Series({<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>:<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#0ff;font-weight:bold">&#39;b&#39;</span>:<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#0ff;font-weight:bold">&#39;c&#39;</span>:<span style="color:#ff0;font-weight:bold">3</span>})  
</span></span><span style="display:flex;"><span>df1 - ss1                                   <span style="color:#007f7f">#æ‰€æœ‰è¡Œç›¸å‡</span>
</span></span><span style="display:flex;"><span>df1.loc[[<span style="color:#0ff;font-weight:bold">&#34;sp1&#34;</span>],:]=df1.loc[[<span style="color:#0ff;font-weight:bold">&#34;sp1&#34;</span>],:]-ss1   <span style="color:#007f7f">#ç‰¹å®šè¡Œç›¸å‡ </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#æŒ‰åˆ—</span>
</span></span><span style="display:flex;"><span>ss2 = pd.Series({<span style="color:#0ff;font-weight:bold">&#39;sp1&#39;</span>:<span style="color:#ff0;font-weight:bold">10</span>,<span style="color:#0ff;font-weight:bold">&#39;sp2&#39;</span>:<span style="color:#ff0;font-weight:bold">20</span>})  
</span></span><span style="display:flex;"><span>df1.subtract(ss2, axis=<span style="color:#ff0;font-weight:bold">0</span>)                   <span style="color:#007f7f">#æ‰€æœ‰åˆ—ç›¸å‡</span>
</span></span><span style="display:flex;"><span>df1.loc[:,<span style="color:#0ff;font-weight:bold">&#34;a&#34;</span>] = df1.loc[:,<span style="color:#0ff;font-weight:bold">&#34;a&#34;</span>] - ss2       <span style="color:#007f7f">#ç‰¹å®šåˆ—ç›¸å‡</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>å¦‚ä¸Šï¼ŒSeriesä¹‹é—´æˆ–è€…DataFrameä¸SeriesæŒ‰è¡ŒæŒ‰åˆ—ä¹‹é—´è®¡ç®—æ—¶ï¼Œä¼šè€ƒè™‘ç´¢å¼•å¯¹é½çš„é—®é¢˜ï¼›å¦‚æœç´¢å¼•ä¸ä¸€è‡´ï¼Œä¼šå–å…¨é›†ï¼Œç”¨NaNå¡«è¡¥ã€‚å¦‚æœSeries/DataFrameæ˜¯ä¸æ•°ç»„/åˆ—è¡¨è¿ç®—ï¼Œåˆ™å¿…é¡»ä¿æŒè¿ç®—åŒæ–¹ç»´åº¦ä¸€è‡´ï¼Œå¹¶ä¸”æŒ‰é¡ºåºè®¡ç®—ã€‚</p></blockquote>
<h2 id="32-pandasç»Ÿè®¡">3.2 Pandasç»Ÿè®¡<a hidden class="anchor" aria-hidden="true" href="#32-pandasç»Ÿè®¡">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> pandas <span style="color:#fff;font-weight:bold">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> numpy <span style="color:#fff;font-weight:bold">as</span> np
</span></span><span style="display:flex;"><span>df = pd.DataFrame(np.random.randint(<span style="color:#ff0;font-weight:bold">0</span>,<span style="color:#ff0;font-weight:bold">100</span>,(<span style="color:#ff0;font-weight:bold">10</span>,<span style="color:#ff0;font-weight:bold">6</span>)),
</span></span><span style="display:flex;"><span>             index= [<span style="color:#0ff;font-weight:bold">&#34;stu</span><span style="color:#0ff;font-weight:bold">%s</span><span style="color:#0ff;font-weight:bold">&#34;</span> % (x) <span style="color:#fff;font-weight:bold">for</span> x in <span style="color:#fff;font-weight:bold">range</span>(<span style="color:#ff0;font-weight:bold">10</span>)],
</span></span><span style="display:flex;"><span>             columns=[<span style="color:#0ff;font-weight:bold">&#34;col1&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;col2&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;col3&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;col4&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;col5&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;col6&#34;</span>])
</span></span><span style="display:flex;"><span>df[<span style="color:#0ff;font-weight:bold">&#34;Group&#34;</span>] = [<span style="color:#0ff;font-weight:bold">&#34;Group</span><span style="color:#0ff;font-weight:bold">%s</span><span style="color:#0ff;font-weight:bold">&#34;</span> % (x) <span style="color:#fff;font-weight:bold">for</span> x in <span style="color:#fff;font-weight:bold">list</span>(<span style="color:#0ff;font-weight:bold">&#34;A&#34;</span>*<span style="color:#ff0;font-weight:bold">5</span> + <span style="color:#0ff;font-weight:bold">&#34;B&#34;</span>*<span style="color:#ff0;font-weight:bold">5</span>)]
</span></span><span style="display:flex;"><span>df.head()
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#       col1  col2  col3  col4  col5  col6   Group</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stu0     0    30    31    72    20     2  GroupA</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stu1    11    47    47    53    92    80  GroupA</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stu2    47    39    11    25    78    57  GroupA</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stu3    15    90    57    28    90    54  GroupA</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stu4    30     9    92    85    40     7  GroupA</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Pandaså†…ç½®å¸¸ç”¨æ•°å€¼åˆ—ç»Ÿè®¡æ–¹æ³•æœ‰</li>
</ul>
<p><code>count()</code> è®¡(è¡Œ)æ•°ï¼ˆä½†æ˜¯ä¼šå¿½ç•¥NAå€¼ï¼Œéœ€è¦æ ¼å¤–æ³¨æ„ï¼‰</p>
<p><code>first()</code>, <code>last()</code> ç¬¬ä¸€é¡¹ä¸æœ€åä¸€é¡¹</p>
<p><code>sum()</code> æ±‚å’Œ</p>
<p><code>mean()</code>, <code>median()</code>, <code>min()</code>, <code>max()</code></p>
<p><code>std()</code>, <code>var()</code>, <code>mad()</code></p>
<p><code>describe()</code> å¯ä»¥è®¡ç®—æ¯ä¸€åˆ—çš„è‹¥å¹²å¸¸ç”¨ç»Ÿè®¡å€¼</p>
<h3 id="321-åŸºç¡€ç»Ÿè®¡">3.2.1 åŸºç¡€ç»Ÿè®¡<a hidden class="anchor" aria-hidden="true" href="#321-åŸºç¡€ç»Ÿè®¡">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span><span style="color:#007f7f">##(1)æ•°å€¼åˆ—ç»Ÿè®¡æ–¹æ³•é»˜è®¤åªä¼šå¯¹æ•°å€¼åˆ—ç»Ÿè®¡</span>
</span></span><span style="display:flex;"><span>df.col1.sum()
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 349</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df.mean()
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># col1    34.9</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># col2    39.8</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># col3    54.2</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># col4    34.9</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># col5    64.4</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># col6    43.5</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># dtype: float64</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df.describe()
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#             col1       col2       col3       col4       col5     col6</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># count  10.000000  10.000000  10.000000  10.000000  10.000000  10.0000</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># mean   34.900000  39.800000  54.200000  34.900000  64.400000  43.5000</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># std    23.811528  24.548365  31.688764  27.404176  31.885908  26.7426</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># min     0.000000   9.000000   2.000000   1.000000  11.000000   2.0000</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 25%    17.250000  23.250000  35.000000  19.000000  42.250000  28.2500</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 50%    31.000000  36.000000  56.500000  28.500000  78.000000  50.0000</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 75%    50.750000  47.000000  78.500000  48.250000  89.250000  56.2500</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># max    70.000000  90.000000  92.000000  85.000000  99.000000  80.0000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2)ç»Ÿè®¡åˆ†ç±»</span>
</span></span><span style="display:flex;"><span>df.Group.value_counts()                <span style="color:#007f7f">#é¢‘æ•°</span>
</span></span><span style="display:flex;"><span>df.Group.value_counts(normalize=True)  <span style="color:#007f7f">#ç™¾åˆ†æ¯”</span>
</span></span><span style="display:flex;"><span>df.Group.unique()                      <span style="color:#007f7f">#å”¯ä¸€å€¼</span>
</span></span><span style="display:flex;"><span>df.describe(include=[<span style="color:#0ff;font-weight:bold">&#34;O&#34;</span>])             <span style="color:#007f7f">#åˆ†åˆ«ç»Ÿè®¡æ‰€æœ‰å­—ç¬¦ä¸²åˆ—</span>
</span></span><span style="display:flex;"><span>pd.crosstab(df.Group, df.Group)        <span style="color:#007f7f">#ç±»ä¼¼Rè¯­è¨€çš„table()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="322-åˆ†ç»„ç»Ÿè®¡">3.2.2 åˆ†ç»„ç»Ÿè®¡<a hidden class="anchor" aria-hidden="true" href="#322-åˆ†ç»„ç»Ÿè®¡">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#007f7f">##(1) æŒ‡å®šDataFrameè¡¨æ ¼ä¸­çš„è¡¨ç¤ºåˆ†ç»„ä¿¡æ¯çš„åˆ—ï¼Œè¿›è¡Œåˆ†ç»„ç»Ÿè®¡</span>
</span></span><span style="display:flex;"><span>df.groupby(<span style="color:#0ff;font-weight:bold">&#39;Group&#39;</span>)[<span style="color:#0ff;font-weight:bold">&#34;col2&#34;</span>].mean()                            <span style="color:#007f7f">#æ ¹æ®åˆ†ç»„åˆ—ï¼Œåˆ†ç»„ç»Ÿè®¡1åˆ—çš„å€¼</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Group</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># GroupA    43.0</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># GroupB    36.6</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Name: col2, dtype: float64</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df.groupby(<span style="color:#0ff;font-weight:bold">&#39;Group&#39;</span>, as_index=<span style="color:#fff;font-weight:bold">False</span>).mean()                    <span style="color:#007f7f">#æ ¹æ®åˆ†ç»„åˆ—ï¼Œåˆ†ç»„ç»Ÿè®¡æ‰€æœ‰åˆ—çš„å€¼</span>
</span></span><span style="display:flex;"><span>df.groupby(<span style="color:#0ff;font-weight:bold">&#39;Group&#39;</span>)[<span style="color:#0ff;font-weight:bold">&#34;col2&#34;</span>].agg([<span style="color:#0ff;font-weight:bold">&#34;min&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;max&#34;</span>])                <span style="color:#007f7f">#æ ¹æ®åˆ†ç»„åˆ—ï¼Œåˆ†ç»„ç»Ÿè®¡1åˆ—çš„å¤šä¸ªæŒ‡æ ‡</span>
</span></span><span style="display:flex;"><span>df.groupby(<span style="color:#0ff;font-weight:bold">&#39;Group&#39;</span>)[<span style="color:#0ff;font-weight:bold">&#34;col2&#34;</span>].describe()                        <span style="color:#007f7f">#æ ¹æ®åˆ†ç»„åˆ—ï¼Œåˆ†ç»„ç»Ÿè®¡1åˆ—çš„å¤šä¸ªæŒ‡æ ‡</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2) æŒ‡å®šå…¶å®ƒèƒ½å¤Ÿè¡¨ç¤ºåˆ†ç»„ä¿¡æ¯çš„ï¼Œåˆ—è¡¨ã€Serisesã€å­—å…¸ç­‰è¿›è¡Œåˆ†ç»„ç»Ÿè®¡</span>
</span></span><span style="display:flex;"><span>Class = [<span style="color:#0ff;font-weight:bold">&#34;Class01&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;Class01&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;Class01&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;Class02&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;Class02&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;Class02&#34;</span>,
</span></span><span style="display:flex;"><span>         <span style="color:#0ff;font-weight:bold">&#34;Class03&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;Class03&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;Class03&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;Class03&#34;</span>]
</span></span><span style="display:flex;"><span>df.groupby(Class)[<span style="color:#0ff;font-weight:bold">&#34;col2&#34;</span>].mean()  
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Class01    38.666667</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Class02    55.333333</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Class03    29.000000</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Name: col2, dtype: float64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="33-pandasæ’åº">3.3 Pandasæ’åº<a hidden class="anchor" aria-hidden="true" href="#33-pandasæ’åº">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> pandas <span style="color:#fff;font-weight:bold">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> numpy <span style="color:#fff;font-weight:bold">as</span> np
</span></span><span style="display:flex;"><span>df = pd.DataFrame(np.random.randint(<span style="color:#ff0;font-weight:bold">0</span>,<span style="color:#ff0;font-weight:bold">100</span>,(<span style="color:#ff0;font-weight:bold">10</span>,<span style="color:#ff0;font-weight:bold">6</span>)),
</span></span><span style="display:flex;"><span>             index= [<span style="color:#0ff;font-weight:bold">&#34;stu</span><span style="color:#0ff;font-weight:bold">%s</span><span style="color:#0ff;font-weight:bold">&#34;</span> % (x) <span style="color:#fff;font-weight:bold">for</span> x in <span style="color:#fff;font-weight:bold">range</span>(<span style="color:#ff0;font-weight:bold">10</span>)],
</span></span><span style="display:flex;"><span>             columns=[<span style="color:#0ff;font-weight:bold">&#34;col1&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;col2&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;col3&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;col4&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;col5&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;col6&#34;</span>])
</span></span><span style="display:flex;"><span>df[<span style="color:#0ff;font-weight:bold">&#34;Group&#34;</span>] = [<span style="color:#0ff;font-weight:bold">&#34;Group</span><span style="color:#0ff;font-weight:bold">%s</span><span style="color:#0ff;font-weight:bold">&#34;</span> % (x) <span style="color:#fff;font-weight:bold">for</span> x in <span style="color:#fff;font-weight:bold">list</span>(<span style="color:#0ff;font-weight:bold">&#34;A&#34;</span>*<span style="color:#ff0;font-weight:bold">5</span> + <span style="color:#0ff;font-weight:bold">&#34;B&#34;</span>*<span style="color:#ff0;font-weight:bold">5</span>)]
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>df.sort_values(<span style="color:#0ff;font-weight:bold">&#34;col1&#34;</span>)                  <span style="color:#007f7f">#æŒ‰ç…§æŒ‡å®šåˆ—å‡åºæ’åˆ—</span>
</span></span><span style="display:flex;"><span>df.sort_values(<span style="color:#0ff;font-weight:bold">&#34;col1&#34;</span>, ascending=<span style="color:#fff;font-weight:bold">False</span>) <span style="color:#007f7f">#æŒ‰ç…§æŒ‡å®šåˆ—é™åºæ’åˆ—</span>
</span></span><span style="display:flex;"><span>df.sort_values([<span style="color:#0ff;font-weight:bold">&#34;col1&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;col2&#34;</span>], 
</span></span><span style="display:flex;"><span>               ascending=[<span style="color:#fff;font-weight:bold">True</span>, <span style="color:#fff;font-weight:bold">False</span>])
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="4å­—ç¬¦ä¸²åˆ—å¤„ç†">4ã€å­—ç¬¦ä¸²åˆ—å¤„ç†<a hidden class="anchor" aria-hidden="true" href="#4å­—ç¬¦ä¸²åˆ—å¤„ç†">#</a></h1>
<p>Pandasä¸ºDataFrameå¯¹è±¡çš„å­—ç¬¦ä¸²åˆ—(ä¹ŸåŒ…æ‹¬Serieså¯¹è±¡)æä¾›äº†<code>str</code>å±æ€§ï¼Œæä¾›äº†è®¸å¤š<strong>å‘é‡åŒ–</strong>å¤„ç†å­—ç¬¦ä¸²çš„æ–¹æ³•ï¼Œå…¶ä¸­å¾ˆå¤šä¸Pythonçš„å­—ç¬¦ä¸²æ–¹æ³•ç›¸ä¼¼ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> pandas <span style="color:#fff;font-weight:bold">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> numpy <span style="color:#fff;font-weight:bold">as</span> np
</span></span><span style="display:flex;"><span>s1 = pd.Series(<span style="color:#fff;font-weight:bold">list</span>(<span style="color:#0ff;font-weight:bold">&#34;ABBAC&#34;</span>), 
</span></span><span style="display:flex;"><span>               index=[<span style="color:#0ff;font-weight:bold">&#34;stuA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuB&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuD&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuE&#39;</span>])
</span></span><span style="display:flex;"><span>s2 = pd.Series(np.random.randint(<span style="color:#ff0;font-weight:bold">60</span>,<span style="color:#ff0;font-weight:bold">100</span>,<span style="color:#ff0;font-weight:bold">5</span>), 
</span></span><span style="display:flex;"><span>               index=[<span style="color:#0ff;font-weight:bold">&#34;stuA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuB&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuD&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuE&#39;</span>])
</span></span><span style="display:flex;"><span>s3 = pd.Series([<span style="color:#0ff;font-weight:bold">&#39;class01&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;class01&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;class02&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;class02&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;class02&#39;</span>], 
</span></span><span style="display:flex;"><span>               index=[<span style="color:#0ff;font-weight:bold">&#34;stuA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuB&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuD&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuE&#39;</span>])
</span></span><span style="display:flex;"><span>df = pd.DataFrame({<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:s1,<span style="color:#0ff;font-weight:bold">&#34;Score&#34;</span>:s2,<span style="color:#0ff;font-weight:bold">&#34;Class&#34;</span>:s3})
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#      Grade  Score    Class</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuA     A     84  class01</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuB     B     68  class01</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuC     B     84  class02</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuD     A     78  class02</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuE     C     74  class02</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(1) Pythonå¤„ç†å­—ç¬¦ä¸²æ–¹æ³•</span>
</span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">&#34;level &#34;</span> + df.Grade 
</span></span><span style="display:flex;"><span>df.Grade.str.len()
</span></span><span style="display:flex;"><span>df.Class.str.upper()
</span></span><span style="display:flex;"><span>df.Class.str.split(<span style="color:#0ff;font-weight:bold">&#34;0&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuA    [class, 1]</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuB    [class, 1]</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuC    [class, 2]</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuD    [class, 2]</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuE    [class, 2]</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Name: Class, dtype: object</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2) æ­£åˆ™åŒ–å¤„ç†å­—ç¬¦ä¸²ï¼Œç±»ä¼¼ re æ¨¡å—</span>
</span></span><span style="display:flex;"><span>df.Class.str.<span style="color:#fff;font-weight:bold">match</span>(<span style="color:#0ff;font-weight:bold">&#39;([A-Za-z]+)&#39;</span>)      <span style="color:#007f7f">#è¿”å›é€»è¾‘å€¼</span>
</span></span><span style="display:flex;"><span>df.Class.str.extract(<span style="color:#0ff;font-weight:bold">&#39;([A-Za-z]+)&#39;</span>)    <span style="color:#007f7f">#æå–åŒ¹é…å­å­—ç¬¦ä¸²</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(3) åˆ‡ç‰‡å–å€¼ç­‰</span>
</span></span><span style="display:flex;"><span>df.Class.str[<span style="color:#ff0;font-weight:bold">0</span>:<span style="color:#ff0;font-weight:bold">3</span>]
</span></span><span style="display:flex;"><span>df.Class.str.split(<span style="color:#0ff;font-weight:bold">&#34;0&#34;</span>).str.get(<span style="color:#ff0;font-weight:bold">0</span>)
</span></span><span style="display:flex;"><span>df.Class.str.split(<span style="color:#0ff;font-weight:bold">&#34;0&#34;</span>).str[<span style="color:#ff0;font-weight:bold">0</span>]
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="5dataframeç­›é€‰ä¸ä¿®æ”¹">5ã€DataFrameç­›é€‰ä¸ä¿®æ”¹<a hidden class="anchor" aria-hidden="true" href="#5dataframeç­›é€‰ä¸ä¿®æ”¹">#</a></h1>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>import pandas as pd
</span></span><span style="display:flex;"><span>import numpy as np
</span></span><span style="display:flex;"><span>df = pd.DataFrame(np.random.randint(<span style="color:#ff0;font-weight:bold">0</span>,<span style="color:#ff0;font-weight:bold">100</span>,(<span style="color:#ff0;font-weight:bold">10</span>,<span style="color:#ff0;font-weight:bold">6</span>)),
</span></span><span style="display:flex;"><span>             index= [<span style="color:#0ff;font-weight:bold">&#34;stu%s&#34;</span> % (x) for x in range(10)],
</span></span><span style="display:flex;"><span>             columns=[&#34;col1&#34;,&#34;col2&#34;,&#34;col3&#34;,&#34;col4&#34;,&#34;col5&#34;,&#34;col6&#34;])
</span></span><span style="display:flex;"><span>df[&#34;Group&#34;] = [&#34;Group%s<span style="color:#0ff;font-weight:bold">&#34; % (x) for x in list(&#34;</span>A<span style="color:#0ff;font-weight:bold">&#34;*3 + &#34;</span>B<span style="color:#0ff;font-weight:bold">&#34;*3 + &#34;</span>C<span style="color:#0ff;font-weight:bold">&#34;*4)]
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">df.head()
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">      # col1  col2  col3  col4  col5  col6   Group
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold"># stu0    13    24    72    45    58    77  GroupA
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold"># stu1    93    29    67    38    95     7  GroupA
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold"># stu2    32    85    54    34    51    84  GroupA
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold"># stu3    16    92    36    10    51    67  GroupB
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold"># stu4    78    69    96    32     1    87  GroupB
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">               
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">#### ä¸‹è¿°é»˜è®¤æ˜¯æŒ‡ç­›é€‰åˆ°ç¬¦åˆæ¡ä»¶çš„è¡Œ               
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">               
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">##(1) æ•°å€¼åˆ—ç­›é€‰
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">df[df.col1&gt;80]
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">               
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">##(2) å­—ç¬¦ä¸²åˆ—ç­›é€‰
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">##å¯ç»“åˆæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ç­›é€‰
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">df[df.Group==&#34;</span>GroupA<span style="color:#0ff;font-weight:bold">&#34;]
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">##(3) å¤šä¸ªæ¡ä»¶ç­›é€‰
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">df[(df.col1&gt;50) &amp; (df.Group==&#34;</span>GroupA<span style="color:#0ff;font-weight:bold">&#34;)]               
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">               
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">##(4) ç­›é€‰ç‰¹å®šèŒƒå›´çš„å€¼               
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">df[df.Group.isin([&#34;</span>GroupA<span style="color:#0ff;font-weight:bold">&#34;,&#34;</span>GroupB<span style="color:#0ff;font-weight:bold">&#34;])]               
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">df[~df.Group.isin([&#34;</span>GroupA<span style="color:#0ff;font-weight:bold">&#34;,&#34;</span>GroupB<span style="color:#0ff;font-weight:bold">&#34;])]     # ~ è¡¨ç¤ºé€»è¾‘ é    
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">##(5) queryè¯­å¥
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">df.query(&#39;col1&gt;50 and Group==&#34;</span>GroupC<span style="color:#0ff;font-weight:bold">&#34;&#39;)
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">               
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">##(6) å»é‡
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">df.drop_duplicates([&#34;</span>Group<span style="color:#0ff;font-weight:bold">&#34;</span><span style="color:#f00">])</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##ç›´æ¥åˆ é™¤æŒ‡å®šåˆ—</span>
</span></span><span style="display:flex;"><span>df.drop([column], axis=<span style="color:#ff0;font-weight:bold">1</span>)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##ç›´æ¥åˆ é™¤æŒ‡å®šè¡Œ</span>
</span></span><span style="display:flex;"><span>df.drop([index])               
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#007f7f">##(1) replaceæ›¿æ¢</span>
</span></span><span style="display:flex;"><span>df.Group.unique()
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># array([&#39;GroupA&#39;, &#39;GroupB&#39;, &#39;GroupC&#39;], dtype=object)</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##ä¸€å¯¹ä¸€æ›¿æ¢</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#0ff;font-weight:bold">&#34;Group&#34;</span>].replace(<span style="color:#0ff;font-weight:bold">&#34;GroupA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;GroupC&#34;</span>).unique()
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># array([&#39;GroupC&#39;, &#39;GroupB&#39;], dtype=object)</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##å¤šå¯¹ä¸€æ›¿æ¢</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#0ff;font-weight:bold">&#34;Group&#34;</span>].replace([<span style="color:#0ff;font-weight:bold">&#34;GroupA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;GroupB&#34;</span>],<span style="color:#0ff;font-weight:bold">&#34;GroupC&#34;</span>).unique()
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># array([&#39;GroupC&#39;], dtype=object)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2) mapæ›¿æ¢</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#0ff;font-weight:bold">&#34;Group&#34;</span>].map({<span style="color:#0ff;font-weight:bold">&#34;GroupA&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;class01&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;GroupB&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;class02&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;GroupC&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;class03&#34;</span>}).unique()
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># array([&#39;class01&#39;, &#39;class02&#39;, &#39;class03&#39;], dtype=object)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="6dataframeåˆå¹¶">6ã€DataFrameåˆå¹¶<a hidden class="anchor" aria-hidden="true" href="#6dataframeåˆå¹¶">#</a></h1>
<h2 id="61-pdconcat">6.1 pd.concat<a hidden class="anchor" aria-hidden="true" href="#61-pdconcat">#</a></h2>
<p>å¯¹äºSerieså¯¹è±¡çš„åˆå¹¶æ¯”è¾ƒç®€å•ï¼Œå®¹æ˜“ï¼›</p>
<p><code>pd.concat</code>åˆå¹¶ä¸¤ä¸ªDataFrameæ—¶ï¼Œé€‚åˆäºè¿™ä¸¤ä¸ªDataFrameçš„<strong>è¡Œåæˆ–åˆ—åç´¢å¼•å®Œå…¨ç›¸åŒ</strong>ï¼Œå¤§éƒ¨åˆ†ç›¸åŒçš„æƒ…å†µã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> numpy <span style="color:#fff;font-weight:bold">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> pandas <span style="color:#fff;font-weight:bold">as</span> pd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df1 = pd.DataFrame(np.random.randint(<span style="color:#ff0;font-weight:bold">0</span>, <span style="color:#ff0;font-weight:bold">20</span>, (<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#ff0;font-weight:bold">4</span>)),
</span></span><span style="display:flex;"><span>                  columns=[<span style="color:#0ff;font-weight:bold">&#39;col1&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col2&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col3&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col4&#39;</span>],
</span></span><span style="display:flex;"><span>                  index=[<span style="color:#0ff;font-weight:bold">&#39;sp1&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;sp2&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;sp3&#39;</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#      col1  col2  col3  col4</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp1    11    10    19    13</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp2     6    13    18    10</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp3     5    14     6    10</span>
</span></span><span style="display:flex;"><span>df2 = pd.DataFrame(np.random.randint(<span style="color:#ff0;font-weight:bold">0</span>, <span style="color:#ff0;font-weight:bold">20</span>, (<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">4</span>)),
</span></span><span style="display:flex;"><span>                  columns=[<span style="color:#0ff;font-weight:bold">&#39;col1&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col2&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col3&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col4&#39;</span>],
</span></span><span style="display:flex;"><span>                  index=[<span style="color:#0ff;font-weight:bold">&#39;sp4&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;sp5&#39;</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#      col1  col2  col3  col4</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp4    11     2     0     2</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp5    11    19    12     4</span>
</span></span><span style="display:flex;"><span>df3 = pd.DataFrame(np.random.randint(<span style="color:#ff0;font-weight:bold">0</span>, <span style="color:#ff0;font-weight:bold">20</span>, (<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">4</span>)),
</span></span><span style="display:flex;"><span>                  columns=[<span style="color:#0ff;font-weight:bold">&#39;col1&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col2&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col3&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col4&#39;</span>],
</span></span><span style="display:flex;"><span>                  index=[<span style="color:#0ff;font-weight:bold">&#39;sp3&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;sp4&#39;</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#      col1  col2  col3  col4</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp3    13     5     3    15</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp4     7     2     2    13</span>
</span></span><span style="display:flex;"><span>df4 = pd.DataFrame(np.random.randint(<span style="color:#ff0;font-weight:bold">0</span>, <span style="color:#ff0;font-weight:bold">20</span>, (<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">4</span>)),
</span></span><span style="display:flex;"><span>                  columns=[<span style="color:#0ff;font-weight:bold">&#39;col3&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col4&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col5&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col6&#39;</span>],
</span></span><span style="display:flex;"><span>                  index=[<span style="color:#0ff;font-weight:bold">&#39;sp4&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;sp5&#39;</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#      col3  col4  col5  col6</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp4    11     1     2    15</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp5    18     2     5    18</span>
</span></span><span style="display:flex;"><span>df5 = pd.DataFrame(np.random.randint(<span style="color:#ff0;font-weight:bold">0</span>, <span style="color:#ff0;font-weight:bold">6</span>, (<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#ff0;font-weight:bold">2</span>)),
</span></span><span style="display:flex;"><span>                  columns=[<span style="color:#0ff;font-weight:bold">&#39;col5&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col6&#39;</span>],
</span></span><span style="display:flex;"><span>                  index=[<span style="color:#0ff;font-weight:bold">&#39;sp1&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;sp2&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;sp3&#39;</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#      col5  col6</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp1     0     5</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp2     5     3</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp3     2     0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(1)æ™®é€šåˆå¹¶--åˆ—åç›¸åŒï¼Œè¡Œåä¸åŒï¼Œä¸Šä¸‹åˆå¹¶</span>
</span></span><span style="display:flex;"><span>pd.concat([df1, df2])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2)æ™®é€šåˆå¹¶--è¡Œåç›¸åŒï¼Œåˆ—åä¸åŒï¼Œå·¦å³åˆå¹¶</span>
</span></span><span style="display:flex;"><span>pd.concat([df1, df5], axis=<span style="color:#ff0;font-weight:bold">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(3)ä¸Šä¸‹åˆå¹¶æ—¶ï¼Œå¿½ç•¥ç´¢å¼•é‡å¤</span>
</span></span><span style="display:flex;"><span>pd.concat([df1, df3])                           <span style="color:#007f7f">#å…è®¸å­˜åœ¨é‡å¤è¡Œå</span>
</span></span><span style="display:flex;"><span>pd.concat([df1, df3]).reset_index()
</span></span><span style="display:flex;"><span>pd.concat([df1, df3], verify_integrity=<span style="color:#fff;font-weight:bold">True</span>)    <span style="color:#007f7f">#æœ‰é‡å¤è¡Œåä¼šæŠ¥é”™</span>
</span></span><span style="display:flex;"><span>pd.concat([df1, df3], ignore_index=<span style="color:#fff;font-weight:bold">True</span>)        <span style="color:#007f7f">#é‡å‘½åæ‰€æœ‰åˆ—åå»é‡</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(4)ä¸Šä¸‹åˆå¹¶æ—¶ï¼Œåˆ—åä¸å®Œå…¨ä¸€è‡´</span>
</span></span><span style="display:flex;"><span>pd.concat([df1, df4])                           <span style="color:#007f7f">#é»˜è®¤ä¿ç•™å…¨é›†åˆ—å</span>
</span></span><span style="display:flex;"><span>pd.concat([df1, df4], join=<span style="color:#0ff;font-weight:bold">&#39;inner&#39;</span>)             <span style="color:#007f7f">#ä»…ä¿ç•™äº¤é›†ç´¢å¼•</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="62-pdmerge">6.2 pd.merge<a hidden class="anchor" aria-hidden="true" href="#62-pdmerge">#</a></h2>
<p>ç±»ä¼¼Rè¯­è¨€ä¸­dplyråŒ…çš„<code>join</code>ç³»åˆ—å‡½æ•°ï¼›</p>
<p>ä¸»è¦ç”¨äºä¸¤ä¸ªDataFrameæœ‰ç›¸åŒåˆ—çš„æƒ…å†µã€‚</p>
<h3 id="621-æœ‰ç›¸åŒåˆ—åˆ—åç›¸åŒ">6.2.1 æœ‰ç›¸åŒåˆ—ï¼Œåˆ—åç›¸åŒ<a hidden class="anchor" aria-hidden="true" href="#621-æœ‰ç›¸åŒåˆ—åˆ—åç›¸åŒ">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df1 = pd.DataFrame([{<span style="color:#0ff;font-weight:bold">&#39;Stu&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;XiaoLi&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;C01&#39;</span>},
</span></span><span style="display:flex;"><span>                    {<span style="color:#0ff;font-weight:bold">&#39;Stu&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;XiaoSun&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;C01&#39;</span>},
</span></span><span style="display:flex;"><span>                    {<span style="color:#0ff;font-weight:bold">&#39;Stu&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;XiaoAi&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;C02&#39;</span>}])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#        Stu  Grade Class</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 0   XiaoLi      2   C01</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1  XiaoSun      1   C01</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 2   XiaoAi      3   C02</span>
</span></span><span style="display:flex;"><span>df2 = pd.DataFrame([{<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;C01&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Teacher&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;Mr.Zhou&#34;</span>},
</span></span><span style="display:flex;"><span>                    {<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;C02&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Teacher&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;Mr.Wu&#34;</span>}])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   Class  Teacher</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 0   C01  Mr.Zhou</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1   C02    Mr.Wu</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##å¦‚ä¸Šä¼šè‡ªåŠ¨æŒ‰ç…§Classåˆ—åˆå¹¶ä¸¤ä¸ªDataFrmae</span>
</span></span><span style="display:flex;"><span>pd.merge(df1, df2)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#ç­‰ä»·äº</span>
</span></span><span style="display:flex;"><span>pd.merge(df1, df2, on=<span style="color:#0ff;font-weight:bold">&#34;Class&#34;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>å½“ä¸¤ä¸ªDataFrameä¸­ä¸åŒå«ä¹‰çš„åˆ—ç¢°å·§å…·æœ‰ç›¸åŒçš„åˆ—åæ—¶ï¼Œå¯è¿›è¡Œé‡å‘½ååŠ ä»¥åŒºåˆ†</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df1 = pd.DataFrame([{<span style="color:#0ff;font-weight:bold">&#39;Stu&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;XiaoLi&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;C01&#39;</span>},
</span></span><span style="display:flex;"><span>                    {<span style="color:#0ff;font-weight:bold">&#39;Stu&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;XiaoSun&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;C01&#39;</span>},
</span></span><span style="display:flex;"><span>                    {<span style="color:#0ff;font-weight:bold">&#39;Stu&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;XiaoAi&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;C02&#39;</span>}])
</span></span><span style="display:flex;"><span>df2 = pd.DataFrame([{<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;C01&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Teacher&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;Mr.Zhou&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;A&#39;</span>},
</span></span><span style="display:flex;"><span>                    {<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;C02&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Teacher&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;Mr.Wu&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;B&#39;</span>}])
</span></span><span style="display:flex;"><span>pd.merge(df1, df2, on=<span style="color:#0ff;font-weight:bold">&#34;Class&#34;</span>)
</span></span><span style="display:flex;"><span>pd.merge(df1, df2, on=<span style="color:#0ff;font-weight:bold">&#34;Class&#34;</span>, suffixes=[<span style="color:#0ff;font-weight:bold">&#34;_stu&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;_class&#34;</span>])
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="622-æœ‰ç›¸åŒåˆ—åˆ—åä¸åŒ">6.2.2 æœ‰ç›¸åŒåˆ—ï¼Œåˆ—åä¸åŒ<a hidden class="anchor" aria-hidden="true" href="#622-æœ‰ç›¸åŒåˆ—åˆ—åä¸åŒ">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span><span style="color:#007f7f">##(1) æŒ‡å®šåˆ—ååˆå¹¶</span>
</span></span><span style="display:flex;"><span>df1 = pd.DataFrame([{<span style="color:#0ff;font-weight:bold">&#39;Stu&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;XiaoLi&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;C01&#39;</span>},
</span></span><span style="display:flex;"><span>                    {<span style="color:#0ff;font-weight:bold">&#39;Stu&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;XiaoSun&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;C01&#39;</span>},
</span></span><span style="display:flex;"><span>                    {<span style="color:#0ff;font-weight:bold">&#39;Stu&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;XiaoAi&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;C02&#39;</span>}])
</span></span><span style="display:flex;"><span>df2 = pd.DataFrame([{<span style="color:#0ff;font-weight:bold">&#39;Room&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;C01&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Teacher&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;Mr.Zhou&#34;</span>},
</span></span><span style="display:flex;"><span>                    {<span style="color:#0ff;font-weight:bold">&#39;Room&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;C02&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Teacher&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;Mr.Wu&#34;</span>}])  
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#å¦‚ä¸Šdf1çš„Classåˆ—ä¸df2çš„Roomåˆ—è¡¨ç¤ºç›¸åŒçš„å«ä¹‰</span>
</span></span><span style="display:flex;"><span>pd.merge(df1, df2, left_on=<span style="color:#0ff;font-weight:bold">&#34;Class&#34;</span>, right_on=<span style="color:#0ff;font-weight:bold">&#34;Room&#34;</span>)
</span></span><span style="display:flex;"><span>pd.merge(df1, df2, left_on=<span style="color:#0ff;font-weight:bold">&#34;Class&#34;</span>, right_on=<span style="color:#0ff;font-weight:bold">&#34;Room&#34;</span>).drop(<span style="color:#0ff;font-weight:bold">&#34;Room&#34;</span>, axis=<span style="color:#ff0;font-weight:bold">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2)æŒ‡å®šç´¢å¼•åˆå¹¶</span>
</span></span><span style="display:flex;"><span>df2.set_index(<span style="color:#0ff;font-weight:bold">&#34;Room&#34;</span>, inplace=True)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#       Teacher</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Room</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># C01   Mr.Zhou</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># C02     Mr.Wu</span>
</span></span><span style="display:flex;"><span>pd.merge(df1, df2, left_on=<span style="color:#0ff;font-weight:bold">&#34;Class&#34;</span>, right_index=True)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="623-åˆ—çš„å†…å®¹ä¸å®Œå…¨ç›¸åŒ">6.2.3 åˆ—çš„å†…å®¹ä¸å®Œå…¨ç›¸åŒ<a hidden class="anchor" aria-hidden="true" href="#623-åˆ—çš„å†…å®¹ä¸å®Œå…¨ç›¸åŒ">#</a></h3>
<ul>
<li>
<p>å½“ä¸¤ä¸ªDataFrameçš„ç›¸åŒåˆ—çš„å†…å®¹ä¸å®Œå…¨æ—¶ï¼Œå¯è®¾ç½®<code>pd.merge()</code>çš„howå‚æ•°è¿›è¡Œä¸åŒçš„åˆå¹¶ï¼Œå¯é€‰<code>inner(default), left, right, outer</code></p>
</li>
<li>
<p>ç±»ä¼¼RåŒ…dplyrçš„<code>inner_join(), left_join(), right_join(), full_join()</code>å‡½æ•°</p>
</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#007f7f">##ä»¥å…¶ä¸­çš„how=&#34;left&#34;ä¸ºä¾‹</span>
</span></span><span style="display:flex;"><span>df1 = pd.DataFrame([{<span style="color:#0ff;font-weight:bold">&#39;Stu&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;XiaoLi&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;C01&#39;</span>},
</span></span><span style="display:flex;"><span>                    {<span style="color:#0ff;font-weight:bold">&#39;Stu&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;XiaoSun&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;C01&#39;</span>},
</span></span><span style="display:flex;"><span>                    {<span style="color:#0ff;font-weight:bold">&#39;Stu&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;XiaoAi&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;C02&#39;</span>},
</span></span><span style="display:flex;"><span>                    {<span style="color:#0ff;font-weight:bold">&#39;Stu&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;XiaoHe&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;C03&#39;</span>},])
</span></span><span style="display:flex;"><span>df2 = pd.DataFrame([{<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;C01&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Teacher&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;Mr.Zhou&#34;</span>},
</span></span><span style="display:flex;"><span>                    {<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;C02&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Teacher&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;Mr.Wu&#34;</span>}])  
</span></span><span style="display:flex;"><span>pd.merge(df1, df2, how=<span style="color:#0ff;font-weight:bold">&#34;left&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#        Stu  Grade Class  Teacher</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 0   XiaoLi      2   C01  Mr.Zhou</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1  XiaoSun      1   C01  Mr.Zhou</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 2   XiaoAi      3   C02    Mr.Wu</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 3   XiaoHe      3   C03      NaN</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="7dataframeå¯¼å…¥ä¸å¯¼å‡º">7ã€DataFrameå¯¼å…¥ä¸å¯¼å‡º<a hidden class="anchor" aria-hidden="true" href="#7dataframeå¯¼å…¥ä¸å¯¼å‡º">#</a></h1>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> numpy <span style="color:#fff;font-weight:bold">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> pandas <span style="color:#fff;font-weight:bold">as</span> pd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df = pd.DataFrame(np.random.randint(<span style="color:#ff0;font-weight:bold">0</span>, <span style="color:#ff0;font-weight:bold">20</span>, (<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#ff0;font-weight:bold">4</span>)),
</span></span><span style="display:flex;"><span>                  columns=[<span style="color:#0ff;font-weight:bold">&#39;col1&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col2&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col3&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col4&#39;</span>],
</span></span><span style="display:flex;"><span>                  index=[<span style="color:#0ff;font-weight:bold">&#39;sp1&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;sp2&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;sp3&#39;</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#      col1  col2  col3  col4</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp1    11    10    19    13</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp2     6    13    18    10</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp3     5    14     6    10</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="71-å¯¼å‡º">7.1 å¯¼å‡º<a hidden class="anchor" aria-hidden="true" href="#71-å¯¼å‡º">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df.to_csv(<span style="color:#0ff;font-weight:bold">&#39;test.csv&#39;</span>)
</span></span><span style="display:flex;"><span>df.to_csv(<span style="color:#0ff;font-weight:bold">&#39;test.txt&#39;</span>, sep=<span style="color:#0ff;font-weight:bold">&#34;</span><span style="color:#0ff;font-weight:bold">\t</span><span style="color:#0ff;font-weight:bold">&#34;</span>)       <span style="color:#007f7f">#æŒ‡å®šåˆ†éš”ç¬¦</span>
</span></span><span style="display:flex;"><span>df.to_csv(<span style="color:#0ff;font-weight:bold">&#39;test.csv&#39;</span>, index=<span style="color:#fff;font-weight:bold">False</span>)    <span style="color:#007f7f">#ä¸ä¿å­˜è¡Œå</span>
</span></span><span style="display:flex;"><span>df.to_csv(<span style="color:#0ff;font-weight:bold">&#39;test.csv&#39;</span>, header=<span style="color:#fff;font-weight:bold">False</span>)   <span style="color:#007f7f">#ä¸ä¿å­˜åˆ—å</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df.to_excel(<span style="color:#0ff;font-weight:bold">&#39;test.xlsx&#39;</span>)                       <span style="color:#007f7f">#éœ€è¦æå‰å®‰è£…openpyxlæ¨¡å—</span>
</span></span><span style="display:flex;"><span>df.to_excel(<span style="color:#0ff;font-weight:bold">&#39;test.xlsx&#39;</span>,sheet_name=<span style="color:#0ff;font-weight:bold">&#39;Sheet1&#39;</span>)   <span style="color:#007f7f">#è‡ªå®šä¹‰ä¿å­˜çš„sheetåç§°</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df.
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="72-å¯¼å…¥">7.2 å¯¼å…¥<a hidden class="anchor" aria-hidden="true" href="#72-å¯¼å…¥">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df0 = pd.read_csv(<span style="color:#0ff;font-weight:bold">&#39;./test.txt&#39;</span>)                      <span style="color:#007f7f">#é»˜è®¤ç¬¬ä¸€è¡Œä¸ºåˆ—åï¼Œä¸”æ²¡æœ‰è¡Œå</span>
</span></span><span style="display:flex;"><span>df0 = pd.read_csv(<span style="color:#0ff;font-weight:bold">&#39;./test.txt&#39;</span>, sep=<span style="color:#0ff;font-weight:bold">&#34;</span><span style="color:#0ff;font-weight:bold">\t</span><span style="color:#0ff;font-weight:bold">&#34;</span>)            <span style="color:#007f7f">#æŒ‡å®šåˆ†éš”ç¬¦</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df0 = pd.read_csv(<span style="color:#0ff;font-weight:bold">&#39;./test.csv&#39;</span>, header=<span style="color:#fff;font-weight:bold">None</span>)         <span style="color:#007f7f">#ä¸è®¾ç½®åˆ—å</span>
</span></span><span style="display:flex;"><span>df0 = pd.read_csv(<span style="color:#0ff;font-weight:bold">&#39;./test.csv&#39;</span>, names=<span style="color:#fff;font-weight:bold">list</span>(<span style="color:#0ff;font-weight:bold">&#34;ABCD&#34;</span>))  <span style="color:#007f7f">#è‡ªå®šä¹‰åˆ—å</span>
</span></span><span style="display:flex;"><span>df0 = pd.read_csv(<span style="color:#0ff;font-weight:bold">&#39;./test.csv&#39;</span>, index_col=<span style="color:#ff0;font-weight:bold">0</span>)         <span style="color:#007f7f">#æŒ‡å®šç¬¬ä¸€åˆ—(ç´¢å¼•ä¸º0)ä½œä¸ºè¡Œå</span>
</span></span><span style="display:flex;"><span>df0 = pd.read_csv(<span style="color:#0ff;font-weight:bold">&#39;./test.csv&#39;</span>, index_col=<span style="color:#0ff;font-weight:bold">&#34;col1&#34;</span>)    <span style="color:#007f7f">#æŒ‡å®šåˆ—ä½œä¸ºè¡Œå</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df0 = pd.read_excel(<span style="color:#0ff;font-weight:bold">&#39;test.xlsx&#39;</span>) 
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="8é•¿å®½è½¬æ¢">8ã€é•¿å®½è½¬æ¢<a hidden class="anchor" aria-hidden="true" href="#8é•¿å®½è½¬æ¢">#</a></h1>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data = {
</span></span><span style="display:flex;"><span>    <span style="color:#0ff;font-weight:bold">&#39;Name&#39;</span>: [<span style="color:#0ff;font-weight:bold">&#39;Alice&#39;</span>, <span style="color:#0ff;font-weight:bold">&#39;Bob&#39;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#0ff;font-weight:bold">&#39;Math&#39;</span>: [<span style="color:#ff0;font-weight:bold">85</span>, <span style="color:#ff0;font-weight:bold">90</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#0ff;font-weight:bold">&#39;English&#39;</span>: [<span style="color:#ff0;font-weight:bold">92</span>, <span style="color:#ff0;font-weight:bold">88</span>]
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>df_wide = pd.DataFrame(data)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#     Name  Math  English</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 0  Alice    85       92</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1    Bob    90       88</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">## (1) å®½å˜é•¿</span>
</span></span><span style="display:flex;"><span>df_long = df_wide.melt(id_vars=[<span style="color:#0ff;font-weight:bold">&#39;Name&#39;</span>], var_name=<span style="color:#0ff;font-weight:bold">&#39;Subject&#39;</span>, value_name=<span style="color:#0ff;font-weight:bold">&#39;Score&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#     Name  Subject  Score</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 0  Alice     Math     85</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1    Bob     Math     90</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 2  Alice  English     92</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 3    Bob  English     88</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">## (2) é•¿å˜å®½</span>
</span></span><span style="display:flex;"><span>df_wide = df_long.pivot(index=<span style="color:#0ff;font-weight:bold">&#39;Name&#39;</span>, columns=<span style="color:#0ff;font-weight:bold">&#39;Subject&#39;</span>, values=<span style="color:#0ff;font-weight:bold">&#39;Score&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Subject  English  Math</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Name                  </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Alice         92    85</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Bob           88    90</span>
</span></span></code></pre></td></tr></table>
</div>
</div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://lishensuo.github.io/en/tags/python/">Python</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://lishensuo.github.io/en/posts/bioinfo/026%E5%8D%95%E7%BB%86%E8%83%9E%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7--cellphonedb%E7%BB%86%E8%83%9E%E9%80%9A%E8%AE%AF%E5%88%86%E6%9E%90/">
    <span class="title">Â« Prev Page</span>
    <br>
    <span>å•ç»†èƒåˆ†æå·¥å…·--cellphonedbç»†èƒé€šè®¯åˆ†æ</span>
  </a>
  <a class="next" href="https://lishensuo.github.io/en/posts/bioinfo/027%E5%8D%95%E7%BB%86%E8%83%9E%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7--doubletfinder%E8%AF%86%E5%88%AB%E5%8F%8C%E7%BB%86%E8%83%9E/">
    <span class="title">Next Page Â»</span>
    <br>
    <span>å•ç»†èƒåˆ†æå·¥å…·--DoubletFinderè¯†åˆ«åŒç»†èƒ</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2025 <a href="https://lishensuo.github.io/en/">Li&#39;s Bioinfo-Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
		<br/>æ‚¨æ˜¯æœ¬ç«™ç¬¬ <span id="busuanzi_value_site_uv"></span> ä½è®¿é—®è€…ï¼Œæ€»æµè§ˆé‡ä¸º <span id="busuanzi_value_site_pv"></span> æ¬¡
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>

<script type="text/javascript"
async
src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
MathJax.Hub.Config({
tex2jax: {
inlineMath: [['$','$'], ['\\(','\\)']],
displayMath: [['$$','$$'], ['\[\[','\]\]']],
processEscapes: true,
processEnvironments: true,
skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
TeX: { equationNumbers: { autoNumber: "AMS" },
extensions: ["AMSmath.js", "AMSsymbols.js"] }
}
});

MathJax.Hub.Queue(function() {



var all = MathJax.Hub.getAllJax(), i;
for(i = 0; i < all.length; i += 1) {
all[i].SourceElement().parentNode.className += ' has-jax';
}
});
</script>

<style>
code.has-jax {
font: inherit;
font-size: 100%;
background: inherit;
border: inherit;
color: #515151;
}
</style></body>
</html>
