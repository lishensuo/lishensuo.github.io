<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">

<link rel="icon" href="/favicon.ico" type="image/x-icon"> 
<title>Python数据科学-(3)Pandas表格 | Li&#39;s Bioinfo-Blog</title>
<meta name="keywords" content="Python">
<meta name="description" content="
Pandas相比Numpy数组支持行列标签、多种数据类型，类似R语言中data.frame数据框。

1、Pandas结构
1.1 Series：有索引的一维数组
1.1.1 创建Series对象

通过pd.Serise函数创建



 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15


##(1) 通过index参数设置索引
import pandas as pd
data = pd.Series([1,2,3,4,5], index=[&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;,&#39;e&#39;])
#a    1
#b    2
#c    3
#d    4
#e    5
#dtype: int64

##(2)如不设置index参数，则索引默认为 range(len)
data1 = pd.Series([1,2,3,4,5])

##(3)也可以以字典的形式创建，键值分别对应索引与值
data2 = pd.Series({&#39;a&#39;:1,&#39;b&#39;:2,&#39;c&#39;:3,&#39;d&#39;:4,&#39;e&#39;:5})


1.1.2 Series对象操作


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20


import pandas as pd
data = pd.Series([1,2,3,4,5], index=[&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;,&#39;e&#39;])
##(1) 提取Series的一维数组与索引标签
data.values
# array([1, 2, 3, 4, 5])
data.index
# Index([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;], dtype=&#39;object&#39;)

##(2) 按显示索引取Series子集
data[&#39;a&#39;] 
data[&#39;a&#39;:&#39;c&#39;]
data[[&#34;a&#34;,&#34;c&#34;,&#34;e&#34;]]
data[data&gt;3]
data.loc[&#34;a&#34;:&#34;c&#34;]

##(3) 按隐式索引取Series子集
data[0]
data[0:3]
data[[0,2,4]]
data.iloc[1:3]



.loc与.iloc的作用主要体现在：Series的index也是数值型时，容易与隐式索引混淆。">
<meta name="author" content="Lishensuo">
<link rel="canonical" href="https://lishensuo.github.io/en/posts/program/022python%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6-pandas%E8%A1%A8%E6%A0%BC/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.9e4de5e3ba61ea358168341aa7cdf70abfaafb7c697dfe8624af3ddff9a35c2f.css" integrity="sha256-nk3l47ph6jWBaDQap833Cr&#43;q&#43;3xpff6GJK893/mjXC8=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.555af97124d54bb1457985dd081b8f5616a48103aafeb30ac89fde835d65aa6c.js" integrity="sha256-VVr5cSTVS7FFeYXdCBuPVhakgQOq/rMKyJ/eg11lqmw="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://lishensuo.github.io/img/Q.gif">
<link rel="icon" type="image/png" sizes="16x16" href="https://lishensuo.github.io/img/Q.gif">
<link rel="icon" type="image/png" sizes="32x32" href="https://lishensuo.github.io/img/Q.gif">
<link rel="apple-touch-icon" href="https://lishensuo.github.io/Q.gif">
<link rel="mask-icon" href="https://lishensuo.github.io/Q.gif">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://lishensuo.github.io/en/posts/program/022python%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6-pandas%E8%A1%A8%E6%A0%BC/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Python数据科学-(3)Pandas表格" />
<meta property="og:description" content="
Pandas相比Numpy数组支持行列标签、多种数据类型，类似R语言中data.frame数据框。

1、Pandas结构
1.1 Series：有索引的一维数组
1.1.1 创建Series对象

通过pd.Serise函数创建



 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15


##(1) 通过index参数设置索引
import pandas as pd
data = pd.Series([1,2,3,4,5], index=[&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;,&#39;e&#39;])
#a    1
#b    2
#c    3
#d    4
#e    5
#dtype: int64

##(2)如不设置index参数，则索引默认为 range(len)
data1 = pd.Series([1,2,3,4,5])

##(3)也可以以字典的形式创建，键值分别对应索引与值
data2 = pd.Series({&#39;a&#39;:1,&#39;b&#39;:2,&#39;c&#39;:3,&#39;d&#39;:4,&#39;e&#39;:5})


1.1.2 Series对象操作


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20


import pandas as pd
data = pd.Series([1,2,3,4,5], index=[&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;,&#39;e&#39;])
##(1) 提取Series的一维数组与索引标签
data.values
# array([1, 2, 3, 4, 5])
data.index
# Index([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;], dtype=&#39;object&#39;)

##(2) 按显示索引取Series子集
data[&#39;a&#39;] 
data[&#39;a&#39;:&#39;c&#39;]
data[[&#34;a&#34;,&#34;c&#34;,&#34;e&#34;]]
data[data&gt;3]
data.loc[&#34;a&#34;:&#34;c&#34;]

##(3) 按隐式索引取Series子集
data[0]
data[0:3]
data[[0,2,4]]
data.iloc[1:3]



.loc与.iloc的作用主要体现在：Series的index也是数值型时，容易与隐式索引混淆。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lishensuo.github.io/en/posts/program/022python%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6-pandas%E8%A1%A8%E6%A0%BC/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-03T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2022-05-10T00:00:00&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Python数据科学-(3)Pandas表格"/>
<meta name="twitter:description" content="
Pandas相比Numpy数组支持行列标签、多种数据类型，类似R语言中data.frame数据框。

1、Pandas结构
1.1 Series：有索引的一维数组
1.1.1 创建Series对象

通过pd.Serise函数创建



 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15


##(1) 通过index参数设置索引
import pandas as pd
data = pd.Series([1,2,3,4,5], index=[&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;,&#39;e&#39;])
#a    1
#b    2
#c    3
#d    4
#e    5
#dtype: int64

##(2)如不设置index参数，则索引默认为 range(len)
data1 = pd.Series([1,2,3,4,5])

##(3)也可以以字典的形式创建，键值分别对应索引与值
data2 = pd.Series({&#39;a&#39;:1,&#39;b&#39;:2,&#39;c&#39;:3,&#39;d&#39;:4,&#39;e&#39;:5})


1.1.2 Series对象操作


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20


import pandas as pd
data = pd.Series([1,2,3,4,5], index=[&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;,&#39;e&#39;])
##(1) 提取Series的一维数组与索引标签
data.values
# array([1, 2, 3, 4, 5])
data.index
# Index([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;], dtype=&#39;object&#39;)

##(2) 按显示索引取Series子集
data[&#39;a&#39;] 
data[&#39;a&#39;:&#39;c&#39;]
data[[&#34;a&#34;,&#34;c&#34;,&#34;e&#34;]]
data[data&gt;3]
data.loc[&#34;a&#34;:&#34;c&#34;]

##(3) 按隐式索引取Series子集
data[0]
data[0:3]
data[[0,2,4]]
data.iloc[1:3]



.loc与.iloc的作用主要体现在：Series的index也是数值型时，容易与隐式索引混淆。"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "分类",
      "item": "https://lishensuo.github.io/en/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "📖 R\u0026Python\u0026Shell --- 编程基础、可视化等",
      "item": "https://lishensuo.github.io/en/posts/program/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Python数据科学-(3)Pandas表格",
      "item": "https://lishensuo.github.io/en/posts/program/022python%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6-pandas%E8%A1%A8%E6%A0%BC/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Python数据科学-(3)Pandas表格",
  "name": "Python数据科学-(3)Pandas表格",
  "description": " Pandas相比Numpy数组支持行列标签、多种数据类型，类似R语言中data.frame数据框。\n1、Pandas结构 1.1 Series：有索引的一维数组 1.1.1 创建Series对象 通过pd.Serise函数创建 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 ##(1) 通过index参数设置索引 import pandas as pd data = pd.Series([1,2,3,4,5], index=[\u0026#39;a\u0026#39;,\u0026#39;b\u0026#39;,\u0026#39;c\u0026#39;,\u0026#39;d\u0026#39;,\u0026#39;e\u0026#39;]) #a 1 #b 2 #c 3 #d 4 #e 5 #dtype: int64 ##(2)如不设置index参数，则索引默认为 range(len) data1 = pd.Series([1,2,3,4,5]) ##(3)也可以以字典的形式创建，键值分别对应索引与值 data2 = pd.Series({\u0026#39;a\u0026#39;:1,\u0026#39;b\u0026#39;:2,\u0026#39;c\u0026#39;:3,\u0026#39;d\u0026#39;:4,\u0026#39;e\u0026#39;:5}) 1.1.2 Series对象操作 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 import pandas as pd data = pd.Series([1,2,3,4,5], index=[\u0026#39;a\u0026#39;,\u0026#39;b\u0026#39;,\u0026#39;c\u0026#39;,\u0026#39;d\u0026#39;,\u0026#39;e\u0026#39;]) ##(1) 提取Series的一维数组与索引标签 data.values # array([1, 2, 3, 4, 5]) data.index # Index([\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;, \u0026#39;d\u0026#39;, \u0026#39;e\u0026#39;], dtype=\u0026#39;object\u0026#39;) ##(2) 按显示索引取Series子集 data[\u0026#39;a\u0026#39;] data[\u0026#39;a\u0026#39;:\u0026#39;c\u0026#39;] data[[\u0026#34;a\u0026#34;,\u0026#34;c\u0026#34;,\u0026#34;e\u0026#34;]] data[data\u0026gt;3] data.loc[\u0026#34;a\u0026#34;:\u0026#34;c\u0026#34;] ##(3) 按隐式索引取Series子集 data[0] data[0:3] data[[0,2,4]] data.iloc[1:3] .loc与.iloc的作用主要体现在：Series的index也是数值型时，容易与隐式索引混淆。\n",
  "keywords": [
    "Python"
  ],
  "articleBody": " Pandas相比Numpy数组支持行列标签、多种数据类型，类似R语言中data.frame数据框。\n1、Pandas结构 1.1 Series：有索引的一维数组 1.1.1 创建Series对象 通过pd.Serise函数创建 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 ##(1) 通过index参数设置索引 import pandas as pd data = pd.Series([1,2,3,4,5], index=['a','b','c','d','e']) #a 1 #b 2 #c 3 #d 4 #e 5 #dtype: int64 ##(2)如不设置index参数，则索引默认为 range(len) data1 = pd.Series([1,2,3,4,5]) ##(3)也可以以字典的形式创建，键值分别对应索引与值 data2 = pd.Series({'a':1,'b':2,'c':3,'d':4,'e':5}) 1.1.2 Series对象操作 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 import pandas as pd data = pd.Series([1,2,3,4,5], index=['a','b','c','d','e']) ##(1) 提取Series的一维数组与索引标签 data.values # array([1, 2, 3, 4, 5]) data.index # Index(['a', 'b', 'c', 'd', 'e'], dtype='object') ##(2) 按显示索引取Series子集 data['a'] data['a':'c'] data[[\"a\",\"c\",\"e\"]] data[data\u003e3] data.loc[\"a\":\"c\"] ##(3) 按隐式索引取Series子集 data[0] data[0:3] data[[0,2,4]] data.iloc[1:3] .loc与.iloc的作用主要体现在：Series的index也是数值型时，容易与隐式索引混淆。\n1.2 DataFrame：多个Series对象组成 DataFrame对象可以认为是多个等长、索引值对应相同的Series对象组成\n1.2.1 创建DataFrame对象 通过pd.DataFrame创建 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 ##(1) 单个Series转为DataFrame,通过columns参数设置列名 import pandas as pd s1 = pd.Series({'a':1,'b':2,'c':3,'d':4,'e':5}) d1 = pd.DataFrame(s1, columns=[\"col_01\"]) # col_01 #a 1 #b 2 #c 3 #d 4 #e 5 ##(2) 多个相同索引的Series对象构成的字典 s2 = pd.Series({'a':\"Dog\",'b':\"Cat\",'c':\"Pig\",'d':\"Cow\",'e':\"Sheep\"}) pd.DataFrame({\"col_1\":s1, \"col_2\":s2}) ##(3) 通过字典列表创建：每个子字典代表一行；键名表示列名，可通过index设置行名 pd.DataFrame([{'a':1,'b':2,'c':3}, {'a':2,'b':4,'c':6}], index=[\"XiaoLi\",\"XiaoWang\"]) # a b c #XiaoLi 1 2 3 #XiaoWang 2 4 6 ##(4) 将NumPy二维数组转为DataFrame import numpy as np pd.DataFrame(np.random.randint(0,10,(2,3)), columns=['a','b','c'], index=['sp1','sp2']) 1.2.2 DataFrame对象操作 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 import pandas as pd import numpy as np s1 = pd.Series(np.random.choice(10,5,replace=False), index=[\"stuA\",'stuB','stuC','stuD','stuE']) s2 = pd.Series(np.random.randint(60,100,5), index=[\"stuA\",'stuB','stuC','stuD','stuE']) s3 = pd.Series(['class01','class01','class02','class02','class02'], index=[\"stuA\",'stuB','stuC','stuD','stuE']) df = pd.DataFrame({'Grade':s1,\"Score\":s2,\"Class\":s3}) # Grade Score Class #stuA 3 95 class01 #stuB 9 96 class01 #stuC 1 85 class02 #stuD 5 76 class02 #stuE 8 70 class02 ##(0) 初步探索 df.head() df.info() #表格概述信息 df.dtypes #每列的数据类型 df.shape df.size df.values #返回二维数组 df.T #行列转换 ##(1)获取行、列名（均为Index对象）以及值 df.index #行名 df.columns #列名 ##(2)返回列 df['Grade'] df.Grade df[['Grade','Score']] df.loc[:,'Grade':'Class'] df.iloc[:,0:3] df['newCol'] = 0 ##(3)返回行 df.loc['stuA':'stuC',:] df.loc[df[\"Score\"]\u003e80,:] df.loc[['stuA','stuC'],:] df.iloc[1:3,:] df[1:3] df.iloc[[0,2,4],:] df[df.Grade\u003e5] #筛选符合条件的行 ##注意：如果仅取DataFrame的一行/一列，会返回为Serires对象；可加上中括号，返回为DataFrame df[['Grade']] df.loc[['stuC'],:] 1.3 Index索引=列名+行名 1.3.1 Index索引对象 如上Series有索引，DataFrame有行、列的索引。可以为数值型(int)或者字符型(object)\n一方面Index可以认为是一维数组（不可改变其内容和顺序）；另一方面拥有集合对象的相关操作。\n1 2 3 4 5 6 7 8 9 10 11 12 13 import pandas as pd idx = pd.Index([1,2,3,4,5]) # Int64Index([1, 2, 3, 4, 5], dtype='int64') ##(1) 数组相关操作 idx[0] #支持一维数组的各种取值方式 list(idx) #转为普通列表 ##(2) 集合相关操作 idx2 = pd.Index([4,5,6,7]) idx.intersection(idx2) # Int64Index([4, 5], dtype='int64') idx.union(idx2) 1.3.2 Index索引修改 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 import pandas as pd import numpy as np s1 = pd.Series(np.random.choice(10,3,replace=False), index=[\"stuA\",'stuB','stuC']) s2 = pd.Series(np.random.randint(60,100,3), index=[\"stuA\",'stuB','stuC']) s3 = pd.Series(['class01','class01','class02'], index=[\"stuA\",'stuB','stuC']) s4 = pd.Series(['Zhang','Li','Liu'], index=[\"stuA\",'stuB','stuC']) df = pd.DataFrame({'Grade':s1,\"Score\":s2,\"Class\":s3,\"Name\":s4}) # Grade Score Class Name #stuA 0 60 class01 Zhang #stuB 8 65 class01 Li #stuC 2 80 class02 Liu ##(1)修改列名 df.rename(columns = {\"Grade\":\"Level\"}) # {\"Old_name\":\"New_name\"} ##(2)将特定列变成行名 df.set_index(\"Name\") ##(3)将行名变为列 df[\"ID\"] = df.index 2、缺失值处理 None是一个python对象，表示缺失值。在数组中属于object类型(字符串属于object类型) NaN是有numpy定义的缺失值，属于浮点型数据 2.1 numpy中的缺失值 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 import numpy as np import pandas as pd ##(1) None缺失值 n1 = np.array([1,2,3,None]) # array([1, 2, 3, None], dtype=object) n1.min() # TypeError n1.astype(np.float64) #array([ 1., 2., 3., nan]) ##(2) NaN缺失值 n2 = np.array([1,2,3,np.nan]) # array([ 1., 2., 3., nan]) # dtype('float64') #含nan的一般统计运算都会返回nan值 n2.min() # nan #可使用针对处理含有nan的numpy数据 np.nanmin(n1) # 1.0 2.2 Pandas处理缺失值 pandas将None也视为np.nan，即浮点类型的缺失值。记录为NaN 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 pd.Series([1,np.nan,3, None]) #0 1.0 #1 NaN #2 3.0 #3 NaN #dtype: float64 #当pandas整型数据中出现一个缺失值时，会自动转为浮点型数据 s1 = pd.Series(np.random.choice(10,5,replace=False), index=[\"stuA\",'stuB','stuC','stuD','stuE']) s2 = pd.Series(np.random.randint(60,100,5), index=[\"stuA\",'stuB','stuC','stuD','stuE']) s3 = pd.Series(['class01','class01','class02','class02','class02'], index=[\"stuA\",'stuB','stuC','stuD','stuE']) df = pd.DataFrame({'Grade':s1,\"Score\":s2,\"Class\":s3}) df.iloc[2,0:2]=None df.iloc[4,1]=np.nan # Grade Score Class # stuA 1.0 91.0 class01 # stuB 3.0 61.0 class01 # stuC NaN NaN class02 # stuD 0.0 94.0 class02 # stuE 7.0 NaN class02 ##(1)判断缺失值 df.isnull() #是否为缺失值 df.notnull() #是否为非缺失值 ##(2)去除缺失值 df.dropna() #删除含有缺失值的整行数据 # axis=1 :删除含有缺失值的整列数据 # how :默认为'any';'all'表示全为缺失值才删除 ##(3)填补缺失值 df.fillna(10) #固定值填充 df.fillna(method='ffill') #使用缺失值前面的数据填充 df.fillna(method='bfill') #使用缺失值后面的数据填充 3、Pandas运算与统计 3.1 Pandas运算 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 import pandas as pd import numpy as np ##(1)整体算数运算：适用于介绍的np算法运算, 不影响原有结构 s1 = pd.Series({'a':1,'b':2,'c':3,'d':4,'e':5}) #a 1 #b 2 #c 3 #d 4 #e 5 #dtype: int64 df1 = pd.DataFrame(np.random.randint(0,10,(2,3)), columns=['a','b','c'], index=['sp1','sp2']) # a b c #sp1 5 9 4 #sp2 6 3 4 np.log(s1 + 1) df1 / 10 ##(2)Series之间索引对齐运算：即使顺序不同，按照索引一一对应计算 s2 = pd.Series({'a':1,'d':4,'e':5,'b':2,'c':3}) s1 + s2 #如果索引不一致，按全集处理，用NaN填充 s3 = pd.Series({'a':1,'d':4,'e':5}) s1 + s3 ##(3)DataFrame与Series(行/列)之间运算 #按行 ss1 = pd.Series({'a':1,'b':2,'c':3}) df1 - ss1 #所有行相减 df1.loc[[\"sp1\"],:]=df1.loc[[\"sp1\"],:]-ss1 #特定行相减 #按列 ss2 = pd.Series({'sp1':10,'sp2':20}) df1.subtract(ss2, axis=0) #所有列相减 df1.loc[:,\"a\"] = df1.loc[:,\"a\"] - ss2 #特定列相减 如上，Series之间或者DataFrame与Series按行按列之间计算时，会考虑索引对齐的问题；如果索引不一致，会取全集，用NaN填补。如果Series/DataFrame是与数组/列表运算，则必须保持运算双方维度一致，并且按顺序计算。\n3.2 Pandas统计 1 2 3 4 5 6 7 8 9 10 11 12 13 import pandas as pd import numpy as np df = pd.DataFrame(np.random.randint(0,100,(10,6)), index= [\"stu%s\" % (x) for x in range(10)], columns=[\"col1\",\"col2\",\"col3\",\"col4\",\"col5\",\"col6\"]) df[\"Group\"] = [\"Group%s\" % (x) for x in list(\"A\"*5 + \"B\"*5)] df.head() # col1 col2 col3 col4 col5 col6 Group # stu0 0 30 31 72 20 2 GroupA # stu1 11 47 47 53 92 80 GroupA # stu2 47 39 11 25 78 57 GroupA # stu3 15 90 57 28 90 54 GroupA # stu4 30 9 92 85 40 7 GroupA Pandas内置常用数值列统计方法有 count() 计(行)数（但是会忽略NA值，需要格外注意）\nfirst(), last() 第一项与最后一项\nsum() 求和\nmean(), median(), min(), max()\nstd(), var(), mad()\ndescribe() 可以计算每一列的若干常用统计值\n3.2.1 基础统计 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 ##(1)数值列统计方法默认只会对数值列统计 df.col1.sum() # 349 df.mean() # col1 34.9 # col2 39.8 # col3 54.2 # col4 34.9 # col5 64.4 # col6 43.5 # dtype: float64 df.describe() # col1 col2 col3 col4 col5 col6 # count 10.000000 10.000000 10.000000 10.000000 10.000000 10.0000 # mean 34.900000 39.800000 54.200000 34.900000 64.400000 43.5000 # std 23.811528 24.548365 31.688764 27.404176 31.885908 26.7426 # min 0.000000 9.000000 2.000000 1.000000 11.000000 2.0000 # 25% 17.250000 23.250000 35.000000 19.000000 42.250000 28.2500 # 50% 31.000000 36.000000 56.500000 28.500000 78.000000 50.0000 # 75% 50.750000 47.000000 78.500000 48.250000 89.250000 56.2500 # max 70.000000 90.000000 92.000000 85.000000 99.000000 80.0000 ##(2)统计分类 df.Group.value_counts() #频数 df.Group.value_counts(normalize=True) #百分比 df.Group.unique() #唯一值 df.describe(include=[\"O\"]) #分别统计所有字符串列 pd.crosstab(df.Group, df.Group) #类似R语言的table() 3.2.2 分组统计 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 ##(1) 指定DataFrame表格中的表示分组信息的列，进行分组统计 df.groupby('Group')[\"col2\"].mean() #根据分组列，分组统计1列的值 # Group # GroupA 43.0 # GroupB 36.6 # Name: col2, dtype: float64 df.groupby('Group', as_index=False).mean() #根据分组列，分组统计所有列的值 df.groupby('Group')[\"col2\"].agg([\"min\",\"max\"]) #根据分组列，分组统计1列的多个指标 df.groupby('Group')[\"col2\"].describe() #根据分组列，分组统计1列的多个指标 ##(2) 指定其它能够表示分组信息的，列表、Serises、字典等进行分组统计 Class = [\"Class01\",\"Class01\",\"Class01\",\"Class02\",\"Class02\",\"Class02\", \"Class03\",\"Class03\",\"Class03\",\"Class03\"] df.groupby(Class)[\"col2\"].mean() # Class01 38.666667 # Class02 55.333333 # Class03 29.000000 # Name: col2, dtype: float64 3.3 Pandas排序 1 2 3 4 5 6 7 8 9 10 11 import pandas as pd import numpy as np df = pd.DataFrame(np.random.randint(0,100,(10,6)), index= [\"stu%s\" % (x) for x in range(10)], columns=[\"col1\",\"col2\",\"col3\",\"col4\",\"col5\",\"col6\"]) df[\"Group\"] = [\"Group%s\" % (x) for x in list(\"A\"*5 + \"B\"*5)] df.sort_values(\"col1\") #按照指定列升序排列 df.sort_values(\"col1\", ascending=False) #按照指定列降序排列 df.sort_values([\"col1\", \"col2\"], ascending=[True, False]) 4、字符串列处理 Pandas为DataFrame对象的字符串列(也包括Series对象)提供了str属性，提供了许多向量化处理字符串的方法，其中很多与Python的字符串方法相似。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 import pandas as pd import numpy as np s1 = pd.Series(list(\"ABBAC\"), index=[\"stuA\",'stuB','stuC','stuD','stuE']) s2 = pd.Series(np.random.randint(60,100,5), index=[\"stuA\",'stuB','stuC','stuD','stuE']) s3 = pd.Series(['class01','class01','class02','class02','class02'], index=[\"stuA\",'stuB','stuC','stuD','stuE']) df = pd.DataFrame({'Grade':s1,\"Score\":s2,\"Class\":s3}) # Grade Score Class # stuA A 84 class01 # stuB B 68 class01 # stuC B 84 class02 # stuD A 78 class02 # stuE C 74 class02 ##(1) Python处理字符串方法 \"level \" + df.Grade df.Grade.str.len() df.Class.str.upper() df.Class.str.split(\"0\") # stuA [class, 1] # stuB [class, 1] # stuC [class, 2] # stuD [class, 2] # stuE [class, 2] # Name: Class, dtype: object ##(2) 正则化处理字符串，类似 re 模块 df.Class.str.match('([A-Za-z]+)') #返回逻辑值 df.Class.str.extract('([A-Za-z]+)') #提取匹配子字符串 ##(3) 切片取值等 df.Class.str[0:3] df.Class.str.split(\"0\").str.get(0) df.Class.str.split(\"0\").str[0] 5、DataFrame筛选与修改 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 import pandas as pd import numpy as np df = pd.DataFrame(np.random.randint(0,100,(10,6)), index= [\"stu%s\" % (x) for x in range(10)], columns=[\"col1\",\"col2\",\"col3\",\"col4\",\"col5\",\"col6\"]) df[\"Group\"] = [\"Group%s\" % (x) for x in list(\"A\"*3 + \"B\"*3 + \"C\"*4)] df.head() # col1 col2 col3 col4 col5 col6 Group # stu0 13 24 72 45 58 77 GroupA # stu1 93 29 67 38 95 7 GroupA # stu2 32 85 54 34 51 84 GroupA # stu3 16 92 36 10 51 67 GroupB # stu4 78 69 96 32 1 87 GroupB #### 下述默认是指筛选到符合条件的行 ##(1) 数值列筛选 df[df.col1\u003e80] ##(2) 字符串列筛选 ##可结合正则表达式匹配筛选 df[df.Group==\"GroupA\"] ##(3) 多个条件筛选 df[(df.col1\u003e50) \u0026 (df.Group==\"GroupA\")] ##(4) 筛选特定范围的值 df[df.Group.isin([\"GroupA\",\"GroupB\"])] df[~df.Group.isin([\"GroupA\",\"GroupB\"])] # ~ 表示逻辑 非 ##(5) query语句 df.query('col1\u003e50 and Group==\"GroupC\"') ##(6) 去重 df.drop_duplicates([\"Group\"]) ##直接删除指定列 df.drop([column], axis=1) ##直接删除指定行 df.drop([index]) 1 2 3 4 5 6 7 8 9 10 11 12 13 ##(1) replace替换 df.Group.unique() # array(['GroupA', 'GroupB', 'GroupC'], dtype=object) ##一对一替换 df[\"Group\"].replace(\"GroupA\",\"GroupC\").unique() # array(['GroupC', 'GroupB'], dtype=object) ##多对一替换 df[\"Group\"].replace([\"GroupA\",\"GroupB\"],\"GroupC\").unique() # array(['GroupC'], dtype=object) ##(2) map替换 df[\"Group\"].map({\"GroupA\":\"class01\", \"GroupB\":\"class02\", \"GroupC\":\"class03\"}).unique() # array(['class01', 'class02', 'class03'], dtype=object) 6、DataFrame合并 6.1 pd.concat 对于Series对象的合并比较简单，容易；\npd.concat合并两个DataFrame时，适合于这两个DataFrame的行名或列名索引完全相同，大部分相同的情况。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 import numpy as np import pandas as pd df1 = pd.DataFrame(np.random.randint(0, 20, (3,4)), columns=['col1','col2','col3','col4'], index=['sp1','sp2','sp3']) # col1 col2 col3 col4 # sp1 11 10 19 13 # sp2 6 13 18 10 # sp3 5 14 6 10 df2 = pd.DataFrame(np.random.randint(0, 20, (2,4)), columns=['col1','col2','col3','col4'], index=['sp4','sp5']) # col1 col2 col3 col4 # sp4 11 2 0 2 # sp5 11 19 12 4 df3 = pd.DataFrame(np.random.randint(0, 20, (2,4)), columns=['col1','col2','col3','col4'], index=['sp3','sp4']) # col1 col2 col3 col4 # sp3 13 5 3 15 # sp4 7 2 2 13 df4 = pd.DataFrame(np.random.randint(0, 20, (2,4)), columns=['col3','col4','col5','col6'], index=['sp4','sp5']) # col3 col4 col5 col6 # sp4 11 1 2 15 # sp5 18 2 5 18 df5 = pd.DataFrame(np.random.randint(0, 6, (3,2)), columns=['col5','col6'], index=['sp1','sp2','sp3']) # col5 col6 # sp1 0 5 # sp2 5 3 # sp3 2 0 ##(1)普通合并--列名相同，行名不同，上下合并 pd.concat([df1, df2]) ##(2)普通合并--行名相同，列名不同，左右合并 pd.concat([df1, df5], axis=1) ##(3)上下合并时，忽略索引重复 pd.concat([df1, df3]) #允许存在重复行名 pd.concat([df1, df3]).reset_index() pd.concat([df1, df3], verify_integrity=True) #有重复行名会报错 pd.concat([df1, df3], ignore_index=True) #重命名所有列名去重 ##(4)上下合并时，列名不完全一致 pd.concat([df1, df4]) #默认保留全集列名 pd.concat([df1, df4], join='inner') #仅保留交集索引 6.2 pd.merge 类似R语言中dplyr包的join系列函数；\n主要用于两个DataFrame有相同列的情况。\n6.2.1 有相同列，列名相同 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 df1 = pd.DataFrame([{'Stu':\"XiaoLi\",'Grade':2,'Class':'C01'}, {'Stu':\"XiaoSun\",'Grade':1,'Class':'C01'}, {'Stu':\"XiaoAi\",'Grade':3,'Class':'C02'}]) # Stu Grade Class # 0 XiaoLi 2 C01 # 1 XiaoSun 1 C01 # 2 XiaoAi 3 C02 df2 = pd.DataFrame([{'Class':\"C01\",'Teacher':\"Mr.Zhou\"}, {'Class':\"C02\",'Teacher':\"Mr.Wu\"}]) # Class Teacher # 0 C01 Mr.Zhou # 1 C02 Mr.Wu ##如上会自动按照Class列合并两个DataFrmae pd.merge(df1, df2) #等价于 pd.merge(df1, df2, on=\"Class\") 当两个DataFrame中不同含义的列碰巧具有相同的列名时，可进行重命名加以区分 1 2 3 4 5 6 7 df1 = pd.DataFrame([{'Stu':\"XiaoLi\",'Grade':2,'Class':'C01'}, {'Stu':\"XiaoSun\",'Grade':1,'Class':'C01'}, {'Stu':\"XiaoAi\",'Grade':3,'Class':'C02'}]) df2 = pd.DataFrame([{'Class':\"C01\",'Teacher':\"Mr.Zhou\",'Grade':'A'}, {'Class':\"C02\",'Teacher':\"Mr.Wu\",'Grade':'B'}]) pd.merge(df1, df2, on=\"Class\") pd.merge(df1, df2, on=\"Class\", suffixes=[\"_stu\",\"_class\"]) 6.2.2 有相同列，列名不同 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 ##(1) 指定列名合并 df1 = pd.DataFrame([{'Stu':\"XiaoLi\",'Grade':2,'Class':'C01'}, {'Stu':\"XiaoSun\",'Grade':1,'Class':'C01'}, {'Stu':\"XiaoAi\",'Grade':3,'Class':'C02'}]) df2 = pd.DataFrame([{'Room':\"C01\",'Teacher':\"Mr.Zhou\"}, {'Room':\"C02\",'Teacher':\"Mr.Wu\"}]) #如上df1的Class列与df2的Room列表示相同的含义 pd.merge(df1, df2, left_on=\"Class\", right_on=\"Room\") pd.merge(df1, df2, left_on=\"Class\", right_on=\"Room\").drop(\"Room\", axis=1) ##(2)指定索引合并 df2.set_index(\"Room\", inplace=True) # Teacher # Room # C01 Mr.Zhou # C02 Mr.Wu pd.merge(df1, df2, left_on=\"Class\", right_index=True) 6.2.3 列的内容不完全相同 当两个DataFrame的相同列的内容不完全时，可设置pd.merge()的how参数进行不同的合并，可选inner(default), left, right, outer\n类似R包dplyr的inner_join(), left_join(), right_join(), full_join()函数\n1 2 3 4 5 6 7 8 9 10 11 12 13 ##以其中的how=\"left\"为例 df1 = pd.DataFrame([{'Stu':\"XiaoLi\",'Grade':2,'Class':'C01'}, {'Stu':\"XiaoSun\",'Grade':1,'Class':'C01'}, {'Stu':\"XiaoAi\",'Grade':3,'Class':'C02'}, {'Stu':\"XiaoHe\",'Grade':3,'Class':'C03'},]) df2 = pd.DataFrame([{'Class':\"C01\",'Teacher':\"Mr.Zhou\"}, {'Class':\"C02\",'Teacher':\"Mr.Wu\"}]) pd.merge(df1, df2, how=\"left\") # Stu Grade Class Teacher # 0 XiaoLi 2 C01 Mr.Zhou # 1 XiaoSun 1 C01 Mr.Zhou # 2 XiaoAi 3 C02 Mr.Wu # 3 XiaoHe 3 C03 NaN 7、DataFrame导入与导出 1 2 3 4 5 6 7 8 9 10 import numpy as np import pandas as pd df = pd.DataFrame(np.random.randint(0, 20, (3,4)), columns=['col1','col2','col3','col4'], index=['sp1','sp2','sp3']) # col1 col2 col3 col4 # sp1 11 10 19 13 # sp2 6 13 18 10 # sp3 5 14 6 10 7.1 导出 1 2 3 4 5 6 7 8 9 df.to_csv('test.csv') df.to_csv('test.txt', sep=\"\\t\") #指定分隔符 df.to_csv('test.csv', index=False) #不保存行名 df.to_csv('test.csv', header=False) #不保存列名 df.to_excel('test.xlsx') #需要提前安装openpyxl模块 df.to_excel('test.xlsx',sheet_name='Sheet1') #自定义保存的sheet名称 df. 7.2 导入 1 2 3 4 5 6 7 8 9 df0 = pd.read_csv('./test.txt') #默认第一行为列名，且没有行名 df0 = pd.read_csv('./test.txt', sep=\"\\t\") #指定分隔符 df0 = pd.read_csv('./test.csv', header=None) #不设置列名 df0 = pd.read_csv('./test.csv', names=list(\"ABCD\")) #自定义列名 df0 = pd.read_csv('./test.csv', index_col=0) #指定第一列(索引为0)作为行名 df0 = pd.read_csv('./test.csv', index_col=\"col1\") #指定列作为行名 df0 = pd.read_excel('test.xlsx') 8、长宽转换 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 data = { 'Name': ['Alice', 'Bob'], 'Math': [85, 90], 'English': [92, 88] } df_wide = pd.DataFrame(data) # Name Math English # 0 Alice 85 92 # 1 Bob 90 88 ## (1) 宽变长 df_long = df_wide.melt(id_vars=['Name'], var_name='Subject', value_name='Score') # Name Subject Score # 0 Alice Math 85 # 1 Bob Math 90 # 2 Alice English 92 # 3 Bob English 88 ## (2) 长变宽 df_wide = df_long.pivot(index='Name', columns='Subject', values='Score') # Subject English Math # Name # Alice 92 85 # Bob 88 90 ",
  "wordCount" : "4749",
  "inLanguage": "en",
  "datePublished": "2022-05-03T00:00:00Z",
  "dateModified": "2022-05-10T00:00:00Z",
  "author":[{
    "@type": "Person",
    "name": "Lishensuo"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://lishensuo.github.io/en/posts/program/022python%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6-pandas%E8%A1%A8%E6%A0%BC/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Li's Bioinfo-Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://lishensuo.github.io/img/Q.gif"
    }
  }
}
</script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://lishensuo.github.io/en/" accesskey="h" title="Li&#39;s Bioinfo-Blog (Alt + H)">Li&#39;s Bioinfo-Blog</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                </ul>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://lishensuo.github.io/en/" title="主页">
                    <span>主页</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/posts" title="分类">
                    <span>分类</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/tags" title="标签">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/archives/" title="归档">
                    <span>归档</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/about" title="关于">
                    <span>关于</span>
                </a>
            </li>
            <li>
                <a href="https://lishensuo.github.io/en/search" title="搜索 (Alt &#43; /)" accesskey=/>
                    <span>搜索</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://lishensuo.github.io/en/">Home</a>&nbsp;»&nbsp;<a href="https://lishensuo.github.io/en/posts/">分类</a>&nbsp;»&nbsp;<a href="https://lishensuo.github.io/en/posts/program/">📖 R&amp;Python&amp;Shell --- 编程基础、可视化等</a></div>
    <h1 class="post-title">
      Python数据科学-(3)Pandas表格
    </h1>
    <div class="post-meta">













Create:&amp;nbsp;&lt;span title=&#39;2022-05-03 00:00:00 &#43;0000 UTC&#39;&gt;2022-05-03&lt;/span&gt;&amp;nbsp;|&amp;nbsp;Update:&amp;nbsp;2022-05-10&amp;nbsp;|&amp;nbsp;Words:&amp;nbsp;4749&amp;nbsp;|&amp;nbsp;10 min&amp;nbsp;|&amp;nbsp;Lishensuo

|  Viewers: <span id="busuanzi_value_page_pv"></span> 
	  
    </div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">Table of Contents</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#1pandas%e7%bb%93%e6%9e%84" aria-label="1、Pandas结构">1、Pandas结构</a><ul>
                            
                    <li>
                        <a href="#11-series%e6%9c%89%e7%b4%a2%e5%bc%95%e7%9a%84%e4%b8%80%e7%bb%b4%e6%95%b0%e7%bb%84" aria-label="1.1 Series：有索引的一维数组">1.1 Series：有索引的一维数组</a><ul>
                            
                    <li>
                        <a href="#111-%e5%88%9b%e5%bb%baseries%e5%af%b9%e8%b1%a1" aria-label="1.1.1 创建Series对象">1.1.1 创建Series对象</a></li>
                    <li>
                        <a href="#112-series%e5%af%b9%e8%b1%a1%e6%93%8d%e4%bd%9c" aria-label="1.1.2 Series对象操作">1.1.2 Series对象操作</a></li></ul>
                    </li>
                    <li>
                        <a href="#12-dataframe%e5%a4%9a%e4%b8%aaseries%e5%af%b9%e8%b1%a1%e7%bb%84%e6%88%90" aria-label="1.2 DataFrame：多个Series对象组成">1.2 DataFrame：多个Series对象组成</a><ul>
                            
                    <li>
                        <a href="#121-%e5%88%9b%e5%bb%badataframe%e5%af%b9%e8%b1%a1" aria-label="1.2.1 创建DataFrame对象">1.2.1 创建DataFrame对象</a></li>
                    <li>
                        <a href="#122-dataframe%e5%af%b9%e8%b1%a1%e6%93%8d%e4%bd%9c" aria-label="1.2.2 DataFrame对象操作">1.2.2 DataFrame对象操作</a></li></ul>
                    </li>
                    <li>
                        <a href="#13-index%e7%b4%a2%e5%bc%95%e5%88%97%e5%90%8d%e8%a1%8c%e5%90%8d" aria-label="1.3 Index索引=列名&#43;行名">1.3 Index索引=列名+行名</a><ul>
                            
                    <li>
                        <a href="#131-index%e7%b4%a2%e5%bc%95%e5%af%b9%e8%b1%a1" aria-label="1.3.1 Index索引对象">1.3.1 Index索引对象</a></li>
                    <li>
                        <a href="#132-index%e7%b4%a2%e5%bc%95%e4%bf%ae%e6%94%b9" aria-label="1.3.2 Index索引修改">1.3.2 Index索引修改</a></li></ul>
                    </li></ul>
                    </li>
                    <li>
                        <a href="#2%e7%bc%ba%e5%a4%b1%e5%80%bc%e5%a4%84%e7%90%86" aria-label="2、缺失值处理">2、缺失值处理</a><ul>
                            
                    <li>
                        <a href="#21-numpy%e4%b8%ad%e7%9a%84%e7%bc%ba%e5%a4%b1%e5%80%bc" aria-label="2.1 numpy中的缺失值">2.1 numpy中的缺失值</a></li>
                    <li>
                        <a href="#22-pandas%e5%a4%84%e7%90%86%e7%bc%ba%e5%a4%b1%e5%80%bc" aria-label="2.2 Pandas处理缺失值">2.2 Pandas处理缺失值</a></li></ul>
                    </li>
                    <li>
                        <a href="#3pandas%e8%bf%90%e7%ae%97%e4%b8%8e%e7%bb%9f%e8%ae%a1" aria-label="3、Pandas运算与统计">3、Pandas运算与统计</a><ul>
                            
                    <li>
                        <a href="#31-pandas%e8%bf%90%e7%ae%97" aria-label="3.1 Pandas运算">3.1 Pandas运算</a></li>
                    <li>
                        <a href="#32-pandas%e7%bb%9f%e8%ae%a1" aria-label="3.2 Pandas统计">3.2 Pandas统计</a><ul>
                            
                    <li>
                        <a href="#321-%e5%9f%ba%e7%a1%80%e7%bb%9f%e8%ae%a1" aria-label="3.2.1 基础统计">3.2.1 基础统计</a></li>
                    <li>
                        <a href="#322-%e5%88%86%e7%bb%84%e7%bb%9f%e8%ae%a1" aria-label="3.2.2 分组统计">3.2.2 分组统计</a></li></ul>
                    </li>
                    <li>
                        <a href="#33-pandas%e6%8e%92%e5%ba%8f" aria-label="3.3 Pandas排序">3.3 Pandas排序</a></li></ul>
                    </li>
                    <li>
                        <a href="#4%e5%ad%97%e7%ac%a6%e4%b8%b2%e5%88%97%e5%a4%84%e7%90%86" aria-label="4、字符串列处理">4、字符串列处理</a></li>
                    <li>
                        <a href="#5dataframe%e7%ad%9b%e9%80%89%e4%b8%8e%e4%bf%ae%e6%94%b9" aria-label="5、DataFrame筛选与修改">5、DataFrame筛选与修改</a></li>
                    <li>
                        <a href="#6dataframe%e5%90%88%e5%b9%b6" aria-label="6、DataFrame合并">6、DataFrame合并</a><ul>
                            
                    <li>
                        <a href="#61-pdconcat" aria-label="6.1 pd.concat">6.1 pd.concat</a></li>
                    <li>
                        <a href="#62-pdmerge" aria-label="6.2 pd.merge">6.2 pd.merge</a><ul>
                            
                    <li>
                        <a href="#621-%e6%9c%89%e7%9b%b8%e5%90%8c%e5%88%97%e5%88%97%e5%90%8d%e7%9b%b8%e5%90%8c" aria-label="6.2.1 有相同列，列名相同">6.2.1 有相同列，列名相同</a></li>
                    <li>
                        <a href="#622-%e6%9c%89%e7%9b%b8%e5%90%8c%e5%88%97%e5%88%97%e5%90%8d%e4%b8%8d%e5%90%8c" aria-label="6.2.2 有相同列，列名不同">6.2.2 有相同列，列名不同</a></li>
                    <li>
                        <a href="#623-%e5%88%97%e7%9a%84%e5%86%85%e5%ae%b9%e4%b8%8d%e5%ae%8c%e5%85%a8%e7%9b%b8%e5%90%8c" aria-label="6.2.3 列的内容不完全相同">6.2.3 列的内容不完全相同</a></li></ul>
                    </li></ul>
                    </li>
                    <li>
                        <a href="#7dataframe%e5%af%bc%e5%85%a5%e4%b8%8e%e5%af%bc%e5%87%ba" aria-label="7、DataFrame导入与导出">7、DataFrame导入与导出</a><ul>
                            
                    <li>
                        <a href="#71-%e5%af%bc%e5%87%ba" aria-label="7.1 导出">7.1 导出</a></li>
                    <li>
                        <a href="#72-%e5%af%bc%e5%85%a5" aria-label="7.2 导入">7.2 导入</a></li></ul>
                    </li>
                    <li>
                        <a href="#8%e9%95%bf%e5%ae%bd%e8%bd%ac%e6%8d%a2" aria-label="8、长宽转换">8、长宽转换</a>
                    </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>


  <div class="post-content"><blockquote>
<p>Pandas相比Numpy数组支持行列标签、多种数据类型，类似R语言中data.frame数据框。</p>
<img src="https://raw.githubusercontent.com/lishensuo/images/main/20354525-b4c441acfb525f6e.png" alt="img" style="zoom: 33%;" /></blockquote>
<h1 id="1pandas结构">1、Pandas结构<a hidden class="anchor" aria-hidden="true" href="#1pandas结构">#</a></h1>
<h2 id="11-series有索引的一维数组">1.1 Series：有索引的一维数组<a hidden class="anchor" aria-hidden="true" href="#11-series有索引的一维数组">#</a></h2>
<h3 id="111-创建series对象">1.1.1 创建Series对象<a hidden class="anchor" aria-hidden="true" href="#111-创建series对象">#</a></h3>
<ul>
<li>通过<code>pd.Serise</code>函数创建</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#007f7f">##(1) 通过index参数设置索引</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> pandas <span style="color:#fff;font-weight:bold">as</span> pd
</span></span><span style="display:flex;"><span>data = pd.Series([<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#ff0;font-weight:bold">5</span>], index=[<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;b&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;c&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;d&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;e&#39;</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#a    1</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#b    2</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#c    3</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#d    4</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#e    5</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#dtype: int64</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2)如不设置index参数，则索引默认为 range(len)</span>
</span></span><span style="display:flex;"><span>data1 = pd.Series([<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#ff0;font-weight:bold">5</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(3)也可以以字典的形式创建，键值分别对应索引与值</span>
</span></span><span style="display:flex;"><span>data2 = pd.Series({<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>:<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#0ff;font-weight:bold">&#39;b&#39;</span>:<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#0ff;font-weight:bold">&#39;c&#39;</span>:<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#0ff;font-weight:bold">&#39;d&#39;</span>:<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#0ff;font-weight:bold">&#39;e&#39;</span>:<span style="color:#ff0;font-weight:bold">5</span>})
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="112-series对象操作">1.1.2 Series对象操作<a hidden class="anchor" aria-hidden="true" href="#112-series对象操作">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> pandas <span style="color:#fff;font-weight:bold">as</span> pd
</span></span><span style="display:flex;"><span>data = pd.Series([<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#ff0;font-weight:bold">5</span>], index=[<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;b&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;c&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;d&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;e&#39;</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(1) 提取Series的一维数组与索引标签</span>
</span></span><span style="display:flex;"><span>data.values
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># array([1, 2, 3, 4, 5])</span>
</span></span><span style="display:flex;"><span>data.index
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Index([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;], dtype=&#39;object&#39;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2) 按显示索引取Series子集</span>
</span></span><span style="display:flex;"><span>data[<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>] 
</span></span><span style="display:flex;"><span>data[<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;c&#39;</span>]
</span></span><span style="display:flex;"><span>data[[<span style="color:#0ff;font-weight:bold">&#34;a&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;c&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;e&#34;</span>]]
</span></span><span style="display:flex;"><span>data[data&gt;<span style="color:#ff0;font-weight:bold">3</span>]
</span></span><span style="display:flex;"><span>data.loc[<span style="color:#0ff;font-weight:bold">&#34;a&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;c&#34;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(3) 按隐式索引取Series子集</span>
</span></span><span style="display:flex;"><span>data[<span style="color:#ff0;font-weight:bold">0</span>]
</span></span><span style="display:flex;"><span>data[<span style="color:#ff0;font-weight:bold">0</span>:<span style="color:#ff0;font-weight:bold">3</span>]
</span></span><span style="display:flex;"><span>data[[<span style="color:#ff0;font-weight:bold">0</span>,<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">4</span>]]
</span></span><span style="display:flex;"><span>data.iloc[<span style="color:#ff0;font-weight:bold">1</span>:<span style="color:#ff0;font-weight:bold">3</span>]
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><code>.loc</code>与<code>.iloc</code>的作用主要体现在：Series的index也是数值型时，容易与隐式索引混淆。</p></blockquote>
<h2 id="12-dataframe多个series对象组成">1.2 DataFrame：多个Series对象组成<a hidden class="anchor" aria-hidden="true" href="#12-dataframe多个series对象组成">#</a></h2>
<p>DataFrame对象可以认为是多个等长、索引值对应相同的Series对象组成</p>
<h3 id="121-创建dataframe对象">1.2.1 创建DataFrame对象<a hidden class="anchor" aria-hidden="true" href="#121-创建dataframe对象">#</a></h3>
<ul>
<li>通过<code>pd.DataFrame</code>创建</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#007f7f">##(1) 单个Series转为DataFrame,通过columns参数设置列名</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> pandas <span style="color:#fff;font-weight:bold">as</span> pd
</span></span><span style="display:flex;"><span>s1 = pd.Series({<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>:<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#0ff;font-weight:bold">&#39;b&#39;</span>:<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#0ff;font-weight:bold">&#39;c&#39;</span>:<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#0ff;font-weight:bold">&#39;d&#39;</span>:<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#0ff;font-weight:bold">&#39;e&#39;</span>:<span style="color:#ff0;font-weight:bold">5</span>})
</span></span><span style="display:flex;"><span>d1 = pd.DataFrame(s1, columns=[<span style="color:#0ff;font-weight:bold">&#34;col_01&#34;</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   col_01</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#a       1</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#b       2</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#c       3</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#d       4</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#e       5</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2) 多个相同索引的Series对象构成的字典</span>
</span></span><span style="display:flex;"><span>s2 = pd.Series({<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;Dog&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;b&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;Cat&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;c&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;Pig&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;d&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;Cow&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;e&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;Sheep&#34;</span>})
</span></span><span style="display:flex;"><span>pd.DataFrame({<span style="color:#0ff;font-weight:bold">&#34;col_1&#34;</span>:s1, <span style="color:#0ff;font-weight:bold">&#34;col_2&#34;</span>:s2})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(3) 通过字典列表创建：每个子字典代表一行；键名表示列名，可通过index设置行名</span>
</span></span><span style="display:flex;"><span>pd.DataFrame([{<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>:<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#0ff;font-weight:bold">&#39;b&#39;</span>:<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#0ff;font-weight:bold">&#39;c&#39;</span>:<span style="color:#ff0;font-weight:bold">3</span>},
</span></span><span style="display:flex;"><span>              {<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>:<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#0ff;font-weight:bold">&#39;b&#39;</span>:<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#0ff;font-weight:bold">&#39;c&#39;</span>:<span style="color:#ff0;font-weight:bold">6</span>}], 
</span></span><span style="display:flex;"><span>             index=[<span style="color:#0ff;font-weight:bold">&#34;XiaoLi&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;XiaoWang&#34;</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#          a  b  c</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#XiaoLi    1  2  3</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#XiaoWang  2  4  6</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(4) 将NumPy二维数组转为DataFrame</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> numpy <span style="color:#fff;font-weight:bold">as</span> np
</span></span><span style="display:flex;"><span>pd.DataFrame(np.random.randint(<span style="color:#ff0;font-weight:bold">0</span>,<span style="color:#ff0;font-weight:bold">10</span>,(<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">3</span>)),
</span></span><span style="display:flex;"><span>             columns=[<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;b&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;c&#39;</span>],
</span></span><span style="display:flex;"><span>             index=[<span style="color:#0ff;font-weight:bold">&#39;sp1&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;sp2&#39;</span>])
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="122-dataframe对象操作">1.2.2 DataFrame对象操作<a hidden class="anchor" aria-hidden="true" href="#122-dataframe对象操作">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> pandas <span style="color:#fff;font-weight:bold">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> numpy <span style="color:#fff;font-weight:bold">as</span> np
</span></span><span style="display:flex;"><span>s1 = pd.Series(np.random.choice(<span style="color:#ff0;font-weight:bold">10</span>,<span style="color:#ff0;font-weight:bold">5</span>,replace=<span style="color:#fff;font-weight:bold">False</span>), 
</span></span><span style="display:flex;"><span>               index=[<span style="color:#0ff;font-weight:bold">&#34;stuA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuB&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuD&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuE&#39;</span>])
</span></span><span style="display:flex;"><span>s2 = pd.Series(np.random.randint(<span style="color:#ff0;font-weight:bold">60</span>,<span style="color:#ff0;font-weight:bold">100</span>,<span style="color:#ff0;font-weight:bold">5</span>), 
</span></span><span style="display:flex;"><span>               index=[<span style="color:#0ff;font-weight:bold">&#34;stuA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuB&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuD&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuE&#39;</span>])
</span></span><span style="display:flex;"><span>s3 = pd.Series([<span style="color:#0ff;font-weight:bold">&#39;class01&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;class01&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;class02&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;class02&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;class02&#39;</span>], 
</span></span><span style="display:flex;"><span>               index=[<span style="color:#0ff;font-weight:bold">&#34;stuA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuB&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuD&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuE&#39;</span>])
</span></span><span style="display:flex;"><span>df = pd.DataFrame({<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:s1,<span style="color:#0ff;font-weight:bold">&#34;Score&#34;</span>:s2,<span style="color:#0ff;font-weight:bold">&#34;Class&#34;</span>:s3})
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#      Grade  Score    Class</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#stuA      3     95  class01</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#stuB      9     96  class01</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#stuC      1     85  class02</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#stuD      5     76  class02</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#stuE      8     70  class02</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(0) 初步探索</span>
</span></span><span style="display:flex;"><span>df.head()
</span></span><span style="display:flex;"><span>df.info()    <span style="color:#007f7f">#表格概述信息</span>
</span></span><span style="display:flex;"><span>df.dtypes    <span style="color:#007f7f">#每列的数据类型</span>
</span></span><span style="display:flex;"><span>df.shape
</span></span><span style="display:flex;"><span>df.size
</span></span><span style="display:flex;"><span>df.values    <span style="color:#007f7f">#返回二维数组</span>
</span></span><span style="display:flex;"><span>df.T         <span style="color:#007f7f">#行列转换</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(1)获取行、列名（均为Index对象）以及值</span>
</span></span><span style="display:flex;"><span>df.index   <span style="color:#007f7f">#行名</span>
</span></span><span style="display:flex;"><span>df.columns <span style="color:#007f7f">#列名</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2)返回列</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>]
</span></span><span style="display:flex;"><span>df.Grade
</span></span><span style="display:flex;"><span>df[[<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;Score&#39;</span>]]
</span></span><span style="display:flex;"><span>df.loc[:,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>]
</span></span><span style="display:flex;"><span>df.iloc[:,<span style="color:#ff0;font-weight:bold">0</span>:<span style="color:#ff0;font-weight:bold">3</span>]
</span></span><span style="display:flex;"><span>df[<span style="color:#0ff;font-weight:bold">&#39;newCol&#39;</span>] = <span style="color:#ff0;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(3)返回行</span>
</span></span><span style="display:flex;"><span>df.loc[<span style="color:#0ff;font-weight:bold">&#39;stuA&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>,:]
</span></span><span style="display:flex;"><span>df.loc[df[<span style="color:#0ff;font-weight:bold">&#34;Score&#34;</span>]&gt;<span style="color:#ff0;font-weight:bold">80</span>,:]
</span></span><span style="display:flex;"><span>df.loc[[<span style="color:#0ff;font-weight:bold">&#39;stuA&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>],:]
</span></span><span style="display:flex;"><span>df.iloc[<span style="color:#ff0;font-weight:bold">1</span>:<span style="color:#ff0;font-weight:bold">3</span>,:]
</span></span><span style="display:flex;"><span>df[<span style="color:#ff0;font-weight:bold">1</span>:<span style="color:#ff0;font-weight:bold">3</span>]
</span></span><span style="display:flex;"><span>df.iloc[[<span style="color:#ff0;font-weight:bold">0</span>,<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">4</span>],:]
</span></span><span style="display:flex;"><span>df[df.Grade&gt;<span style="color:#ff0;font-weight:bold">5</span>]  <span style="color:#007f7f">#筛选符合条件的行</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##注意：如果仅取DataFrame的一行/一列，会返回为Serires对象；可加上中括号，返回为DataFrame</span>
</span></span><span style="display:flex;"><span>df[[<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>]]
</span></span><span style="display:flex;"><span>df.loc[[<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>],:]
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="13-index索引列名行名">1.3 Index索引=列名+行名<a hidden class="anchor" aria-hidden="true" href="#13-index索引列名行名">#</a></h2>
<h3 id="131-index索引对象">1.3.1 Index索引对象<a hidden class="anchor" aria-hidden="true" href="#131-index索引对象">#</a></h3>
<p>如上Series有索引，DataFrame有行、列的索引。可以为数值型(int)或者字符型(object)</p>
<p>一方面Index可以认为是一维数组（不可改变其内容和顺序）；另一方面拥有集合对象的相关操作。</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> pandas <span style="color:#fff;font-weight:bold">as</span> pd
</span></span><span style="display:flex;"><span>idx = pd.Index([<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#ff0;font-weight:bold">5</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Int64Index([1, 2, 3, 4, 5], dtype=&#39;int64&#39;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(1) 数组相关操作</span>
</span></span><span style="display:flex;"><span>idx[<span style="color:#ff0;font-weight:bold">0</span>]    <span style="color:#007f7f">#支持一维数组的各种取值方式</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">list</span>(idx) <span style="color:#007f7f">#转为普通列表</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2) 集合相关操作</span>
</span></span><span style="display:flex;"><span>idx2 = pd.Index([<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#ff0;font-weight:bold">5</span>,<span style="color:#ff0;font-weight:bold">6</span>,<span style="color:#ff0;font-weight:bold">7</span>])
</span></span><span style="display:flex;"><span>idx.intersection(idx2)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Int64Index([4, 5], dtype=&#39;int64&#39;)</span>
</span></span><span style="display:flex;"><span>idx.union(idx2)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="132-index索引修改">1.3.2 Index索引修改<a hidden class="anchor" aria-hidden="true" href="#132-index索引修改">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> pandas <span style="color:#fff;font-weight:bold">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> numpy <span style="color:#fff;font-weight:bold">as</span> np
</span></span><span style="display:flex;"><span>s1 = pd.Series(np.random.choice(<span style="color:#ff0;font-weight:bold">10</span>,<span style="color:#ff0;font-weight:bold">3</span>,replace=<span style="color:#fff;font-weight:bold">False</span>), 
</span></span><span style="display:flex;"><span>               index=[<span style="color:#0ff;font-weight:bold">&#34;stuA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuB&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>])
</span></span><span style="display:flex;"><span>s2 = pd.Series(np.random.randint(<span style="color:#ff0;font-weight:bold">60</span>,<span style="color:#ff0;font-weight:bold">100</span>,<span style="color:#ff0;font-weight:bold">3</span>), 
</span></span><span style="display:flex;"><span>               index=[<span style="color:#0ff;font-weight:bold">&#34;stuA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuB&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>])
</span></span><span style="display:flex;"><span>s3 = pd.Series([<span style="color:#0ff;font-weight:bold">&#39;class01&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;class01&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;class02&#39;</span>], 
</span></span><span style="display:flex;"><span>               index=[<span style="color:#0ff;font-weight:bold">&#34;stuA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuB&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>])
</span></span><span style="display:flex;"><span>s4 = pd.Series([<span style="color:#0ff;font-weight:bold">&#39;Zhang&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;Li&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;Liu&#39;</span>], 
</span></span><span style="display:flex;"><span>               index=[<span style="color:#0ff;font-weight:bold">&#34;stuA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuB&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>])
</span></span><span style="display:flex;"><span>df = pd.DataFrame({<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:s1,<span style="color:#0ff;font-weight:bold">&#34;Score&#34;</span>:s2,<span style="color:#0ff;font-weight:bold">&#34;Class&#34;</span>:s3,<span style="color:#0ff;font-weight:bold">&#34;Name&#34;</span>:s4})
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#      Grade  Score    Class   Name</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#stuA      0     60  class01  Zhang</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#stuB      8     65  class01     Li</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#stuC      2     80  class02    Liu</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(1)修改列名</span>
</span></span><span style="display:flex;"><span>df.rename(columns = {<span style="color:#0ff;font-weight:bold">&#34;Grade&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;Level&#34;</span>})  <span style="color:#007f7f"># {&#34;Old_name&#34;:&#34;New_name&#34;}</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2)将特定列变成行名</span>
</span></span><span style="display:flex;"><span>df.set_index(<span style="color:#0ff;font-weight:bold">&#34;Name&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(3)将行名变为列</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#0ff;font-weight:bold">&#34;ID&#34;</span>] = df.index
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="2缺失值处理">2、缺失值处理<a hidden class="anchor" aria-hidden="true" href="#2缺失值处理">#</a></h1>
<ul>
<li><code>None</code>是一个python对象，表示缺失值。在数组中属于object类型(字符串属于object类型)</li>
<li><code>NaN</code>是有numpy定义的缺失值，属于浮点型数据</li>
</ul>
<h2 id="21-numpy中的缺失值">2.1 numpy中的缺失值<a hidden class="anchor" aria-hidden="true" href="#21-numpy中的缺失值">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> numpy <span style="color:#fff;font-weight:bold">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> pandas <span style="color:#fff;font-weight:bold">as</span> pd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(1) None缺失值</span>
</span></span><span style="display:flex;"><span>n1 = np.array([<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#fff;font-weight:bold">None</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># array([1, 2, 3, None], dtype=object)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>n1.min()  <span style="color:#007f7f"># TypeError</span>
</span></span><span style="display:flex;"><span>n1.astype(np.float64)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#array([ 1.,  2.,  3., nan])</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2) NaN缺失值</span>
</span></span><span style="display:flex;"><span>n2 = np.array([<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">3</span>,np.nan])
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># array([ 1.,  2.,  3., nan])</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># dtype(&#39;float64&#39;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#含nan的一般统计运算都会返回nan值</span>
</span></span><span style="display:flex;"><span>n2.min()      <span style="color:#007f7f"># nan</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#可使用针对处理含有nan的numpy数据</span>
</span></span><span style="display:flex;"><span>np.nanmin(n1) <span style="color:#007f7f"># 1.0</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="22-pandas处理缺失值">2.2 Pandas处理缺失值<a hidden class="anchor" aria-hidden="true" href="#22-pandas处理缺失值">#</a></h2>
<ul>
<li>pandas将None也视为np.nan，即浮点类型的缺失值。记录为<code>NaN</code></li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pd.Series([<span style="color:#ff0;font-weight:bold">1</span>,np.nan,<span style="color:#ff0;font-weight:bold">3</span>, <span style="color:#fff;font-weight:bold">None</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#0    1.0</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#1    NaN</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#2    3.0</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#3    NaN</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#dtype: float64</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#当pandas整型数据中出现一个缺失值时，会自动转为浮点型数据</span>
</span></span><span style="display:flex;"><span>s1 = pd.Series(np.random.choice(<span style="color:#ff0;font-weight:bold">10</span>,<span style="color:#ff0;font-weight:bold">5</span>,replace=<span style="color:#fff;font-weight:bold">False</span>), 
</span></span><span style="display:flex;"><span>               index=[<span style="color:#0ff;font-weight:bold">&#34;stuA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuB&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuD&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuE&#39;</span>])
</span></span><span style="display:flex;"><span>s2 = pd.Series(np.random.randint(<span style="color:#ff0;font-weight:bold">60</span>,<span style="color:#ff0;font-weight:bold">100</span>,<span style="color:#ff0;font-weight:bold">5</span>), 
</span></span><span style="display:flex;"><span>               index=[<span style="color:#0ff;font-weight:bold">&#34;stuA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuB&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuD&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuE&#39;</span>])
</span></span><span style="display:flex;"><span>s3 = pd.Series([<span style="color:#0ff;font-weight:bold">&#39;class01&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;class01&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;class02&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;class02&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;class02&#39;</span>], 
</span></span><span style="display:flex;"><span>               index=[<span style="color:#0ff;font-weight:bold">&#34;stuA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuB&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuD&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuE&#39;</span>])
</span></span><span style="display:flex;"><span>df = pd.DataFrame({<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:s1,<span style="color:#0ff;font-weight:bold">&#34;Score&#34;</span>:s2,<span style="color:#0ff;font-weight:bold">&#34;Class&#34;</span>:s3})
</span></span><span style="display:flex;"><span>df.iloc[<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">0</span>:<span style="color:#ff0;font-weight:bold">2</span>]=<span style="color:#fff;font-weight:bold">None</span>
</span></span><span style="display:flex;"><span>df.iloc[<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#ff0;font-weight:bold">1</span>]=np.nan
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#       Grade  Score    Class</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuA    1.0   91.0  class01</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuB    3.0   61.0  class01</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuC    NaN    NaN  class02</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuD    0.0   94.0  class02</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuE    7.0    NaN  class02</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(1)判断缺失值</span>
</span></span><span style="display:flex;"><span>df.isnull()   <span style="color:#007f7f">#是否为缺失值</span>
</span></span><span style="display:flex;"><span>df.notnull()  <span style="color:#007f7f">#是否为非缺失值</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2)去除缺失值</span>
</span></span><span style="display:flex;"><span>df.dropna()       <span style="color:#007f7f">#删除含有缺失值的整行数据</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># axis=1 :删除含有缺失值的整列数据</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># how    :默认为&#39;any&#39;;&#39;all&#39;表示全为缺失值才删除</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(3)填补缺失值</span>
</span></span><span style="display:flex;"><span>df.fillna(<span style="color:#ff0;font-weight:bold">10</span>)             <span style="color:#007f7f">#固定值填充</span>
</span></span><span style="display:flex;"><span>df.fillna(method=<span style="color:#0ff;font-weight:bold">&#39;ffill&#39;</span>) <span style="color:#007f7f">#使用缺失值前面的数据填充</span>
</span></span><span style="display:flex;"><span>df.fillna(method=<span style="color:#0ff;font-weight:bold">&#39;bfill&#39;</span>) <span style="color:#007f7f">#使用缺失值后面的数据填充</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="3pandas运算与统计">3、Pandas运算与统计<a hidden class="anchor" aria-hidden="true" href="#3pandas运算与统计">#</a></h1>
<h2 id="31-pandas运算">3.1 Pandas运算<a hidden class="anchor" aria-hidden="true" href="#31-pandas运算">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> pandas <span style="color:#fff;font-weight:bold">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> numpy <span style="color:#fff;font-weight:bold">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(1)整体算数运算：适用于介绍的np算法运算, 不影响原有结构</span>
</span></span><span style="display:flex;"><span>s1 = pd.Series({<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>:<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#0ff;font-weight:bold">&#39;b&#39;</span>:<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#0ff;font-weight:bold">&#39;c&#39;</span>:<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#0ff;font-weight:bold">&#39;d&#39;</span>:<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#0ff;font-weight:bold">&#39;e&#39;</span>:<span style="color:#ff0;font-weight:bold">5</span>})  
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#a    1</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#b    2</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#c    3</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#d    4</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#e    5</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#dtype: int64</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df1 = pd.DataFrame(np.random.randint(<span style="color:#ff0;font-weight:bold">0</span>,<span style="color:#ff0;font-weight:bold">10</span>,(<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">3</span>)),
</span></span><span style="display:flex;"><span>                   columns=[<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;b&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;c&#39;</span>],
</span></span><span style="display:flex;"><span>                   index=[<span style="color:#0ff;font-weight:bold">&#39;sp1&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;sp2&#39;</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#     a  b  c</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#sp1  5  9  4</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#sp2  6  3  4</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>np.log(s1 + <span style="color:#ff0;font-weight:bold">1</span>)
</span></span><span style="display:flex;"><span>df1 / <span style="color:#ff0;font-weight:bold">10</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2)Series之间索引对齐运算：即使顺序不同，按照索引一一对应计算</span>
</span></span><span style="display:flex;"><span>s2 = pd.Series({<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>:<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#0ff;font-weight:bold">&#39;d&#39;</span>:<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#0ff;font-weight:bold">&#39;e&#39;</span>:<span style="color:#ff0;font-weight:bold">5</span>,<span style="color:#0ff;font-weight:bold">&#39;b&#39;</span>:<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#0ff;font-weight:bold">&#39;c&#39;</span>:<span style="color:#ff0;font-weight:bold">3</span>})   
</span></span><span style="display:flex;"><span>s1 + s2
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#如果索引不一致，按全集处理，用NaN填充</span>
</span></span><span style="display:flex;"><span>s3 = pd.Series({<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>:<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#0ff;font-weight:bold">&#39;d&#39;</span>:<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#0ff;font-weight:bold">&#39;e&#39;</span>:<span style="color:#ff0;font-weight:bold">5</span>})   
</span></span><span style="display:flex;"><span>s1 + s3
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(3)DataFrame与Series(行/列)之间运算</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#按行</span>
</span></span><span style="display:flex;"><span>ss1 = pd.Series({<span style="color:#0ff;font-weight:bold">&#39;a&#39;</span>:<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#0ff;font-weight:bold">&#39;b&#39;</span>:<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#0ff;font-weight:bold">&#39;c&#39;</span>:<span style="color:#ff0;font-weight:bold">3</span>})  
</span></span><span style="display:flex;"><span>df1 - ss1                                   <span style="color:#007f7f">#所有行相减</span>
</span></span><span style="display:flex;"><span>df1.loc[[<span style="color:#0ff;font-weight:bold">&#34;sp1&#34;</span>],:]=df1.loc[[<span style="color:#0ff;font-weight:bold">&#34;sp1&#34;</span>],:]-ss1   <span style="color:#007f7f">#特定行相减 </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#按列</span>
</span></span><span style="display:flex;"><span>ss2 = pd.Series({<span style="color:#0ff;font-weight:bold">&#39;sp1&#39;</span>:<span style="color:#ff0;font-weight:bold">10</span>,<span style="color:#0ff;font-weight:bold">&#39;sp2&#39;</span>:<span style="color:#ff0;font-weight:bold">20</span>})  
</span></span><span style="display:flex;"><span>df1.subtract(ss2, axis=<span style="color:#ff0;font-weight:bold">0</span>)                   <span style="color:#007f7f">#所有列相减</span>
</span></span><span style="display:flex;"><span>df1.loc[:,<span style="color:#0ff;font-weight:bold">&#34;a&#34;</span>] = df1.loc[:,<span style="color:#0ff;font-weight:bold">&#34;a&#34;</span>] - ss2       <span style="color:#007f7f">#特定列相减</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>如上，Series之间或者DataFrame与Series按行按列之间计算时，会考虑索引对齐的问题；如果索引不一致，会取全集，用NaN填补。如果Series/DataFrame是与数组/列表运算，则必须保持运算双方维度一致，并且按顺序计算。</p></blockquote>
<h2 id="32-pandas统计">3.2 Pandas统计<a hidden class="anchor" aria-hidden="true" href="#32-pandas统计">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> pandas <span style="color:#fff;font-weight:bold">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> numpy <span style="color:#fff;font-weight:bold">as</span> np
</span></span><span style="display:flex;"><span>df = pd.DataFrame(np.random.randint(<span style="color:#ff0;font-weight:bold">0</span>,<span style="color:#ff0;font-weight:bold">100</span>,(<span style="color:#ff0;font-weight:bold">10</span>,<span style="color:#ff0;font-weight:bold">6</span>)),
</span></span><span style="display:flex;"><span>             index= [<span style="color:#0ff;font-weight:bold">&#34;stu</span><span style="color:#0ff;font-weight:bold">%s</span><span style="color:#0ff;font-weight:bold">&#34;</span> % (x) <span style="color:#fff;font-weight:bold">for</span> x in <span style="color:#fff;font-weight:bold">range</span>(<span style="color:#ff0;font-weight:bold">10</span>)],
</span></span><span style="display:flex;"><span>             columns=[<span style="color:#0ff;font-weight:bold">&#34;col1&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;col2&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;col3&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;col4&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;col5&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;col6&#34;</span>])
</span></span><span style="display:flex;"><span>df[<span style="color:#0ff;font-weight:bold">&#34;Group&#34;</span>] = [<span style="color:#0ff;font-weight:bold">&#34;Group</span><span style="color:#0ff;font-weight:bold">%s</span><span style="color:#0ff;font-weight:bold">&#34;</span> % (x) <span style="color:#fff;font-weight:bold">for</span> x in <span style="color:#fff;font-weight:bold">list</span>(<span style="color:#0ff;font-weight:bold">&#34;A&#34;</span>*<span style="color:#ff0;font-weight:bold">5</span> + <span style="color:#0ff;font-weight:bold">&#34;B&#34;</span>*<span style="color:#ff0;font-weight:bold">5</span>)]
</span></span><span style="display:flex;"><span>df.head()
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#       col1  col2  col3  col4  col5  col6   Group</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stu0     0    30    31    72    20     2  GroupA</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stu1    11    47    47    53    92    80  GroupA</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stu2    47    39    11    25    78    57  GroupA</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stu3    15    90    57    28    90    54  GroupA</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stu4    30     9    92    85    40     7  GroupA</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Pandas内置常用数值列统计方法有</li>
</ul>
<p><code>count()</code> 计(行)数（但是会忽略NA值，需要格外注意）</p>
<p><code>first()</code>, <code>last()</code> 第一项与最后一项</p>
<p><code>sum()</code> 求和</p>
<p><code>mean()</code>, <code>median()</code>, <code>min()</code>, <code>max()</code></p>
<p><code>std()</code>, <code>var()</code>, <code>mad()</code></p>
<p><code>describe()</code> 可以计算每一列的若干常用统计值</p>
<h3 id="321-基础统计">3.2.1 基础统计<a hidden class="anchor" aria-hidden="true" href="#321-基础统计">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span><span style="color:#007f7f">##(1)数值列统计方法默认只会对数值列统计</span>
</span></span><span style="display:flex;"><span>df.col1.sum()
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 349</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df.mean()
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># col1    34.9</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># col2    39.8</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># col3    54.2</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># col4    34.9</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># col5    64.4</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># col6    43.5</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># dtype: float64</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df.describe()
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#             col1       col2       col3       col4       col5     col6</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># count  10.000000  10.000000  10.000000  10.000000  10.000000  10.0000</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># mean   34.900000  39.800000  54.200000  34.900000  64.400000  43.5000</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># std    23.811528  24.548365  31.688764  27.404176  31.885908  26.7426</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># min     0.000000   9.000000   2.000000   1.000000  11.000000   2.0000</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 25%    17.250000  23.250000  35.000000  19.000000  42.250000  28.2500</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 50%    31.000000  36.000000  56.500000  28.500000  78.000000  50.0000</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 75%    50.750000  47.000000  78.500000  48.250000  89.250000  56.2500</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># max    70.000000  90.000000  92.000000  85.000000  99.000000  80.0000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2)统计分类</span>
</span></span><span style="display:flex;"><span>df.Group.value_counts()                <span style="color:#007f7f">#频数</span>
</span></span><span style="display:flex;"><span>df.Group.value_counts(normalize=True)  <span style="color:#007f7f">#百分比</span>
</span></span><span style="display:flex;"><span>df.Group.unique()                      <span style="color:#007f7f">#唯一值</span>
</span></span><span style="display:flex;"><span>df.describe(include=[<span style="color:#0ff;font-weight:bold">&#34;O&#34;</span>])             <span style="color:#007f7f">#分别统计所有字符串列</span>
</span></span><span style="display:flex;"><span>pd.crosstab(df.Group, df.Group)        <span style="color:#007f7f">#类似R语言的table()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="322-分组统计">3.2.2 分组统计<a hidden class="anchor" aria-hidden="true" href="#322-分组统计">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#007f7f">##(1) 指定DataFrame表格中的表示分组信息的列，进行分组统计</span>
</span></span><span style="display:flex;"><span>df.groupby(<span style="color:#0ff;font-weight:bold">&#39;Group&#39;</span>)[<span style="color:#0ff;font-weight:bold">&#34;col2&#34;</span>].mean()                            <span style="color:#007f7f">#根据分组列，分组统计1列的值</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Group</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># GroupA    43.0</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># GroupB    36.6</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Name: col2, dtype: float64</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df.groupby(<span style="color:#0ff;font-weight:bold">&#39;Group&#39;</span>, as_index=<span style="color:#fff;font-weight:bold">False</span>).mean()                    <span style="color:#007f7f">#根据分组列，分组统计所有列的值</span>
</span></span><span style="display:flex;"><span>df.groupby(<span style="color:#0ff;font-weight:bold">&#39;Group&#39;</span>)[<span style="color:#0ff;font-weight:bold">&#34;col2&#34;</span>].agg([<span style="color:#0ff;font-weight:bold">&#34;min&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;max&#34;</span>])                <span style="color:#007f7f">#根据分组列，分组统计1列的多个指标</span>
</span></span><span style="display:flex;"><span>df.groupby(<span style="color:#0ff;font-weight:bold">&#39;Group&#39;</span>)[<span style="color:#0ff;font-weight:bold">&#34;col2&#34;</span>].describe()                        <span style="color:#007f7f">#根据分组列，分组统计1列的多个指标</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2) 指定其它能够表示分组信息的，列表、Serises、字典等进行分组统计</span>
</span></span><span style="display:flex;"><span>Class = [<span style="color:#0ff;font-weight:bold">&#34;Class01&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;Class01&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;Class01&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;Class02&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;Class02&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;Class02&#34;</span>,
</span></span><span style="display:flex;"><span>         <span style="color:#0ff;font-weight:bold">&#34;Class03&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;Class03&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;Class03&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;Class03&#34;</span>]
</span></span><span style="display:flex;"><span>df.groupby(Class)[<span style="color:#0ff;font-weight:bold">&#34;col2&#34;</span>].mean()  
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Class01    38.666667</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Class02    55.333333</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Class03    29.000000</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Name: col2, dtype: float64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="33-pandas排序">3.3 Pandas排序<a hidden class="anchor" aria-hidden="true" href="#33-pandas排序">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> pandas <span style="color:#fff;font-weight:bold">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> numpy <span style="color:#fff;font-weight:bold">as</span> np
</span></span><span style="display:flex;"><span>df = pd.DataFrame(np.random.randint(<span style="color:#ff0;font-weight:bold">0</span>,<span style="color:#ff0;font-weight:bold">100</span>,(<span style="color:#ff0;font-weight:bold">10</span>,<span style="color:#ff0;font-weight:bold">6</span>)),
</span></span><span style="display:flex;"><span>             index= [<span style="color:#0ff;font-weight:bold">&#34;stu</span><span style="color:#0ff;font-weight:bold">%s</span><span style="color:#0ff;font-weight:bold">&#34;</span> % (x) <span style="color:#fff;font-weight:bold">for</span> x in <span style="color:#fff;font-weight:bold">range</span>(<span style="color:#ff0;font-weight:bold">10</span>)],
</span></span><span style="display:flex;"><span>             columns=[<span style="color:#0ff;font-weight:bold">&#34;col1&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;col2&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;col3&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;col4&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;col5&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;col6&#34;</span>])
</span></span><span style="display:flex;"><span>df[<span style="color:#0ff;font-weight:bold">&#34;Group&#34;</span>] = [<span style="color:#0ff;font-weight:bold">&#34;Group</span><span style="color:#0ff;font-weight:bold">%s</span><span style="color:#0ff;font-weight:bold">&#34;</span> % (x) <span style="color:#fff;font-weight:bold">for</span> x in <span style="color:#fff;font-weight:bold">list</span>(<span style="color:#0ff;font-weight:bold">&#34;A&#34;</span>*<span style="color:#ff0;font-weight:bold">5</span> + <span style="color:#0ff;font-weight:bold">&#34;B&#34;</span>*<span style="color:#ff0;font-weight:bold">5</span>)]
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>df.sort_values(<span style="color:#0ff;font-weight:bold">&#34;col1&#34;</span>)                  <span style="color:#007f7f">#按照指定列升序排列</span>
</span></span><span style="display:flex;"><span>df.sort_values(<span style="color:#0ff;font-weight:bold">&#34;col1&#34;</span>, ascending=<span style="color:#fff;font-weight:bold">False</span>) <span style="color:#007f7f">#按照指定列降序排列</span>
</span></span><span style="display:flex;"><span>df.sort_values([<span style="color:#0ff;font-weight:bold">&#34;col1&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;col2&#34;</span>], 
</span></span><span style="display:flex;"><span>               ascending=[<span style="color:#fff;font-weight:bold">True</span>, <span style="color:#fff;font-weight:bold">False</span>])
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="4字符串列处理">4、字符串列处理<a hidden class="anchor" aria-hidden="true" href="#4字符串列处理">#</a></h1>
<p>Pandas为DataFrame对象的字符串列(也包括Series对象)提供了<code>str</code>属性，提供了许多<strong>向量化</strong>处理字符串的方法，其中很多与Python的字符串方法相似。</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> pandas <span style="color:#fff;font-weight:bold">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> numpy <span style="color:#fff;font-weight:bold">as</span> np
</span></span><span style="display:flex;"><span>s1 = pd.Series(<span style="color:#fff;font-weight:bold">list</span>(<span style="color:#0ff;font-weight:bold">&#34;ABBAC&#34;</span>), 
</span></span><span style="display:flex;"><span>               index=[<span style="color:#0ff;font-weight:bold">&#34;stuA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuB&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuD&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuE&#39;</span>])
</span></span><span style="display:flex;"><span>s2 = pd.Series(np.random.randint(<span style="color:#ff0;font-weight:bold">60</span>,<span style="color:#ff0;font-weight:bold">100</span>,<span style="color:#ff0;font-weight:bold">5</span>), 
</span></span><span style="display:flex;"><span>               index=[<span style="color:#0ff;font-weight:bold">&#34;stuA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuB&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuD&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuE&#39;</span>])
</span></span><span style="display:flex;"><span>s3 = pd.Series([<span style="color:#0ff;font-weight:bold">&#39;class01&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;class01&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;class02&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;class02&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;class02&#39;</span>], 
</span></span><span style="display:flex;"><span>               index=[<span style="color:#0ff;font-weight:bold">&#34;stuA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuB&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuC&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuD&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;stuE&#39;</span>])
</span></span><span style="display:flex;"><span>df = pd.DataFrame({<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:s1,<span style="color:#0ff;font-weight:bold">&#34;Score&#34;</span>:s2,<span style="color:#0ff;font-weight:bold">&#34;Class&#34;</span>:s3})
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#      Grade  Score    Class</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuA     A     84  class01</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuB     B     68  class01</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuC     B     84  class02</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuD     A     78  class02</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuE     C     74  class02</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(1) Python处理字符串方法</span>
</span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">&#34;level &#34;</span> + df.Grade 
</span></span><span style="display:flex;"><span>df.Grade.str.len()
</span></span><span style="display:flex;"><span>df.Class.str.upper()
</span></span><span style="display:flex;"><span>df.Class.str.split(<span style="color:#0ff;font-weight:bold">&#34;0&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuA    [class, 1]</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuB    [class, 1]</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuC    [class, 2]</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuD    [class, 2]</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># stuE    [class, 2]</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Name: Class, dtype: object</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2) 正则化处理字符串，类似 re 模块</span>
</span></span><span style="display:flex;"><span>df.Class.str.<span style="color:#fff;font-weight:bold">match</span>(<span style="color:#0ff;font-weight:bold">&#39;([A-Za-z]+)&#39;</span>)      <span style="color:#007f7f">#返回逻辑值</span>
</span></span><span style="display:flex;"><span>df.Class.str.extract(<span style="color:#0ff;font-weight:bold">&#39;([A-Za-z]+)&#39;</span>)    <span style="color:#007f7f">#提取匹配子字符串</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(3) 切片取值等</span>
</span></span><span style="display:flex;"><span>df.Class.str[<span style="color:#ff0;font-weight:bold">0</span>:<span style="color:#ff0;font-weight:bold">3</span>]
</span></span><span style="display:flex;"><span>df.Class.str.split(<span style="color:#0ff;font-weight:bold">&#34;0&#34;</span>).str.get(<span style="color:#ff0;font-weight:bold">0</span>)
</span></span><span style="display:flex;"><span>df.Class.str.split(<span style="color:#0ff;font-weight:bold">&#34;0&#34;</span>).str[<span style="color:#ff0;font-weight:bold">0</span>]
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="5dataframe筛选与修改">5、DataFrame筛选与修改<a hidden class="anchor" aria-hidden="true" href="#5dataframe筛选与修改">#</a></h1>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>import pandas as pd
</span></span><span style="display:flex;"><span>import numpy as np
</span></span><span style="display:flex;"><span>df = pd.DataFrame(np.random.randint(<span style="color:#ff0;font-weight:bold">0</span>,<span style="color:#ff0;font-weight:bold">100</span>,(<span style="color:#ff0;font-weight:bold">10</span>,<span style="color:#ff0;font-weight:bold">6</span>)),
</span></span><span style="display:flex;"><span>             index= [<span style="color:#0ff;font-weight:bold">&#34;stu%s&#34;</span> % (x) for x in range(10)],
</span></span><span style="display:flex;"><span>             columns=[&#34;col1&#34;,&#34;col2&#34;,&#34;col3&#34;,&#34;col4&#34;,&#34;col5&#34;,&#34;col6&#34;])
</span></span><span style="display:flex;"><span>df[&#34;Group&#34;] = [&#34;Group%s<span style="color:#0ff;font-weight:bold">&#34; % (x) for x in list(&#34;</span>A<span style="color:#0ff;font-weight:bold">&#34;*3 + &#34;</span>B<span style="color:#0ff;font-weight:bold">&#34;*3 + &#34;</span>C<span style="color:#0ff;font-weight:bold">&#34;*4)]
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">df.head()
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">      # col1  col2  col3  col4  col5  col6   Group
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold"># stu0    13    24    72    45    58    77  GroupA
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold"># stu1    93    29    67    38    95     7  GroupA
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold"># stu2    32    85    54    34    51    84  GroupA
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold"># stu3    16    92    36    10    51    67  GroupB
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold"># stu4    78    69    96    32     1    87  GroupB
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">               
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">#### 下述默认是指筛选到符合条件的行               
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">               
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">##(1) 数值列筛选
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">df[df.col1&gt;80]
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">               
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">##(2) 字符串列筛选
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">##可结合正则表达式匹配筛选
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">df[df.Group==&#34;</span>GroupA<span style="color:#0ff;font-weight:bold">&#34;]
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">##(3) 多个条件筛选
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">df[(df.col1&gt;50) &amp; (df.Group==&#34;</span>GroupA<span style="color:#0ff;font-weight:bold">&#34;)]               
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">               
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">##(4) 筛选特定范围的值               
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">df[df.Group.isin([&#34;</span>GroupA<span style="color:#0ff;font-weight:bold">&#34;,&#34;</span>GroupB<span style="color:#0ff;font-weight:bold">&#34;])]               
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">df[~df.Group.isin([&#34;</span>GroupA<span style="color:#0ff;font-weight:bold">&#34;,&#34;</span>GroupB<span style="color:#0ff;font-weight:bold">&#34;])]     # ~ 表示逻辑 非    
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">##(5) query语句
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">df.query(&#39;col1&gt;50 and Group==&#34;</span>GroupC<span style="color:#0ff;font-weight:bold">&#34;&#39;)
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">               
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">##(6) 去重
</span></span></span><span style="display:flex;"><span><span style="color:#0ff;font-weight:bold">df.drop_duplicates([&#34;</span>Group<span style="color:#0ff;font-weight:bold">&#34;</span><span style="color:#f00">])</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##直接删除指定列</span>
</span></span><span style="display:flex;"><span>df.drop([column], axis=<span style="color:#ff0;font-weight:bold">1</span>)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##直接删除指定行</span>
</span></span><span style="display:flex;"><span>df.drop([index])               
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#007f7f">##(1) replace替换</span>
</span></span><span style="display:flex;"><span>df.Group.unique()
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># array([&#39;GroupA&#39;, &#39;GroupB&#39;, &#39;GroupC&#39;], dtype=object)</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##一对一替换</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#0ff;font-weight:bold">&#34;Group&#34;</span>].replace(<span style="color:#0ff;font-weight:bold">&#34;GroupA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;GroupC&#34;</span>).unique()
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># array([&#39;GroupC&#39;, &#39;GroupB&#39;], dtype=object)</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##多对一替换</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#0ff;font-weight:bold">&#34;Group&#34;</span>].replace([<span style="color:#0ff;font-weight:bold">&#34;GroupA&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;GroupB&#34;</span>],<span style="color:#0ff;font-weight:bold">&#34;GroupC&#34;</span>).unique()
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># array([&#39;GroupC&#39;], dtype=object)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2) map替换</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#0ff;font-weight:bold">&#34;Group&#34;</span>].map({<span style="color:#0ff;font-weight:bold">&#34;GroupA&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;class01&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;GroupB&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;class02&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;GroupC&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;class03&#34;</span>}).unique()
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># array([&#39;class01&#39;, &#39;class02&#39;, &#39;class03&#39;], dtype=object)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="6dataframe合并">6、DataFrame合并<a hidden class="anchor" aria-hidden="true" href="#6dataframe合并">#</a></h1>
<h2 id="61-pdconcat">6.1 pd.concat<a hidden class="anchor" aria-hidden="true" href="#61-pdconcat">#</a></h2>
<p>对于Series对象的合并比较简单，容易；</p>
<p><code>pd.concat</code>合并两个DataFrame时，适合于这两个DataFrame的<strong>行名或列名索引完全相同</strong>，大部分相同的情况。</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> numpy <span style="color:#fff;font-weight:bold">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> pandas <span style="color:#fff;font-weight:bold">as</span> pd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df1 = pd.DataFrame(np.random.randint(<span style="color:#ff0;font-weight:bold">0</span>, <span style="color:#ff0;font-weight:bold">20</span>, (<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#ff0;font-weight:bold">4</span>)),
</span></span><span style="display:flex;"><span>                  columns=[<span style="color:#0ff;font-weight:bold">&#39;col1&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col2&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col3&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col4&#39;</span>],
</span></span><span style="display:flex;"><span>                  index=[<span style="color:#0ff;font-weight:bold">&#39;sp1&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;sp2&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;sp3&#39;</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#      col1  col2  col3  col4</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp1    11    10    19    13</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp2     6    13    18    10</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp3     5    14     6    10</span>
</span></span><span style="display:flex;"><span>df2 = pd.DataFrame(np.random.randint(<span style="color:#ff0;font-weight:bold">0</span>, <span style="color:#ff0;font-weight:bold">20</span>, (<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">4</span>)),
</span></span><span style="display:flex;"><span>                  columns=[<span style="color:#0ff;font-weight:bold">&#39;col1&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col2&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col3&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col4&#39;</span>],
</span></span><span style="display:flex;"><span>                  index=[<span style="color:#0ff;font-weight:bold">&#39;sp4&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;sp5&#39;</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#      col1  col2  col3  col4</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp4    11     2     0     2</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp5    11    19    12     4</span>
</span></span><span style="display:flex;"><span>df3 = pd.DataFrame(np.random.randint(<span style="color:#ff0;font-weight:bold">0</span>, <span style="color:#ff0;font-weight:bold">20</span>, (<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">4</span>)),
</span></span><span style="display:flex;"><span>                  columns=[<span style="color:#0ff;font-weight:bold">&#39;col1&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col2&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col3&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col4&#39;</span>],
</span></span><span style="display:flex;"><span>                  index=[<span style="color:#0ff;font-weight:bold">&#39;sp3&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;sp4&#39;</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#      col1  col2  col3  col4</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp3    13     5     3    15</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp4     7     2     2    13</span>
</span></span><span style="display:flex;"><span>df4 = pd.DataFrame(np.random.randint(<span style="color:#ff0;font-weight:bold">0</span>, <span style="color:#ff0;font-weight:bold">20</span>, (<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">4</span>)),
</span></span><span style="display:flex;"><span>                  columns=[<span style="color:#0ff;font-weight:bold">&#39;col3&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col4&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col5&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col6&#39;</span>],
</span></span><span style="display:flex;"><span>                  index=[<span style="color:#0ff;font-weight:bold">&#39;sp4&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;sp5&#39;</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#      col3  col4  col5  col6</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp4    11     1     2    15</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp5    18     2     5    18</span>
</span></span><span style="display:flex;"><span>df5 = pd.DataFrame(np.random.randint(<span style="color:#ff0;font-weight:bold">0</span>, <span style="color:#ff0;font-weight:bold">6</span>, (<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#ff0;font-weight:bold">2</span>)),
</span></span><span style="display:flex;"><span>                  columns=[<span style="color:#0ff;font-weight:bold">&#39;col5&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col6&#39;</span>],
</span></span><span style="display:flex;"><span>                  index=[<span style="color:#0ff;font-weight:bold">&#39;sp1&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;sp2&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;sp3&#39;</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#      col5  col6</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp1     0     5</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp2     5     3</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp3     2     0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(1)普通合并--列名相同，行名不同，上下合并</span>
</span></span><span style="display:flex;"><span>pd.concat([df1, df2])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2)普通合并--行名相同，列名不同，左右合并</span>
</span></span><span style="display:flex;"><span>pd.concat([df1, df5], axis=<span style="color:#ff0;font-weight:bold">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(3)上下合并时，忽略索引重复</span>
</span></span><span style="display:flex;"><span>pd.concat([df1, df3])                           <span style="color:#007f7f">#允许存在重复行名</span>
</span></span><span style="display:flex;"><span>pd.concat([df1, df3]).reset_index()
</span></span><span style="display:flex;"><span>pd.concat([df1, df3], verify_integrity=<span style="color:#fff;font-weight:bold">True</span>)    <span style="color:#007f7f">#有重复行名会报错</span>
</span></span><span style="display:flex;"><span>pd.concat([df1, df3], ignore_index=<span style="color:#fff;font-weight:bold">True</span>)        <span style="color:#007f7f">#重命名所有列名去重</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(4)上下合并时，列名不完全一致</span>
</span></span><span style="display:flex;"><span>pd.concat([df1, df4])                           <span style="color:#007f7f">#默认保留全集列名</span>
</span></span><span style="display:flex;"><span>pd.concat([df1, df4], join=<span style="color:#0ff;font-weight:bold">&#39;inner&#39;</span>)             <span style="color:#007f7f">#仅保留交集索引</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="62-pdmerge">6.2 pd.merge<a hidden class="anchor" aria-hidden="true" href="#62-pdmerge">#</a></h2>
<p>类似R语言中dplyr包的<code>join</code>系列函数；</p>
<p>主要用于两个DataFrame有相同列的情况。</p>
<h3 id="621-有相同列列名相同">6.2.1 有相同列，列名相同<a hidden class="anchor" aria-hidden="true" href="#621-有相同列列名相同">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df1 = pd.DataFrame([{<span style="color:#0ff;font-weight:bold">&#39;Stu&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;XiaoLi&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;C01&#39;</span>},
</span></span><span style="display:flex;"><span>                    {<span style="color:#0ff;font-weight:bold">&#39;Stu&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;XiaoSun&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;C01&#39;</span>},
</span></span><span style="display:flex;"><span>                    {<span style="color:#0ff;font-weight:bold">&#39;Stu&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;XiaoAi&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;C02&#39;</span>}])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#        Stu  Grade Class</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 0   XiaoLi      2   C01</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1  XiaoSun      1   C01</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 2   XiaoAi      3   C02</span>
</span></span><span style="display:flex;"><span>df2 = pd.DataFrame([{<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;C01&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Teacher&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;Mr.Zhou&#34;</span>},
</span></span><span style="display:flex;"><span>                    {<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;C02&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Teacher&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;Mr.Wu&#34;</span>}])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#   Class  Teacher</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 0   C01  Mr.Zhou</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1   C02    Mr.Wu</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##如上会自动按照Class列合并两个DataFrmae</span>
</span></span><span style="display:flex;"><span>pd.merge(df1, df2)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#等价于</span>
</span></span><span style="display:flex;"><span>pd.merge(df1, df2, on=<span style="color:#0ff;font-weight:bold">&#34;Class&#34;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>当两个DataFrame中不同含义的列碰巧具有相同的列名时，可进行重命名加以区分</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df1 = pd.DataFrame([{<span style="color:#0ff;font-weight:bold">&#39;Stu&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;XiaoLi&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;C01&#39;</span>},
</span></span><span style="display:flex;"><span>                    {<span style="color:#0ff;font-weight:bold">&#39;Stu&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;XiaoSun&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;C01&#39;</span>},
</span></span><span style="display:flex;"><span>                    {<span style="color:#0ff;font-weight:bold">&#39;Stu&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;XiaoAi&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;C02&#39;</span>}])
</span></span><span style="display:flex;"><span>df2 = pd.DataFrame([{<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;C01&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Teacher&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;Mr.Zhou&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;A&#39;</span>},
</span></span><span style="display:flex;"><span>                    {<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;C02&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Teacher&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;Mr.Wu&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;B&#39;</span>}])
</span></span><span style="display:flex;"><span>pd.merge(df1, df2, on=<span style="color:#0ff;font-weight:bold">&#34;Class&#34;</span>)
</span></span><span style="display:flex;"><span>pd.merge(df1, df2, on=<span style="color:#0ff;font-weight:bold">&#34;Class&#34;</span>, suffixes=[<span style="color:#0ff;font-weight:bold">&#34;_stu&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;_class&#34;</span>])
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="622-有相同列列名不同">6.2.2 有相同列，列名不同<a hidden class="anchor" aria-hidden="true" href="#622-有相同列列名不同">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span><span style="color:#007f7f">##(1) 指定列名合并</span>
</span></span><span style="display:flex;"><span>df1 = pd.DataFrame([{<span style="color:#0ff;font-weight:bold">&#39;Stu&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;XiaoLi&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;C01&#39;</span>},
</span></span><span style="display:flex;"><span>                    {<span style="color:#0ff;font-weight:bold">&#39;Stu&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;XiaoSun&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;C01&#39;</span>},
</span></span><span style="display:flex;"><span>                    {<span style="color:#0ff;font-weight:bold">&#39;Stu&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;XiaoAi&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;C02&#39;</span>}])
</span></span><span style="display:flex;"><span>df2 = pd.DataFrame([{<span style="color:#0ff;font-weight:bold">&#39;Room&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;C01&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Teacher&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;Mr.Zhou&#34;</span>},
</span></span><span style="display:flex;"><span>                    {<span style="color:#0ff;font-weight:bold">&#39;Room&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;C02&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Teacher&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;Mr.Wu&#34;</span>}])  
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#如上df1的Class列与df2的Room列表示相同的含义</span>
</span></span><span style="display:flex;"><span>pd.merge(df1, df2, left_on=<span style="color:#0ff;font-weight:bold">&#34;Class&#34;</span>, right_on=<span style="color:#0ff;font-weight:bold">&#34;Room&#34;</span>)
</span></span><span style="display:flex;"><span>pd.merge(df1, df2, left_on=<span style="color:#0ff;font-weight:bold">&#34;Class&#34;</span>, right_on=<span style="color:#0ff;font-weight:bold">&#34;Room&#34;</span>).drop(<span style="color:#0ff;font-weight:bold">&#34;Room&#34;</span>, axis=<span style="color:#ff0;font-weight:bold">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">##(2)指定索引合并</span>
</span></span><span style="display:flex;"><span>df2.set_index(<span style="color:#0ff;font-weight:bold">&#34;Room&#34;</span>, inplace=True)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#       Teacher</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Room</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># C01   Mr.Zhou</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># C02     Mr.Wu</span>
</span></span><span style="display:flex;"><span>pd.merge(df1, df2, left_on=<span style="color:#0ff;font-weight:bold">&#34;Class&#34;</span>, right_index=True)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="623-列的内容不完全相同">6.2.3 列的内容不完全相同<a hidden class="anchor" aria-hidden="true" href="#623-列的内容不完全相同">#</a></h3>
<ul>
<li>
<p>当两个DataFrame的相同列的内容不完全时，可设置<code>pd.merge()</code>的how参数进行不同的合并，可选<code>inner(default), left, right, outer</code></p>
</li>
<li>
<p>类似R包dplyr的<code>inner_join(), left_join(), right_join(), full_join()</code>函数</p>
</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#007f7f">##以其中的how=&#34;left&#34;为例</span>
</span></span><span style="display:flex;"><span>df1 = pd.DataFrame([{<span style="color:#0ff;font-weight:bold">&#39;Stu&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;XiaoLi&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;C01&#39;</span>},
</span></span><span style="display:flex;"><span>                    {<span style="color:#0ff;font-weight:bold">&#39;Stu&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;XiaoSun&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;C01&#39;</span>},
</span></span><span style="display:flex;"><span>                    {<span style="color:#0ff;font-weight:bold">&#39;Stu&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;XiaoAi&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;C02&#39;</span>},
</span></span><span style="display:flex;"><span>                    {<span style="color:#0ff;font-weight:bold">&#39;Stu&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;XiaoHe&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Grade&#39;</span>:<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#39;C03&#39;</span>},])
</span></span><span style="display:flex;"><span>df2 = pd.DataFrame([{<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;C01&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Teacher&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;Mr.Zhou&#34;</span>},
</span></span><span style="display:flex;"><span>                    {<span style="color:#0ff;font-weight:bold">&#39;Class&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;C02&#34;</span>,<span style="color:#0ff;font-weight:bold">&#39;Teacher&#39;</span>:<span style="color:#0ff;font-weight:bold">&#34;Mr.Wu&#34;</span>}])  
</span></span><span style="display:flex;"><span>pd.merge(df1, df2, how=<span style="color:#0ff;font-weight:bold">&#34;left&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#        Stu  Grade Class  Teacher</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 0   XiaoLi      2   C01  Mr.Zhou</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1  XiaoSun      1   C01  Mr.Zhou</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 2   XiaoAi      3   C02    Mr.Wu</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 3   XiaoHe      3   C03      NaN</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="7dataframe导入与导出">7、DataFrame导入与导出<a hidden class="anchor" aria-hidden="true" href="#7dataframe导入与导出">#</a></h1>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> numpy <span style="color:#fff;font-weight:bold">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> pandas <span style="color:#fff;font-weight:bold">as</span> pd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df = pd.DataFrame(np.random.randint(<span style="color:#ff0;font-weight:bold">0</span>, <span style="color:#ff0;font-weight:bold">20</span>, (<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#ff0;font-weight:bold">4</span>)),
</span></span><span style="display:flex;"><span>                  columns=[<span style="color:#0ff;font-weight:bold">&#39;col1&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col2&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col3&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;col4&#39;</span>],
</span></span><span style="display:flex;"><span>                  index=[<span style="color:#0ff;font-weight:bold">&#39;sp1&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;sp2&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;sp3&#39;</span>])
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#      col1  col2  col3  col4</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp1    11    10    19    13</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp2     6    13    18    10</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># sp3     5    14     6    10</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="71-导出">7.1 导出<a hidden class="anchor" aria-hidden="true" href="#71-导出">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df.to_csv(<span style="color:#0ff;font-weight:bold">&#39;test.csv&#39;</span>)
</span></span><span style="display:flex;"><span>df.to_csv(<span style="color:#0ff;font-weight:bold">&#39;test.txt&#39;</span>, sep=<span style="color:#0ff;font-weight:bold">&#34;</span><span style="color:#0ff;font-weight:bold">\t</span><span style="color:#0ff;font-weight:bold">&#34;</span>)       <span style="color:#007f7f">#指定分隔符</span>
</span></span><span style="display:flex;"><span>df.to_csv(<span style="color:#0ff;font-weight:bold">&#39;test.csv&#39;</span>, index=<span style="color:#fff;font-weight:bold">False</span>)    <span style="color:#007f7f">#不保存行名</span>
</span></span><span style="display:flex;"><span>df.to_csv(<span style="color:#0ff;font-weight:bold">&#39;test.csv&#39;</span>, header=<span style="color:#fff;font-weight:bold">False</span>)   <span style="color:#007f7f">#不保存列名</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df.to_excel(<span style="color:#0ff;font-weight:bold">&#39;test.xlsx&#39;</span>)                       <span style="color:#007f7f">#需要提前安装openpyxl模块</span>
</span></span><span style="display:flex;"><span>df.to_excel(<span style="color:#0ff;font-weight:bold">&#39;test.xlsx&#39;</span>,sheet_name=<span style="color:#0ff;font-weight:bold">&#39;Sheet1&#39;</span>)   <span style="color:#007f7f">#自定义保存的sheet名称</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df.
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="72-导入">7.2 导入<a hidden class="anchor" aria-hidden="true" href="#72-导入">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df0 = pd.read_csv(<span style="color:#0ff;font-weight:bold">&#39;./test.txt&#39;</span>)                      <span style="color:#007f7f">#默认第一行为列名，且没有行名</span>
</span></span><span style="display:flex;"><span>df0 = pd.read_csv(<span style="color:#0ff;font-weight:bold">&#39;./test.txt&#39;</span>, sep=<span style="color:#0ff;font-weight:bold">&#34;</span><span style="color:#0ff;font-weight:bold">\t</span><span style="color:#0ff;font-weight:bold">&#34;</span>)            <span style="color:#007f7f">#指定分隔符</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df0 = pd.read_csv(<span style="color:#0ff;font-weight:bold">&#39;./test.csv&#39;</span>, header=<span style="color:#fff;font-weight:bold">None</span>)         <span style="color:#007f7f">#不设置列名</span>
</span></span><span style="display:flex;"><span>df0 = pd.read_csv(<span style="color:#0ff;font-weight:bold">&#39;./test.csv&#39;</span>, names=<span style="color:#fff;font-weight:bold">list</span>(<span style="color:#0ff;font-weight:bold">&#34;ABCD&#34;</span>))  <span style="color:#007f7f">#自定义列名</span>
</span></span><span style="display:flex;"><span>df0 = pd.read_csv(<span style="color:#0ff;font-weight:bold">&#39;./test.csv&#39;</span>, index_col=<span style="color:#ff0;font-weight:bold">0</span>)         <span style="color:#007f7f">#指定第一列(索引为0)作为行名</span>
</span></span><span style="display:flex;"><span>df0 = pd.read_csv(<span style="color:#0ff;font-weight:bold">&#39;./test.csv&#39;</span>, index_col=<span style="color:#0ff;font-weight:bold">&#34;col1&#34;</span>)    <span style="color:#007f7f">#指定列作为行名</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df0 = pd.read_excel(<span style="color:#0ff;font-weight:bold">&#39;test.xlsx&#39;</span>) 
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="8长宽转换">8、长宽转换<a hidden class="anchor" aria-hidden="true" href="#8长宽转换">#</a></h1>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data = {
</span></span><span style="display:flex;"><span>    <span style="color:#0ff;font-weight:bold">&#39;Name&#39;</span>: [<span style="color:#0ff;font-weight:bold">&#39;Alice&#39;</span>, <span style="color:#0ff;font-weight:bold">&#39;Bob&#39;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#0ff;font-weight:bold">&#39;Math&#39;</span>: [<span style="color:#ff0;font-weight:bold">85</span>, <span style="color:#ff0;font-weight:bold">90</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#0ff;font-weight:bold">&#39;English&#39;</span>: [<span style="color:#ff0;font-weight:bold">92</span>, <span style="color:#ff0;font-weight:bold">88</span>]
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>df_wide = pd.DataFrame(data)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#     Name  Math  English</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 0  Alice    85       92</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1    Bob    90       88</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">## (1) 宽变长</span>
</span></span><span style="display:flex;"><span>df_long = df_wide.melt(id_vars=[<span style="color:#0ff;font-weight:bold">&#39;Name&#39;</span>], var_name=<span style="color:#0ff;font-weight:bold">&#39;Subject&#39;</span>, value_name=<span style="color:#0ff;font-weight:bold">&#39;Score&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#     Name  Subject  Score</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 0  Alice     Math     85</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 1    Bob     Math     90</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 2  Alice  English     92</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 3    Bob  English     88</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">## (2) 长变宽</span>
</span></span><span style="display:flex;"><span>df_wide = df_long.pivot(index=<span style="color:#0ff;font-weight:bold">&#39;Name&#39;</span>, columns=<span style="color:#0ff;font-weight:bold">&#39;Subject&#39;</span>, values=<span style="color:#0ff;font-weight:bold">&#39;Score&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Subject  English  Math</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Name                  </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Alice         92    85</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># Bob           88    90</span>
</span></span></code></pre></td></tr></table>
</div>
</div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://lishensuo.github.io/en/tags/python/">Python</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://lishensuo.github.io/en/posts/bioinfo/026%E5%8D%95%E7%BB%86%E8%83%9E%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7--cellphonedb%E7%BB%86%E8%83%9E%E9%80%9A%E8%AE%AF%E5%88%86%E6%9E%90/">
    <span class="title">« Prev Page</span>
    <br>
    <span>单细胞分析工具--cellphonedb细胞通讯分析</span>
  </a>
  <a class="next" href="https://lishensuo.github.io/en/posts/bioinfo/027%E5%8D%95%E7%BB%86%E8%83%9E%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7--doubletfinder%E8%AF%86%E5%88%AB%E5%8F%8C%E7%BB%86%E8%83%9E/">
    <span class="title">Next Page »</span>
    <br>
    <span>单细胞分析工具--DoubletFinder识别双细胞</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2025 <a href="https://lishensuo.github.io/en/">Li&#39;s Bioinfo-Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
		<br/>您是本站第 <span id="busuanzi_value_site_uv"></span> 位访问者，总浏览量为 <span id="busuanzi_value_site_pv"></span> 次
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>

<script type="text/javascript"
async
src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
MathJax.Hub.Config({
tex2jax: {
inlineMath: [['$','$'], ['\\(','\\)']],
displayMath: [['$$','$$'], ['\[\[','\]\]']],
processEscapes: true,
processEnvironments: true,
skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
TeX: { equationNumbers: { autoNumber: "AMS" },
extensions: ["AMSmath.js", "AMSsymbols.js"] }
}
});

MathJax.Hub.Queue(function() {



var all = MathJax.Hub.getAllJax(), i;
for(i = 0; i < all.length; i += 1) {
all[i].SourceElement().parentNode.className += ' has-jax';
}
});
</script>

<style>
code.has-jax {
font: inherit;
font-size: 100%;
background: inherit;
border: inherit;
color: #515151;
}
</style></body>
</html>
